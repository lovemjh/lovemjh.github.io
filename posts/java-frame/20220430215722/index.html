<!DOCTYPE html>
<html><head>
  
  
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=no">

  <title>mybatis-3</title>
  <meta name="description" content="MJH Blog & MEET HTML Theme">
  
  <link rel="shortcut icon" type="image/x-icon" href="images/favicon.png">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery.fancybox@2.1.5/source/jquery.fancybox.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.4/tocbot.css">
  <link href="https://cdn.bootcss.com/highlight.js/9.12.0/styles/monokai.min.css" rel="stylesheet">
  <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script type="text/javascript">
    if (!!window.ActiveXObject || "ActiveXObject" in window) { 
      alert('朋友，上古浏览器不支持呢~');
    }
  </script>
  <style>
    .highlight {
      overflow-x: auto;
    }

    pre {
      position: relative;
      padding: 30px 10px 10px 10px;
      border-width: 1px;
      border-color:#7c4242;
    }

    .post-content pre code {
      font-family: Consolas;
    }

    pre::after {
      display: block;
      content: " ";
      position: absolute;
      border-radius: 50%;
      background: #ff5f56;
      width: 12px;
      height: 12px;
      top: 0;
      left: 12px;
      margin-top: 12px;
      -webkit-box-shadow: 20px 0 #ffbd2e, 40px 0 #27c93f;
      box-shadow: 20px 0 #ffbd2e, 40px 0 #27c93f;
    }










    html,
    body {
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch;
    }

    .page-list {
      height: 18em;
      background-color: rgba(255, 255, 255, 0);
      border-radius: 20px;
      margin-bottom: 2em;
      box-shadow: 2px 4px 6px #000;
      display: flex;
    }

    .page-img {
      float: left;
      display: block;
      width: 40%;
      height: 100%;
      border-radius: 20px 0px 0px 20px;
      background-color: yellow;
      background-image: url(https://api.ixiaowai.cn/api/api.php);
      background-repeat: no-repeat;
      background-size: 100% 100%;
      -moz-background-size: 100% 100%;
    }

    .page-mian {
      float: left;
      display: block;
      width: 60%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0);
       
      padding: 0% 2% 0% 2%;
    }

    .page-Title a {
      text-decoration: none;
      font-size: 22px;
      color: rgb(0, 0, 0);
    }

    .page-Content a {
      text-decoration: none;
      font-size: 16px;
      color: rgb(0, 0, 0);
    }


    .ull {
      display: flex;
      flex-flow: row nowrap;
      justify-content: center;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.263);
      height: 50px;
      margin: 0px;
    }

    .ull a {
      text-decoration: none;
      font-size: 22px;
      color: rgb(255, 255, 255);
    }

    .lii {
      display: inline;
      margin-right: 20px;
    }

    .btn {
      width: 120px;
      height: 40px;
      background: linear-gradient(315deg, #a4d8fa 0%, #5eb1e9 74%);
      border: none;
      border-radius: 10px;
      font-family: 'Lato', sans-serif;
      font-weight: 500;
      font-size: smaller;
      color: #fff;
      box-shadow: inset 2px 2px 2px 0px rgba(255, 255, 255, .5),
        7px 7px 20px 0px rgba(0, 0, 0, .1),
        4px 4px 5px 0px rgba(0, 0, 0, .1);
      outline: none;
      position: relative;
      z-index: 0;
    }

    .btn::before {
      position: absolute;
      content: '';
      left: 0;
      bottom: 0;
      width: 100%;
      height: 0;
      transition: all 0.3s ease;
      border-radius: 10px;
      background: linear-gradient(315deg, #4dccc6 0%, #96e4df 74%);
      z-index: -1;
    }

    .btn:hover::before {
      top: 0;
      height: 100%;
    }

    .btn:active {
      top: 2px;
    }










    @media screen and (max-width: 1080px) {

       
      .navigation {
        display: none;
      }

      .page-list {
        height: 25em;
        background-color: rgba(255, 255, 255, 0);
        border-radius: 20px;
        margin-bottom: 2em;
        box-shadow: 2px 4px 6px #000;
        display: block;
      }

      .page-img {
        width: 100%;
        height: 40%;
        border-radius: 20px 20px 0px 0px;
        background-color: yellow;
        background-image: url(https://api.ixiaowai.cn/api/api.php);
        background-repeat: no-repeat;
        background-size: 100% 100%;
        -moz-background-size: 100% 100%;
      }

      .page-mian {
        width: 100%;
        height: 60%;
        background-color: rgba(0, 0, 0, 0);
         
        padding: 0% 2% 0% 2%;
      }

    }
  </style>




  <style>
    a.toc-link {
      color: currentColor;
      height: auto;
    }

     
    ::-webkit-scrollbar {
      width: 8px;
      height: 6px
    }

     
    ::-webkit-scrollbar-track {
      background-color: transparent;
      -webkit-border-radius: 2em;
      -moz-border-radius: 2em;
      border-radius: 2em
    }

     
    ::-webkit-scrollbar-thumb {
      background-color: #30B07F;
      background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, .4) 100%, transparent 100%, transparent 50%, rgba(255, 255, 255, .4) 50%, rgba(255, 255, 255, .4) 75%, transparent 75%, transparent);
      -webkit-border-radius: 2em;
      -moz-border-radius: 2em;
      border-radius: 2em
    }
  </style>
  <style>
    .sidebar {
      z-index: 998;
      position: fixed;
      left: -200px;
      width: 200px;
      height: 100%;
      background: #ffffff;
      transition: all .5s ease;
    }

    .sidebar .top {
      font-size: 22px;
      color: rgb(0, 0, 0);
      text-align: center;
      height: 60px;
      line-height: 60px;
      background-color: rgb(255, 255, 255);
      user-select: none;

    }

    .sidebar ul {
      list-style: none;
    }

    .sidebar ul a {
      display: block;
      height: 100%;
      width: 100%;
      text-align: center;
      line-height: 45px;
      font-size: 18px;
      color: rgb(0, 0, 0);
      box-sizing: border-box;
      border-top: 1px solid rgb(255, 0, 0);
      border-bottom: 1px solid rgb(0, 17, 255);
      transition: .4s;
    }

    ul li:hover a {
      padding-left: 30px;
      color: #7c4242;
      border-left: 5px solid #ffffff;
      transition: all 0.5s;
    }

    .sidebar ul a i {
      margin-right: 16px;
    }

    #check {
      display: none;
    }

    label #btn,
    label #cancel {
      position: fixed;
      cursor: pointer;
      background-color: #000000;
      border-radius: 3px;
    }

    label #btn {
      left: 5px;
      top: 7px;
      font-size: 25px;
      color: #fff;
      padding: 6px 10px;
      transition: all .5s;
      z-index: 999;
    }

    label #cancel {
      z-index: 999;
      left: -145px;
      top: 10px;
      font-size: 25px;
      color: rgb(255, 255, 255);
      padding: 4px 9px;
      transition: all .5s ease;
    }

    #check:checked~.sidebar {
      left: 0;
    }

    #check:checked~label #btn {
      left: 10px;
      opacity: 0;
      pointer-events: none;
    }

    #check:checked~label #cancel {
      left: 150px;
    }

     
    .navigation {
      width: 100%;
      height: 50px;
      background-color: rgba(208, 240, 121, 0.184);
      position: fixed;
      left: 0;
      top: 0;
      text-align: center;
      transition: top 0.5s;
      z-index: 999;
    }

     
    .hide {
      top: -60px;
    }
  </style>
</head><body><input type="checkbox" id="check">
<label for="check">
  <i class="fa fa-bars" id="btn"></i>
  <i class="fa fa-times" id="cancel"></i>
</label>
<div class="sidebar">
  <div class="top">Hi~</div>
  <ul>
    
    <li class="lii">
      <a href="/">
        <div class="burger-item">
          <i class='fa fa-home'></i> Home
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/posts">
        <div class="burger-item">
          <i class='fa fa-book'></i> Posts
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/archive">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> Archive
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/categories">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> Categories
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/tags">
        <div class="burger-item">
          <i class='fa fa-tags'></i> Tags
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/about">
        <div class="burger-item">
          <i class='fa fa-info-circle'></i> About
        </div>
      </a>
    </li>
    
  </ul>
</div>
<div id="body-wrap content"><nav class="navigation">
  <ul class="ull">
    
    <li class="lii">
      <a href="/">
        <div class="burger-item">
          <i class='fa fa-home'></i> Home
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/posts">
        <div class="burger-item">
          <i class='fa fa-book'></i> Posts
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/archive">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> Archive
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/categories">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> Categories
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/tags">
        <div class="burger-item">
          <i class='fa fa-tags'></i> Tags
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/about">
        <div class="burger-item">
          <i class='fa fa-info-circle'></i> About
        </div>
      </a>
    </li>
    
  </ul>
</nav>
  <div style="width: 100%; height: 65vh;">
    <div id="page_site-info">
      <div id="site-title">
        <input type="checkbox" id="check">
        <br>
        <span class="blogtitle"></span>
        
        
        <div class="post-header">
          <span>
            
            <i class="fa fa-calendar"></i>
            2022-05-25&nbsp;
          </span>
          <span>
            
            <i class="fa fa-calendar-check-o"></i>
            2022-05-25&nbsp;&nbsp;&nbsp;
          </span>
          <span>
            
            <i class="fa fa-edit"></i>
            6398 字
          </span>&nbsp;
          <span>
            
            <i class="fa fa-paper-plane"></i>
            13 分钟
          </span>
        </div><div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
		</div>
		<div class="tag">
			
			 - 
			
			<a href="/tags/"></a>
			
		</div>
	</div>
</div>

        <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11"></script>
        <script>
          var typed = new Typed(".blogtitle", {
            strings: ['mybatis-3'],
            startDelay: 300,
            typeSpeed: 100,
            loop: true,
            backSpeed: 50,
            showCursor: true
          });
        </script>
      </div>
    </div>
  </div>
  
<main id="content-outer">
    <div class="layout_page" id="content-inner">
        <article id="page" style="margin-right: 10px;">
            <div class="js-toc-content">
                <h1 id="延迟加载策略">延迟加载策略</h1>
<h2 id="延迟加载的简介什么是延迟加载为什么要使用延迟加载">延迟加载的简介：什么是延迟加载，为什么要使用延迟加载</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1.什么是延迟加载?
</span></span><span class="line"><span class="cl">延迟加载(lazy load)是(也称为懒加载)关联关系对象默认的加载方式，延迟加载机制是为了避免一些无谓的性能开销而提出来的，所谓延迟加载就是当在真正需要数据的时候，才真正执行数据加载操作。
</span></span><span class="line"><span class="cl">延迟加载，可以简单理解为，只有在使用的时候，才会发出sql语句进行查询。
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">2.为什么要使用延迟加载?
</span></span><span class="line"><span class="cl">减少访问数据库的频率，我们要访问的数据量过大时，明显用缓存不太合适，因为内存容量有限为了减少并发量，减少系统资源的消耗。
</span></span></code></pre></div><h2 id="配置延迟加载策略并测试结果">配置延迟加载策略，并测试结果</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-text" data-lang="text"><span class="line"><span class="cl">在mybatis中使用resultMap来实现一对一，一对多，多对多关系的操作。主要是通过 association、collection 实现一对一及一对多映射。association、collection 具备延迟加载功能。
</span></span></code></pre></div><h3 id="局部延时加载">局部延时加载</h3>
<h4 id="departmentdaoxml配置文件">DepartmentDao.xml配置文件</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;select</span> <span class="na">id=</span><span class="s">&#34;getDepartmentById&#34;</span> <span class="na">resultMap=</span><span class="s">&#34;DepartemntResultMap&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    select * from department where d_id=#{id}
</span></span><span class="line"><span class="cl"> <span class="nt">&lt;/select&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;resultMap</span> <span class="na">id=</span><span class="s">&#34;DepartemntResultMap&#34;</span> <span class="na">type=</span><span class="s">&#34;Department&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&lt;id</span> <span class="na">column=</span><span class="s">&#34;d_id&#34;</span> <span class="na">property=</span><span class="s">&#34;id&#34;</span><span class="nt">&gt;&lt;/id&gt;</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&lt;result</span> <span class="na">column=</span><span class="s">&#34;d_name&#34;</span> <span class="na">property=</span><span class="s">&#34;name&#34;</span><span class="nt">&gt;&lt;/result&gt;</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&lt;collection</span> <span class="na">property=</span><span class="s">&#34;emps&#34;</span> <span class="na">ofType=</span><span class="s">&#34;Employee&#34;</span> <span class="na">column=</span><span class="s">&#34;d_id&#34;</span>
</span></span><span class="line"><span class="cl">              <span class="na">select=</span><span class="s">&#34;cn.offcn.mapper.EmployeeMapper.getEmployeeByDepartId&#34;</span>
</span></span><span class="line"><span class="cl">                 <span class="na">fetchType=</span><span class="s">”lazy”</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">     <span class="nt">&lt;/collection&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/resultMap&gt;</span>
</span></span><span class="line"><span class="cl">相关联的查询标签上加 fetchType=”lazy” 
</span></span><span class="line"><span class="cl">fetchType默认值为eager 立即加载,Lazy为延时加载。
</span></span></code></pre></div><h4 id="测试类">测试类</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGetDepartentById</span><span class="o">()</span> <span class="kd">throws</span>  <span class="n">Exception</span><span class="o">{</span>
</span></span><span class="line"><span class="cl"><span class="c1">//获取SqlSession对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="c1">//调用SqlSession 创建 UserDao接口的代理对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">DepartmentDao</span> <span class="n">departmentDao</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">DepartmentDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="n">Department</span> <span class="n">dept</span><span class="o">=</span><span class="n">departmentDao</span><span class="o">.</span><span class="na">getDepartentById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//打印
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">dept</span><span class="o">.</span><span class="na">getName</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="c1">//提交事务
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="c1">//关闭连接
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="2全局延时加载">2.全局延时加载</h3>
<p>如果希望所有关联都需要延时加载，可以在mybatis的核心配置文件中进行配置，不用在collection或association中指定。默认全局开启。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;settings&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!--开启延时加载开关--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;lazyLoadingEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!--关闭立即加载，实施按需加载--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;aggressiveLazyLoading&#34;</span> <span class="na">value=</span><span class="s">&#34;false&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/settings&gt;</span>
</span></span></code></pre></div><h1 id="mybatis的逆向工程">MyBatis的逆向工程</h1>
<h2 id="逆向工程绍">逆向工程绍</h2>
<p>MyBatis的一个主要的特点就是需要程序员自己编写sql，那么如果表太多的话，难免会很麻烦，所以mybatis官方提供了一个逆向工程，可以针对单表自动生成mybatis执行所需要的代码（包括mapper.xml、mapper.java、po..）。一般在开发中，常用的逆向工程方式是通过数据库的表生成代码。</p>
<h2 id="构建项目环境">构建项目环境</h2>
<h3 id="构建maven工程并导入依赖">构建maven工程并导入依赖</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Java" data-lang="Java"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">dependencies</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">org</span><span class="o">.</span><span class="na">mybatis</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">mybatis</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="n">3</span><span class="o">.</span><span class="na">4</span><span class="o">.</span><span class="na">6</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">mysql</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">mysql</span><span class="o">-</span><span class="n">connector</span><span class="o">-</span><span class="n">java</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="n">5</span><span class="o">.</span><span class="na">1</span><span class="o">.</span><span class="na">47</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">org</span><span class="o">.</span><span class="na">mybatis</span><span class="o">.</span><span class="na">generator</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">mybatis</span><span class="o">-</span><span class="n">generator</span><span class="o">-</span><span class="n">core</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="n">1</span><span class="o">.</span><span class="na">3</span><span class="o">.</span><span class="na">7</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">log4j</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">log4j</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="n">1</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">16</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">dependencies</span><span class="o">&gt;</span>
</span></span></code></pre></div><h3 id="编写配置框架配置文件">编写配置框架配置文件</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Xml" data-lang="Xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34; ?&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="cp">&lt;!DOCTYPE configuration
</span></span></span><span class="line"><span class="cl"><span class="cp">          PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">          &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;properties</span> <span class="na">resource=</span><span class="s">&#34;db.properties&#34;</span><span class="nt">&gt;&lt;/properties&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;settings&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;lazyLoadingEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="c">&lt;!--开启二级缓存--&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;cacheEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/settings&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;typeAliases&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;cn.offcn.entity&#34;</span><span class="nt">&gt;&lt;/package&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/typeAliases&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;plugins&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;plugin</span> <span class="na">interceptor=</span><span class="s">&#34;com.github.pagehelper.PageInterceptor&#34;</span><span class="nt">&gt;&lt;/plugin&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/plugins&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">&gt;&lt;/transactionManager&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;${driver}&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;${url}&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;${username}&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;${password}&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="nt">&lt;/dataSource&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/environment&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/environments&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!--在核心配置文件中注册mapper--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;mappers&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;cn.offcn.mapper&#34;</span><span class="nt">&gt;&lt;/package&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/mappers&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></div><h3 id="编写逆向工程的配置文件generatorxml">编写逆向工程的配置文件generator.xml</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Xml" data-lang="Xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE generatorConfiguration
</span></span></span><span class="line"><span class="cl"><span class="cp">PUBLIC &#34;-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">&#34;http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;generatorConfiguration&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;context</span> <span class="na">id=</span><span class="s">&#34;testTables&#34;</span> <span class="na">targetRuntime=</span><span class="s">&#34;MyBatis3&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;commentGenerator&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="c">&lt;!-- 是否去除自动生成的注释 true：是 ： false:否 --&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;suppressAllComments&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;/commentGenerator&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="c">&lt;!--数据库连接的信息：驱动类、连接地址、用户名、密码 --&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;jdbcConnection</span> <span class="na">driverClass=</span><span class="s">&#34;com.mysql.jdbc.Driver&#34;</span>
</span></span><span class="line"><span class="cl">			<span class="na">connectionURL=</span><span class="s">&#34;jdbc:mysql://localhost:3306/mybatis828_002&#34;</span>
</span></span><span class="line"><span class="cl">						<span class="na">userId=</span><span class="s">&#34;root&#34;</span> <span class="na">password=</span><span class="s">&#34;root&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;/jdbcConnection&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c">&lt;!-- 默认false，把JDBC DECIMAL 和 NUMERIC 类型解析为 Integer，为 true时把JDBC DECIMAL 和 
</span></span></span><span class="line"><span class="cl"><span class="c">			NUMERIC 类型解析为java.math.BigDecimal --&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;javaTypeResolver&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;forceBigDecimals&#34;</span> <span class="na">value=</span><span class="s">&#34;false&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;/javaTypeResolver&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c">&lt;!-- targetProject:生成实体类的位置 --&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;javaModelGenerator</span> <span class="na">targetPackage=</span><span class="s">&#34;cn.offcn.entity&#34;</span>
</span></span><span class="line"><span class="cl">			<span class="na">targetProject=</span><span class="s">&#34;.\src\main\java&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="c">&lt;!-- enableSubPackages:是否让schema作为包的后缀 --&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;enableSubPackages&#34;</span> <span class="na">value=</span><span class="s">&#34;false&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="c">&lt;!-- 从数据库返回的值被清理前后的空格 --&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;trimStrings&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;/javaModelGenerator&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">		<span class="c">&lt;!-- targetProject:mapper映射文件生成的位置 --&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;sqlMapGenerator</span> <span class="na">targetPackage=</span><span class="s">&#34;cn.offcn.mapper&#34;</span>
</span></span><span class="line"><span class="cl">						 <span class="na">targetProject=</span><span class="s">&#34;.\src\main\java&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="c">&lt;!-- enableSubPackages:是否让schema作为包的后缀 --&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;enableSubPackages&#34;</span> <span class="na">value=</span><span class="s">&#34;false&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;/sqlMapGenerator&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="c">&lt;!-- targetPackage：mapper接口生成的位置 --&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;javaClientGenerator</span> <span class="na">type=</span><span class="s">&#34;XMLMAPPER&#34;</span>
</span></span><span class="line"><span class="cl">							 <span class="na">targetPackage=</span><span class="s">&#34;cn.offcn.mapper&#34;</span>
</span></span><span class="line"><span class="cl">							 <span class="na">targetProject=</span><span class="s">&#34;.\src\main\java&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="c">&lt;!-- enableSubPackages:是否让schema作为包的后缀 --&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;enableSubPackages&#34;</span> <span class="na">value=</span><span class="s">&#34;false&#34;</span> <span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;/javaClientGenerator&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="c">&lt;!-- 指定数据库表 --&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;table</span> <span class="na">tableName=</span><span class="s">&#34;department&#34;</span><span class="nt">&gt;&lt;/table&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;table</span> <span class="na">tableName=</span><span class="s">&#34;employee&#34;</span><span class="nt">&gt;&lt;/table&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;table</span> <span class="na">tableName=</span><span class="s">&#34;person&#34;</span><span class="nt">&gt;&lt;/table&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;table</span> <span class="na">tableName=</span><span class="s">&#34;idcard&#34;</span><span class="nt">&gt;&lt;/table&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;table</span> <span class="na">tableName=</span><span class="s">&#34;student&#34;</span><span class="nt">&gt;&lt;/table&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;table</span> <span class="na">tableName=</span><span class="s">&#34;teacher_student&#34;</span><span class="nt">&gt;&lt;/table&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;table</span> <span class="na">tableName=</span><span class="s">&#34;teacher&#34;</span><span class="nt">&gt;&lt;/table&gt;</span>
</span></span><span class="line"><span class="cl">	<span class="nt">&lt;/context&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/generatorConfiguration&gt;</span>
</span></span></code></pre></div><h3 id="调用官方api实现逆向工程">调用官方api实现逆向工程</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Java" data-lang="Java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">cn.test</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.mybatis.generator.api.MyBatisGenerator</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.mybatis.generator.config.Configuration</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.mybatis.generator.config.xml.ConfigurationParser</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.mybatis.generator.internal.DefaultShellCallback</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.io.File</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.ArrayList</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GeneratorTest</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">Exception</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">warnings</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ArrayList</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;();</span>
</span></span><span class="line"><span class="cl">  <span class="kt">boolean</span> <span class="n">overwrite</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//指定 逆向工程配置文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">File</span> <span class="n">configFile</span> <span class="o">=</span> <span class="k">new</span> <span class="n">File</span><span class="o">(</span><span class="s">&#34;F:\\828class\\workspace\\mybatis\\mybatis004_reflect\\generatorConfig.xml&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">ConfigurationParser</span> <span class="n">cp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ConfigurationParser</span><span class="o">(</span><span class="n">warnings</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Configuration</span> <span class="n">config</span> <span class="o">=</span> <span class="n">cp</span><span class="o">.</span><span class="na">parseConfiguration</span><span class="o">(</span><span class="n">configFile</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">DefaultShellCallback</span> <span class="n">callba</span>
</span></span><span class="line"><span class="cl">      <span class="n">ck</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DefaultShellCallback</span><span class="o">(</span><span class="n">overwrite</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisGenerator</span> <span class="n">myBatisGenerator</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MyBatisGenerator</span><span class="o">(</span><span class="n">config</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">          <span class="n">callback</span><span class="o">,</span> <span class="n">warnings</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">myBatisGenerator</span><span class="o">.</span><span class="na">generate</span><span class="o">(</span><span class="kc">null</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="逆向工程自动生成的文件解析">逆向工程自动生成的文件解析</h3>
<h3 id="使用逆向工程完成数据crud">使用逆向工程完成数据CRUD</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Java" data-lang="Java"><span class="line"><span class="cl"><span class="c1">//添加员工
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">addEmployee</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeMapper</span> <span class="n">employeeMapper</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Employee</span> <span class="n">employee</span><span class="o">=</span><span class="k">new</span> <span class="n">Employee</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">employee</span><span class="o">.</span><span class="na">seteName</span><span class="o">(</span><span class="s">&#34;马大力&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">employee</span><span class="o">.</span><span class="na">seteGender</span><span class="o">(</span><span class="s">&#34;男&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">employee</span><span class="o">.</span><span class="na">seteAge</span><span class="o">(</span><span class="n">23</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">employee</span><span class="o">.</span><span class="na">seteDepartId</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">employeeMapper</span><span class="o">.</span><span class="na">insert</span><span class="o">(</span><span class="n">employee</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//根据id查询员工
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">queryEmployeeById</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeMapper</span> <span class="n">employeeMapper</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Employee</span> <span class="n">emp</span><span class="o">=</span><span class="n">employeeMapper</span><span class="o">.</span><span class="na">selectByPrimaryKey</span><span class="o">(</span><span class="n">2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">emp</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//根据年龄查询员工
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">queryEmployeeByAge</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">  <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeMapper</span> <span class="n">employeeMapper</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeExample</span> <span class="n">employeeExample</span><span class="o">=</span><span class="k">new</span> <span class="n">EmployeeExample</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeExample</span><span class="o">.</span><span class="na">Criteria</span> <span class="n">criteria</span><span class="o">=</span><span class="n">employeeExample</span><span class="o">.</span><span class="na">createCriteria</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">criteria</span><span class="o">.</span><span class="na">andEAgeGreaterThan</span><span class="o">(</span><span class="n">20</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">List</span><span class="o">&lt;</span><span class="n">Employee</span><span class="o">&gt;</span> <span class="n">employeeList</span><span class="o">=</span><span class="n">employeeMapper</span><span class="o">.</span><span class="na">selectByExample</span><span class="o">(</span><span class="n">employeeExample</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span> <span class="o">:</span> <span class="n">employeeList</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//根据年龄和性别查询员工
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">queryEmployeeByAgeAndGender</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">      <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">      <span class="n">EmployeeMapper</span> <span class="n">employeeMapper</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">EmployeeExample</span> <span class="n">employeeExample</span><span class="o">=</span><span class="k">new</span> <span class="n">EmployeeExample</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">      <span class="n">EmployeeExample</span><span class="o">.</span><span class="na">Criteria</span> <span class="n">criteria</span><span class="o">=</span><span class="n">employeeExample</span><span class="o">.</span><span class="na">createCriteria</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">      <span class="n">criteria</span><span class="o">.</span><span class="na">andEAgeGreaterThan</span><span class="o">(</span><span class="n">20</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">criteria</span><span class="o">.</span><span class="na">andEGenderEqualTo</span><span class="o">(</span><span class="s">&#34;男&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">      <span class="n">List</span><span class="o">&lt;</span><span class="n">Employee</span><span class="o">&gt;</span> <span class="n">employeeList</span><span class="o">=</span><span class="n">employeeMapper</span><span class="o">.</span><span class="na">selectByExample</span><span class="o">(</span><span class="n">employeeExample</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">      <span class="k">for</span> <span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span> <span class="o">:</span> <span class="n">employeeList</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">          <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">      <span class="o">}</span>
</span></span><span class="line"><span class="cl">      <span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">      <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//根据id修改员工
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">updateEmployeeById</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">  <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeMapper</span> <span class="n">employeeMapper</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Employee</span> <span class="n">employee</span><span class="o">=</span> <span class="n">employeeMapper</span><span class="o">.</span><span class="na">selectByPrimaryKey</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">employee</span><span class="o">.</span><span class="na">seteGender</span><span class="o">(</span><span class="s">&#34;女&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">employee</span><span class="o">.</span><span class="na">seteDepartId</span><span class="o">(</span><span class="n">2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">employeeMapper</span><span class="o">.</span><span class="na">updateByPrimaryKey</span><span class="o">(</span><span class="n">employee</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//根据id删除员工
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">deleteEmployeeById</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">  <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeMapper</span> <span class="n">employeeMapper</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">employeeMapper</span><span class="o">.</span><span class="na">deleteByPrimaryKey</span><span class="o">(</span><span class="n">10</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//根据姓名更新员工
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">updateEmployeeByName</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">  <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeMapper</span> <span class="n">employeeMapper</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Employee</span> <span class="n">employee</span><span class="o">=</span> <span class="n">employeeMapper</span><span class="o">.</span><span class="na">selectByPrimaryKey</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">employee</span><span class="o">.</span><span class="na">seteGender</span><span class="o">(</span><span class="s">&#34;男&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">employee</span><span class="o">.</span><span class="na">seteAge</span><span class="o">(</span><span class="n">24</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeExample</span> <span class="n">employeeExample</span><span class="o">=</span><span class="k">new</span> <span class="n">EmployeeExample</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeExample</span><span class="o">.</span><span class="na">Criteria</span> <span class="n">criteria</span> <span class="o">=</span> <span class="n">employeeExample</span><span class="o">.</span><span class="na">createCriteria</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">criteria</span><span class="o">.</span><span class="na">andENameEqualTo</span><span class="o">(</span><span class="n">employee</span><span class="o">.</span><span class="na">geteName</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">  <span class="n">employeeMapper</span><span class="o">.</span><span class="na">updateByExample</span><span class="o">(</span><span class="n">employee</span><span class="o">,</span><span class="n">employeeExample</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//分页查询员工
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">queryEmployees</span><span class="o">(</span><span class="kt">int</span> <span class="n">currentPage</span><span class="o">,</span><span class="kt">int</span> <span class="n">pageSize</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="n">currentPage</span><span class="o">,</span><span class="n">pageSize</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeMapper</span> <span class="n">employeeMapper</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeExample</span> <span class="n">employeeExample</span><span class="o">=</span><span class="k">new</span> <span class="n">EmployeeExample</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">List</span><span class="o">&lt;</span><span class="n">Employee</span><span class="o">&gt;</span> <span class="n">employeeList</span><span class="o">=</span><span class="n">employeeMapper</span><span class="o">.</span><span class="na">selectByExample</span><span class="o">(</span><span class="n">employeeExample</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">PageInfo</span><span class="o">&lt;</span><span class="n">Employee</span><span class="o">&gt;</span> <span class="n">pageInfo</span><span class="o">=</span><span class="k">new</span> <span class="n">PageInfo</span><span class="o">&lt;&gt;(</span><span class="n">employeeList</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">List</span><span class="o">&lt;</span><span class="n">Employee</span><span class="o">&gt;</span> <span class="n">empList</span><span class="o">=</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getList</span><span class="o">();</span>  <span class="c1">//取当前页的所有记录
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">long</span> <span class="n">totalRecored</span><span class="o">=</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getTotal</span><span class="o">();</span><span class="c1">//总记录数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="kt">int</span>  <span class="n">totalPages</span><span class="o">=</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getPages</span><span class="o">();</span> <span class="c1">//总页数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;总记录数:&#34;</span><span class="o">+</span><span class="n">totalRecored</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;总页数:&#34;</span><span class="o">+</span><span class="n">totalPages</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">for</span> <span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span> <span class="o">:</span> <span class="n">empList</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">      <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="o">}</span>
</span></span><span class="line"><span class="cl">  <span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//根据性别和部门查询员工
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">queryEmployeeByGenderNum</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">  <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeMapper</span> <span class="n">employeeMapper</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeExample</span> <span class="n">employeeExample</span><span class="o">=</span><span class="k">new</span> <span class="n">EmployeeExample</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeExample</span><span class="o">.</span><span class="na">Criteria</span> <span class="n">criteria</span> <span class="o">=</span> <span class="n">employeeExample</span><span class="o">.</span><span class="na">createCriteria</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">criteria</span><span class="o">.</span><span class="na">andEGenderEqualTo</span><span class="o">(</span><span class="s">&#34;男&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">criteria</span><span class="o">.</span><span class="na">andEDepartIdEqualTo</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="kt">long</span> <span class="n">count</span><span class="o">=</span> <span class="n">employeeMapper</span><span class="o">.</span><span class="na">countByExample</span><span class="o">(</span><span class="n">employeeExample</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">count</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//根据部门查询员工
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">public</span> <span class="kd">static</span> <span class="n">Employee</span> <span class="nf">queryEmployeeDepartmentById</span><span class="o">(</span><span class="kt">int</span> <span class="n">eid</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">  <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeMapper</span> <span class="n">employeeMapper</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Employee</span> <span class="n">employee</span><span class="o">=</span><span class="n">employeeMapper</span><span class="o">.</span><span class="na">selectByPrimaryKey</span><span class="o">(</span><span class="n">eid</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//查部门
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">DepartmentMapper</span> <span class="n">departmentMapper</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">DepartmentMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Department</span> <span class="n">department</span><span class="o">=</span><span class="n">departmentMapper</span><span class="o">.</span><span class="na">selectByPrimaryKey</span><span class="o">(</span><span class="n">employee</span><span class="o">.</span><span class="na">geteDepartId</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">  <span class="n">employee</span><span class="o">.</span><span class="na">setDepart</span><span class="o">(</span><span class="n">department</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">employee</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="n">addEmployee</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">queryEmployeeById</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">queryEmployeeByAge</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">queryEmployeeByAgeAndGender</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">updateEmployeeById</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">updateEmployeeByName</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">deleteEmployeeById</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">queryEmployees</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">queryEmployeeByGenderNum</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">Employee</span> <span class="n">employee</span><span class="o">=</span><span class="n">queryEmployeeDepartmentById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee</span><span class="o">.</span><span class="na">geteName</span><span class="o">()+</span><span class="s">&#34;\t&#34;</span>
</span></span><span class="line"><span class="cl">                        <span class="o">+</span><span class="n">employee</span><span class="o">.</span><span class="na">getDepart</span><span class="o">().</span><span class="na">getdName</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">  <span class="n">queryEmployees</span><span class="o">(</span><span class="n">1</span><span class="o">,</span><span class="n">2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h1 id="mybatis-缓存">Mybatis 缓存</h1>
<h2 id="缓存简介">缓存简介</h2>
<p>缓存是存在于内存中的临时数据，使用缓存的目的是减少和数据库的交互次数，提高执行效率。像大多数的持久化框架一样，Mybatis 也提供了缓存策略，通过缓存策略来减少数据库的查询次数，从而提高性能，Mybatis 中缓存分为一级缓存，二级缓存。</p>
<p><img src="/posts/Java-frame/20220430215722/image-20220526000536083.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="一级缓存">一级缓存</h2>
<h3 id="一级缓存介绍">一级缓存介绍</h3>
<p>mybatis一级缓存一种是SESSION级别的，针对同一个会话SqlSession中，执行多次条件完全相同的同一个sql，那么会共享这一缓存。</p>
<h3 id="一级缓存结构图">一级缓存结构图</h3>
<p><img src="/posts/Java-frame/20220430215722/image-20220526000808890.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="编写用户持久层-dao-接口">编写用户持久层 Dao 接口</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">EmployeeDao</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Employee</span> <span class="nf">getEmployeeById</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="编写用户持久层映射文件">编写用户持久层映射文件</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"> <span class="o">&lt;</span><span class="n">select</span> <span class="n">id</span><span class="o">=</span><span class="s">&#34;getEmployeeById&#34;</span> <span class="n">resultMap</span><span class="o">=</span><span class="s">&#34;EmployeeResultMap&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">       <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">employee</span> <span class="n">WHERE</span> <span class="n">e_id</span><span class="o">=</span><span class="err">#</span><span class="o">{</span><span class="n">id</span><span class="o">}</span>
</span></span><span class="line"><span class="cl"> <span class="o">&lt;/</span><span class="n">select</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"> <span class="o">&lt;</span><span class="n">resultMap</span> <span class="n">id</span><span class="o">=</span><span class="s">&#34;EmployeeResultMap&#34;</span> <span class="n">type</span><span class="o">=</span><span class="s">&#34;Employee&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">     <span class="o">&lt;</span><span class="n">id</span> <span class="n">column</span><span class="o">=</span><span class="s">&#34;e_id&#34;</span> <span class="n">property</span><span class="o">=</span><span class="s">&#34;id&#34;</span><span class="o">&gt;&lt;/</span><span class="n">id</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">     <span class="o">&lt;</span><span class="n">result</span> <span class="n">column</span><span class="o">=</span><span class="s">&#34;e_name&#34;</span> <span class="n">property</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="o">&gt;&lt;/</span><span class="n">result</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">     <span class="o">&lt;</span><span class="n">result</span> <span class="n">column</span><span class="o">=</span><span class="s">&#34;e_gender&#34;</span> <span class="n">property</span><span class="o">=</span><span class="s">&#34;gender&#34;</span><span class="o">&gt;&lt;/</span><span class="n">result</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">     <span class="o">&lt;</span><span class="n">result</span> <span class="n">column</span><span class="o">=</span><span class="s">&#34;e_age&#34;</span> <span class="n">property</span><span class="o">=</span><span class="s">&#34;age&#34;</span><span class="o">&gt;&lt;/</span><span class="n">result</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"> <span class="o">&lt;/</span><span class="n">resultMap</span><span class="o">&gt;</span>
</span></span></code></pre></div><h3 id="编写测试方法">编写测试方法</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">firstCahce</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">     <span class="n">EmployeeMapper</span> <span class="n">employeeMapper</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="c1">//第一次查询
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="n">Employee</span> <span class="n">employee1</span><span class="o">=</span><span class="n">employeeMapper</span><span class="o">.</span><span class="na">getEmployeeById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee1</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">     
</span></span><span class="line"><span class="cl">     <span class="c1">//第二次查询
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="n">Employee</span> <span class="n">employee2</span><span class="o">=</span><span class="n">employeeMapper</span><span class="o">.</span><span class="na">getEmployeeById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee2</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">     <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span></code></pre></div><p><img src="/posts/Java-frame/20220430215722/image-20220526001136242.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="一级缓存的分析">一级缓存的分析</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">  从上面的代码可以出，我们写了两次查询操作，但在访问数据时，只有一次。第一次先从一级缓存中获取，因为session是新创建的，一级缓存中没有数据，于是就查询数据获取数据，然后把查询的数据放到一级缓存中，此时一定要注意的是，一级缓存是一个Map集合，map的key是你的查询条件字符串，值就是查询出来的对象。等第二次查询时，先从一缓存中获取，因为上一次查询后已经放到一级缓存中了，所以从一级缓存中获取到了，就不用访问数据库了，减少和数据次的一次交互，提高了执行效率。
</span></span></code></pre></div><h3 id="测试一级缓存的清空">测试一级缓存的清空</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">当我们在两次查询之间做增</span><span class="err">、</span><span class="n">删</span><span class="err">、</span><span class="n">改操作都会把一级缓存清空</span><span class="err">，</span><span class="n">因为不清空就不能保证缓存中的数据与数据库中数据的一致性</span><span class="err">，</span><span class="n">可能会读取不正确的数据</span><span class="err">。</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">firstCahce</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">     <span class="n">EmployeeMapper</span> <span class="n">employeeMapper</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="c1">//第一次查询
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="n">Employee</span> <span class="n">employee1</span><span class="o">=</span><span class="n">employeeMapper</span><span class="o">.</span><span class="na">getEmployeeById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee1</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">      <span class="c1">//新增员工
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="n">employeeMapper</span><span class="o">.</span><span class="na">addEmployee</span><span class="o">(</span><span class="k">new</span> <span class="n">Employee</span><span class="o">(</span><span class="s">&#34;张小志&#34;</span><span class="o">,</span><span class="s">&#34;男&#34;</span><span class="o">,</span><span class="n">18</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">     <span class="c1">//第二次查询
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="n">Employee</span> <span class="n">employee2</span><span class="o">=</span><span class="n">employeeMapper</span><span class="o">.</span><span class="na">getEmployeeById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee2</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">     <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span></code></pre></div><h2 id="二级缓存">二级缓存</h2>
<h3 id="二级缓存简介">二级缓存简介</h3>
<p>二级缓存是 mapper 映射级别的缓存，多个 SqlSession 去操作同一个 Mapper 映射的 sql 语句，多个 SqlSession 可以共用二级缓存，二级缓存是跨 SqlSession 的。</p>
<h3 id="二级缓存结构图">二级缓存结构图</h3>
<p><img src="/posts/Java-frame/20220430215722/image-20220526001236876.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="二级缓存的开启与关闭">二级缓存的开启与关闭</h3>
<h4 id="在sqlmapconfigxml-文件开启二级缓存">在SqlMapConfig.xml 文件开启二级缓存</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Xml" data-lang="Xml"><span class="line"><span class="cl"><span class="nt">&lt;settings&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- 开启二级缓存的支持 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;setting</span> <span class="na">name=</span><span class="s">&#34;cacheEnabled&#34;</span> <span class="na">value=</span><span class="s">&#34;true&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/settings&gt;</span>
</span></span><span class="line"><span class="cl">因为 cacheEnabled 的取值默认就为 true，所以这一步可以省略不配置。为 true 代表开启二级缓存；为
</span></span><span class="line"><span class="cl">false 代表不开启二级缓存。
</span></span></code></pre></div><h4 id="配置相关的-mapper-映射文件">配置相关的 Mapper 映射文件</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Xml" data-lang="Xml"><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE mapper
</span></span></span><span class="line"><span class="cl"><span class="cp">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;mapper</span> <span class="na">namespace=</span><span class="s">&#34;cn.offcn.dao.EmployeeDao&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- 开启二级缓存的支持 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;cache&gt;&lt;/cache&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/mapper&gt;</span>
</span></span></code></pre></div><h4 id="配置-statement-上面的-usecache-属性">配置 statement 上面的 useCache 属性</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">select</span> <span class="n">id</span><span class="o">=</span><span class="s">&#34;getEmployeeById&#34;</span> <span class="n">resultMap</span><span class="o">=</span><span class="s">&#34;EmployeeResultMap&#34;</span> <span class="n">useCache</span><span class="o">=</span><span class="s">&#34;true&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">employee</span> <span class="n">WHERE</span> <span class="n">e_id</span><span class="o">=</span><span class="err">#</span><span class="o">{</span><span class="n">id</span><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">select</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">resultMap</span> <span class="n">id</span><span class="o">=</span><span class="s">&#34;EmployeeResultMap&#34;</span> <span class="n">type</span><span class="o">=</span><span class="s">&#34;Employee&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">id</span> <span class="n">column</span><span class="o">=</span><span class="s">&#34;e_id&#34;</span> <span class="n">property</span><span class="o">=</span><span class="s">&#34;id&#34;</span><span class="o">&gt;&lt;/</span><span class="n">id</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">result</span> <span class="n">column</span><span class="o">=</span><span class="s">&#34;e_name&#34;</span> <span class="n">property</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="o">&gt;&lt;/</span><span class="n">result</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">result</span> <span class="n">column</span><span class="o">=</span><span class="s">&#34;e_gender&#34;</span> <span class="n">property</span><span class="o">=</span><span class="s">&#34;gender&#34;</span><span class="o">&gt;&lt;/</span><span class="n">result</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">result</span> <span class="n">column</span><span class="o">=</span><span class="s">&#34;e_age&#34;</span> <span class="n">property</span><span class="o">=</span><span class="s">&#34;age&#34;</span><span class="o">&gt;&lt;/</span><span class="n">result</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">resultMap</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">将</span> <span class="n">EmployeeDao</span><span class="o">.</span><span class="na">xml</span> <span class="n">映射文件中的</span><span class="o">&lt;</span><span class="n">select</span><span class="o">&gt;</span><span class="n">标签中设置</span> <span class="n">useCache</span><span class="o">=</span><span class="err">”</span><span class="kc">true</span><span class="err">”</span><span class="n">代表当前这个</span> <span class="n">statement</span> <span class="n">要使用二级缓存</span><span class="err">，</span><span class="n">如果不使用二级缓存可以设置为</span> <span class="kc">false</span><span class="err">。</span>
</span></span><span class="line"><span class="cl"><span class="n">注意</span><span class="err">：</span><span class="n">针对每次查询都需要最新的数据</span> <span class="n">sql</span><span class="err">，</span><span class="n">要设置成</span> <span class="n">useCache</span><span class="o">=</span><span class="kc">false</span><span class="err">，</span><span class="n">禁用二级缓存</span><span class="err">。</span>
</span></span></code></pre></div><h4 id="二级缓存测试">二级缓存测试</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">secondCahce</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">SqlSession</span> <span class="n">session1</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">SqlSession</span> <span class="n">session2</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">EmployeeMapper</span> <span class="n">employeeMapper1</span><span class="o">=</span><span class="n">session1</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//第一次查询
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">Employee</span> <span class="n">employee1</span><span class="o">=</span><span class="n">employeeMapper1</span><span class="o">.</span><span class="na">getEmployeeById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee1</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">  <span class="n">session1</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="c1">//第二次查询
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="n">EmployeeMapper</span> <span class="n">employeeMapper2</span><span class="o">=</span><span class="n">session2</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Employee</span> <span class="n">employee2</span><span class="o">=</span><span class="n">employeeMapper2</span><span class="o">.</span><span class="na">getEmployeeById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee2</span><span class="o">.</span><span class="na">getName</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">  <span class="n">session2</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="n">经过上面的测试</span><span class="err">，</span><span class="n">我们发现执行了两次查询</span><span class="err">，</span><span class="n">并且在执行第一次查询后</span><span class="err">，</span><span class="n">我们关闭了一级缓存</span><span class="err">，</span><span class="n">再去执行第二</span>
</span></span><span class="line"><span class="cl"><span class="n">次查询时</span><span class="err">，</span><span class="n">我们发现并没有对数据库发出</span> <span class="n">sql</span> <span class="n">语句</span><span class="err">，</span><span class="n">所以此时的数据就只能是来自于我们所说的二级缓存</span><span class="err">。</span>
</span></span></code></pre></div><p><img src="/posts/Java-frame/20220430215722/image-20220526001426548.png"
    
    
    
    loading="lazy"
    
    
></p>
<h1 id="mybatis分页插件">MyBatis分页插件</h1>
<h2 id="分页插件的介绍">分页插件的介绍</h2>
<p>分页是一种将所有数据分段展示给用户的技术.用户每次看到的不是全部数据,而是其中的一部分,如果在其中没有找到自己想要的内容,用户可以通过制定页码或是翻页的方式转换可见内容,直到找到自己想要的内容为止。<br>
分页的的好处：<br>
1.提高性能，一次查20个，比一次查20000个性能肯定更好；另外如果数据量很大，一次性将内容都查询出来，查询出来的结果是放在内存存里面的，会增加cpu的开销造成内存的浪费，效率极低。<br>
2.展现层面的考虑：如果一次展现太多的数据，不管是排版，还是美观上都不好。</p>
<h2 id="分页插件的引入和配置">分页插件的引入和配置</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Xml" data-lang="Xml"><span class="line"><span class="cl">1.在pom.xml中引入插件依赖
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl"> <span class="nt">&lt;groupId&gt;</span>com.github.pagehelper<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl"> <span class="nt">&lt;artifactId&gt;</span>pagehelper<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"> <span class="nt">&lt;version&gt;</span>5.1.10<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">2.在mybatis核心配置文件中进行配置
</span></span><span class="line"><span class="cl"><span class="nt">&lt;plugins&gt;</span>
</span></span><span class="line"><span class="cl"> <span class="nt">&lt;plugin</span> <span class="na">interceptor=</span><span class="s">&#34;com.github.pagehelper.PageInterceptor&#34;</span><span class="nt">&gt;&lt;/plugin&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/plugins&gt;</span>
</span></span></code></pre></div><h2 id="定义接口方法getinfo">定义接口方法getInfo</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">EmployeeDao</span><span class="o">{</span>
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">getInfo</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="配置sql语句对应接口方法">配置sql语句对应接口方法</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">select</span> <span class="n">id</span><span class="o">=</span><span class="s">&#34;getInfo&#34;</span> <span class="n">resultType</span><span class="o">=</span><span class="s">&#34;cn.offcn.entity.Employee&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">       <span class="n">SELECT</span> <span class="o">*</span> <span class="n">FROM</span> <span class="n">employee</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">select</span><span class="o">&gt;</span>
</span></span></code></pre></div><h2 id="测试分页插件作用">测试分页插件作用</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Java" data-lang="Java"><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">queryEmployees</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">     <span class="c1">//在查询前设置当前页与每页显示的记录数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="n">PageHelper</span><span class="o">.</span><span class="na">startPage</span><span class="o">(</span><span class="n">1</span><span class="o">,</span><span class="n">5</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">     <span class="n">EmployeeDao</span> <span class="n">employeeDao</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">EmployeeDao</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="c1">//查询
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="n">List</span><span class="o">&lt;</span><span class="n">Employee</span><span class="o">&gt;</span> <span class="n">employeeList</span><span class="o">=</span><span class="n">employeeDao</span><span class="o">.</span><span class="na">getInfo</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">     <span class="c1">//创建一个PageInfo对象，把查询出的结果集合当做参数传入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="n">PageInfo</span><span class="o">&lt;</span><span class="n">Employee</span><span class="o">&gt;</span> <span class="n">pageInfo</span><span class="o">=</span><span class="k">new</span> <span class="n">PageInfo</span><span class="o">&lt;&gt;(</span><span class="n">employeeList</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="n">List</span><span class="o">&lt;</span><span class="n">Employee</span><span class="o">&gt;</span> <span class="n">empList</span><span class="o">=</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getList</span><span class="o">();</span>  <span class="c1">//取当前页的所有记录
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="kt">long</span> <span class="n">totalRecored</span><span class="o">=</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getTotal</span><span class="o">();</span><span class="c1">//总记录数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="kt">int</span>  <span class="n">totalPages</span><span class="o">=</span><span class="n">pageInfo</span><span class="o">.</span><span class="na">getPages</span><span class="o">();</span> <span class="c1">//总页数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;总记录数:&#34;</span><span class="o">+</span><span class="n">totalRecored</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;总页数:&#34;</span><span class="o">+</span><span class="n">totalPages</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="k">for</span> <span class="o">(</span><span class="n">Employee</span> <span class="n">employee</span> <span class="o">:</span> <span class="n">empList</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">         <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">employee</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="o">}</span>
</span></span><span class="line"><span class="cl">     <span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">     <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span></code></pre></div><h1 id="mybatis的注解开发">MyBatis的注解开发</h1>
<h2 id="注解开发的背景介绍">注解开发的背景介绍</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">注解提供了一种简单的方式来实现简单映射语句,而不会引入大量的开销。能够读懂别人写的代码，特别是框架相关的代码。本来可能需要很多配置文件，需要很多逻辑才能实现的内容，就可以使用一个或者多个注解来替代，这样就使得编程更加简洁，代码更加清晰。
</span></span></code></pre></div><h2 id="常用注解介绍">常用注解介绍</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">这几年来注解开发越来越流行，Mybatis 也可以使用注解开发方式，这样我们就可以减少编写 Mapper 映射文件了。本次我们先围绕一些基本的 CRUD 来学习，再学习复杂映射关系及延迟加载。
</span></span><span class="line"><span class="cl">@Insert:实现新增
</span></span><span class="line"><span class="cl">@Update:实现更新
</span></span><span class="line"><span class="cl">@Delete:实现删除
</span></span><span class="line"><span class="cl">@Select:实现查询
</span></span><span class="line"><span class="cl">@Result:实现结果集封装
</span></span><span class="line"><span class="cl">@Results:可以与@Result 一起使用，封装多个结果集
</span></span><span class="line"><span class="cl">@ResultMap:实现引用@Results 定义的封装
</span></span><span class="line"><span class="cl">@One:实现一对一结果集封装
</span></span><span class="line"><span class="cl">@Many:实现一对多结果集封装
</span></span><span class="line"><span class="cl">@SelectProvider: 实现动态 SQL 映射
</span></span><span class="line"><span class="cl">@CacheNamespace:实现注解二级缓存的使用
</span></span></code></pre></div><h2 id="项目环境搭建">项目环境搭建</h2>
<h3 id="构建maven工程导入依赖">构建maven工程，导入依赖</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">dependencies</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">org</span><span class="o">.</span><span class="na">mybatis</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">mybatis</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="n">3</span><span class="o">.</span><span class="na">4</span><span class="o">.</span><span class="na">6</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">mysql</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">mysql</span><span class="o">-</span><span class="n">connector</span><span class="o">-</span><span class="n">java</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="n">5</span><span class="o">.</span><span class="na">1</span><span class="o">.</span><span class="na">47</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="o">&lt;</span><span class="n">scope</span><span class="o">&gt;</span><span class="n">runtime</span><span class="o">&lt;/</span><span class="n">scope</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">junit</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">junit</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="n">4</span><span class="o">.</span><span class="na">12</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="o">&lt;</span><span class="n">scope</span><span class="o">&gt;</span><span class="n">test</span><span class="o">&lt;/</span><span class="n">scope</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">log4j</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">log4j</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="o">&lt;</span><span class="n">version</span><span class="o">&gt;</span><span class="n">1</span><span class="o">.</span><span class="na">2</span><span class="o">.</span><span class="na">17</span><span class="o">&lt;/</span><span class="n">version</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">dependencies</span><span class="o">&gt;</span>
</span></span></code></pre></div><h2 id="使用-mybatis-注解实现基本-crud">使用 Mybatis 注解实现基本 CRUD</h2>
<h3 id="编写实体类">编写实体类</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Worker</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="n">Integer</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="n">String</span> <span class="n">gender</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="nf">Worker</span><span class="o">(){}</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="nf">Worker</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">String</span> <span class="n">gender</span><span class="o">,</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="o">.</span><span class="na">gender</span> <span class="o">=</span> <span class="n">gender</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="o">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">age</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">String</span> <span class="nf">getGender</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">gender</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">setGender</span><span class="o">(</span><span class="n">String</span> <span class="n">gender</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="o">.</span><span class="na">gender</span> <span class="o">=</span> <span class="n">gender</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getAge</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="n">age</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAge</span><span class="o">(</span><span class="n">Integer</span> <span class="n">age</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">this</span><span class="o">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">age</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Override</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">String</span> <span class="nf">toString</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">  <span class="k">return</span> <span class="s">&#34;Worker{&#34;</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">          <span class="s">&#34;id=&#34;</span> <span class="o">+</span> <span class="n">id</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">          <span class="s">&#34;, name=&#39;&#34;</span> <span class="o">+</span> <span class="n">name</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">          <span class="s">&#34;, gender=&#39;&#34;</span> <span class="o">+</span> <span class="n">gender</span> <span class="o">+</span> <span class="sc">&#39;\&#39;&#39;</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">          <span class="s">&#34;, age=&#34;</span> <span class="o">+</span> <span class="n">age</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">          <span class="sc">&#39;}&#39;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="使用注解方式开发持久层接口">使用注解方式开发持久层接口</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">WorkerMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Insert</span><span class="o">(</span><span class="s">&#34;insert into worker (w_name,w_gender,w_age) &#34;</span> <span class="o">+</span>
</span></span><span class="line"><span class="cl">      <span class="s">&#34;values(#{name},#{gender},#{age})&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">saveWorker</span><span class="o">(</span><span class="n">Worker</span> <span class="n">worker</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Update</span><span class="o">(</span><span class="s">&#34;update worker set w_name=#{name},w_gender=#{gender},w_age=#{age} where w_id=#{id}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">updateWorker</span><span class="o">(</span><span class="n">Worker</span> <span class="n">worker</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Delete</span><span class="o">(</span><span class="s">&#34;delete from worker where w_id=#{id}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">deleteWorkerById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Select</span><span class="o">(</span><span class="s">&#34;select * from worker where w_id=#{id}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Results</span><span class="o">({</span>
</span></span><span class="line"><span class="cl">      <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;w_id&#34;</span><span class="o">,</span><span class="n">property</span><span class="o">=</span><span class="s">&#34;id&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">      <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;w_name&#34;</span><span class="o">,</span><span class="n">property</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">      <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;w_gender&#34;</span><span class="o">,</span><span class="n">property</span><span class="o">=</span><span class="s">&#34;gender&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">      <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;w_age&#34;</span><span class="o">,</span><span class="n">property</span><span class="o">=</span><span class="s">&#34;age&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">})</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">Worker</span> <span class="nf">getWorkerById</span><span class="o">(</span><span class="n">Integer</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Select</span><span class="o">(</span><span class="s">&#34;select * from worker&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@Results</span><span class="o">({</span>
</span></span><span class="line"><span class="cl">      <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;w_id&#34;</span><span class="o">,</span><span class="n">property</span><span class="o">=</span><span class="s">&#34;id&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">      <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;w_name&#34;</span><span class="o">,</span><span class="n">property</span><span class="o">=</span><span class="s">&#34;name&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">      <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;w_gender&#34;</span><span class="o">,</span><span class="n">property</span><span class="o">=</span><span class="s">&#34;gender&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">      <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;w_age&#34;</span><span class="o">,</span><span class="n">property</span><span class="o">=</span><span class="s">&#34;age&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="o">})</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Worker</span><span class="o">&gt;</span> <span class="nf">getWorkers</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="编写-sqlmapconfig-配置文件">编写 SqlMapConfig 配置文件</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Xml" data-lang="Xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="cp">&lt;!DOCTYPE configuration
</span></span></span><span class="line"><span class="cl"><span class="cp">PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span class="line"><span class="cl"><span class="cp">&#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- 配置 mybatis的环境 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;environments</span> <span class="na">default=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c">&lt;!-- 配置环境 --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;environment</span> <span class="na">id=</span><span class="s">&#34;development&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="c">&lt;!-- 配置事务的类型 --&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;transactionManager</span> <span class="na">type=</span><span class="s">&#34;JDBC&#34;</span><span class="nt">&gt;&lt;/transactionManager&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="c">&lt;!-- 配置连接数据库的信息:用的是数据源【连接池】--&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;dataSource</span> <span class="na">type=</span><span class="s">&#34;POOLED&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;driver&#34;</span> <span class="na">value=</span><span class="s">&#34;com.mysql.jdbc.Driver&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;url&#34;</span> <span class="na">value=</span><span class="s">&#34;jdbc:mysql://localhost:3306/mybatis002&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;username&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">       <span class="nt">&lt;property</span> <span class="na">name=</span><span class="s">&#34;password&#34;</span> <span class="na">value=</span><span class="s">&#34;root&#34;</span><span class="nt">/&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;/dataSource&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/environment&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/environments&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;mappers&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;package</span> <span class="na">name=</span><span class="s">&#34;cn.offcn.dao&#34;</span><span class="nt">&gt;&lt;/package&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/mappers&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/configuration&gt;</span>
</span></span></code></pre></div><h3 id="编写测试方法-1">编写测试方法</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">cn.offcn.dao.WorkerMapper</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">cn.offcn.entity.Worker</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">cn.offcn.utils.MyBatisUtils</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.apache.ibatis.session.SqlSession</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.junit.Test</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.List</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">WorkerTest</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testSaveWorker</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">  <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">WorkerMapper</span> <span class="n">workerMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">WorkerMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Worker</span> <span class="n">worker</span><span class="o">=</span><span class="k">new</span> <span class="n">Worker</span><span class="o">(</span><span class="s">&#34;白晓云&#34;</span><span class="o">,</span><span class="s">&#34;女&#34;</span><span class="o">,</span><span class="n">20</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">workerMapper</span><span class="o">.</span><span class="na">saveWorker</span><span class="o">(</span><span class="n">worker</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testUpdateWorker</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">  <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">WorkerMapper</span> <span class="n">workerMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">WorkerMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Worker</span> <span class="n">worker</span><span class="o">=</span><span class="k">new</span> <span class="n">Worker</span><span class="o">(</span><span class="n">1</span><span class="o">,</span><span class="s">&#34;白晓云&#34;</span><span class="o">,</span><span class="s">&#34;男&#34;</span><span class="o">,</span><span class="n">22</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">workerMapper</span><span class="o">.</span><span class="na">updateWorker</span><span class="o">(</span><span class="n">worker</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testDeleteWorkerById</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">  <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">WorkerMapper</span> <span class="n">workerMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">WorkerMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">workerMapper</span><span class="o">.</span><span class="na">deleteWorkerById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">session</span><span class="o">.</span><span class="na">commit</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGetWorkerById</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">  <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">WorkerMapper</span> <span class="n">workerMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">WorkerMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">Worker</span> <span class="n">worker</span><span class="o">=</span> <span class="n">workerMapper</span><span class="o">.</span><span class="na">getWorkerById</span><span class="o">(</span><span class="n">2</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">worker</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGetWorkers</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">  <span class="n">SqlSession</span> <span class="n">session</span> <span class="o">=</span> <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">WorkerMapper</span> <span class="n">workerMapper</span> <span class="o">=</span> <span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">WorkerMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">List</span><span class="o">&lt;</span><span class="n">Worker</span><span class="o">&gt;</span> <span class="n">workerList</span><span class="o">=</span><span class="n">workerMapper</span><span class="o">.</span><span class="na">getWorkers</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">  <span class="n">workerList</span><span class="o">.</span><span class="na">forEach</span><span class="o">(</span><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">::</span><span class="n">println</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">  <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="使用注解实现复杂关系映射开发">使用注解实现复杂关系映射开发</h2>
<h3 id="复杂关系映射的注解介绍">复杂关系映射的注解介绍</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">@Results  注解
</span></span><span class="line"><span class="cl">代替的是标签&lt;resultMap&gt;
</span></span><span class="line"><span class="cl">该注解中可以使用单个@Result 注解，也可以使用@Result 集合
</span></span><span class="line"><span class="cl">@Results（{@Result（），@Result（）}）或@Results（@Result（））
</span></span><span class="line"><span class="cl">@Resutl 注解
</span></span><span class="line"><span class="cl">代替了 &lt;id&gt; 标签和&lt;result&gt; 标签
</span></span><span class="line"><span class="cl">@Result  中  属性介绍：
</span></span><span class="line"><span class="cl">id 是否是主键字段
</span></span><span class="line"><span class="cl">column 数据库的列名
</span></span><span class="line"><span class="cl">property 需要装配的属性名
</span></span><span class="line"><span class="cl">one 需要使用的@One 注解（@Result（one=@One）（）））
</span></span><span class="line"><span class="cl">many 需要使用的@Many 注解（@Result（many=@many）（）））
</span></span><span class="line"><span class="cl">@One  注解（一对一）
</span></span><span class="line"><span class="cl">代替了&lt;assocation&gt; 标签，是多表查询的关键，在注解中用来指定子查询返回单一对象。
</span></span><span class="line"><span class="cl">@One  注解属性介绍：
</span></span><span class="line"><span class="cl">select 指定用的 来多表查询的 sqlmapper
</span></span><span class="line"><span class="cl">fetchType 会覆盖全局的配置参数 lazyLoadingEnabled。
</span></span><span class="line"><span class="cl">使用格式：
</span></span><span class="line"><span class="cl">@Result(column=&#34; &#34;,property=&#34;&#34;,one=@One(select=&#34;&#34;))
</span></span><span class="line"><span class="cl">@Many  注解（多对一）
</span></span><span class="line"><span class="cl">代替了&lt;Collection&gt; 标签, 是是多表查询的关键，在注解中用来指定子查询返回对象集合。
</span></span><span class="line"><span class="cl">注意：聚集元素用来处理“一对多”的关系。需要指定映射的 Java 实体类的属性，属性的 javaType
</span></span><span class="line"><span class="cl">（一般为 ArrayList）但是注解中可以不定义；
</span></span><span class="line"><span class="cl">使用格式：
</span></span><span class="line"><span class="cl">@Result(property=&#34;&#34;,column=&#34;&#34;,many=@Many(select=&#34;&#34;))
</span></span></code></pre></div><h3 id="使用注解实现一对一复杂关系映射及延迟加载">使用注解实现一对一复杂关系映射及延迟加载</h3>
<h4 id="添加-person实体类及-idcard-实体类">添加 Person实体类及 IdCard 实体类</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nl">Person实体类:</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Person</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="kd">private</span> <span class="n">IdCard</span> <span class="n">idCard</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="n">IdCard</span> <span class="nf">getIdCard</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="n">idCard</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setIdCard</span><span class="o">(</span><span class="n">IdCard</span> <span class="n">idCard</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">idCard</span> <span class="o">=</span> <span class="n">idCard</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">IdCard实体类:</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">IdCard</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="kd">private</span> <span class="n">String</span> <span class="n">cardno</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="kd">private</span> <span class="n">Date</span> <span class="n">useLife</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="n">String</span> <span class="nf">getCardno</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="n">cardno</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setCardno</span><span class="o">(</span><span class="n">String</span> <span class="n">cardno</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">cardno</span> <span class="o">=</span> <span class="n">cardno</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="n">Date</span> <span class="nf">getUseLife</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="n">useLife</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setUseLife</span><span class="o">(</span><span class="n">Date</span> <span class="n">useLife</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">useLife</span> <span class="o">=</span> <span class="n">useLife</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h4 id="添加idcard的持久层接口并使用注解配置">添加IdCard的持久层接口并使用注解配置</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">IdCardMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Select</span><span class="o">(</span><span class="s">&#34;select * from idcard where c_id=#{id}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"> <span class="nd">@Results</span><span class="o">({</span>
</span></span><span class="line"><span class="cl">         <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;c_id&#34;</span><span class="o">,</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;id&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">         <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;c_cardno&#34;</span><span class="o">,</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;cardno&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">         <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;e_uselife&#34;</span><span class="o">,</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;useLife&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"> <span class="o">})</span>
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="n">IdCard</span> <span class="nf">getIdCardByPersonId</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h4 id="添加person持久层接口并使用注解配置">添加Person持久层接口并使用注解配置</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">PersonMapper</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="nd">@Select</span><span class="o">(</span><span class="n">select</span> <span class="o">*</span> <span class="n">from</span> <span class="n">person</span> <span class="n">where</span>  <span class="n">p_id</span><span class="o">=</span><span class="err">#</span><span class="o">{</span><span class="n">id</span><span class="o">})</span>
</span></span><span class="line"><span class="cl"> <span class="nd">@Results</span><span class="o">({</span>
</span></span><span class="line"><span class="cl">         <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;p_id&#34;</span><span class="o">,</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;id&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">         <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;p_name&#34;</span><span class="o">,</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;name&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">         <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;idCard&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">javaType</span> <span class="o">=</span> <span class="n">IdCard</span><span class="o">.</span><span class="na">class</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">column</span> <span class="o">=</span> <span class="s">&#34;p_id&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">one</span> <span class="o">=</span> <span class="nd">@One</span><span class="o">(</span><span class="n">select</span> <span class="o">=</span> <span class="s">&#34;cn.offcn.dao.IdCardDao.getIdCardByPersonId&#34;</span><span class="o">,</span><span class="n">fetchType</span> <span class="o">=</span> <span class="n">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">         <span class="o">)</span>
</span></span><span class="line"><span class="cl"> <span class="o">})</span>
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="n">Person</span> <span class="nf">getPersonById</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h4 id="测试一对一关联及延迟加载">测试一对一关联及延迟加载</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testGetPersonById</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="n">SqlSession</span> <span class="n">session</span><span class="o">=</span><span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">     <span class="n">PersonMapper</span> <span class="n">personMapper</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">PersonMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="n">Person</span> <span class="n">person</span><span class="o">=</span><span class="n">personMapper</span><span class="o">.</span><span class="na">getPersonById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">person</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">     <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span></code></pre></div><h3 id="使用注解实现一对多复杂关系映射">使用注解实现一对多复杂关系映射</h3>
<h4 id="构建department和employee实体类">构建Department和Employee实体类</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nl">Department实体类:</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Department</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="nl">Employee实体类:</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Employee</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">private</span> <span class="kt">int</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="kd">private</span> <span class="n">String</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="kd">private</span> <span class="n">String</span> <span class="n">gender</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="kd">private</span> <span class="n">Integer</span> <span class="n">age</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="nf">Employee</span><span class="o">(){}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="nf">Employee</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">,</span><span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">String</span> <span class="n">gender</span><span class="o">,</span> <span class="kt">int</span> <span class="n">age</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">id</span><span class="o">=</span><span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">gender</span> <span class="o">=</span> <span class="n">gender</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">age</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="nf">Employee</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">,</span> <span class="n">String</span> <span class="n">gender</span><span class="o">,</span> <span class="kt">int</span> <span class="n">age</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">gender</span> <span class="o">=</span> <span class="n">gender</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">age</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">int</span> <span class="nf">getId</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setId</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">id</span> <span class="o">=</span> <span class="n">id</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="n">String</span> <span class="nf">getName</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setName</span><span class="o">(</span><span class="n">String</span> <span class="n">name</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">name</span> <span class="o">=</span> <span class="n">name</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="n">String</span> <span class="nf">getGender</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="n">gender</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setGender</span><span class="o">(</span><span class="n">String</span> <span class="n">gender</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">gender</span> <span class="o">=</span> <span class="n">gender</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="n">Integer</span> <span class="nf">getAge</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="n">age</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="kt">void</span> <span class="nf">setAge</span><span class="o">(</span><span class="n">Integer</span> <span class="n">age</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">age</span> <span class="o">=</span> <span class="n">age</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h4 id="department实体类加入-listemployee">Department实体类加入 <code>List&lt;Employee&gt;</code></h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">private</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Employee</span><span class="o">&gt;</span> <span class="n">emps</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Employee</span><span class="o">&gt;</span> <span class="nf">getEmps</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">return</span> <span class="n">emps</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">setEmps</span><span class="o">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">Employee</span><span class="o">&gt;</span> <span class="n">emps</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">     <span class="k">this</span><span class="o">.</span><span class="na">emps</span> <span class="o">=</span> <span class="n">emps</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h4 id="编写employeemapper持久层接口并使用注解配置">编写EmployeeMapper持久层接口并使用注解配置</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">EmployeeMapper</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="nd">@Select</span><span class="o">(</span><span class="s">&#34;select * from employee where e_depart_id=#{id}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"> <span class="nd">@Results</span><span class="o">({</span>
</span></span><span class="line"><span class="cl">         <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;e_id&#34;</span><span class="o">,</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;id&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">         <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;e_name&#34;</span><span class="o">,</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;name&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">         <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;e_gender&#34;</span><span class="o">,</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;gender&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">         <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;e_age&#34;</span><span class="o">,</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;age&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"> <span class="o">})</span>
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Employee</span><span class="o">&gt;</span> <span class="nf">getEmployeeByDepartId</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h4 id="编写departmentmapper持久层接口并使用注解配置">编写DepartmentMapper持久层接口并使用注解配置</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">DepartmentDao</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="nd">@Select</span><span class="o">(</span><span class="s">&#34;select d_id id,d_name name from department where d_id=#{id}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="n">Department</span> <span class="nf">getDepartmentById</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"> <span class="nd">@Select</span><span class="o">(</span><span class="s">&#34;select * from department where d_id=#{id}&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"> <span class="nd">@Results</span><span class="o">({</span>
</span></span><span class="line"><span class="cl">         <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;d_id&#34;</span><span class="o">,</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;id&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">         <span class="nd">@Result</span><span class="o">(</span><span class="n">column</span> <span class="o">=</span> <span class="s">&#34;d_name&#34;</span><span class="o">,</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;name&#34;</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">         <span class="nd">@Result</span><span class="o">(</span><span class="n">property</span> <span class="o">=</span> <span class="s">&#34;emps&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">column</span> <span class="o">=</span> <span class="s">&#34;d_id&#34;</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">many</span> <span class="o">=</span> <span class="nd">@Many</span><span class="o">(</span><span class="n">select</span> <span class="o">=</span> <span class="s">&#34;cn.offcn.dao.EmployeeMapper.getEmployeeByDepartId&#34;</span><span class="o">,</span><span class="n">fetchType</span> <span class="o">=</span> <span class="n">FetchType</span><span class="o">.</span><span class="na">LAZY</span><span class="o">))</span>
</span></span><span class="line"><span class="cl"> <span class="o">})</span>
</span></span><span class="line"><span class="cl"> <span class="kd">public</span> <span class="n">Department</span> <span class="nf">getDepartmentById</span><span class="o">(</span><span class="kt">int</span> <span class="n">id</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h4 id="添加测试方法">添加测试方法</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span>  <span class="nf">testGetDepartmentById</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="n">SqlSession</span> <span class="n">session</span><span class="o">=</span><span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">getSession</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">     <span class="n">DepartmentMapper</span> <span class="n">departmentMapper</span><span class="o">=</span><span class="n">session</span><span class="o">.</span><span class="na">getMapper</span><span class="o">(</span><span class="n">DepartmentMapper</span><span class="o">.</span><span class="na">class</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="n">Department</span> <span class="n">department</span><span class="o">=</span><span class="n">departmentMapper</span><span class="o">.</span><span class="na">getDepartmentById</span><span class="o">(</span><span class="n">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">department</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">     <span class="n">MyBatisUtils</span><span class="o">.</span><span class="na">close</span><span class="o">(</span><span class="n">session</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"> <span class="o">}</span>
</span></span></code></pre></div>
            </div>
            <hr>
            <div style="text-align: center;">
                <button class="btn"><a href="https://lovemjh.github.io/posts/tool/20220526205691/">← Zookeeper</a></button>
                <button class="btn"><a href="https://lovemjh.github.io/posts/java-frame/20220526003427/">Spring-1  →</a></button>
            </div>
        </article><div class="aside_content" id="aside_content">
    <div class="card-widget card-info">
        <div class="card-content">
            <div class="card-info-avatar is-center">
                <img class="avatar-img" src="http://q1.qlogo.cn/g?b=qq&nk=2409741052&s=640" alt="avatar">
                <div class="author-info__name">青山客</div>
                <div class="author-info__description">晓梦云码支付 <s>三网云端免挂/QQ/支付宝/微信</s>pay.yzfyd.cn</div>
            </div>
            <div class="card-info-social-icons is-center">
                <a class="social-icon" href="https://yzfyd.cn" target="_blank">
                    <i class="fa fa-github"></i>
                </a>
            </div>
        </div>
    </div>


    <div class="card-widget card-announcement">
        <div class="card-content">
            <meting-js auto="https://y.qq.com/n/yqq/playlist/7713574197.html">
            </meting-js>
        </div>
    </div>

    <div class="card-widget card-announcement">
        <div class="card-content">
            <div class="item-headline">
                <i class="fa fa-bullhorn" aria-hidden="true"></i>
                <span>一言</span>
            </div>
            <div id="hitokoto"></div>
        </div>
    </div>
    <div class="card-widget card-announcement">
        <div class="card-content">
            <div class="item-headline">
                <i class="fa fa-calendar" aria-hidden="true"></i>
                <span>今日诗词</span>
            </div>
            <div id="jinrishici-sentence"></div>
        </div>
    </div>

    <div class="card-widget card-webinfo">
        <div class="card-content">
            <div class="item-headline">
                <i class="fa fa-line-chart" aria-hidden="true"></i>
                <span>站点信息</span>
            </div>
            <div class="webinfo">
                <div class="webinfo-item">
                    <div class="webinfo-site-uv-name">本站访客数 :</div>
                    <div class="webinfo-site-uv-count" id="busuanzi_value_site_uv"></div>
                </div>
                <div class="webinfo-item">
                    <div class="webinfo-site-name">本站总访问量 :</div>
                    <div class="webinfo-site-pv-count" id="busuanzi_value_site_pv"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="card-widget js-toc-w" id="js-toc-w">
        <div class="card-content js-toc">
            
        </div>
    </div>
    
</div></div>
</main>
<footer id="footer">
    <div id="footer-wrap">
        <div class="copyright">&copy;2019 - 2021 BY QING SHAN KE</div>
    </div>
</footer>
</div>
<div class="fan" id="fan" style="
position: fixed;
width: 40px;
height: 120px;
right: -200px;
bottom: 0px;
transition: all 0.5s;
z-index: 99999;
 ">

    <i class="fa fa-cog fa-spin fa-2x"></i><br>
    <i class="fa fa-align-justify fa-2x" id="ff"></i><br>
    <i class="fa fa fa-arrow-up fa-2x" id="aa"></i><br>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script>

    var a = 0;
    ff.onclick = function () {

        if (a === 0) {
            $(".js-toc-w").css("position", "fixed"); 
            $(".js-toc-w").css("bottom", "10px");
            $(".js-toc-w").css("right", "40px");
            a++;
        } else {
            $(".js-toc-w").css("position", "static");
            a--;
        }

    }
    

    aa.onclick = function () {
        window.scrollTo({     
            top: 0,            
            behavior: "smooth"   
        })
    }



</script>
<script>
    $(window).scroll(function () {
        var scrollY = document.documentElement.scrollTop || document.body.scrollTop
        
        if (scrollY > 40) {
            $('.fan').css("right", "0px");
        } else {
            $('.fan').css("right", "-220px");
        }
    });

    $(function () {
        
        var start_height = $(document).scrollTop();
        
        var navigation_height = $('.navigation').outerHeight();
        $(window).scroll(function () {
            
            var end_height = $(document).scrollTop();
            
            if (end_height > navigation_height) {
                $('.navigation').addClass('hide');
            } else {
                $('.navigation').removeClass('hide');
            }
            
            if (end_height < start_height) {
                $('.navigation').removeClass('hide');
            }
            
            start_height = $(document).scrollTop();
        });
    });
</script>
<script>
    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    

    

</script>
<script src="https://cdn.jsdelivr.net/npm/jquery.fancybox@2.1.5/source/jquery.fancybox.js"></script>
<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="https://cdn.jsdelivr.net/npm/instant.page@3.0.0/instantpage.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.0/lazysizes.min.js" async></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>


<script src="https://unpkg.com/nplayer@latest/dist/index.min.js"></script>


<script src="https://v1.hitokoto.cn/?encode=js&select=%23hitokoto" defer></script>
<script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>





<script src="https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itrhx.com@3.0.8/js/maodian.js"></script>


<script>
    tocbot.init({
        
        tocSelector: '.js-toc',
        
        contentSelector: '.js-toc-content',
        
        headingSelector: 'h1, h2, h3, h4, h5 ,h6',
        
        hasInnerContainers: false,
        
    });
</script>


<script type="text/javascript">
    console.clear();
    console.log("%c 有朋自远方来, 不亦说乎.", "background:#24272A; color:#ffffff", "");
    console.log("%c Github %c", "background:#24272A; color:#ffffff", "", "https://github.com/laoxuai");
    console.log("%c 版本号: %c", "background:#24272A; color:#ffffff", "", "1.0.0");

    (function ($) {
        $.fn.snow = function (options) {
            var $flake = $('<div id="snowbox" />').css({ 'position': 'absolute', 'z-index': '9999', 'top': '-50px' }).html('&#10052;'),
                documentHeight = $(document).height(),
                documentWidth = $(document).width(),
                defaults = {
                    minSize: 10,
                    maxSize: 20,
                    newOn: 1000,
                    flakeColor: "#AFDAEF"  
                },
                options = $.extend({}, defaults, options);
            var interval = setInterval(function () {
                var startPositionLeft = Math.random() * documentWidth - 100,
                    startOpacity = 0.5 + Math.random(),
                    sizeFlake = options.minSize + Math.random() * options.maxSize,
                    endPositionTop = documentHeight - 200,
                    endPositionLeft = startPositionLeft - 500 + Math.random() * 500,
                    durationFall = documentHeight * 10 + Math.random() * 5000;
                $flake.clone().appendTo('body').css({
                    left: startPositionLeft,
                    opacity: startOpacity,
                    'font-size': sizeFlake,
                    color: options.flakeColor
                }).animate({
                    top: endPositionTop,
                    left: endPositionLeft,
                    opacity: 0.2
                }, durationFall, 'linear', function () {
                    $(this).remove()
                });
            }, options.newOn);
        };
    })(jQuery);
    $(function () {
        $.fn.snow({
            minSize: 5,  
            maxSize: 50, 
            newOn: 800   
        });
    });

    
    var OriginTitle = document.title;
    var titleTime;
    document.addEventListener('visibilitychange', function () {
        if (document.hidden) {
            
            document.title = '╭(°A°`)╮ 页面崩溃啦 ~';
            clearTimeout(titleTime);
        }
        else {
            $('[rel="icon"]').attr('href', "/favicon.ico");
            document.title = '(ฅ>ω<*ฅ) 噫又好啦 ~' + OriginTitle;
            titleTime = setTimeout(function () {
                document.title = OriginTitle;
            }, 2000);
        }
    });
</script><script type="text/javascript" size="150" alpha='0.3' zIndex="-2" src="/js/ribbon.js"></script>
    </body>
</html>
