<!DOCTYPE html>
<html><head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=no">
  <meta name="description" content="MJH Blog & MEET HTML Theme">
  <title>Spring-Boot-1</title>
  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/jquery.fancybox@2.1.5/source/jquery.fancybox.css">
  <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/tocbot@4.21.1/dist/tocbot.min.css">
  
  <link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-webfont@1.1.0/lxgwwenkai-regular.css" />
  <link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/highlightjs/cdn-release@11.8.0/build/styles/agate.min.css">
  <script src="https://fastly.jsdelivr.net/gh/highlightjs/cdn-release@11.8.0/build/highlight.min.js"></script>
  <script>
    hljs.highlightAll();
  </script>
  
  <link rel="stylesheet" href="https://unpkg.com/animate.css@3.5.2/animate.min.css">
  <script type="text/javascript">
    if (!!window.ActiveXObject || "ActiveXObject" in window) { 
      alert('朋友，上古浏览器不支持呢~');
    }
  </script>

  <style>
    .sidebar {
      z-index: 998;
      position: fixed;
      left: -200px;
      width: 200px;
      height: 100%;
      background: #ffffff;
      transition: all .5s ease;
    }

    .sidebar .top {
      font-size: 22px;
      color: rgb(0, 0, 0);
      text-align: center;
      height: 60px;
      line-height: 60px;
      background-color: rgb(255, 255, 255);
      user-select: none;

    }

    .sidebar ul {
      list-style: none;
    }

    .sidebar ul a {
      display: block;
      height: 100%;
      width: 100%;
      text-align: center;
      line-height: 45px;
      font-size: 18px;
      color: rgb(0, 0, 0);
      box-sizing: border-box;
      border-top: 1px solid rgb(255, 0, 0);
      border-bottom: 1px solid rgb(0, 17, 255);
      transition: .4s;
    }

    .sidebar ul li:hover a {
      padding-left: 30px;
      color: #7c4242;
      border-left: 5px solid #ffffff;
      transition: all 0.5s;
    }

    .sidebar ul a i {
      margin-right: 16px;
    }

    #check {
      display: none;
    }

    label #btn,
    label #cancel {
      position: fixed;
      cursor: pointer;
      background-color: #000000;
      border-radius: 3px;
    }

    label #btn {
      left: 5px;
      top: 7px;
      font-size: 25px;
      color: #fff;
      padding: 6px 10px;
      transition: all .5s;
      z-index: 999;
    }

    label #cancel {
      z-index: 999;
      left: -145px;
      top: 10px;
      font-size: 25px;
      color: rgb(255, 255, 255);
      padding: 4px 9px;
      transition: all .5s ease;
    }

    #check:checked~.sidebar {
      left: 0;
    }

    #check:checked~label #btn {
      left: 10px;
      opacity: 0;
      pointer-events: none;
    }

    #check:checked~label #cancel {
      left: 150px;
    }







     
    ::-webkit-scrollbar {
      width: 8px;
      height: 6px
    }

     
    ::-webkit-scrollbar-track {
      background-color: transparent;
      -webkit-border-radius: 2em;
      -moz-border-radius: 2em;
      border-radius: 2em
    }

     
    ::-webkit-scrollbar-thumb {
      background-color: #30B07F;
      background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, .4) 100%, transparent 100%, transparent 50%, rgba(255, 255, 255, .4) 50%, rgba(255, 255, 255, .4) 75%, transparent 75%, transparent);
      -webkit-border-radius: 2em;
      -moz-border-radius: 2em;
      border-radius: 2em
    }






     
    .navigation {
      width: 100%;
      height: 50px;
       
      position: fixed;
      left: 0;
      top: 0;
      text-align: center;
      transition: top 0.5s;
      z-index: 999;

      background: rgba(255, 255, 255, .4) !important;
      -webkit-backdrop-filter: saturate(180%) blur(20px);
      backdrop-filter: saturate(180%) blur(20px) !important;
    }

     
    .hide {
      top: -60px;
    }



     
    .btn {
      width: 120px;
      height: 40px;
      background: linear-gradient(315deg, #a4d8fa 0%, #5eb1e9 74%);
      border: none;
      border-radius: 10px;
      font-family: 'Lato', sans-serif;
      font-weight: 500;
      font-size: smaller;
      color: #fff;
      box-shadow: inset 2px 2px 2px 0px rgba(255, 255, 255, .5),
        7px 7px 20px 0px rgba(0, 0, 0, .1),
        4px 4px 5px 0px rgba(0, 0, 0, .1);
      outline: none;
      position: relative;
      z-index: 0;
    }

    .btn::before {
      position: absolute;
      content: '';
      left: 0;
      bottom: 0;
      width: 100%;
      height: 0;
      transition: all 0.3s ease;
      border-radius: 10px;
      background: linear-gradient(315deg, #4dccc6 0%, #96e4df 74%);
      z-index: -1;
    }

    .btn:hover::before {
      top: 0;
      height: 100%;
    }

    .btn:active {
      top: 2px;
    }




     
     

     
    * {
      font-family: LXGW WenKai
    }

    * {
      font-weight: bold
    }

    body {
      font-family: LXGW WenKai;
    }




     
    .pagination {
      display: flex;
      flex-flow: row nowrap;
      justify-content: center;
      align-items: center;
      height: 50px;
      margin: 0px;
    }

    .pagination a {
      text-decoration: none;
      font-size: 22px;
      color: rgb(0, 0, 0);
    }

    .page-item {
      display: inline;
      margin-right: 20px;
    }

    #Background_animation { 
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    }

  </style>

</head>
    <body style="background-color: rgb(229, 204, 15);">
    
<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" viewBox="0 0 100 100" id="Background_animation">
  <defs>
      <style>
          @keyframes rotate {
              100% {
                  transform: rotate(360deg);
              }
          }
          .out-top {
              animation: rotate 20s linear infinite;
              transform-origin: 13px 25px;
          }
          .in-top {
              animation: rotate 10s linear infinite;
              transform-origin: 13px 25px;
          }
          .out-bottom {
              animation: rotate 25s linear infinite;
              transform-origin: 84px 93px;
          }
          .in-bottom {
              animation: rotate 15s linear infinite;
              transform-origin: 84px 93px;
          }
      </style>
  </defs>
  <path fill="#9b5de5" class="out-top" d="M37-5C25.1-14.7,5.7-19.1-9.2-10-28.5,1.8-32.7,31.1-19.8,49c15.5,21.5,52.6,22,67.2,2.3C59.4,35,53.7,8.5,37-5Z"/>
  <path fill="#f15bb5" class="in-top" d="M20.6,4.1C11.6,1.5-1.9,2.5-8,11.2-16.3,23.1-8.2,45.6,7.4,50S42.1,38.9,41,24.5C40.2,14.1,29.4,6.6,20.6,4.1Z"/>
  <path fill="#00bbf9" class="out-bottom" d="M105.9,48.6c-12.4-8.2-29.3-4.8-39.4.8-23.4,12.8-37.7,51.9-19.1,74.1s63.9,15.3,76-5.6c7.6-13.3,1.8-31.1-2.3-43.8C117.6,63.3,114.7,54.3,105.9,48.6Z"/>
  <path fill="#00f5d4" class="in-bottom" d="M102,67.1c-9.6-6.1-22-3.1-29.5,2-15.4,10.7-19.6,37.5-7.6,47.8s35.9,3.9,44.5-12.5C115.5,92.6,113.9,74.6,102,67.1Z"/>
</svg>

  <input type="checkbox" id="check">
<label for="check">
  <i class="fa fa-bars" id="btn"></i>
  <i class="fa fa-times" id="cancel"></i>
</label>
<div class="sidebar">
  <div class="top">Hi~</div>
  <ul>
    
    <li class="lii">
      <a href="/">
        <div class="burger-item">
          <i class='fa fa-home'></i> 主页
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/posts">
        <div class="burger-item">
          <i class='fa fa-archive'></i> 文章
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/categories">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> 分类
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/archive">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> 归档
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/tags">
        <div class="burger-item">
          <i class='fa fa-tags'></i> 标签
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/about">
        <div class="burger-item">
          <i class='fa fa-info-circle'></i> 关于
        </div>
      </a>
    </li>
    
  </ul>
</div><nav class="navigation">
  <ul class="ull">
    
    <li class="lii">
      <a href="/">
        <div class="burger-item">
          <i class='fa fa-home'></i> 主页
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/posts">
        <div class="burger-item">
          <i class='fa fa-archive'></i> 文章
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/categories">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> 分类
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/archive">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> 归档
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/tags">
        <div class="burger-item">
          <i class='fa fa-tags'></i> 标签
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/about">
        <div class="burger-item">
          <i class='fa fa-info-circle'></i> 关于
        </div>
      </a>
    </li>
    
  </ul>
</nav>
<div id="body-wrap">
  
  <div style="width: 100%; height: 65vh;">
    <div id="page_site-info">
      <div id="site-title">
        <input type="checkbox" id="check">
        <br>
        <span class="blogtitle"></span>
        
        
        <div class="post-header">
          <span>
            
            <i class="fa fa-calendar"></i>
            2022-05-26&nbsp;
          </span>
          <span>
            
            <i class="fa fa-calendar-check-o"></i>
            2022-05-26&nbsp;&nbsp;&nbsp;
          </span>
          <span>
            
            <i class="fa fa-edit"></i>
            9702 字
          </span>&nbsp;
          <span>
            
            <i class="fa fa-paper-plane"></i>
            20 分钟
          </span>
        </div><div class="container-ctgtag">
	<div class="taxonomy" style="display: flex; justify-content: center;">
		
		<div class="ctg" style="display: flex; justify-content: center; margin-right: 20px;">
			
			<div style="margin-right: 10px;">
				
				<a href="/categories/"></a>
			</div>
			
		</div>
		<div class="tag" style="display: flex; justify-content: center;">
			
			<div style="margin-right: 10px;">
				
				<a href="/tags/"></a></i>
			</div>
			
		</div>
	</div>
</div>

        <script src="https://fastly.jsdelivr.net/npm/typed.js@2.0.16/dist/typed.umd.min.js"></script>
        <script>
          var typed = new Typed(".blogtitle", {
            strings: ['Spring-Boot-1'],
            startDelay: 300,
            typeSpeed: 100,
            loop: true,
            backSpeed: 50,
            showCursor: true
          });
        </script>
      </div>
    </div>
  </div>
  
<main id="content-outer">
    <div class="layout_page" id="content-inner">
        <article id="page" style="margin-right: 10px;">
            
            <div class="js-toc-content" style="height: 100%;">
                <h1 id="spring-boot第一节">Spring Boot第一节</h1>
<h2 id="一spring-boot概述">一、Spring Boot概述</h2>
<h3 id="一微服务概述">（一）微服务概述</h3>
<h4 id="1微服务">1、微服务</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">微服务（英语：Microservices）是一种软件架构风格，它是以专注于单一责任与功能的小型功能区块 (Small Building Blocks) 为基础，利用模块化的方式组合出复杂的大型应用程序，各功能区块使用与语言无关 (Language-Independent/Language agnostic）的API集相互通信；2014年，Martin Fowler 与 James Lewis 共同提出了微服务的概念，定义了微服务是以开发一组小型服务的方式来开发一个独立的应用系统的。其中每个小型服务都运行在自己的进程中，并经常采用HTTP资源API这样轻量的机制来相互通信。这些服务围绕业务功能进行构建，并能通过全自动的部署机制来进行独立部署。这些微服务可以使用不同的语言来编写，并且可以使用不同的数据存储技术。对这些微服务我们仅做最低限度的集中管理。
</span></span><span class="line"><span class="cl"> 
</span></span><span class="line"><span class="cl">把大型的项目按功能模块进行拆分，每个模块可以构建一个springBoot项目。
</span></span></code></pre></div><p><a class="link" href="/posts/tool/https://martinfowler.com/microservices/"  target="_blank" rel="noopener"
    >参考Martin Fowler微服务</a></p>
<h4 id="2单体应用">2、单体应用</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">（1）单体应用：一个单块应用系统是以一个单个单元的方式来构建的。企业应用系统经常包含三个主要部分：客户端用户界面、数据库和服务端应用系统，这里的服务端应用系统就是一个单体的应用，系统中任意逻辑发生变化都会导致重新构建部署一个新版本的服务端应用系统。针对单体应用，当访问量变大时，通常采用负载均衡，横向扩展的方式将多个单体应用部署到多个服务器上访问。
</span></span><span class="line"><span class="cl">（2）单体应用缺点：
</span></span><span class="line"><span class="cl">软件变更受到了很大的限制，应用系统的一个很小的部分的一处变更，也需要将整个单块应用系统进行重新构建和部署。不能根据用户需求部署应用系统中的功能模块，只能扩展部署整个应用系统。
</span></span></code></pre></div><h4 id="3单体应用和微服务对比">3、单体应用和微服务对比</h4>
<p><img src="/posts/tool/20220526204358/image-20220526211225028.jpeg"
    
    
    
    loading="lazy"
    
    
></p>
<h4 id="4微服务应用搭建">4、微服务应用搭建</h4>
<p><img src="/posts/tool/20220526204358/image-20220526211238818.jpeg"
    
    
    
    loading="lazy"
    
    
></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">要搭建一个微服务，运维和部署都变得非常复杂，spring提供了一套解决方案：
</span></span><span class="line"><span class="cl">springBoot:快速构建单个服务；
</span></span><span class="line"><span class="cl">springcloud:是一系列有序框架的集合，其主要的设施有，服务发现与注册，配置中心，消息总线，负载均衡，断路器，数据监控等，通过Spring Boot的方式，可以实现一键启动，和部署。
</span></span><span class="line"><span class="cl">Spring cloud data flow: 为基于微服务的分布式流处理和批处理数据通道提供了一系列模型和最佳实践.
</span></span></code></pre></div><p><img src="/posts/tool/20220526204358/image-20220526211250943.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="二spring-boot简介">（二）Spring Boot简介</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Spring-Boot是由Pivotal团队提供的全新框架，其设计目的是用来简化新Spring应用的初始搭建以及开发过程。个人理解来说Spring-Boot其实不是什么新的框架，它默认配置了很多框架的使用方式，就像maven整合了所有的jar包，Spring-Boot整合了其他相关联框架。
</span></span></code></pre></div><h3 id="三spring-boot的优势">（三）Spring Boot的优势</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1、快速构建项目。
</span></span><span class="line"><span class="cl">2、对主流开发框架的无配置集成。
</span></span><span class="line"><span class="cl">3、项目可独立运行，无须外部依赖Servlet容器。
</span></span><span class="line"><span class="cl">4、提供运行时的应用监控。
</span></span><span class="line"><span class="cl">5、极大的提高了开发、部署效率。
</span></span><span class="line"><span class="cl">6、与云计算的天然集成。
</span></span></code></pre></div><h3 id="四spring-boot的核心功能介绍">（四）Spring Boot的核心功能介绍</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1、独立运行Spring项目
</span></span><span class="line"><span class="cl">	Spring Boot 可以以jar包形式独立运行，运行一个Spring Boot项目只需要通过java -jar xx.jar来运行。
</span></span><span class="line"><span class="cl">2、内嵌servlet容器
</span></span><span class="line"><span class="cl">    Spring Boot可以选择内嵌Tomcat、jetty或者Undertow,这样我们无须以war包形式部署项目。
</span></span><span class="line"><span class="cl">3、提供starter简化Maven配置
</span></span><span class="line"><span class="cl">    spring提供了一系列的start pom来简化Maven的依赖加载，例如，当你使用了spring-boot-starter-web，会自动加入如图5-1所示的依赖包。
</span></span><span class="line"><span class="cl">4、自动装配Spring
</span></span><span class="line"><span class="cl">    Spring Boot会根据在类路径中的jar包，类、为jar包里面的类自动配置Bean，这样会极大地减少我们要使用的配置。当然，Spring Boot只考虑大多数的开发场景，并不是所有的场景，若在实际开发中我们需要配置Bean，而Spring Boot没有提供支持，则可以自定义自动配置。
</span></span><span class="line"><span class="cl">5、准生产的应用监控
</span></span><span class="line"><span class="cl">    Spring Boot提供基于http ssh telnet对运行时的项目进行监控。
</span></span><span class="line"><span class="cl">6、无代码生产和xml配置　　
</span></span><span class="line"><span class="cl">    Spring Boot不是借助与代码生成来实现的，而是通过条件注解来实现的，这是Spring4.x提供的新特性。
</span></span></code></pre></div><h2 id="二spring-boot入门程序">二、Spring Boot入门程序</h2>
<ol>
<li>新建一个maven工程
<img src="/posts/tool/20220526204358/image-20220526212521754.png"
    
    
    
    loading="lazy"
    
    
></li>
</ol>
<h3 id="一创建maven工程导入springboot依赖---继承父工程并加入web依赖">（一）创建maven工程导入springboot依赖  ( 继承父工程并加入web依赖)</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">  <span class="c">&lt;!--继承指定的父模块pom.xml文件：对项目进行整体的管理维护，如统一版本管理--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;parent&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;version&gt;</span>2.4.3<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/parent&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--spring提供的web项目启动器模块--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependencies&gt;</span>
</span></span></code></pre></div><p>Spring Boot将所有的功能场景都抽取出来，做成一个个的starters（启动器），只需要在项目里面引入这些starter 相关场景的所有依赖都会导入进来。要用什么功能就导入什么场景的启动器 。</p>
<h3 id="二编写spring-boot的主程序">（二）编写spring Boot的主程序</h3>
<h4 id="1项目结构">1、项目结构</h4>
<p><img src="/posts/tool/20220526204358/image-20220526211315420.png"
    
    
    
    loading="lazy"
    
    
></p>
<h4 id="2主程序代码">2、主程序代码</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@SpringBootApplication</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Example</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">         * 启动springboot
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">Example</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="n">args</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><p>@<strong>SpringBootApplication</strong>: 注解说明这个类是SpringBoot的主配置类，SpringBoot 就应该运行这个类的main方法来启动SpringBoot应用；并将<strong>主配置类（@SpringBootApplication标注的类）的所在包及下面所有子包里面的所有组件扫描到Spring容器</strong>；</p>
<h3 id="三编写controller代码">（三）编写Controller代码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Controller</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">TestController</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@RequestMapping</span><span class="p">(</span><span class="s">&#34;/hello&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@ResponseBody</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="nf">helloWorld</span><span class="p">(){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="s">&#34;Hello world!&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="四运行主程序进行测试">（四）运行主程序进行测试</h3>
<p><img src="/posts/tool/20220526204358/image-20220526211343801.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>（五）学员编写第一个springboot程序</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">练习CRUD
</span></span></code></pre></div><h1 id="spring-boot第二节">Spring Boot第二节</h1>
<h2 id="一spring-boot的简化部署">一、Spring Boot的简化部署</h2>
<h3 id="一添加maven插件">（一）添加maven插件</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">   <span class="c">&lt;!--执行maven命令插件--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;build&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;plugins&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;plugin&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/plugin&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/plugins&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/build&gt;</span>
</span></span></code></pre></div><h3 id="二执行package命令给项目打包">（二）执行package命令给项目打包</h3>
<p><img src="/posts/tool/20220526204358/image-20220526211451041.png"
    
    
    
    loading="lazy"
    
    
></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">执行打包命令后，会在target目录下生成项目对应的jar包。
</span></span></code></pre></div><h3 id="三执行java--jar命令运行程序">（三）执行java -jar命令运行程序</h3>
<p><img src="/posts/tool/20220526204358/image-20220526211504187.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="四学员进行简化部署练习">（四）学员进行简化部署练习</h3>
<h2 id="二spring-initializer快速创建spring-boot项目">二、Spring Initializer快速创建Spring Boot项目</h2>
<h3 id="一创建spring-boot项目">（一）创建Spring Boot项目</h3>
<p><img src="/posts/tool/20220526204358/image-20220526211523357.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/tool/20220526204358/image-20220526211536923.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/tool/20220526204358/image-20220526211549016.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/tool/20220526204358/image-20220526211603188.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/tool/20220526204358/image-20220526211615649.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="二项目结构解析">（二）项目结构解析</h3>
<p><img src="/posts/tool/20220526204358/image-20220526211628579.png"
    
    
    
    loading="lazy"
    
    
></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1、java文件夹目录结构中自动创建好指定包和Spring Boot启动主程序SpringbootApplication.class；
</span></span><span class="line"><span class="cl">2、resources文件夹中目录结构 
</span></span><span class="line"><span class="cl">static：保存所有的静态资源； js css images； 
</span></span><span class="line"><span class="cl">templates：保存所有的模板页面，（Spring Boot默认jar包使用嵌入式的Tomcat，默认不支持JSP页面），可以使用模板引擎（freemarker、thymeleaf）； 
</span></span><span class="line"><span class="cl">application.properties：Spring Boot应用的配置文件；可以修改一些默认设置；
</span></span></code></pre></div><h1 id="spring-boot第三节">Spring Boot第三节</h1>
<h2 id="一spring-boot配置文件">一、Spring Boot配置文件</h2>
<h3 id="一配置文件的作用及规范">（一）配置文件的作用及规范</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Spring Boot使用一个全局的配置文件，配置文件名是固定的；默认使用以下两种格式： 
</span></span><span class="line"><span class="cl">•application.properties 
</span></span><span class="line"><span class="cl">•application.yml 
</span></span><span class="line"><span class="cl">配置文件的作用：修改SpringBoot自动配置的默认值；Spring Boot启动时会根据配置文件自动注册相关的应用组件；
</span></span></code></pre></div><h3 id="二yaml配置文件">（二）yaml配置文件</h3>
<h4 id="1yaml的语法">1、yaml的语法</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">YAML：以数据为中心，比json、xml等更适合做配置文件；
</span></span></code></pre></div><h5 id="1基本语法">（1）基本语法</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">– 使用缩进表示层级关系
</span></span><span class="line"><span class="cl">– 缩进时不允许使用Tab键，只允许使用空格。
</span></span><span class="line"><span class="cl">– 缩进的空格数目不重要，只要相同层级的元素左侧对齐即可 – 大小写敏感
</span></span><span class="line"><span class="cl">- 键值对中间必须要有空格k:(空格)v
</span></span></code></pre></div><h5 id="2值的写法">（2）值的写法</h5>
<p>YAML 支持的三种数据结构:</p>
<h6 id="a字面量普通的值数字字符串布尔">a、字面量：普通的值（数字，字符串，布尔）</h6>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">server</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">8081</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">注意：字符串默认不用加上单引号或者双引号； </span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">双引号：特殊符号表示转义符本身；</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;zhangsan \n lisi&#34;</span><span class="l">：输出；zhangsan 换行 lisi</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">单引号；特殊字符就表示字符本身；</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">‘zhangsan \n lisi’：输出；zhangsan \n lisi</span><span class="w">
</span></span></span></code></pre></div><h6 id="b对象map属性和值键值对">b、对象、Map（属性和值）（键值对)</h6>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">person</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">zhangsan</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">age</span><span class="p">:</span><span class="w"> </span><span class="m">12</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">另一种行内写法：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">person</span><span class="p">:</span><span class="w"> </span>{<span class="nt">name: zhangsan,age</span><span class="p">:</span><span class="w"> </span><span class="m">12</span>}<span class="w">
</span></span></span></code></pre></div><h6 id="c数组listset">c、数组（List,Set）</h6>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">hobbies</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="l">singing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="l">dancing</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"> </span>- <span class="l">running</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">用-（空格）值表示数组中的一个元素</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">另一种行内写法：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">hobbies</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">singing,dancing,running]</span><span class="w">
</span></span></span></code></pre></div><p><a class="link" href="/posts/tool/https://bitbucket.org/asomov/snakeyaml/wiki/Documentation#markdown-header-yaml%02syntax"  target="_blank" rel="noopener"
    >yaml参考文档</a></p>
<h4 id="2配置文件值的注入">2、配置文件值的注入</h4>
<h5 id="1构建bean对象">（1）构建bean对象</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//只有spring容器中的对象才能自动进行数据绑定</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Component</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//将本类中的所有属性和配置文件中相关的配置进行绑定；</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// prefix指定要绑定的配置文件中的属性前缀；</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@ConfigurationProperties</span><span class="p">(</span><span class="n">prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;person&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Person</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">pname</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">success</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="n">birth</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Car</span><span class="w"> </span><span class="n">car</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">maps</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lists</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h5 id="2构建配置文件">（2）构建配置文件</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">person</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">pname</span><span class="p">:</span><span class="w"> </span><span class="l">zhangsan</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">age</span><span class="p">:</span><span class="w"> </span><span class="m">12</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">birth</span><span class="p">:</span><span class="w"> </span><span class="m">2020</span><span class="l">/12/12</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">success</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">car</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">cname</span><span class="p">:</span><span class="w"> </span><span class="l">奔驰</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">cprice</span><span class="p">:</span><span class="w"> </span><span class="m">200.0</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">lists</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="l">唱歌,跳舞]</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">maps</span><span class="p">:</span><span class="w"> </span>{<span class="nt">key1: v1,key2</span><span class="p">:</span><span class="w"> </span><span class="l">v2}</span><span class="w">
</span></span></span></code></pre></div><h5 id="3执行单元测试查看person对象的值">（3）执行单元测试查看person对象的值</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@SpringBootTest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">class</span> <span class="nc">SpringbootApplicationTests</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Autowired</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="n">person</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">contextLoads</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">person</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h5 id="4引入配置文件处理器插件">（4）引入配置文件处理器插件</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">   <span class="c">&lt;!--作用：编辑配置文件时会有相关提示信息--&gt;</span> 
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span> org.springframework.boot <span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span> spring-boot-configuration-processor <span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;optional&gt;</span> true <span class="nt">&lt;/optional&gt;</span>
</span></span><span class="line"><span class="cl"> <span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h4 id="3学员练习yuml的值的注入方式">3、学员练习yuml的值的注入方式</h4>
<h1 id="spring-boot第四节">Spring Boot第四节</h1>
<h2 id="一spring-boot配置文件-1">一、Spring Boot配置文件</h2>
<h3 id="一properties配置文件">（一）properties配置文件</h3>
<h4 id="1properties语法">1、properties语法</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">以KEY=VALue键值对的方式设置值
</span></span></code></pre></div><h5 id="1字面量普通的值数字字符串布尔">（1）字面量：普通的值（数字，字符串，布尔）</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-properties" data-lang="properties"><span class="line"><span class="cl"><span class="na">name</span><span class="o">=</span><span class="s">张三</span>
</span></span></code></pre></div><h5 id="2对象map属性和值键值对">（2）对象、Map（属性和值）（键值对)</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-properties" data-lang="properties"><span class="line"><span class="cl"><span class="na">person.name</span><span class="o">=</span><span class="s">张三</span>
</span></span><span class="line"><span class="cl"><span class="na">person.age</span><span class="o">=</span><span class="s">12</span>
</span></span><span class="line"><span class="cl"><span class="na">maps.key1</span><span class="o">=</span><span class="s">value1</span>
</span></span><span class="line"><span class="cl"><span class="na">maps.key2</span><span class="o">=</span><span class="s">value2</span>
</span></span></code></pre></div><h5 id="3数组listset">（3）数组（List,Set）</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-properties" data-lang="properties"><span class="line"><span class="cl"><span class="na">hobbies</span><span class="o">=</span><span class="s">singing,dancing,running</span>
</span></span></code></pre></div><h4 id="2配置文件值的注入-1">2、配置文件值的注入</h4>
<h5 id="1构建bean对象-1">（1）构建bean对象</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//只有spring容器中的对象才能自动进行数据绑定</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Component</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//将本类中的所有属性和配置文件中相关的配置进行绑定；</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">// prefix指定要绑定的配置文件中的属性前缀；</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@ConfigurationProperties</span><span class="p">(</span><span class="n">prefix</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;person&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Person</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">pname</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">success</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="n">birth</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Car</span><span class="w"> </span><span class="n">car</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">maps</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">lists</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h5 id="2构建配置文件-1">（2）构建配置文件</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-properties" data-lang="properties"><span class="line"><span class="cl"><span class="na">person.pname</span><span class="o">=</span><span class="s">张三</span>
</span></span><span class="line"><span class="cl"><span class="na">person.age</span><span class="o">=</span><span class="s">12</span>
</span></span><span class="line"><span class="cl"><span class="na">person.birth</span><span class="o">=</span><span class="s">2019/12/12</span>
</span></span><span class="line"><span class="cl"><span class="na">person.success</span><span class="o">=</span><span class="s">true</span>
</span></span><span class="line"><span class="cl"><span class="na">person.car.cname</span><span class="o">=</span><span class="s">宝马</span>
</span></span><span class="line"><span class="cl"><span class="na">person.car.cprice</span><span class="o">=</span><span class="s">100.0</span>
</span></span><span class="line"><span class="cl"><span class="na">person.lists</span><span class="o">=</span><span class="s">唱歌,跳舞,跑步</span>
</span></span><span class="line"><span class="cl"><span class="na">person.maps.k1</span><span class="o">=</span><span class="s">value1</span>
</span></span><span class="line"><span class="cl"><span class="na">person.maps.k2</span><span class="o">=</span><span class="s">value2</span>
</span></span></code></pre></div><h5 id="3执行单元测试查看person对象的值-1">（3）执行单元测试查看person对象的值</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@SpringBootTest</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">class</span> <span class="nc">SpringbootApplicationTests</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Autowired</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="n">person</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">contextLoads</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">person</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="3学员练习properties的值的注入方式">3、学员练习properties的值的注入方式</h4>
<h3 id="二configurationproperties注解和value注解的区别">（二）@ConfigurationProperties注解和@Value注解的区别</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">1、@ConfigurationProperties注解用于根据配置文件批量注入值，springboot默认配置文件application.yml/application.properties；
</span></span><span class="line"><span class="cl">2、@Value注解用于根据配置文件单个注入值；
</span></span></code></pre></div><table>
<thead>
<tr>
<th>区别</th>
<th>@ConfigurationProperties</th>
<th>@Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>SpEL</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>复杂类型封装</td>
<td>支持</td>
<td>不支持</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">案例</span><span class="err">：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Component</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//@ConfigurationProperties(prefix = &#34;person&#34;)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">Person</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Value</span><span class="p">(</span><span class="s">&#34;${person.pname}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">pname</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Value</span><span class="p">(</span><span class="s">&#34;#{12*2}&#34;</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">age</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">success</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Date</span><span class="w"> </span><span class="n">birth</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Car</span><span class="w"> </span><span class="n">car</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">map</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">hobbies</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h3 id="三配置文件中的占位符">（三）配置文件中的占位符</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-txt" data-lang="txt"><span class="line"><span class="cl">1、springboot全局配置文件中可以使用随机数
</span></span><span class="line"><span class="cl">${random.value}、${random.int}、${random.long}
</span></span><span class="line"><span class="cl">${random.int(10)}、${random.int[1024,65536]}
</span></span><span class="line"><span class="cl">2、springboot全局配置文件中可以使用占位符
</span></span><span class="line"><span class="cl">通过${属性名}获取已经在配置文件中加载过的属性值；
</span></span><span class="line"><span class="cl">通过${属性名:默认值}来指定找不到属性时的默认值；
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-properties" data-lang="properties"><span class="line"><span class="cl"><span class="err">案例：</span>
</span></span><span class="line"><span class="cl"><span class="na">person.pname</span><span class="o">=</span><span class="s">张三</span>
</span></span><span class="line"><span class="cl"><span class="na">person.age</span><span class="o">=</span><span class="s">${random.int}</span>
</span></span><span class="line"><span class="cl"><span class="na">person.success</span><span class="o">=</span><span class="s">true</span>
</span></span><span class="line"><span class="cl"><span class="na">person.birth</span><span class="o">=</span><span class="s">2012/12/12</span>
</span></span><span class="line"><span class="cl"><span class="na">person.car.cname</span><span class="o">=</span><span class="s">${car.cname:奔驰}</span>
</span></span><span class="line"><span class="cl"><span class="na">person.car.cprice</span><span class="o">=</span><span class="s">200.0</span>
</span></span><span class="line"><span class="cl"><span class="na">person.map.key1</span><span class="o">=</span><span class="s">value1</span>
</span></span><span class="line"><span class="cl"><span class="na">person.map.key2</span><span class="o">=</span><span class="s">value2</span>
</span></span><span class="line"><span class="cl"><span class="na">person.hobbies</span><span class="o">=</span><span class="s">唱歌,跳舞,跑步</span>
</span></span></code></pre></div><h3 id="四多环境支持">（四）多环境支持</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="l">Profile是Spring对不同环境提供不同配置功能的支持，可以通过激活、指定参数等方式快速切换环境；</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="m">1</span><span class="l">、多文件多环境形式：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">格式：application-{profile}.properties/yml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">例如：可以在项目中创建如下主配置文件：application-dev.properties、application-test.properties、application-prod.properties、application.properties,默认使用application.properties,可以通过配置spring.profiles.active=profile指定使用某个环境的配置文件。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="m">2</span><span class="l">、yaml支持单文件多环境形式：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">profiles</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">active</span><span class="p">:</span><span class="w"> </span><span class="l">test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">---</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">profiles</span><span class="p">:</span><span class="w"> </span><span class="l">dev</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">server</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">8081</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nn">---</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">profiles</span><span class="p">:</span><span class="w"> </span><span class="l">test</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">server</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">8082</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="l">通过---来区分不同的profile环境。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="m">3</span><span class="l">、激活方式：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">在配置文件中指定 spring.profiles.active=dev</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">命令行  java -jar springboot-0.0.1-SNAPSHOT.jar --spring.profiles.active=dev</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="l">jvm参数 -Dspring.profiles.active=dev</span><span class="w">
</span></span></span></code></pre></div><p><img src="/posts/tool/20220526204358/image-20220526211847607.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="五配置文件加载位置">（五）配置文件加载位置</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">springboot默认会从以下位置加载配置文件：application.properties/application.yml
</span></span><span class="line"><span class="cl">项目所在磁盘路径file:./config/ 
</span></span><span class="line"><span class="cl">项目所在磁盘路径file:./ 
</span></span><span class="line"><span class="cl">项目类路径classpath:/config/ 
</span></span><span class="line"><span class="cl">项目类路径classpath:/
</span></span><span class="line"><span class="cl">优先级由高到底，高优先级的配置会覆盖低优先级的配置；SpringBoot会从这四个位置全部加载主配置文件，互补配置；
</span></span><span class="line"><span class="cl">如果要加载其他位置的配置文件，可以通过--spring.config.location（只能加到命令行）来指定要加载的配置文件的位置。
</span></span></code></pre></div><h1 id="spring-boot第五节">Spring Boot第五节</h1>
<h2 id="一spring-boot的web开发">一、Spring Boot的web开发</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">讲解思路： 
</span></span><span class="line"><span class="cl"> 本章节主要掌握springboot当中静态资源的处理，springboot当中提供的静态资源存放的位置。 在实际当中开发，我们应该满足springboot的约定和规范。如果提供的静态资源目录不能满足实际的需求，还可以自定义静态资源的位置
</span></span></code></pre></div><h3 id="一springboot关于静态资源的处理">（一）springboot关于静态资源的处理</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">springboot启动时会根据配置文件自动配置相应场景的组件xxxAutoConfiguration</span><span class="err">，</span><span class="n">web项目启动时会初始化WebMvcAutoConfiguration组件处理请求相关的操作</span><span class="err">，</span><span class="n">其中有默认处理静态资源的方法</span><span class="err">：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addResourceHandlers</span><span class="p">(</span><span class="n">ResourceHandlerRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="kd">super</span><span class="p">.</span><span class="na">addResourceHandlers</span><span class="p">(</span><span class="n">registry</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="na">resourceProperties</span><span class="p">.</span><span class="na">isAddMappings</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">logger</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&#34;Default resource handling disabled&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">return</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">ServletContext</span><span class="w"> </span><span class="n">servletContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getServletContext</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">addResourceHandler</span><span class="p">(</span><span class="n">registry</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;/webjars/**&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;classpath:/META-INF/resources/webjars/&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">addResourceHandler</span><span class="p">(</span><span class="n">registry</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">mvcProperties</span><span class="p">.</span><span class="na">getStaticPathPattern</span><span class="p">(),</span><span class="w"> </span><span class="p">(</span><span class="n">registration</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">registration</span><span class="p">.</span><span class="na">addResourceLocations</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">resourceProperties</span><span class="p">.</span><span class="na">getStaticLocations</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">servletContext</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">registration</span><span class="p">.</span><span class="na">addResourceLocations</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ServletContextResource</span><span class="p">(</span><span class="n">servletContext</span><span class="p">,</span><span class="w"> </span><span class="n">SERVLET_LOCATION</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">从该方法中可以发现：
</span></span><span class="line"><span class="cl">1、默认情况下：
</span></span><span class="line"><span class="cl">（1）匹配/webjars/** 的请求，都去 classpath:/META-INF/resources/webjars/ 找资源；
</span></span><span class="line"><span class="cl">（2）匹配 &#34;/**&#34; 的请求，都去（静态资源的文件夹）找映射，静态资源文件夹路径如下：
</span></span><span class="line"><span class="cl">&#34;classpath:/META‐INF/resources/&#34;
</span></span><span class="line"><span class="cl">&#34;classpath:/resources/&#34;
</span></span><span class="line"><span class="cl">&#34;classpath:/static/&#34;
</span></span><span class="line"><span class="cl">&#34;classpath:/public/&#34; 
</span></span><span class="line"><span class="cl">&#34;/&#34;：当前项目的根路径
</span></span><span class="line"><span class="cl">2、自定义配置静态资源路径：
</span></span><span class="line"><span class="cl">spring.web.resources.static-locations=自定义路径
</span></span></code></pre></div><h4 id="1webjars的使用">1、webjars的使用</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">我们可以通过webjars以jar包的方式引入静态资源。
</span></span></code></pre></div><p><a class="link" href="/posts/tool/https://www.webjars.org/"  target="_blank" rel="noopener"
    >静态资源坐标参考</a></p>
<h5 id="1引入依赖">（1）引入依赖</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"> <span class="c">&lt;!--jquery的jar包引入--&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.webjars<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>jquery<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;version&gt;</span>3.6.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h5 id="2启动服务访问资源">（2）启动服务访问资源</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">浏览器访问路径：http://localhost:8080/webjars/jquery/3.6.0/jquery.min.js获取相应的静态资源。
</span></span></code></pre></div><h5 id="3学员练习webjars的使用">（3）学员练习webjars的使用</h5>
<h4 id="2静态资源的存放位置">2、静态资源的存放位置</h4>
<h5 id="1默认存放位置查看">（1）默认存放位置查看</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">默认静态资源路径：
</span></span><span class="line"><span class="cl">&#34;classpath:/META‐INF/resources/&#34;
</span></span><span class="line"><span class="cl">&#34;classpath:/resources/&#34;
</span></span><span class="line"><span class="cl">&#34;classpath:/static/&#34;
</span></span><span class="line"><span class="cl">&#34;classpath:/public/&#34; 
</span></span><span class="line"><span class="cl">&#34;/&#34;：当前项目的根路径
</span></span><span class="line"><span class="cl">案例：在上述任意路径下创建静态资源hello.html,浏览器访问路径：http://localhost:8080/hello.html获取相应的静态资源。
</span></span></code></pre></div><h5 id="2自定义位置存放">（2）自定义位置存放</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">在配置文件中通过属性spring.web.resources.static-locations=自定义路径，设置自定义静态资源存放路径；
</span></span><span class="line"><span class="cl">案例：
</span></span><span class="line"><span class="cl">a、配置文件中设置：spring.web.resources.static-locations=classpath:/hello/
</span></span><span class="line"><span class="cl">b、在自定义路径下添加静态资源hello.html,浏览器访问路径：http://localhost:8080/hello.html获取相应的静态资源。
</span></span><span class="line"><span class="cl">注意：自定义静态资源路径后，默认静态资源路径失效！
</span></span></code></pre></div><h5 id="3学员练习自定义静态资源访问">（3）学员练习自定义静态资源访问</h5>
<h1 id="spring-boot第六节">Spring Boot第六节</h1>
<h2 id="一spring-boot的web开发-1">一、Spring Boot的web开发</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">讲解思路： 
</span></span><span class="line"><span class="cl">  本章节有两大重点： 
</span></span><span class="line"><span class="cl">  1、掌握springboot web模块的自动配置原理，从该模块引申，整个springboot当中大量的应用了自动配置，实现的具体思路相同。 
</span></span><span class="line"><span class="cl">  2、自定义拦截器，注册拦截器，演示拦截器是否生效，拦截器在实际当中有大量的应用，务必掌握
</span></span></code></pre></div><h3 id="一springboot的自动配置">（一）springboot的自动配置</h3>
<h4 id="1自动配置原理">1、自动配置原理</h4>
<h5 id="1springboot启动时加载主配值类解析注解springbootapplication">（1）springboot启动时加载主配值类，解析注解@SpringBootApplication</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@SpringBootApplication</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">SpringbootApplication</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">args</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">SpringApplication</span><span class="p">.</span><span class="na">run</span><span class="p">(</span><span class="n">SpringbootApplication</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">args</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h5 id="2在springbootapplication组合注解中解析enableautoconfiguration获取自动配置信息">（2）在@SpringBootApplication组合注解中解析@EnableAutoConfiguration获取自动配置信息</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//在@EnableAutoConfiguration注解中，为容器导入自动配置的组件：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Target</span><span class="p">(</span><span class="n">ElementType</span><span class="p">.</span><span class="na">TYPE</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Retention</span><span class="p">(</span><span class="n">RetentionPolicy</span><span class="p">.</span><span class="na">RUNTIME</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Documented</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Inherited</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@AutoConfigurationPackage</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Import</span><span class="p">(</span><span class="n">AutoConfigurationImportSelector</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="nd">@interface</span><span class="w"> </span><span class="n">EnableAutoConfiguration</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//1、第一步：通过AutoConfigurationImportSelector类的selectImports方法获取要导入的自动配置组件</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="kd">public</span><span class="w"> </span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="nf">selectImports</span><span class="p">(</span><span class="n">AnnotationMetadata</span><span class="w"> </span><span class="n">annotationMetadata</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">isEnabled</span><span class="p">(</span><span class="n">annotationMetadata</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">NO_IMPORTS</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//获取自动配置的内容</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">AutoConfigurationEntry</span><span class="w"> </span><span class="n">autoConfigurationEntry</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getAutoConfigurationEntry</span><span class="p">(</span><span class="n">annotationMetadata</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">StringUtils</span><span class="p">.</span><span class="na">toStringArray</span><span class="p">(</span><span class="n">autoConfigurationEntry</span><span class="p">.</span><span class="na">getConfigurations</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">}</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//2、第二步：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="kd">protected</span><span class="w"> </span><span class="n">AutoConfigurationEntry</span><span class="w"> </span><span class="nf">getAutoConfigurationEntry</span><span class="p">(</span><span class="n">AnnotationMetadata</span><span class="w"> </span><span class="n">annotationMetadata</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="n">isEnabled</span><span class="p">(</span><span class="n">annotationMetadata</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">EMPTY_ENTRY</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">AnnotationAttributes</span><span class="w"> </span><span class="n">attributes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getAttributes</span><span class="p">(</span><span class="n">annotationMetadata</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//获取配置信息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">configurations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getCandidateConfigurations</span><span class="p">(</span><span class="n">annotationMetadata</span><span class="p">,</span><span class="w"> </span><span class="n">attributes</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">configurations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">removeDuplicates</span><span class="p">(</span><span class="n">configurations</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">Set</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">exclusions</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getExclusions</span><span class="p">(</span><span class="n">annotationMetadata</span><span class="p">,</span><span class="w"> </span><span class="n">attributes</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">checkExcludedClasses</span><span class="p">(</span><span class="n">configurations</span><span class="p">,</span><span class="w"> </span><span class="n">exclusions</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">configurations</span><span class="p">.</span><span class="na">removeAll</span><span class="p">(</span><span class="n">exclusions</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">configurations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getConfigurationClassFilter</span><span class="p">().</span><span class="na">filter</span><span class="p">(</span><span class="n">configurations</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">fireAutoConfigurationImportEvents</span><span class="p">(</span><span class="n">configurations</span><span class="p">,</span><span class="w"> </span><span class="n">exclusions</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">AutoConfigurationEntry</span><span class="p">(</span><span class="n">configurations</span><span class="p">,</span><span class="w"> </span><span class="n">exclusions</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//3、第三步：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">protected</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">getCandidateConfigurations</span><span class="p">(</span><span class="n">AnnotationMetadata</span><span class="w"> </span><span class="n">metadata</span><span class="p">,</span><span class="w"> </span><span class="n">AnnotationAttributes</span><span class="w"> </span><span class="n">attributes</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    	</span><span class="c1">//获取配置信息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">configurations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SpringFactoriesLoader</span><span class="p">.</span><span class="na">loadFactoryNames</span><span class="p">(</span><span class="n">getSpringFactoriesLoaderFactoryClass</span><span class="p">(),</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">getBeanClassLoader</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">Assert</span><span class="p">.</span><span class="na">notEmpty</span><span class="p">(</span><span class="n">configurations</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;No auto configuration classes found in META-INF/spring.factories. If you &#34;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="o">+</span><span class="w"> </span><span class="s">&#34;are using a custom packaging, make sure that file is correct.&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">configurations</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//4、第四步：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">loadFactoryNames</span><span class="p">(</span><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">factoryType</span><span class="p">,</span><span class="w"> </span><span class="nd">@Nullable</span><span class="w"> </span><span class="n">ClassLoader</span><span class="w"> </span><span class="n">classLoader</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">ClassLoader</span><span class="w"> </span><span class="n">classLoaderToUse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">classLoader</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">classLoaderToUse</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">classLoaderToUse</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">SpringFactoriesLoader</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getClassLoader</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">String</span><span class="w"> </span><span class="n">factoryTypeName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">factoryType</span><span class="p">.</span><span class="na">getName</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//获取要自动注入的组件信息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">loadSpringFactories</span><span class="p">(</span><span class="n">classLoaderToUse</span><span class="p">).</span><span class="na">getOrDefault</span><span class="p">(</span><span class="n">factoryTypeName</span><span class="p">,</span><span class="w"> </span><span class="n">Collections</span><span class="p">.</span><span class="na">emptyList</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//5、第五步：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">private</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="nf">loadSpringFactories</span><span class="p">(</span><span class="n">ClassLoader</span><span class="w"> </span><span class="n">classLoader</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;&gt;</span><span class="w"> </span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">cache</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="n">classLoader</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">result</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">result</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HashMap</span><span class="o">&lt;&gt;</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">try</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c1">//获取要自动注入的组件信息</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">Enumeration</span><span class="o">&lt;</span><span class="n">URL</span><span class="o">&gt;</span><span class="w"> </span><span class="n">urls</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">classLoader</span><span class="p">.</span><span class="na">getResources</span><span class="p">(</span><span class="n">FACTORIES_RESOURCE_LOCATION</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">while</span><span class="w"> </span><span class="p">(</span><span class="n">urls</span><span class="p">.</span><span class="na">hasMoreElements</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">URL</span><span class="w"> </span><span class="n">url</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">urls</span><span class="p">.</span><span class="na">nextElement</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">UrlResource</span><span class="w"> </span><span class="n">resource</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UrlResource</span><span class="p">(</span><span class="n">url</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">Properties</span><span class="w"> </span><span class="n">properties</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">PropertiesLoaderUtils</span><span class="p">.</span><span class="na">loadProperties</span><span class="p">(</span><span class="n">resource</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">Map</span><span class="p">.</span><span class="na">Entry</span><span class="o">&lt;?</span><span class="p">,</span><span class="w"> </span><span class="o">?&gt;</span><span class="w"> </span><span class="n">entry</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">properties</span><span class="p">.</span><span class="na">entrySet</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">String</span><span class="w"> </span><span class="n">factoryTypeName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">((</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">entry</span><span class="p">.</span><span class="na">getKey</span><span class="p">()).</span><span class="na">trim</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">String</span><span class="o">[]</span><span class="w"> </span><span class="n">factoryImplementationNames</span><span class="w"> </span><span class="o">=</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">							</span><span class="n">StringUtils</span><span class="p">.</span><span class="na">commaDelimitedListToStringArray</span><span class="p">((</span><span class="n">String</span><span class="p">)</span><span class="w"> </span><span class="n">entry</span><span class="p">.</span><span class="na">getValue</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">factoryImplementationName</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="n">factoryImplementationNames</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">						</span><span class="n">result</span><span class="p">.</span><span class="na">computeIfAbsent</span><span class="p">(</span><span class="n">factoryTypeName</span><span class="p">,</span><span class="w"> </span><span class="n">key</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="o">&lt;&gt;</span><span class="p">())</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">								</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="n">factoryImplementationName</span><span class="p">.</span><span class="na">trim</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">// Replace all lists with unmodifiable lists containing unique elements</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">result</span><span class="p">.</span><span class="na">replaceAll</span><span class="p">((</span><span class="n">factoryType</span><span class="p">,</span><span class="w"> </span><span class="n">implementations</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">implementations</span><span class="p">.</span><span class="na">stream</span><span class="p">().</span><span class="na">distinct</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="p">.</span><span class="na">collect</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">collectingAndThen</span><span class="p">(</span><span class="n">Collectors</span><span class="p">.</span><span class="na">toList</span><span class="p">(),</span><span class="w"> </span><span class="n">Collections</span><span class="p">::</span><span class="n">unmodifiableList</span><span class="p">)));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">cache</span><span class="p">.</span><span class="na">put</span><span class="p">(</span><span class="n">classLoader</span><span class="p">,</span><span class="w"> </span><span class="n">result</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">IOException</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">throw</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">IllegalArgumentException</span><span class="p">(</span><span class="s">&#34;Unable to load factories from location [&#34;</span><span class="w"> </span><span class="o">+</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">FACTORIES_RESOURCE_LOCATION</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&#34;]&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">ex</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="k">return</span><span class="w"> </span><span class="n">result</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//第六步：获取自动配置信息spring.factories</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">String</span><span class="w"> </span><span class="n">FACTORIES_RESOURCE_LOCATION</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;META-INF/spring.factories&#34;</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">获取到配置文件中的自动配置类xxxAutoConfiguration的信息</span><span class="err">，</span><span class="n">并将自动配置类中的组件初始化到容器中</span><span class="err">。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">初始化的过程中会加载xxxProperties对象</span><span class="err">，</span><span class="n">根据xxxProperties对象中的属性值初始化组件</span><span class="p">,</span><span class="n">xxxProperties对象的值可以通过全局配置文件指定</span><span class="err">。</span><span class="w">
</span></span></span></code></pre></div><h5 id="3初始化自动配置组件">（3）初始化自动配置组件</h5>
<p>以Spring Boot 自动配置SpringMVC为例，Spring Boot启动时会做以下操作：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//根据以上步骤找到自动配置类WebMvcAutoConfiguration，并根据自动配置类进行以下初始化操作：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Configuration</span><span class="p">(</span><span class="n">proxyBeanMethods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="c1">//表示这是一个配置类，和以前编写的配置文件一样</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@ConditionalOnWebApplication</span><span class="p">(</span><span class="n">type</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Type</span><span class="p">.</span><span class="na">SERVLET</span><span class="p">)</span><span class="c1">//@Conditional判断满足指定的条件，整个配置类里面的配置就会生效,否则不生效； 这里是判断当前应用是否是web应用，如果是当前配置类生效</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@ConditionalOnClass</span><span class="p">({</span><span class="w"> </span><span class="n">Servlet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">DispatcherServlet</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">WebMvcConfigurer</span><span class="p">.</span><span class="na">class</span><span class="w"> </span><span class="p">})</span><span class="c1">//判断当前项目有没有以上指定类</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@ConditionalOnMissingBean</span><span class="p">(</span><span class="n">WebMvcConfigurationSupport</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="c1">//判断容器中是否没有指定组件</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@AutoConfigureOrder</span><span class="p">(</span><span class="n">Ordered</span><span class="p">.</span><span class="na">HIGHEST_PRECEDENCE</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">10</span><span class="p">)</span><span class="c1">//自动配置顺序</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@AutoConfigureAfter</span><span class="p">({</span><span class="w"> </span><span class="n">DispatcherServletAutoConfiguration</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">TaskExecutionAutoConfiguration</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="n">ValidationAutoConfiguration</span><span class="p">.</span><span class="na">class</span><span class="w"> </span><span class="p">})</span><span class="c1">//在指定自动配置之后配置</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">WebMvcAutoConfiguration</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    	</span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">         * a、自动配置视图解析器
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    	</span><span class="nd">@Bean</span><span class="c1">//给容器中添加组件</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@ConditionalOnBean</span><span class="p">(</span><span class="n">ViewResolver</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@ConditionalOnMissingBean</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;viewResolver&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ContentNegotiatingViewResolver</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="n">ContentNegotiatingViewResolver</span><span class="w"> </span><span class="nf">viewResolver</span><span class="p">(</span><span class="n">BeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">ContentNegotiatingViewResolver</span><span class="w"> </span><span class="n">resolver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ContentNegotiatingViewResolver</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">resolver</span><span class="p">.</span><span class="na">setContentNegotiationManager</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">ContentNegotiationManager</span><span class="p">.</span><span class="na">class</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">// ContentNegotiatingViewResolver uses all the other view resolvers to locate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">// a view so it should have a high precedence</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">resolver</span><span class="p">.</span><span class="na">setOrder</span><span class="p">(</span><span class="n">Ordered</span><span class="p">.</span><span class="na">HIGHEST_PRECEDENCE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">resolver</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    	</span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">         * 自动配置视图解析器
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nd">@Bean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@ConditionalOnBean</span><span class="p">(</span><span class="n">View</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@ConditionalOnMissingBean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="n">BeanNameViewResolver</span><span class="w"> </span><span class="nf">beanNameViewResolver</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">BeanNameViewResolver</span><span class="w"> </span><span class="n">resolver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanNameViewResolver</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">resolver</span><span class="p">.</span><span class="na">setOrder</span><span class="p">(</span><span class="n">Ordered</span><span class="p">.</span><span class="na">LOWEST_PRECEDENCE</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">10</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">resolver</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    	
</span></span></span><span class="line"><span class="cl"><span class="w">    	</span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">         * b、提供静态资源访问路径和webjars访问路径
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    	</span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">protected</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addResourceHandlers</span><span class="p">(</span><span class="n">ResourceHandlerRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="kd">super</span><span class="p">.</span><span class="na">addResourceHandlers</span><span class="p">(</span><span class="n">registry</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="o">!</span><span class="k">this</span><span class="p">.</span><span class="na">resourceProperties</span><span class="p">.</span><span class="na">isAddMappings</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">logger</span><span class="p">.</span><span class="na">debug</span><span class="p">(</span><span class="s">&#34;Default resource handling disabled&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">return</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">ServletContext</span><span class="w"> </span><span class="n">servletContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getServletContext</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">addResourceHandler</span><span class="p">(</span><span class="n">registry</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;/webjars/**&#34;</span><span class="p">,</span><span class="w"> </span><span class="s">&#34;classpath:/META-INF/resources/webjars/&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">addResourceHandler</span><span class="p">(</span><span class="n">registry</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">mvcProperties</span><span class="p">.</span><span class="na">getStaticPathPattern</span><span class="p">(),</span><span class="w"> </span><span class="p">(</span><span class="n">registration</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">registration</span><span class="p">.</span><span class="na">addResourceLocations</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">resourceProperties</span><span class="p">.</span><span class="na">getStaticLocations</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">servletContext</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">registration</span><span class="p">.</span><span class="na">addResourceLocations</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ServletContextResource</span><span class="p">(</span><span class="n">servletContext</span><span class="p">,</span><span class="w"> </span><span class="n">SERVLET_LOCATION</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="o">-----------------</span><span class="n">内部类</span><span class="o">--------------------</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Configuration</span><span class="p">(</span><span class="n">proxyBeanMethods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nd">@Import</span><span class="p">(</span><span class="n">EnableWebMvcConfiguration</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nd">@EnableConfigurationProperties</span><span class="p">({</span><span class="w"> </span><span class="n">WebMvcProperties</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">org</span><span class="p">.</span><span class="na">springframework</span><span class="p">.</span><span class="na">boot</span><span class="p">.</span><span class="na">autoconfigure</span><span class="p">.</span><span class="na">web</span><span class="p">.</span><span class="na">ResourceProperties</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">WebProperties</span><span class="p">.</span><span class="na">class</span><span class="w"> </span><span class="p">})</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="nd">@Order</span><span class="p">(</span><span class="n">0</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">WebMvcAutoConfigurationAdapter</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">WebMvcConfigurer</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">WebMvcProperties</span><span class="w"> </span><span class="n">mvcProperties</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">ListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">ObjectProvider</span><span class="o">&lt;</span><span class="n">HttpMessageConverters</span><span class="o">&gt;</span><span class="w"> </span><span class="n">messageConvertersProvider</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">ObjectProvider</span><span class="o">&lt;</span><span class="n">DispatcherServletPath</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dispatcherServletPath</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">ObjectProvider</span><span class="o">&lt;</span><span class="n">ServletRegistrationBean</span><span class="o">&lt;?&gt;&gt;</span><span class="w"> </span><span class="n">servletRegistrations</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">final</span><span class="w"> </span><span class="n">ResourceHandlerRegistrationCustomizer</span><span class="w"> </span><span class="n">resourceHandlerRegistrationCustomizer</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="c1">//该内部类只有一个带参构造方法，那么spring在创建该类实例时，只能从容器中获取参数；</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="nf">WebMvcAutoConfigurationAdapter</span><span class="p">(</span><span class="n">WebProperties</span><span class="w"> </span><span class="n">webProperties</span><span class="p">,</span><span class="w"> </span><span class="n">WebMvcProperties</span><span class="w"> </span><span class="n">mvcProperties</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">ListableBeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">,</span><span class="w"> </span><span class="n">ObjectProvider</span><span class="o">&lt;</span><span class="n">HttpMessageConverters</span><span class="o">&gt;</span><span class="w"> </span><span class="n">messageConvertersProvider</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">ObjectProvider</span><span class="o">&lt;</span><span class="n">ResourceHandlerRegistrationCustomizer</span><span class="o">&gt;</span><span class="w"> </span><span class="n">resourceHandlerRegistrationCustomizerProvider</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">ObjectProvider</span><span class="o">&lt;</span><span class="n">DispatcherServletPath</span><span class="o">&gt;</span><span class="w"> </span><span class="n">dispatcherServletPath</span><span class="p">,</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">ObjectProvider</span><span class="o">&lt;</span><span class="n">ServletRegistrationBean</span><span class="o">&lt;?&gt;&gt;</span><span class="w"> </span><span class="n">servletRegistrations</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">this</span><span class="p">.</span><span class="na">mvcProperties</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mvcProperties</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">this</span><span class="p">.</span><span class="na">messageConvertersProvider</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">messageConvertersProvider</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">this</span><span class="p">.</span><span class="na">resourceHandlerRegistrationCustomizer</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">resourceHandlerRegistrationCustomizerProvider</span><span class="p">.</span><span class="na">getIfAvailable</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">this</span><span class="p">.</span><span class="na">dispatcherServletPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dispatcherServletPath</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">this</span><span class="p">.</span><span class="na">servletRegistrations</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">servletRegistrations</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">this</span><span class="p">.</span><span class="na">mvcProperties</span><span class="p">.</span><span class="na">checkConfiguration</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">         * c、自动注册Converter类型转换器
</span></span></span><span class="line"><span class="cl"><span class="cm">         */</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configureMessageConverters</span><span class="p">(</span><span class="n">List</span><span class="o">&lt;</span><span class="n">HttpMessageConverter</span><span class="o">&lt;?&gt;&gt;</span><span class="w"> </span><span class="n">converters</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">this</span><span class="p">.</span><span class="na">messageConvertersProvider</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="p">.</span><span class="na">ifAvailable</span><span class="p">((</span><span class="n">customConverters</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">converters</span><span class="p">.</span><span class="na">addAll</span><span class="p">(</span><span class="n">customConverters</span><span class="p">.</span><span class="na">getConverters</span><span class="p">()));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configureAsyncSupport</span><span class="p">(</span><span class="n">AsyncSupportConfigurer</span><span class="w"> </span><span class="n">configurer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="p">.</span><span class="na">containsBean</span><span class="p">(</span><span class="n">TaskExecutionAutoConfiguration</span><span class="p">.</span><span class="na">APPLICATION_TASK_EXECUTOR_BEAN_NAME</span><span class="p">))</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">Object</span><span class="w"> </span><span class="n">taskExecutor</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">						</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">TaskExecutionAutoConfiguration</span><span class="p">.</span><span class="na">APPLICATION_TASK_EXECUTOR_BEAN_NAME</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">taskExecutor</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">AsyncTaskExecutor</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">configurer</span><span class="p">.</span><span class="na">setTaskExecutor</span><span class="p">(((</span><span class="n">AsyncTaskExecutor</span><span class="p">)</span><span class="w"> </span><span class="n">taskExecutor</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">Duration</span><span class="w"> </span><span class="n">timeout</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">mvcProperties</span><span class="p">.</span><span class="na">getAsync</span><span class="p">().</span><span class="na">getRequestTimeout</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">timeout</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">configurer</span><span class="p">.</span><span class="na">setDefaultTimeout</span><span class="p">(</span><span class="n">timeout</span><span class="p">.</span><span class="na">toMillis</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configurePathMatch</span><span class="p">(</span><span class="n">PathMatchConfigurer</span><span class="w"> </span><span class="n">configurer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">mvcProperties</span><span class="p">.</span><span class="na">getPathmatch</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="p">.</span><span class="na">getMatchingStrategy</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">WebMvcProperties</span><span class="p">.</span><span class="na">MatchingStrategy</span><span class="p">.</span><span class="na">PATH_PATTERN_PARSER</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">configurer</span><span class="p">.</span><span class="na">setPatternParser</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">PathPatternParser</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">configurer</span><span class="p">.</span><span class="na">setUseSuffixPatternMatch</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">mvcProperties</span><span class="p">.</span><span class="na">getPathmatch</span><span class="p">().</span><span class="na">isUseSuffixPattern</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">configurer</span><span class="p">.</span><span class="na">setUseRegisteredSuffixPatternMatch</span><span class="p">(</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="k">this</span><span class="p">.</span><span class="na">mvcProperties</span><span class="p">.</span><span class="na">getPathmatch</span><span class="p">().</span><span class="na">isUseRegisteredSuffixPattern</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">this</span><span class="p">.</span><span class="na">dispatcherServletPath</span><span class="p">.</span><span class="na">ifAvailable</span><span class="p">((</span><span class="n">dispatcherPath</span><span class="p">)</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">String</span><span class="w"> </span><span class="n">servletUrlMapping</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dispatcherPath</span><span class="p">.</span><span class="na">getServletUrlMapping</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">servletUrlMapping</span><span class="p">.</span><span class="na">equals</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">)</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">singleDispatcherServlet</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">UrlPathHelper</span><span class="w"> </span><span class="n">urlPathHelper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">UrlPathHelper</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">urlPathHelper</span><span class="p">.</span><span class="na">setAlwaysUseFullPath</span><span class="p">(</span><span class="kc">true</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="n">configurer</span><span class="p">.</span><span class="na">setUrlPathHelper</span><span class="p">(</span><span class="n">urlPathHelper</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">});</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">private</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">singleDispatcherServlet</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">servletRegistrations</span><span class="p">.</span><span class="na">stream</span><span class="p">().</span><span class="na">map</span><span class="p">(</span><span class="n">ServletRegistrationBean</span><span class="p">::</span><span class="n">getServlet</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="p">.</span><span class="na">filter</span><span class="p">(</span><span class="n">DispatcherServlet</span><span class="p">.</span><span class="na">class</span><span class="p">::</span><span class="n">isInstance</span><span class="p">).</span><span class="na">count</span><span class="p">()</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="n">1</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">configureContentNegotiation</span><span class="p">(</span><span class="n">ContentNegotiationConfigurer</span><span class="w"> </span><span class="n">configurer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">WebMvcProperties</span><span class="p">.</span><span class="na">Contentnegotiation</span><span class="w"> </span><span class="n">contentnegotiation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">mvcProperties</span><span class="p">.</span><span class="na">getContentnegotiation</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">configurer</span><span class="p">.</span><span class="na">favorPathExtension</span><span class="p">(</span><span class="n">contentnegotiation</span><span class="p">.</span><span class="na">isFavorPathExtension</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">configurer</span><span class="p">.</span><span class="na">favorParameter</span><span class="p">(</span><span class="n">contentnegotiation</span><span class="p">.</span><span class="na">isFavorParameter</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">contentnegotiation</span><span class="p">.</span><span class="na">getParameterName</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">configurer</span><span class="p">.</span><span class="na">parameterName</span><span class="p">(</span><span class="n">contentnegotiation</span><span class="p">.</span><span class="na">getParameterName</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="p">,</span><span class="w"> </span><span class="n">MediaType</span><span class="o">&gt;</span><span class="w"> </span><span class="n">mediaTypes</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">mvcProperties</span><span class="p">.</span><span class="na">getContentnegotiation</span><span class="p">().</span><span class="na">getMediaTypes</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">mediaTypes</span><span class="p">.</span><span class="na">forEach</span><span class="p">(</span><span class="n">configurer</span><span class="p">::</span><span class="n">mediaType</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@Bean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@ConditionalOnMissingBean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="n">InternalResourceViewResolver</span><span class="w"> </span><span class="nf">defaultViewResolver</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">InternalResourceViewResolver</span><span class="w"> </span><span class="n">resolver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">InternalResourceViewResolver</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">resolver</span><span class="p">.</span><span class="na">setPrefix</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">mvcProperties</span><span class="p">.</span><span class="na">getView</span><span class="p">().</span><span class="na">getPrefix</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">resolver</span><span class="p">.</span><span class="na">setSuffix</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">mvcProperties</span><span class="p">.</span><span class="na">getView</span><span class="p">().</span><span class="na">getSuffix</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">resolver</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@Bean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@ConditionalOnBean</span><span class="p">(</span><span class="n">View</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@ConditionalOnMissingBean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="n">BeanNameViewResolver</span><span class="w"> </span><span class="nf">beanNameViewResolver</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">BeanNameViewResolver</span><span class="w"> </span><span class="n">resolver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">BeanNameViewResolver</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">resolver</span><span class="p">.</span><span class="na">setOrder</span><span class="p">(</span><span class="n">Ordered</span><span class="p">.</span><span class="na">LOWEST_PRECEDENCE</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">10</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">resolver</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@Bean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@ConditionalOnBean</span><span class="p">(</span><span class="n">ViewResolver</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@ConditionalOnMissingBean</span><span class="p">(</span><span class="n">name</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&#34;viewResolver&#34;</span><span class="p">,</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">ContentNegotiatingViewResolver</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="n">ContentNegotiatingViewResolver</span><span class="w"> </span><span class="nf">viewResolver</span><span class="p">(</span><span class="n">BeanFactory</span><span class="w"> </span><span class="n">beanFactory</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">ContentNegotiatingViewResolver</span><span class="w"> </span><span class="n">resolver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ContentNegotiatingViewResolver</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">resolver</span><span class="p">.</span><span class="na">setContentNegotiationManager</span><span class="p">(</span><span class="n">beanFactory</span><span class="p">.</span><span class="na">getBean</span><span class="p">(</span><span class="n">ContentNegotiationManager</span><span class="p">.</span><span class="na">class</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">// ContentNegotiatingViewResolver uses all the other view resolvers to locate</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="c1">// a view so it should have a high precedence</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">resolver</span><span class="p">.</span><span class="na">setOrder</span><span class="p">(</span><span class="n">Ordered</span><span class="p">.</span><span class="na">HIGHEST_PRECEDENCE</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">resolver</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="c1">//e、自动注册消息代码提示处理器MessageCodesResolver</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="n">MessageCodesResolver</span><span class="w"> </span><span class="nf">getMessageCodesResolver</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">mvcProperties</span><span class="p">.</span><span class="na">getMessageCodesResolverFormat</span><span class="p">()</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">DefaultMessageCodesResolver</span><span class="w"> </span><span class="n">resolver</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">DefaultMessageCodesResolver</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">resolver</span><span class="p">.</span><span class="na">setMessageCodeFormatter</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="na">mvcProperties</span><span class="p">.</span><span class="na">getMessageCodesResolverFormat</span><span class="p">());</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">return</span><span class="w"> </span><span class="n">resolver</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="c1">//获取所有的格式化器和转换器</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addFormatters</span><span class="p">(</span><span class="n">FormatterRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">ApplicationConversionService</span><span class="p">.</span><span class="na">addBeans</span><span class="p">(</span><span class="n">registry</span><span class="p">,</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">beanFactory</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">---------------------------------------------------------</span><span class="w">  
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//EnableWebMvcConfiguration内部类：</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="c1">// c、自动注册Formatter格式化器；</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nd">@Bean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="n">FormattingConversionService</span><span class="w"> </span><span class="nf">mvcConversionService</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">Format</span><span class="w"> </span><span class="n">format</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">mvcProperties</span><span class="p">.</span><span class="na">getFormat</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">WebConversionService</span><span class="w"> </span><span class="n">conversionService</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">WebConversionService</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">DateTimeFormatters</span><span class="p">()</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="p">.</span><span class="na">dateFormat</span><span class="p">(</span><span class="n">format</span><span class="p">.</span><span class="na">getDate</span><span class="p">()).</span><span class="na">timeFormat</span><span class="p">(</span><span class="n">format</span><span class="p">.</span><span class="na">getTime</span><span class="p">()).</span><span class="na">dateTimeFormat</span><span class="p">(</span><span class="n">format</span><span class="p">.</span><span class="na">getDateTime</span><span class="p">()));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">addFormatters</span><span class="p">(</span><span class="n">conversionService</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="n">conversionService</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="c1">//f、支持静态首页index.html访问</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="kd">private</span><span class="w"> </span><span class="n">Resource</span><span class="w"> </span><span class="nf">getWelcomePage</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">location</span><span class="w"> </span><span class="p">:</span><span class="w"> </span><span class="k">this</span><span class="p">.</span><span class="na">resourceProperties</span><span class="p">.</span><span class="na">getStaticLocations</span><span class="p">())</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="n">Resource</span><span class="w"> </span><span class="n">indexHtml</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getIndexHtml</span><span class="p">(</span><span class="n">location</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">indexHtml</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">					</span><span class="k">return</span><span class="w"> </span><span class="n">indexHtml</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="n">ServletContext</span><span class="w"> </span><span class="n">servletContext</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">getServletContext</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">servletContext</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">				</span><span class="k">return</span><span class="w"> </span><span class="n">getIndexHtml</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ServletContextResource</span><span class="p">(</span><span class="n">servletContext</span><span class="p">,</span><span class="w"> </span><span class="n">SERVLET_LOCATION</span><span class="p">));</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="kc">null</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">-------------------------------------------------------</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@Bean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@ConditionalOnMissingBean</span><span class="p">({</span><span class="w"> </span><span class="n">RequestContextListener</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">RequestContextFilter</span><span class="p">.</span><span class="na">class</span><span class="w"> </span><span class="p">})</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="nd">@ConditionalOnMissingFilterBean</span><span class="p">(</span><span class="n">RequestContextFilter</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">RequestContextFilter</span><span class="w"> </span><span class="nf">requestContextFilter</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">			</span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">OrderedRequestContextFilter</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">		</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="n">a</span><span class="err">、</span><span class="n">自动配置视图解析器ViewResolver</span><span class="err">（</span><span class="n">ContentNegotiatingViewResolver</span><span class="w"> </span><span class="n">和</span><span class="w"> </span><span class="n">BeanNameViewResolver</span><span class="err">）</span><span class="p">,</span><span class="n">作用</span><span class="err">：</span><span class="n">根据方法返回值得到视图对象</span><span class="err">，</span><span class="n">由视图对象决定请求转发或者重定向到指定视图</span><span class="err">。（</span><span class="n">注意</span><span class="err">：</span><span class="n">此处会创建获取容器中的所有视图解析器</span><span class="err">，</span><span class="n">包括自定义的视图解析器</span><span class="err">）</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">b</span><span class="err">、</span><span class="n">提供静态资源访问路径和webjars访问路径</span><span class="err">；</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">c</span><span class="err">、</span><span class="n">自动注册Converter类型转换器</span><span class="p">,</span><span class="n">Formatter格式化器</span><span class="err">；</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">d</span><span class="err">、</span><span class="n">提供HttpMessageConverters</span><span class="err">，</span><span class="n">用于Http请求和响应之间的转换</span><span class="err">，</span><span class="n">将json或者xml格式字符串和java类型之间做转换</span><span class="err">；</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="err">（</span><span class="n">注意</span><span class="err">：</span><span class="n">如果要自定义类型转换器</span><span class="err">，</span><span class="n">也可以通过该接口注册</span><span class="err">）</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Configuration</span><span class="p">(</span><span class="n">proxyBeanMethods</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyConfiguration</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Bean</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">HttpMessageConverters</span><span class="w"> </span><span class="nf">customConverters</span><span class="p">()</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">HttpMessageConverter</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">additional</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">HttpMessageConverter</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">another</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">...</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">HttpMessageConverters</span><span class="p">(</span><span class="n">additional</span><span class="p">,</span><span class="w"> </span><span class="n">another</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">e</span><span class="err">、</span><span class="n">自动注册消息代码提示处理器MessageCodesResolver</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">f</span><span class="err">、</span><span class="n">支持静态首页index</span><span class="p">.</span><span class="na">html访问</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">g</span><span class="err">、</span><span class="n">自动注册web数据参数绑定对象ConfigurableWebBindingInitializer</span><span class="err">，</span><span class="n">如果我们自己注册了该类型对象</span><span class="err">，</span><span class="n">那springboot会自动调用我们注册的对象</span><span class="err">，</span><span class="n">替换默认对象将请求参数绑定到javabean</span><span class="err">（</span><span class="n">了解</span><span class="err">）。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">h</span><span class="err">、</span><span class="n">如果要自定义拦截器interceptors</span><span class="err">，</span><span class="n">格式化器formatters</span><span class="err">，</span><span class="n">视图控制器view</span><span class="w"> </span><span class="n">controllers等</span><span class="err">，</span><span class="n">可以通过创建类型为WebMvcConfigurer的配置类来实现</span><span class="err">，</span><span class="n">不要加注解</span><span class="nd">@EnableWebMvc</span><span class="err">。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">i</span><span class="err">、</span><span class="n">如果要自定义处理器映射器RequestMappingHandlerMapping</span><span class="p">,</span><span class="w"> </span><span class="n">处理器适配器RequestMappingHandlerAdapter</span><span class="p">,</span><span class="w"> </span><span class="n">或者异常处理器ExceptionHandlerExceptionResolver</span><span class="err">，</span><span class="n">可以在容器中创建类型为WebMvcRegistrations的组件对象来实现</span><span class="err">。</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">j</span><span class="err">、</span><span class="n">如果想要完全使用自定义配置</span><span class="err">，</span><span class="n">不使用springboot默认配置</span><span class="err">，</span><span class="n">可以在配置类上加注解</span><span class="nd">@EnableWebMvc</span><span class="err">。（</span><span class="n">不推荐</span><span class="err">）</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">参考官方文档</span><span class="err">：</span><span class="n">https</span><span class="p">:</span><span class="c1">//docs.spring.io/spring-boot/docs/2.4.3/reference/html/spring-boot-features.html#boot-features-spring-mvc</span><span class="w">
</span></span></span></code></pre></div><h5 id="4小结">（4）小结</h5>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">a、SpringBoot启动会加载大量的自动配置类 
</span></span><span class="line"><span class="cl">b、根据配置文件和xxxProperties的默认设置初始化自动配置类中的组件
</span></span><span class="line"><span class="cl">c、可以在自动配置类中查看我们需要的功能是否已经自动配置，如果配置，我们就不用再做配置了；
</span></span></code></pre></div><h4 id="2自定义配置实现访问拦截">2、自定义配置实现访问拦截</h4>
<h4 id="1自定义拦截器">（1）自定义拦截器</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyIntercepter</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">HandlerInterceptor</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="nf">preHandle</span><span class="p">(</span><span class="n">HttpServletRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">HttpServletResponse</span><span class="w"> </span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">handler</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">HttpSession</span><span class="w"> </span><span class="n">session</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">request</span><span class="p">.</span><span class="na">getSession</span><span class="p">();</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">String</span><span class="w"> </span><span class="n">username</span><span class="o">=</span><span class="p">(</span><span class="n">String</span><span class="p">)</span><span class="n">session</span><span class="p">.</span><span class="na">getAttribute</span><span class="p">(</span><span class="s">&#34;username&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="k">if</span><span class="p">(</span><span class="n">username</span><span class="o">!=</span><span class="kc">null</span><span class="p">){</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;登录成功不拦截&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">true</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="k">else</span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">request</span><span class="p">.</span><span class="na">getRequestDispatcher</span><span class="p">(</span><span class="s">&#34;/index.html&#34;</span><span class="p">).</span><span class="na">forward</span><span class="p">(</span><span class="n">request</span><span class="p">,</span><span class="n">response</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&#34;未登录拦截&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="k">return</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">postHandle</span><span class="p">(</span><span class="n">HttpServletRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">HttpServletResponse</span><span class="w"> </span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">handler</span><span class="p">,</span><span class="w"> </span><span class="n">ModelAndView</span><span class="w"> </span><span class="n">modelAndView</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">afterCompletion</span><span class="p">(</span><span class="n">HttpServletRequest</span><span class="w"> </span><span class="n">request</span><span class="p">,</span><span class="w"> </span><span class="n">HttpServletResponse</span><span class="w"> </span><span class="n">response</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">handler</span><span class="p">,</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="n">ex</span><span class="p">)</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Exception</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="2注册拦截器">（2）注册拦截器</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyConfig</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">WebMvcConfigurer</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">   
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addInterceptors</span><span class="p">(</span><span class="n">InterceptorRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">addInterceptor</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">MyIntercepter</span><span class="p">()).</span><span class="na">addPathPatterns</span><span class="p">(</span><span class="s">&#34;/**&#34;</span><span class="p">).</span><span class="na">excludePathPatterns</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span><span class="s">&#34;/index.html&#34;</span><span class="p">,</span><span class="s">&#34;/user/login&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="3自定义配置视图控制器">3、自定义配置视图控制器</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//springboot默认不支持jsp，而是使用模板引擎thymeleaf作为视图</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//引入thymeleaf</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">&lt;</span><span class="n">dependency</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">&lt;</span><span class="n">groupId</span><span class="o">&gt;</span><span class="n">org</span><span class="p">.</span><span class="na">springframework</span><span class="p">.</span><span class="na">boot</span><span class="o">&lt;/</span><span class="n">groupId</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="o">&lt;</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="n">spring</span><span class="o">-</span><span class="n">boot</span><span class="o">-</span><span class="n">starter</span><span class="o">-</span><span class="n">thymeleaf</span><span class="o">&lt;/</span><span class="n">artifactId</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="o">&lt;/</span><span class="n">dependency</span><span class="o">&gt;</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="c1">//配置视图控制器</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nd">@Configuration</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyConfig</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">WebMvcConfigurer</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addInterceptors</span><span class="p">(</span><span class="n">InterceptorRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">addInterceptor</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">MyIntercepter</span><span class="p">()).</span><span class="na">addPathPatterns</span><span class="p">(</span><span class="s">&#34;/**&#34;</span><span class="p">).</span><span class="na">excludePathPatterns</span><span class="p">(</span><span class="s">&#34;/&#34;</span><span class="p">,</span><span class="s">&#34;/index.html&#34;</span><span class="p">,</span><span class="s">&#34;/user/login&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">	</span><span class="c1">//配置视图控制器</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nd">@Override</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addViewControllers</span><span class="p">(</span><span class="n">ViewControllerRegistry</span><span class="w"> </span><span class="n">registry</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="n">registry</span><span class="p">.</span><span class="na">addViewController</span><span class="p">(</span><span class="s">&#34;/main&#34;</span><span class="p">).</span><span class="na">setViewName</span><span class="p">(</span><span class="s">&#34;main&#34;</span><span class="p">);</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="p">}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="p">}</span><span class="w">
</span></span></span></code></pre></div><h4 id="4学员练习自动配置拦截器">4、学员练习自动配置拦截器</h4>

            </div>
            <hr>
            <div style="text-align: center;">
                <button class="btn"><a href="https://lovemjh.github.io/posts/tool/20220526164948/">← Redis</a></button>
                <button class="btn"><a href="https://lovemjh.github.io/posts/java-frame/20220526213257/">Spring-Boot-2 →</a></button>
            </div>

            
        </article><div class="aside_content" id="aside_content">
    <div class="card-widget card-info">
        <div class="card-content">
            <div class="card-info-avatar is-center">
                <img class="avatar-img" src="http://q1.qlogo.cn/g?b=qq&nk=2409741052&s=640" alt="avatar">
                <div class="author-info__name">青山</div>
                <div class="author-info__description">悟已往之不谏 知来者之可追</div>
            </div>
            
            <div class="card-info-social-icons is-center">
                <a class="social-icon" href="https://github.com/xioyito" target="_blank">
                    <i class="fa fa-github"></i>
                </a>
            </div>
            

        </div>
    </div>


    <div class="card-widget">
        <div class="card-content">
            <meting-js auto="https://music.163.com/?from=itab#/playlist?id=8181838897.html">
            </meting-js>
        </div>
    </div>

    <div class="card-widget">
        <div class="card-content">
            <div class="item-headline">
                <i class="fa fa-bullhorn" aria-hidden="true"></i>
                <span>一言</span>
            </div>
            <div id="hitokoto"></div>
        </div>
    </div>
    <div class="card-widget">
        <div class="card-content">
            <div class="item-headline">
                <i class="fa fa-calendar" aria-hidden="true"></i>
                <span>今日诗词</span>
            </div>
            <div id="jinrishici-sentence"></div>
        </div>
    </div>

    <div class="card-widget">
        <div class="card-content">
            <div class="item-headline">
                <i class="fa fa-line-chart" aria-hidden="true"></i>
                <span>站点信息</span>
            </div>
            <div class="webinfo">
                <div class="webinfo-item">
                    <div class="webinfo-site-uv-name">本站访客数 :</div>
                    <div class="webinfo-site-uv-count" id="busuanzi_value_site_uv"></div>
                </div>
                <div class="webinfo-item">
                    <div class="webinfo-site-name">本站总访问量 :</div>
                    <div class="webinfo-site-pv-count" id="busuanzi_value_site_pv"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="card-widget js-toc-w" id="js-toc-w">
        <div class="card-content js-toc">
            
        </div>
    </div>
    
</div></div>
</main>
<footer id="footer">
    <div id="footer-wrap">
        <div class="copyright">&copy;2019 - 2021 BY QING SHAN KE</div>
    </div>
</footer>
</div>

<div class="fan" id="fan" style="
position: fixed;
width: 40px;
height: 120px;
right: -200px;
bottom: 0px;
transition: all 0.5s;
z-index: 99999;
 ">
    <i class="fa fa-cog fa-spin fa-2x"></i><br>
    <i class="fa fa-align-justify fa-2x" id="ff"></i><br>
    <i class="fa fa fa-arrow-up fa-2x" id="aa"></i><br>
</div>


<script src="https://fastly.jsdelivr.net/npm/tocbot@4.21.1/dist/tocbot.min.js"></script>
<script src="https://fastly.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>


  
  <script src="https://fastly.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script> 

    <script type="text/javascript">
            $(function () {
                $(document).pjax('a', '#page', {
                    fragment: '#page',
                    timeout: 5000,
                    cache: false
                });
                $(document).on({
                    'pjax:click': function () {
                        
                        console.log("点击链接");
                    },
                    'pjax:start': function () {
                        
                        console.log("获取请求");
                    },
                    'pjax:end': function () {
                        
                        console.log("请求完成");
                        addNumbers();

                }
            });
        });

    </script>

    <script>
        function addNumbers() {
            
            
            var myElement = document.getElementById('js-toc-w');
            if (window.location.href.includes('/posts/')) {
                
                console.log('地址栏中包含 "/posts/"');
                tocbot.refresh();
                myElement.style.display = 'block';
            } else {
                
                initpageimg();
                console.log('地址栏中不包含 "/posts/"');
                myElement.style.display = 'none';
            }

        }
        function initpageimg() {
            const imgArr = [
                "https://pic1.zhimg.com/80/v2-23d671bf74a246c54b1256bd2322d461_720w.webp?source=1940ef5c",
                "https://pic1.zhimg.com/80/v2-3afad658b44f596b10ec13b2b6d4299d_720w.webp?source=1940ef5c",
                "https://picx.zhimg.com/80/v2-b83d637fafb72fd13a5922aa0038bff9_720w.webp?source=1940ef5c",
                "https://pic1.zhimg.com/80/v2-3afad658b44f596b10ec13b2b6d4299d_720w.webp?source=1940ef5c",
                "https://pic1.zhimg.com/80/v2-7ee6f104979814d2bf420461e3872475_720w.webp?source=1940ef5c",
                "https://picx.zhimg.com/80/v2-585754b4ab4d49f480b833cbbbf4839f_720w.webp?source=1940ef5c",
                "https://pic1.zhimg.com/80/v2-b3d8f74192b2940a1112c93797cc0815_720w.webp?source=1940ef5c",
            ];
            var objs = document.getElementsByClassName('page-img');
            for (var i = 0; i < objs.length; i++) {
                objs[i].id = "myid" + i;
                let randNum = Math.floor(Math.random() * imgArr.length);
                var odiv = document.getElementById("myid" + i);
                odiv.style.backgroundImage = `url(${imgArr[randNum]})`;
                
                odiv.style.backgroundRepeat = "no-repeat";
                odiv.style.backgroundPosition = "0px 0px";
            }
        }
    </script>

<script>
    var a = 0;
    ff.onclick = function () {
        if (a === 0) {
            $(".js-toc-w").css("position", "fixed"); 
            $(".js-toc-w").css("bottom", "10px");
            $(".js-toc-w").css("right", "40px");

            a++;
        } else {
            $(".js-toc-w").css("position", "static");
            a--;
        }
    }

    aa.onclick = function () {
        window.scrollTo({     
            top: 0,            
            behavior: "smooth"   
        })
    }

    
    window.onload = function () {
        $(".aplayer").css("background", "rgba(0, 0, 0, 0)");
        
        addNumbers();
        
    } 
</script>
<script>
    $(window).scroll(function () {
        var scrollY = document.documentElement.scrollTop || document.body.scrollTop
        if (scrollY > 40) {
            $('.fan').css("right", "0px");
        } else {
            $('.fan').css("right", "-220px");
        }
        if (scrollY > 600) {
            $(".js-toc-w").css("position", "fixed");
            $('.js-toc-w').css("right", "0px");
            $(".js-toc-w").css("bottom", "10px");
            $(".js-toc-w").css("right", "40px");
        } else {
            $(".js-toc-w").css("position", "fixed");
            $('.js-toc-w').css("right", "-220px");
        }
    });
    $(function () {
        
        var start_height = $(document).scrollTop();
        
        var navigation_height = $('.navigation').outerHeight();
        $(window).scroll(function () {
            
            var end_height = $(document).scrollTop();
            
            if (end_height > navigation_height) {
                $('.navigation').addClass('hide');
            } else {
                $('.navigation').removeClass('hide');
            }
            
            if (end_height < start_height) {
                $('.navigation').removeClass('hide');
            }
            
            start_height = $(document).scrollTop();
        });
    });
</script>

<script src="https://fastly.jsdelivr.net/npm/jquery.fancybox@2.1.5/source/jquery.fancybox.js"></script>

<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="https://fastly.jsdelivr.net/npm/instant.page@3.0.0/instantpage.js" type="module"></script>

<script src="https://fastly.jsdelivr.net/npm/lazysizes@5.2.0/lazysizes.min.js" async></script>


<link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://fastly.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>

<script src="https://fastly.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
<script>
  
  var meting_api='https://api.injahow.cn/meting/?server=:server&type=:type&id=:id&auth=:auth&r=:r';
</script>

<script src="https://fastly.jsdelivr.net/npm/nplayer@1.0.15/dist/index.min.js"></script>


<script src="https://v1.hitokoto.cn/?encode=js&select=%23hitokoto" defer></script>
<script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>





<script src="https://fastly.jsdelivr.net/gh/TRHX/CDN-for-itrhx.com@3.0.8/js/maodian.js"></script>



<script type="text/javascript">
    
    tocbot.init({
    
    tocSelector: '.js-toc',
    
    contentSelector: '.js-toc-content',
    
    headingSelector: 'h1, h2, h3, h4, h5 ,h6',
    
    hasInnerContainers: false,
    
    });
    console.clear();
    console.log("%c 有朋自远方来, 不亦说乎.", "background:#24272A; color:#ffffff", "");
    console.log("%c Github %c", "background:#24272A; color:#ffffff", "", "https://github.com/laoxuai");
    console.log("%c 版本号: %c", "background:#24272A; color:#ffffff", "", "1.0.0");

    (function ($) {
        $.fn.snow = function (options) {
            var $flake = $('<div id="snowbox" />').css({ 'position': 'absolute', 'z-index': '9999', 'top': '-50px' }).html('&#10052;'),
                documentHeight = $(document).height(),
                documentWidth = $(document).width(),
                defaults = {
                    minSize: 10,
                    maxSize: 20,
                    newOn: 1000,
                    flakeColor: "#AFDAEF"  
                },
                options = $.extend({}, defaults, options);
            var interval = setInterval(function () {
                var startPositionLeft = Math.random() * documentWidth - 100,
                    startOpacity = 0.5 + Math.random(),
                    sizeFlake = options.minSize + Math.random() * options.maxSize,
                    endPositionTop = documentHeight - 200,
                    endPositionLeft = startPositionLeft - 500 + Math.random() * 500,
                    durationFall = documentHeight * 10 + Math.random() * 5000;
                $flake.clone().appendTo('body').css({
                    left: startPositionLeft,
                    opacity: startOpacity,
                    'font-size': sizeFlake,
                    color: options.flakeColor
                }).animate({
                    top: endPositionTop,
                    left: endPositionLeft,
                    opacity: 0.2
                }, durationFall, 'linear', function () {
                    $(this).remove()
                });
            }, options.newOn);
        };
    })(jQuery);
    $(function () {
        $.fn.snow({
            minSize: 5,  
            maxSize: 50, 
            newOn: 800   
        });
    });

    
    var OriginTitle = document.title;
    var titleTime;
    document.addEventListener('visibilitychange', function () {
        if (document.hidden) {
            
            document.title = '╭(°A°`)╮ 页面崩溃啦 ~';
            clearTimeout(titleTime);
        }
        else {
            $('[rel="icon"]').attr('href', "/favicon.ico");
            document.title = '(ฅ>ω<*ฅ) 噫又好啦 ~' + OriginTitle;
            titleTime = setTimeout(function () {
                document.title = OriginTitle;
            }, 2000);
        }
    });
</script></body>
</html>