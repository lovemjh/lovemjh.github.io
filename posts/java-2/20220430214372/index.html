<!DOCTYPE html>
<html><head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=no">
  <meta name="description" content="MJH Blog & MEET HTML Theme">
  <title>多线程</title>
  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery.fancybox@2.1.5/source/jquery.fancybox.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.4/tocbot.css">
  
  <link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-webfont@1.1.0/lxgwwenkai-regular.css" />
  <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/styles/agate.min.css">
  <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/11.6.0/highlight.min.js"></script>
  <script>
    hljs.highlightAll();
  </script>
  
  <link rel="stylesheet" href="https://unpkg.com/animate.css@3.5.2/animate.min.css">
  <script type="text/javascript">
    if (!!window.ActiveXObject || "ActiveXObject" in window) { 
      alert('朋友，上古浏览器不支持呢~');
    }
  </script>

  <style>
    .sidebar {
      z-index: 998;
      position: fixed;
      left: -200px;
      width: 200px;
      height: 100%;
      background: #ffffff;
      transition: all .5s ease;
    }

    .sidebar .top {
      font-size: 22px;
      color: rgb(0, 0, 0);
      text-align: center;
      height: 60px;
      line-height: 60px;
      background-color: rgb(255, 255, 255);
      user-select: none;

    }

    .sidebar ul {
      list-style: none;
    }

    .sidebar ul a {
      display: block;
      height: 100%;
      width: 100%;
      text-align: center;
      line-height: 45px;
      font-size: 18px;
      color: rgb(0, 0, 0);
      box-sizing: border-box;
      border-top: 1px solid rgb(255, 0, 0);
      border-bottom: 1px solid rgb(0, 17, 255);
      transition: .4s;
    }

    .sidebar ul li:hover a {
      padding-left: 30px;
      color: #7c4242;
      border-left: 5px solid #ffffff;
      transition: all 0.5s;
    }

    .sidebar ul a i {
      margin-right: 16px;
    }

    #check {
      display: none;
    }

    label #btn,
    label #cancel {
      position: fixed;
      cursor: pointer;
      background-color: #000000;
      border-radius: 3px;
    }

    label #btn {
      left: 5px;
      top: 7px;
      font-size: 25px;
      color: #fff;
      padding: 6px 10px;
      transition: all .5s;
      z-index: 999;
    }

    label #cancel {
      z-index: 999;
      left: -145px;
      top: 10px;
      font-size: 25px;
      color: rgb(255, 255, 255);
      padding: 4px 9px;
      transition: all .5s ease;
    }

    #check:checked~.sidebar {
      left: 0;
    }

    #check:checked~label #btn {
      left: 10px;
      opacity: 0;
      pointer-events: none;
    }

    #check:checked~label #cancel {
      left: 150px;
    }







     
    ::-webkit-scrollbar {
      width: 8px;
      height: 6px
    }

     
    ::-webkit-scrollbar-track {
      background-color: transparent;
      -webkit-border-radius: 2em;
      -moz-border-radius: 2em;
      border-radius: 2em
    }

     
    ::-webkit-scrollbar-thumb {
      background-color: #30B07F;
      background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, .4) 100%, transparent 100%, transparent 50%, rgba(255, 255, 255, .4) 50%, rgba(255, 255, 255, .4) 75%, transparent 75%, transparent);
      -webkit-border-radius: 2em;
      -moz-border-radius: 2em;
      border-radius: 2em
    }






     
    .navigation {
      width: 100%;
      height: 50px;
       
      position: fixed;
      left: 0;
      top: 0;
      text-align: center;
      transition: top 0.5s;
      z-index: 999;

      background: rgba(255, 255, 255, .4) !important;
      -webkit-backdrop-filter: saturate(180%) blur(20px);
      backdrop-filter: saturate(180%) blur(20px) !important;
    }

     
    .hide {
      top: -60px;
    }



     
    .btn {
      width: 120px;
      height: 40px;
      background: linear-gradient(315deg, #a4d8fa 0%, #5eb1e9 74%);
      border: none;
      border-radius: 10px;
      font-family: 'Lato', sans-serif;
      font-weight: 500;
      font-size: smaller;
      color: #fff;
      box-shadow: inset 2px 2px 2px 0px rgba(255, 255, 255, .5),
        7px 7px 20px 0px rgba(0, 0, 0, .1),
        4px 4px 5px 0px rgba(0, 0, 0, .1);
      outline: none;
      position: relative;
      z-index: 0;
    }

    .btn::before {
      position: absolute;
      content: '';
      left: 0;
      bottom: 0;
      width: 100%;
      height: 0;
      transition: all 0.3s ease;
      border-radius: 10px;
      background: linear-gradient(315deg, #4dccc6 0%, #96e4df 74%);
      z-index: -1;
    }

    .btn:hover::before {
      top: 0;
      height: 100%;
    }

    .btn:active {
      top: 2px;
    }




     
     

     
    * {
      font-family: LXGW WenKai
    }

    * {
      font-weight: bold
    }

    body {
      font-family: LXGW WenKai;
    }




     
    .pagination {
      display: flex;
      flex-flow: row nowrap;
      justify-content: center;
      align-items: center;
      height: 50px;
      margin: 0px;
    }

    .pagination a {
      text-decoration: none;
      font-size: 22px;
      color: rgb(0, 0, 0);
    }

    .page-item {
      display: inline;
      margin-right: 20px;
    }

    #Background_animation { 
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    }

  </style>

</head>
    <body style="background-color: rgb(229, 204, 15);">
    
<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" viewBox="0 0 100 100" id="Background_animation">
  <defs>
      <style>
          @keyframes rotate {
              100% {
                  transform: rotate(360deg);
              }
          }
          .out-top {
              animation: rotate 20s linear infinite;
              transform-origin: 13px 25px;
          }
          .in-top {
              animation: rotate 10s linear infinite;
              transform-origin: 13px 25px;
          }
          .out-bottom {
              animation: rotate 25s linear infinite;
              transform-origin: 84px 93px;
          }
          .in-bottom {
              animation: rotate 15s linear infinite;
              transform-origin: 84px 93px;
          }
      </style>
  </defs>
  <path fill="#9b5de5" class="out-top" d="M37-5C25.1-14.7,5.7-19.1-9.2-10-28.5,1.8-32.7,31.1-19.8,49c15.5,21.5,52.6,22,67.2,2.3C59.4,35,53.7,8.5,37-5Z"/>
  <path fill="#f15bb5" class="in-top" d="M20.6,4.1C11.6,1.5-1.9,2.5-8,11.2-16.3,23.1-8.2,45.6,7.4,50S42.1,38.9,41,24.5C40.2,14.1,29.4,6.6,20.6,4.1Z"/>
  <path fill="#00bbf9" class="out-bottom" d="M105.9,48.6c-12.4-8.2-29.3-4.8-39.4.8-23.4,12.8-37.7,51.9-19.1,74.1s63.9,15.3,76-5.6c7.6-13.3,1.8-31.1-2.3-43.8C117.6,63.3,114.7,54.3,105.9,48.6Z"/>
  <path fill="#00f5d4" class="in-bottom" d="M102,67.1c-9.6-6.1-22-3.1-29.5,2-15.4,10.7-19.6,37.5-7.6,47.8s35.9,3.9,44.5-12.5C115.5,92.6,113.9,74.6,102,67.1Z"/>
</svg>

  <input type="checkbox" id="check">
<label for="check">
  <i class="fa fa-bars" id="btn"></i>
  <i class="fa fa-times" id="cancel"></i>
</label>
<div class="sidebar">
  <div class="top">Hi~</div>
  <ul>
    
    <li class="lii">
      <a href="/">
        <div class="burger-item">
          <i class='fa fa-home'></i> 主页
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/posts">
        <div class="burger-item">
          <i class='fa fa-archive'></i> 文章
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/categories">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> 分类
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/archive">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> 归档
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/tags">
        <div class="burger-item">
          <i class='fa fa-tags'></i> 标签
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/about">
        <div class="burger-item">
          <i class='fa fa-info-circle'></i> 关于
        </div>
      </a>
    </li>
    
  </ul>
</div><nav class="navigation">
  <ul class="ull">
    
    <li class="lii">
      <a href="/">
        <div class="burger-item">
          <i class='fa fa-home'></i> 主页
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/posts">
        <div class="burger-item">
          <i class='fa fa-archive'></i> 文章
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/categories">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> 分类
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/archive">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> 归档
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/tags">
        <div class="burger-item">
          <i class='fa fa-tags'></i> 标签
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/about">
        <div class="burger-item">
          <i class='fa fa-info-circle'></i> 关于
        </div>
      </a>
    </li>
    
  </ul>
</nav>
<div id="body-wrap">
  
  <div style="width: 100%; height: 65vh;">
    <div id="page_site-info">
      <div id="site-title">
        <input type="checkbox" id="check">
        <br>
        <span class="blogtitle"></span>
        
        
        <div class="post-header">
          <span>
            
            <i class="fa fa-calendar"></i>
            2021-11-04&nbsp;
          </span>
          <span>
            
            <i class="fa fa-calendar-check-o"></i>
            2021-11-04&nbsp;&nbsp;&nbsp;
          </span>
          <span>
            
            <i class="fa fa-edit"></i>
            7768 字
          </span>&nbsp;
          <span>
            
            <i class="fa fa-paper-plane"></i>
            16 分钟
          </span>
        </div><div class="container-ctgtag">
	<div class="taxonomy" style="display: flex; justify-content: center;">
		
		<div class="ctg" style="display: flex; justify-content: center; margin-right: 20px;">
			
			<div style="margin-right: 10px;">
				
				<a href="/categories/"></a>
			</div>
			
		</div>
		<div class="tag" style="display: flex; justify-content: center;">
			
			<div style="margin-right: 10px;">
				
				<a href="/tags/"></a></i>
			</div>
			
		</div>
	</div>
</div>

        <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11"></script>
        <script>
          var typed = new Typed(".blogtitle", {
            strings: ['多线程'],
            startDelay: 300,
            typeSpeed: 100,
            loop: true,
            backSpeed: 50,
            showCursor: true
          });
        </script>
      </div>
    </div>
  </div>
  
<main id="content-outer">
    <div class="layout_page" id="content-inner">
        <article id="page" style="margin-right: 10px;">
            
            <div class="js-toc-content" style="height: 100%;">
                <h1 id="多线程">多线程</h1>
<h2 id="概念">概念</h2>
<p>三个概念：</p>
<p>① 程序：软件。数据与指令的集合。</p>
<p>② 进程：正在执行的程序。</p>
<p>③ 线程：进程中的多条执行路径。</p>
<p>两个概念：</p>
<p>① 并发：在某一个时间段内，都有执行。</p>
<p>② 并行：在同一时刻，同时执行。
<img src="/posts/Java-2/20220430214372/image-20220430221016704.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="多线程的好处">多线程的好处：</h2>
<p>提高了程序的执行效率。</p>
<p>线程也不能无限开启，必须要有度。</p>
<h2 id="创建线程的方式">创建线程的方式</h2>
<p>① 继承 Thread</p>
<p>② 实现 Runnable</p>
<p>③ 实现 Callable</p>
<h3 id="线程创建方式一">线程创建方式一</h3>
<p>继承：</p>
<p>Thread类：</p>
<p>java提供的线程类，运行线程并发执行。</p>
<p>一种方法是将类声明为 Thread 的子类。该子类应重写 Thread 类的 run 方法</p>
<p>需要调用start方法开启线程</p>
<h4 id="代码">代码</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">线程创建方式一</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">AThread</span>  <span class="n">at</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AThread</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">at</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">1000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;main+==&#34;</span><span class="o">+</span><span class="n">i</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">AThread</span> <span class="kd">extends</span> <span class="n">Thread</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span><span class="n">1000</span> <span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;AThread=================&#34;</span><span class="o">+</span><span class="n">i</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">};</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>线程执行的调度机制</p>
<p>抢占式执行。cpu的时间片</p>
<p>线程的执行结果是未知的。</p>
<p>线程的执行原理
<img src="/posts/Java-2/20220430214372/image-20220524203212280.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="线程创建的方式二">线程创建的方式二</h3>
<p>实现Runnable</p>
<p>实现接口中的run方法。</p>
<p>在创建对象时，需要通过start方法才能开启线程。</p>
<p>Thread(Runnable target) 该构造可以把Runnable接口对象转换成线程。进而调用start方法。</p>
<p>注意：继承和实现两种形式在实际开发中，使用？</p>
<p>继承的特点：单继承 多重继承</p>
<p>实现的特点：多继承 多重继承 多实现。</p>
<p>现实开发中，使用接口的实现的形式较多，该方式比继承更灵活。</p>
<h4 id="代码-1">代码</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> 实现Runnable
</span></span></span><span class="line"><span class="cl"><span class="cm"> 实现接口中的run方法。
</span></span></span><span class="line"><span class="cl"><span class="cm"> 在创建对象时，需要通过start方法才能开启线程。
</span></span></span><span class="line"><span class="cl"><span class="cm"> Thread(Runnable target) 该构造可以把Runnable接口对象转换成线程。进而调用start方法。
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">线程创建方式二</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ARunnable</span> <span class="n">ar</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ARunnable</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// ar --&gt;Thread
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Thread</span> <span class="n">at</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="n">ar</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">at</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">1000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;main+==&#34;</span><span class="o">+</span><span class="n">i</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">ARunnable</span> <span class="kd">implements</span>  <span class="n">Runnable</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span><span class="n">1000</span> <span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;ARunnable=================&#34;</span><span class="o">+</span><span class="n">i</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">};</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="线程创建的方式三">线程创建的方式三</h3>
<p>1.实现接口Callable：</p>
<p>需要线程返回线程的执行结果。</p>
<p>call()</p>
<p>由于Thread中没有直接接收Callable的参数的构造方法，可以通过FutureTask(Callable<V></p>
<p>callable)</p>
<p>进行线程对象的创建。</p>
<p>2.FutureTask常用方法：</p>
<p>get() 获取线程的执行结果</p>
<h4 id="代码-2">代码</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.concurrent.Callable</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.concurrent.ExecutionException</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.concurrent.FutureTask</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> 1.实现接口Callable：
</span></span></span><span class="line"><span class="cl"><span class="cm"> 需要线程返回线程的执行结果。
</span></span></span><span class="line"><span class="cl"><span class="cm"> call()
</span></span></span><span class="line"><span class="cl"><span class="cm"> 由于Thread中没有直接接收Callable的参数的构造方法，可以通过FutureTask(Callable&lt;V&gt; callable)
</span></span></span><span class="line"><span class="cl"><span class="cm"> 进行线程对象的创建。
</span></span></span><span class="line"><span class="cl"><span class="cm"> 2.FutureTask常用方法：
</span></span></span><span class="line"><span class="cl"><span class="cm"> get() 获取线程的执行结果
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">线程创建方式三</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">ExecutionException</span><span class="o">,</span> <span class="n">InterruptedException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ACallable</span> <span class="n">ab</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ACallable</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//转线程对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">FutureTask</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span> <span class="n">task</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FutureTask</span><span class="o">&lt;&gt;(</span><span class="n">ab</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Thread</span> <span class="n">at</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="n">task</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">at</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">task</span><span class="o">.</span><span class="na">get</span><span class="o">()+</span><span class="s">&#34;=======================================&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">200</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;main+==&#34;</span><span class="o">+</span><span class="n">i</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">ACallable</span> <span class="kd">implements</span> <span class="n">Callable</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">String</span> <span class="nf">call</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span><span class="n">100</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;======================Acallable&#34;</span><span class="o">+</span><span class="n">i</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="s">&#34;这是一个线程的执行结果&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="总结">总结</h2>
<p>线程创建：</p>
<p>① 继承Thread类</p>
<p>② 实现Runnable接口</p>
<p>③ 实现Callable接口</p>
<h2 id="线程执行的调度机制">线程执行的调度机制</h2>
<p>抢占式执行。cpu的时间片</p>
<p>线程的执行结果是未知的。</p>
<h2 id="线程的执行原理">线程的执行原理</h2>
<p><img src="/posts/Java-2/20220430214372/image-20220430221451229.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="线程的常见方法">线程的常见方法</h2>
<h3 id="thread">Thread</h3>
<p>线程 是程序中的执行线程。Java 虚拟机允许应用程序并发地运行多个执行线程。</p>
<h3 id="线程常见方法">线程常见方法</h3>
<p>1.常见方法：</p>
<p>① currentThread() 返回当前线程对象:不是线程体系的类，还想调用线程的方法时。</p>
<p>main方法 ：main线程 主线程</p>
<p>② getName() /setName(String name) 返回/设置当前线程名称</p>
<p>默认线程的名称：</p>
<p>Thread-index :index从0开始</p>
<p>③ getPriority()/setPriority(int newPriority)返回/设置线程的优先级。</p>
<p>(***) 线程的优先级：高优先级的执行要高于低优先级的。</p>
<p>1&gt;MAX_PRIORITY 最高优先级 10</p>
<p>2&gt;MIN_PRIORITY 最小优先级 1</p>
<p>3&gt;NORM_PRIORITY 默认优先级 5</p>
<h3 id="代码-3">代码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">   1.常见方法：
</span></span></span><span class="line"><span class="cl"><span class="cm">     ① currentThread() 返回当前线程对象:不是线程体系的类，还想调用线程的方法时。
</span></span></span><span class="line"><span class="cl"><span class="cm">      main方法 ：main线程 主线程
</span></span></span><span class="line"><span class="cl"><span class="cm">     ② getName() /setName(String name)  返回/设置当前线程名称
</span></span></span><span class="line"><span class="cl"><span class="cm">       默认线程的名称：
</span></span></span><span class="line"><span class="cl"><span class="cm">           Thread-index :index从0开始
</span></span></span><span class="line"><span class="cl"><span class="cm">     ③ getPriority()/setPriority(int newPriority)返回/设置线程的优先级。
</span></span></span><span class="line"><span class="cl"><span class="cm">      (***) 线程的优先级：高优先级的执行要高于低优先级的。
</span></span></span><span class="line"><span class="cl"><span class="cm">             1&gt;MAX_PRIORITY 最高优先级 10
</span></span></span><span class="line"><span class="cl"><span class="cm">             2&gt;MIN_PRIORITY 最小优先级  1
</span></span></span><span class="line"><span class="cl"><span class="cm">             3&gt;NORM_PRIORITY 默认优先级 5
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">线程常见方法</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">       <span class="cm">/* AThread at = new AThread();
</span></span></span><span class="line"><span class="cl"><span class="cm">        at.start();
</span></span></span><span class="line"><span class="cl"><span class="cm">        AThread at1 = new AThread();
</span></span></span><span class="line"><span class="cl"><span class="cm">        at1.start();*/</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getPriority</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">AThread</span> <span class="kd">extends</span>  <span class="n">Thread</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">getName</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="线程常见方法一">线程常见方法一</h2>
<p>1.interrupt()中断线程。标记线程是否是中断。</p>
<p>2.interrupted() 判断线程是否中断。</p>
<h3 id="代码-4">代码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">   1.interrupt()中断线程。标记线程是否是中断。
</span></span></span><span class="line"><span class="cl"><span class="cm">   2.interrupted() 判断线程是否中断。
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">线程常见方法一</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">BThread</span> <span class="n">bt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BThread</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">bt</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">BThread</span> <span class="kd">extends</span> <span class="n">Thread</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">100</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="o">(</span><span class="n">i</span>  <span class="o">==</span> <span class="n">5</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">                <span class="n">interrupt</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">i</span><span class="o">+</span><span class="s">&#34;===============&#34;</span><span class="o">+</span><span class="n">interrupted</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="线程常见方法二">线程常见方法二</h2>
<p>1.守护线程：setDaemon(boolean on)/isDaemon() 设置/判断是否为守护线程</p>
<p>注意： 参数为true表示是一个守护线程。</p>
<p>在线程开启之前设置为守护线程。</p>
<p>2.线程分类：</p>
<p>① 用户线程</p>
<p>② 守护线程： 为用户线程提供便捷服务的线程。用户线程一旦结束，守护线程也会随之结</p>
<p>束。</p>
<h3 id="代码-5">代码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">   1.守护线程：setDaemon(boolean on)/isDaemon() 设置/判断是否为守护线程
</span></span></span><span class="line"><span class="cl"><span class="cm">               注意： 参数为true表示是一个守护线程。
</span></span></span><span class="line"><span class="cl"><span class="cm">                    在线程开启之前设置为守护线程。
</span></span></span><span class="line"><span class="cl"><span class="cm">   2.线程分类：
</span></span></span><span class="line"><span class="cl"><span class="cm">      ① 用户线程
</span></span></span><span class="line"><span class="cl"><span class="cm">      ② 守护线程： 为用户线程提供便捷服务的线程。用户线程一旦结束，守护线程也会随之结束。
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">线程常见方法三</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">CThread</span> <span class="n">ct</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CThread</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//线程开启之前 设置
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">ct</span><span class="o">.</span><span class="na">setDaemon</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">ct</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span><span class="n">10</span> <span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;=============main&#34;</span><span class="o">+</span><span class="n">i</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">CThread</span> <span class="kd">extends</span>  <span class="n">Thread</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">1000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;====+CThread+==&#34;</span><span class="o">+</span><span class="n">i</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="线程常见方法三">线程常见方法三</h2>
<p>1.join()/join(ms) 等待线程的终止</p>
<p>注意： 线程开启之后调用。</p>
<p>相当于方法调用，调用run方法。</p>
<h3 id="代码-6">代码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">    1.join()/join(ms) 等待线程的终止
</span></span></span><span class="line"><span class="cl"><span class="cm">     注意： 线程开启之后调用。
</span></span></span><span class="line"><span class="cl"><span class="cm">           相当于方法调用，调用run方法。
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">线程常见方式四</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">         <span class="n">DThread</span> <span class="n">dt</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DThread</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">         <span class="n">dt</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">         <span class="n">dt</span><span class="o">.</span><span class="na">join</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">         <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">100</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;main+======================================&#34;</span><span class="o">+</span><span class="n">i</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">         <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">DThread</span> <span class="kd">extends</span> <span class="n">Thread</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">100</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;DThread +======&#34;</span><span class="o">+</span> <span class="n">i</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="线程常见方法四">线程常见方法四</h2>
<p>（***） 1.sleep(long millis) 休眠</p>
<p>（*）2.yield() 线程的让步，暂停当前线程的执行，转而执行其他线程</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.text.SimpleDateFormat</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.Date</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">   （***）  1.sleep(long millis) 休眠
</span></span></span><span class="line"><span class="cl"><span class="cm">       （*）2.yield() 线程的让步，暂停当前线程的执行，转而执行其他线程。
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">线程常见方法五</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="kd">throws</span> <span class="n">InterruptedException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="cm">/*for (int i = 0; i &lt; 100; i++) {
</span></span></span><span class="line"><span class="cl"><span class="cm">            System.out.println(i);
</span></span></span><span class="line"><span class="cl"><span class="cm">            Thread.sleep(100);
</span></span></span><span class="line"><span class="cl"><span class="cm">        }*/</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//打印时间
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>       <span class="cm">/* SimpleDateFormat sf = new SimpleDateFormat(&#34;yyyy/MM/dd HH:mm:ss&#34;);
</span></span></span><span class="line"><span class="cl"><span class="cm">        while (true){
</span></span></span><span class="line"><span class="cl"><span class="cm">            Date date = new Date();
</span></span></span><span class="line"><span class="cl"><span class="cm">            System.out.println(sf.format(date));
</span></span></span><span class="line"><span class="cl"><span class="cm">            Thread.sleep(1000);
</span></span></span><span class="line"><span class="cl"><span class="cm">        }*/</span>
</span></span><span class="line"><span class="cl"><span class="c1">//        System.out.println(Thread.currentThread().toString());
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="c1">//        yield()
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">MThread</span>  <span class="n">m</span> <span class="o">=</span> <span class="k">new</span> <span class="n">MThread</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">m</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">10000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;main+============================&#34;</span><span class="o">+</span><span class="n">i</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">MThread</span> <span class="kd">extends</span>  <span class="n">Thread</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">10000</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span><span class="o">(</span><span class="n">i</span><span class="o">%</span><span class="n">2</span> <span class="o">==</span> <span class="n">0</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">                <span class="n">yield</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;====&#34;</span><span class="o">+</span><span class="n">i</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="多线程的安全问题">多线程的安全问题</h2>
<h3 id="概述">概述</h3>
<p>（***）多线程的安全问题：当多个线程，共同操作多个共享数据时，由于多个线程的同时操作，导致</p>
<p>程序运行的结果与预期的结果不一致，该现象称为多线程的安全问题。</p>
<h3 id="解决">解决</h3>
<p>方式：</p>
<p>① 同步</p>
<p>② 线程的通信： wait() notify() notifyAll()</p>
<h3 id="同步">同步</h3>
<p>也称为加锁</p>
<p>关键字：synchronized</p>
<p>① 分类：</p>
<p>同步方法：</p>
<p>[权限修饰符] synchronized 返回值类型 方法名称(参数列表){}</p>
<p>同步代码块</p>
<p>synchronized(锁对象){</p>
<p>}</p>
<p>锁对象：可以是任意对象。</p>
<p>常见的锁对象：</p>
<p>① 对象锁： 对象</p>
<p>② this锁： this</p>
<p>③ 静态锁: 静态成员</p>
<p>④ 类锁: 类名/数据类型 .class</p>
<p><img src="/posts/Java-2/20220430214372/image-20220430221657658.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="代码-7">代码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">  1.多线程的安全问题：
</span></span></span><span class="line"><span class="cl"><span class="cm">      账户取款操作。
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">多线程的安全问题</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">BankAccount</span>  <span class="n">ba</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BankAccount</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">Thread</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="n">ba</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Thread</span> <span class="n">t1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="n">ba</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&#34;张三&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">t1</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&#34;李思&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">t1</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">class</span>  <span class="nc">BankAccount</span> <span class="kd">implements</span>  <span class="n">Runnable</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">balance</span> <span class="o">=</span> <span class="n">1000</span><span class="o">;</span><span class="c1">//余额
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Object</span> <span class="n">o</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="kd">static</span> <span class="n">Double</span> <span class="n">d</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Double</span><span class="o">(</span><span class="n">12</span><span class="o">.</span><span class="na">3</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="cm">/*synchronized*/</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//同步代码块 任意对象：锁对象:要求对所有的线程对象有效 ，共享。
</span></span></span><span class="line"><span class="cl"><span class="c1">//        synchronized (o) {//对象锁
</span></span></span><span class="line"><span class="cl"><span class="c1">//        synchronized (this) {//this锁
</span></span></span><span class="line"><span class="cl"><span class="c1">//        synchronized (d) {//静态锁：静态成员
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">synchronized</span> <span class="o">(</span><span class="n">BankAccount</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span><span class="c1">//类锁
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">if</span><span class="o">(</span><span class="n">balance</span><span class="o">&gt;</span><span class="n">0</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">                <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="n">balance</span> <span class="o">-=</span><span class="n">1000</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()+</span><span class="s">&#34;取款后，金额为:&#34;</span><span class="o">+</span> <span class="n">balance</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span><span class="k">else</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()+</span><span class="s">&#34;余额不足&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="继承关系下的同步方式">继承关系下的同步方式</h2>
<h3 id="多线程的安全问题-1">多线程的安全问题</h3>
<p>1.解决多线程的安全问题：同步</p>
<p>2.同步注意事项：</p>
<p>又叫加锁：</p>
<p>1》同步方法</p>
<p>2》同步代码块</p>
<p>3.同步的前提：</p>
<p>① 必须存在多线程的安全问题</p>
<p>② 同步时，锁必须是唯一的，共享的，所有线程共享同一把锁。</p>
<p>4.同步方法：</p>
<p>静态方法 ：相当于 同步代码块中的类锁</p>
<p>[权限修饰符] static synchronized 返回值类型 方法名称(参数列表){}</p>
<p>非静态方法： 相当于 同步代码块中的this</p>
<p>[权限修饰符] synchronized 返回值类型 方法名称(参数列表){}</p>
<p>注意：</p>
<p>一般不建议 synchronized 加载run方法上。</p>
<p>5.同步代码块：</p>
<p>锁对象：</p>
<p>① this锁</p>
<p>② 任意对象</p>
<p>③ 类锁: .class</p>
<p>④ 静态锁：静态对象</p>
<h3 id="代码-8">代码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">  1.多线程？ 安全问题？：
</span></span></span><span class="line"><span class="cl"><span class="cm">    ① 多个线程
</span></span></span><span class="line"><span class="cl"><span class="cm">    ② 共享数据
</span></span></span><span class="line"><span class="cl"><span class="cm">    ③ 共同访问共享数据
</span></span></span><span class="line"><span class="cl"><span class="cm">  2.同步 又叫加锁：
</span></span></span><span class="line"><span class="cl"><span class="cm">     ① 保证有多线程的安全问题
</span></span></span><span class="line"><span class="cl"><span class="cm">     ② 保证锁唯一，所有线程对象共享同一把锁。
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">多线程的安全问题继承方式</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">BankAccount</span> <span class="n">ba</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BankAccount</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">BankAccount</span> <span class="n">ba1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BankAccount</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">ba</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&#34;张三&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">ba1</span><span class="o">.</span><span class="na">setName</span><span class="o">(</span><span class="s">&#34;李思&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">ba</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">ba1</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">class</span>  <span class="nc">BankAccount</span> <span class="kd">extends</span> <span class="n">Thread</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">   <span class="kd">static</span>  <span class="kt">double</span> <span class="n">balance</span> <span class="o">=</span> <span class="n">1000</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">   <span class="kd">static</span> <span class="n">Object</span> <span class="n">o</span> <span class="o">=</span>  <span class="k">new</span> <span class="n">Object</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span>  <span class="cm">/*synchronized */</span><span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl"><span class="c1">//        synchronized (BankAccount.class) {
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="kd">synchronized</span> <span class="o">(</span><span class="n">o</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">if</span> <span class="o">(</span><span class="n">balance</span><span class="o">&gt;</span><span class="n">0</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">                <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">10</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="n">balance</span> <span class="o">-=</span> <span class="n">1000</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">getName</span><span class="o">()</span> <span class="o">+</span> <span class="s">&#34;取款后，余额为:&#34;</span><span class="o">+</span><span class="n">balance</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span><span class="k">else</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">getName</span><span class="o">()+</span><span class="s">&#34;余额不足&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="cm">/*fun();
</span></span></span><span class="line"><span class="cl"><span class="cm">        System.out.println(&#34;==============&#34;);*/</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="cm">/*public static synchronized void fun(){
</span></span></span><span class="line"><span class="cl"><span class="cm">        if (balance&gt;0){
</span></span></span><span class="line"><span class="cl"><span class="cm">            try {
</span></span></span><span class="line"><span class="cl"><span class="cm">                Thread.sleep(10);
</span></span></span><span class="line"><span class="cl"><span class="cm">            } catch (InterruptedException e) {
</span></span></span><span class="line"><span class="cl"><span class="cm">                e.printStackTrace();
</span></span></span><span class="line"><span class="cl"><span class="cm">            }
</span></span></span><span class="line"><span class="cl"><span class="cm">            balance -= 1000;
</span></span></span><span class="line"><span class="cl"><span class="cm">            System.out.println(getName() + &#34;取款后，余额为:&#34;+balance);
</span></span></span><span class="line"><span class="cl"><span class="cm">        }else{
</span></span></span><span class="line"><span class="cl"><span class="cm">            System.out.println(getName()+&#34;余额不足&#34;);
</span></span></span><span class="line"><span class="cl"><span class="cm">        }
</span></span></span><span class="line"><span class="cl"><span class="cm">    }*/</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="lock锁">Lock锁</h2>
<h3 id="概念-1">概念</h3>
<p>Lock接口。</p>
<p>比使用 synchronized 方法和语句可获得的更广泛的锁定操作</p>
<p>创建对象：</p>
<p>使用的是子类ReentrantLock。</p>
<h3 id="常用方法">常用方法</h3>
<p>① lock ：获取锁</p>
<p>② unlock：释放锁</p>
<h3 id="代码-9">代码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.concurrent.locks.Lock</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.concurrent.locks.ReentrantLock</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">Lock锁</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">BA</span> <span class="n">ba</span> <span class="o">=</span> <span class="k">new</span> <span class="n">BA</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">Thread</span> <span class="n">t</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="n">ba</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Thread</span> <span class="n">t1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Thread</span><span class="o">(</span><span class="n">ba</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">t</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">t1</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">BA</span> <span class="kd">implements</span>  <span class="n">Runnable</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">Lock</span> <span class="n">lock</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ReentrantLock</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="kt">double</span> <span class="n">balance</span> <span class="o">=</span> <span class="n">1000</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//加锁
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">lock</span><span class="o">.</span><span class="na">lock</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">balance</span><span class="o">&gt;</span><span class="n">0</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">10</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="n">balance</span> <span class="o">-=</span> <span class="n">1000</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()+</span><span class="s">&#34;取款后，余额为:&#34;</span><span class="o">+</span><span class="n">balance</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span><span class="k">else</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()+</span><span class="s">&#34;余额不足！！！&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//释放锁
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">lock</span><span class="o">.</span><span class="na">unlock</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;==============&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="死锁">死锁</h2>
<h3 id="概念-2">概念</h3>
<p>DeadLock 死锁：</p>
<p>(***) 解决了多线程安全问题的同步线程，如果访问的是互斥的共享资源(互斥：多个共享资源，访问</p>
<p>顺序相反。)，由于互斥访问，造成的资源锁死现象，称为死锁。</p>
<h3 id="死锁现象">死锁现象</h3>
<p>哲学家餐桌问题：</p>
<h3 id="代码-10">代码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">死锁</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">AThread</span> <span class="n">at</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AThread</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">AThread</span> <span class="n">at1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">AThread</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">at</span><span class="o">.</span><span class="na">flag</span> <span class="o">=</span> <span class="kc">true</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">at</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">at1</span><span class="o">.</span><span class="na">start</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">AThread</span> <span class="kd">extends</span>  <span class="n">Thread</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">static</span> <span class="n">Object</span> <span class="n">o</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="kd">static</span> <span class="n">Object</span> <span class="n">o1</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Object</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="kt">boolean</span> <span class="n">flag</span> <span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">flag</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">            <span class="kd">synchronized</span> <span class="o">(</span><span class="n">o</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;执行了o......1&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">sleep</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="kd">synchronized</span> <span class="o">(</span><span class="n">o1</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;执行了o1....1&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span><span class="k">else</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="kd">synchronized</span> <span class="o">(</span><span class="n">o1</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;执行了o1......2&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">sleep</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">                <span class="kd">synchronized</span> <span class="o">(</span><span class="n">o</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;执行了o....2&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="查看死锁的工具">查看死锁的工具</h3>
<p>jstack 查看jvm的内存的运行状况。</p>
<p>格式：</p>
<p>jstack PID号</p>
<p><img src="/posts/Java-2/20220430214372/image-20220524203431915.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="生产者和消费者模式">生产者和消费者模式</h2>
<h3 id="解决线程安全问题的方式">解决线程安全问题的方式</h3>
<p>线程的通信：</p>
<p>可以实现多个线程之间的交互。
<img src="/posts/Java-2/20220430214372/image-20220430221737104.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="线程生命周期线程的状态">线程生命周期/线程的状态</h2>
<h3 id="线程的生命周期">线程的生命周期</h3>
<p>新建状态：创建对象</p>
<p>就绪状态：start方法被调用。</p>
<p>运行状态：抢到了cpu时间片</p>
<p>消亡状态： 执行完毕</p>
<p>阻塞状态：在运行过程中，遇到的 wait、join、sleep等。</p>
<p><img src="/posts/Java-2/20220430214372/image-20220430221742831.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="单例设计模式饿汉式懒汉式">单例设计模式（饿汉式/懒汉式）</h2>
<h3 id="设计模式">设计模式</h3>
<p>java中有常见23种设计模式： 模板设计模式</p>
<p>单例：一个类中就只有一个对象。</p>
<p>实例化：创建对象</p>
<h3 id="单例设计模式饿汉式">单例设计模式（饿汉式）</h3>
<p>步骤：</p>
<p>① 私有构造方法</p>
<p>② 在该类中声明一个属性，该属性的数据类型就是该类，修饰符用 private static修饰。</p>
<p>③ 提供一个public static的get方法，对外提供该对象。</p>
<h4 id="代码-11">代码</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">单例设计模式</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">       <span class="cm">/* A  a = new A();
</span></span></span><span class="line"><span class="cl"><span class="cm">        A  a1 = new A();
</span></span></span><span class="line"><span class="cl"><span class="cm">        A  a2 = new A();
</span></span></span><span class="line"><span class="cl"><span class="cm">        A  a3 = new A();
</span></span></span><span class="line"><span class="cl"><span class="cm">        SingleTon s = new SingleTon();*/</span>
</span></span><span class="line"><span class="cl">       <span class="n">SingleTon</span>  <span class="n">s</span> <span class="o">=</span> <span class="n">SingleTon</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">       <span class="n">SingleTon</span>  <span class="n">s1</span> <span class="o">=</span> <span class="n">SingleTon</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s</span> <span class="o">==</span> <span class="n">s1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">A</span><span class="o">{}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//饿汉式
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">class</span>  <span class="nc">SingleTon</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span>  <span class="nf">SingleTon</span><span class="o">(){}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="n">SingleTon</span> <span class="n">instance</span> <span class="o">=</span><span class="k">new</span> <span class="n">SingleTon</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="n">SingleTon</span> <span class="nf">getInstance</span> <span class="o">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">instance</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span>  <span class="kt">void</span> <span class="nf">fun</span><span class="o">(){}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="懒汉式">懒汉式</h3>
<p>1.由于饿汉式无论是否使用单例对象，都会创建该对象，为了进行改进，引入了懒汉式。</p>
<p>2.在实际开发中，使用饿汉式比懒汉式更多，</p>
<p>尽管饿汉式可能造成资源的浪费，但是懒汉式有线程安全问题的。</p>
<p>所以，考虑线程安全问题的前提下，使用饿汉式居多。如果要使用懒汉式，必须要进行线程安全问题的解决。加同步。</p>
<h4 id="代码-12">代码</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">  1.由于饿汉式无论是否使用单例对象，都会创建该对象，为了进行改进，引入了懒汉式。
</span></span></span><span class="line"><span class="cl"><span class="cm">  2.在实际开发中，使用饿汉式比懒汉式更多，
</span></span></span><span class="line"><span class="cl"><span class="cm">    尽管饿汉式可能造成资源的浪费，但是懒汉式有线程安全问题的。
</span></span></span><span class="line"><span class="cl"><span class="cm">   所以，考虑线程安全问题的前提下，使用饿汉式居多。如果要使用懒汉式，必须要进行线程安全问题的解决。加同步。
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">单例设计模式</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">SingleTon</span> <span class="n">s</span> <span class="o">=</span> <span class="n">SingleTon</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">SingleTon</span> <span class="n">s1</span> <span class="o">=</span> <span class="n">SingleTon</span><span class="o">.</span><span class="na">getInstance</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">s</span> <span class="o">==</span> <span class="n">s1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//懒汉式
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">class</span> <span class="nc">SingleTon</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="nf">SingleTon</span><span class="o">(){}</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="kd">static</span> <span class="n">SingleTon</span> <span class="n">instance</span> <span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="n">SingleTon</span> <span class="nf">getInstance</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">instance</span> <span class="o">==</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="kd">synchronized</span> <span class="o">(</span><span class="n">SingleTon</span><span class="o">.</span><span class="na">class</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span> <span class="o">(</span><span class="n">instance</span> <span class="o">==</span> <span class="kc">null</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">                    <span class="n">instance</span> <span class="o">=</span> <span class="k">new</span> <span class="n">SingleTon</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">instance</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="枚举">枚举</h2>
<h3 id="概念-3">概念</h3>
<p>1.枚举：有穷序列集。一一列举</p>
<p>2.案例：</p>
<p>性别： 数据类型 int 0 1 12</p>
<h3 id="细节">细节</h3>
<p>1.1.5jdk引入了枚举</p>
<p>2.关键字 ：enum 枚举类关键字 用法同class</p>
<p>3.枚举类第一行必须是该类对象的名称，多个之间用逗号隔开。</p>
<p>4.枚举类：本质： 类。</p>
<p>① 构造方法：有 并且是私有的。</p>
<p>② 属性：</p>
<p>③ 方法</p>
<p>④ 抽象方法</p>
<h3 id="代码-13">代码</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">   1.1.5jdk引入了枚举
</span></span></span><span class="line"><span class="cl"><span class="cm">   2.关键字 ：enum 枚举类关键字 用法同class
</span></span></span><span class="line"><span class="cl"><span class="cm">   3.枚举类第一行必须是该类对象的名称，多个之间用逗号隔开。
</span></span></span><span class="line"><span class="cl"><span class="cm">   4.枚举类：本质： 类。
</span></span></span><span class="line"><span class="cl"><span class="cm">       ① 构造方法：有 并且是私有的。
</span></span></span><span class="line"><span class="cl"><span class="cm">       ② 属性：
</span></span></span><span class="line"><span class="cl"><span class="cm">       ③ 方法
</span></span></span><span class="line"><span class="cl"><span class="cm">       ④ 抽象方法
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">枚举</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Student</span> <span class="n">st</span> <span class="o">=</span> <span class="k">new</span> <span class="n">Student</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="n">st</span><span class="o">.</span><span class="na">sex</span> <span class="o">=</span> <span class="n">Sex</span><span class="o">.</span><span class="na">MALE</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="n">st</span><span class="o">.</span><span class="na">sex</span> <span class="o">=</span> <span class="n">Sex</span><span class="o">.</span><span class="na">FEMALE</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//面向对象 对象.方法/属性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Sex</span><span class="o">.</span><span class="na">MALE</span><span class="o">.</span><span class="na">fun</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//红灯的行为
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Traffic</span><span class="o">.</span><span class="na">RED</span><span class="o">.</span><span class="na">action</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//绿灯的行为
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Traffic</span><span class="o">.</span><span class="na">GREEN</span><span class="o">.</span><span class="na">action</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="kd">class</span> <span class="nc">Student</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//性别
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Sex</span> <span class="n">sex</span> <span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="cm">/*
</span></span></span><span class="line"><span class="cl"><span class="cm">class Sex {
</span></span></span><span class="line"><span class="cl"><span class="cm">    //只有两个对象
</span></span></span><span class="line"><span class="cl"><span class="cm">private Sex(){}
</span></span></span><span class="line"><span class="cl"><span class="cm">private static Sex in = new Sex();
</span></span></span><span class="line"><span class="cl"><span class="cm">private static Sex in1 = new Sex();
</span></span></span><span class="line"><span class="cl"><span class="cm">        }*/</span>
</span></span><span class="line"><span class="cl"><span class="kd">enum</span> <span class="n">Sex</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">MALE</span><span class="o">,</span><span class="n">FEMALE</span><span class="o">;</span><span class="c1">//表示该类的对象，必须放在枚举类的第一行，直接写枚举类对象的名称，由于是static final一般全部大写。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kt">int</span> <span class="n">a</span><span class="o">;</span><span class="c1">//属性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">fun</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;这是Sex中的方法。。。&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//enum
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">enum</span> <span class="n">Traffic</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">RED</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;红灯停&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span> <span class="o">,</span><span class="n">YELLOW</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;黄灯等待&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">},</span><span class="n">GREEN</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">        <span class="kd">public</span> <span class="kt">void</span> <span class="nf">action</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;绿灯行&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">};</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">abstract</span>  <span class="kt">void</span> <span class="nf">action</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//四季
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="kd">enum</span> <span class="n">Season</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="n">SPRING</span><span class="o">(</span><span class="s">&#34;春季&#34;</span><span class="o">),</span><span class="n">SUMMER</span><span class="o">(</span><span class="s">&#34;夏季&#34;</span><span class="o">),</span> <span class="n">AUTUMN</span><span class="o">(</span><span class="s">&#34;秋季&#34;</span><span class="o">),</span><span class="n">WINTER</span><span class="o">(</span><span class="s">&#34;冬季&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">String</span> <span class="n">desc</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//构造方法注入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">private</span> <span class="nf">Season</span><span class="o">(</span><span class="n">String</span> <span class="n">desc</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="o">.</span><span class="na">desc</span> <span class="o">=</span> <span class="n">desc</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="c1">//    private Season(){}
</span></span></span><span class="line"><span class="cl"><span class="c1"></span><span class="o">}</span>
</span></span></code></pre></div><h2 id="线程的生命周期-1">线程的生命周期</h2>
<p>java中Thread类提供了6个状态</p>
<h3 id="概念-4">概念</h3>
<p>Thread.State</p>
<p>NEW</p>
<p>至今尚未启动的线程处于这种状态。</p>
<p>RUNNABLE</p>
<p>正在 Java 虚拟机中执行的线程处于这种状态。</p>
<p>BLOCKED</p>
<p>受阻塞并等待某个监视器锁的线程处于这种状态。</p>
<p>WAITING</p>
<p>无限期地等待另一个线程来执行某一特定操作的线程处于这种状态。</p>
<p>TIMED_WAITING</p>
<p>等待另一个线程来执行取决于指定等待时间的操作的线程处于这种状态。</p>
<p>TERMINATED</p>
<p>已退出的线程处于这种状态。</p>
<h2 id="线程池">线程池</h2>
<h3 id="概念-5">概念</h3>
<p><img src="/posts/Java-2/20220430214372/image-20220524203632871.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>线程池：是用来管理线程的&quot;池子&quot;.频繁的创建和销毁的线程，会增大内存的消耗，为了降低内存的消耗，使用线程池来管理和循环利用线程。</p>
<h3 id="java中提供的线程池">java中提供的线程池</h3>
<p>Executor 管理线程的接口</p>
<p>子接口：</p>
<p>ExecutorService</p>
<p>常用方法：</p>
<p>① submit(Runnable task) 提交线程</p>
<p>② shutdown() 执行之前提交的任务，并且关闭线程池</p>
<p>Executors：线程池的工厂类。</p>
<p>常用方法：</p>
<p>① newCachedThreadPool() 创建一个可根据需要创建新线程的线程池,池中的线程不够，就创</p>
<p>建。会导致线程过多，造成内存泄漏。</p>
<p>② newFixedThreadPool(int nThreads) 创建一个可重用固定线程数的线程池,线程池中线</p>
<p>程是固定的，如果任务数大于线程数，等待。如果线程任务执行长，等待时间就会过长。</p>
<p>代码</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.concurrent.*</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> ThreadPoolExecutor(int corePoolSize, int maximumPoolSize,
</span></span></span><span class="line"><span class="cl"><span class="cm"> long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue,
</span></span></span><span class="line"><span class="cl"><span class="cm"> ThreadFactory threadFactory, RejectedExecutionHandler handler)
</span></span></span><span class="line"><span class="cl"><span class="cm"> 参数：
</span></span></span><span class="line"><span class="cl"><span class="cm"> corePoolSize - 池中所保存的线程数，包括空闲线程。
</span></span></span><span class="line"><span class="cl"><span class="cm"> maximumPoolSize - 池中允许的最大线程数。
</span></span></span><span class="line"><span class="cl"><span class="cm"> keepAliveTime - 当线程数大于核心时，此为终止前多余的空闲线程等待新任务的最长时间。
</span></span></span><span class="line"><span class="cl"><span class="cm"> unit - keepAliveTime 参数的时间单位。
</span></span></span><span class="line"><span class="cl"><span class="cm"> workQueue - 执行前用于保持任务的队列。此队列仅保持由 execute 方法提交的 Runnable 任 务。
</span></span></span><span class="line"><span class="cl"><span class="cm">        ArrayBlockingQueue:由数组支持的有界任务队列。 ArrayBlockingQueue(int capacity)
</span></span></span><span class="line"><span class="cl"><span class="cm"> threadFactory - 执行程序创建新线程时使用的工厂。 Executors.defaultThreadFactory()
</span></span></span><span class="line"><span class="cl"><span class="cm"> handler - 由于超出线程范围和队列容量而使执行被阻塞时所使用的处理程序。
</span></span></span><span class="line"><span class="cl"><span class="cm"> 在默认的 ThreadPoolExecutor.AbortPolicy 中，处理程序遭到拒绝将抛出运行时 RejectedExecutionException。
</span></span></span><span class="line"><span class="cl"><span class="cm"> 在 ThreadPoolExecutor.CallerRunsPolicy 中，线程调用运行该任务的 execute 本 身。此策略提供简单的反馈控制机制，能够减缓新任务的提交速度。
</span></span></span><span class="line"><span class="cl"><span class="cm"> 在 ThreadPoolExecutor.DiscardPolicy 中，新的不能执行的任务将被删除。
</span></span></span><span class="line"><span class="cl"><span class="cm"> 在 ThreadPoolExecutor.DiscardOldestPolicy 中，如果执行程序尚未关闭，则位于 工作队列头部的任务将被删除，
</span></span></span><span class="line"><span class="cl"><span class="cm"> 然后重试执行程序（如果再次失败，则重复此过程）。
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ThreadPoolExecutor线程池</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">ThreadPoolExecutor</span> <span class="n">tp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ThreadPoolExecutor</span><span class="o">(</span><span class="n">3</span><span class="o">,</span> <span class="n">5</span><span class="o">,</span> <span class="n">1</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">                <span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">,</span> <span class="k">new</span> <span class="n">ArrayBlockingQueue</span><span class="o">&lt;&gt;(</span><span class="n">1</span><span class="o">),</span> <span class="n">Executors</span><span class="o">.</span><span class="na">defaultThreadFactory</span><span class="o">(),</span>
</span></span><span class="line"><span class="cl">                <span class="k">new</span> <span class="n">ThreadPoolExecutor</span><span class="o">.</span><span class="na">DiscardOldestPolicy</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">7</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="kt">int</span> <span class="n">finalI</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span><span class="c1">//1.8jdk之后，在内部类中使用时，加final或省略都是加的。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">tp</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">                <span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                        <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                    <span class="o">}</span>
</span></span><span class="line"><span class="cl">                    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()+</span><span class="s">&#34;======&gt;&#34;</span><span class="o">+</span> <span class="n">finalI</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="o">}</span>
</span></span><span class="line"><span class="cl">            <span class="o">});</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="threadpoolexecutor">ThreadPoolExecutor</h3>
<p>1.引入
ThreadPoolExecutor：可以解决线程的管理问题，由于newCachedThreadPool()在使用时，可能会</p>
<p>造成线程的过多，</p>
<p>newFixedThreadPool(int nThreads)创建的线程池，可能会造成等待时间过长，为了平衡这两种现</p>
<p>象，引入了</p>
<p>ThreadPoolExecutor。</p>
<p>2.创建对象</p>
<p>ThreadPoolExecutor(int corePoolSize, int maximumPoolSize,</p>
<p>long keepAliveTime, TimeUnit unit, BlockingQueue<Runnable> workQueue,</p>
<p>ThreadFactory threadFactory, RejectedExecutionHandler handler)</p>
<p>参数：</p>
<p>corePoolSize - 池中所保存的线程数，包括空闲线程。</p>
<p>maximumPoolSize - 池中允许的最大线程数。</p>
<p>keepAliveTime - 当线程数大于核心时，此为终止前多余的空闲线程等待新任务的最长时间。</p>
<p>unit - keepAliveTime 参数的时间单位。</p>
<p>workQueue - 执行前用于保持任务的队列。此队列仅保持由 execute 方法提交的 Runnable 任</p>
<p>务。</p>
<p>ArrayBlockingQueue:由数组支持的有界任务队列。 ArrayBlockingQueue(int</p>
<p>capacity)</p>
<p>threadFactory - 执行程序创建新线程时使用的工厂。 Executors.defaultThreadFactory()</p>
<p>handler - 由于超出线程范围和队列容量而使执行被阻塞时所使用的处理程序。</p>
<p>在默认的 ThreadPoolExecutor.AbortPolicy 中，处理程序遭到拒绝将抛出运行时</p>
<p>RejectedExecutionException。</p>
<p>在 ThreadPoolExecutor.CallerRunsPolicy 中，线程调用运行该任务的 execute 本 身。此策</p>
<p>略提供简单的反馈控制机制，能够减缓新任务的提交速度。</p>
<p>在 ThreadPoolExecutor.DiscardPolicy 中，新的不能执行的任务将被删除。</p>
<p>在 ThreadPoolExecutor.DiscardOldestPolicy 中，如果执行程序尚未关闭，则位于 工作队列</p>
<p>头部的任务将被删除，</p>
<p>然后重试执行程序（如果再次失败，则重复此过程）。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-Java" data-lang="Java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.demo</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">java.util.concurrent.*</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">ThreadPoolExecutor(int corePoolSize, int maximumPoolSize,
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">long keepAliveTime, TimeUnit unit, BlockingQueue&lt;Runnable&gt; workQueue,
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">ThreadFactory threadFactory, RejectedExecutionHandler handler)
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">参数：
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">corePoolSize - 池中所保存的线程数，包括空闲线程。
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">maximumPoolSize - 池中允许的最大线程数。
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">keepAliveTime - 当线程数大于核心时，此为终止前多余的空闲线程等待新任务的最长时间。
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">unit - keepAliveTime 参数的时间单位。
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">workQueue - 执行前用于保持任务的队列。此队列仅保持由 execute 方法提交的 Runnable 任
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">务。
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">ArrayBlockingQueue:由数组支持的有界任务队列。 ArrayBlockingQueue(int
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">capacity)
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">threadFactory - 执行程序创建新线程时使用的工厂。 Executors.defaultThreadFactory()
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">handler - 由于超出线程范围和队列容量而使执行被阻塞时所使用的处理程序。
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">在默认的 ThreadPoolExecutor.AbortPolicy 中，处理程序遭到拒绝将抛出运行时
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">RejectedExecutionException。
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">在 ThreadPoolExecutor.CallerRunsPolicy 中，线程调用运行该任务的 execute 本 身。此策
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">略提供简单的反馈控制机制，能够减缓新任务的提交速度。
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">在 ThreadPoolExecutor.DiscardPolicy 中，新的不能执行的任务将被删除。
</span></span></span><span class="line"><span class="cl"><span class="cm">在 ThreadPoolExecutor.DiscardOldestPolicy 中，如果执行程序尚未关闭，则位于 工作队列
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">头部的任务将被删除，
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">然后重试执行程序（如果再次失败，则重复此过程）。
</span></span></span><span class="line"><span class="cl"><span class="cm">
</span></span></span><span class="line"><span class="cl"><span class="cm">*/</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ThreadPoolExecutor线程池</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">ThreadPoolExecutor</span> <span class="n">tp</span> <span class="o">=</span> <span class="k">new</span> <span class="n">ThreadPoolExecutor</span><span class="o">(</span><span class="n">3</span><span class="o">,</span> <span class="n">5</span><span class="o">,</span> <span class="n">1</span><span class="o">,</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">TimeUnit</span><span class="o">.</span><span class="na">SECONDS</span><span class="o">,</span> <span class="k">new</span> <span class="n">ArrayBlockingQueue</span><span class="o">&lt;&gt;(</span><span class="n">1</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Executors</span><span class="o">.</span><span class="na">defaultThreadFactory</span><span class="o">(),</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">new</span> <span class="n">ThreadPoolExecutor</span><span class="o">.</span><span class="na">DiscardOldestPolicy</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="n">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">7</span><span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kt">int</span> <span class="n">finalI</span> <span class="o">=</span> <span class="n">i</span><span class="o">;</span><span class="c1">//1.8jdk之后，在内部类中使用时，加final或省略都是加的。
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl"><span class="n">tp</span><span class="o">.</span><span class="na">submit</span><span class="o">(</span><span class="k">new</span> <span class="n">Runnable</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">run</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">Thread</span><span class="o">.</span><span class="na">sleep</span><span class="o">(</span><span class="n">100</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">InterruptedException</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">Thread</span><span class="o">.</span><span class="na">currentThread</span><span class="o">().</span><span class="na">getName</span><span class="o">()+</span><span class="s">&#34;======&gt;&#34;</span><span class="o">+</span> <span class="n">finalI</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">});</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div>
            </div>
            <hr>
            <div style="text-align: center;">
                <button class="btn"><a href="https://lovemjh.github.io/posts/java-2/20220430214426/">← 网络编程</a></button>
                <button class="btn"><a href="https://lovemjh.github.io/posts/java-2/20220430214135/">I/O →</a></button>
            </div>

            
        </article><div class="aside_content" id="aside_content">
    <div class="card-widget card-info">
        <div class="card-content">
            <div class="card-info-avatar is-center">
                <img class="avatar-img" src="http://q1.qlogo.cn/g?b=qq&nk=2409741052&s=640" alt="avatar">
                <div class="author-info__name">青山</div>
                <div class="author-info__description">悟已往之不谏 知来者之可追</div>
            </div>
            
            <div class="card-info-social-icons is-center">
                <a class="social-icon" href="https://github.com/xioyito" target="_blank">
                    <i class="fa fa-github"></i>
                </a>
            </div>
            

        </div>
    </div>


    <div class="card-widget">
        <div class="card-content">
            <meting-js auto="https://y.qq.com/n/yqq/playlist/7713574197.html">
            </meting-js>
        </div>
    </div>

    <div class="card-widget">
        <div class="card-content">
            <div class="item-headline">
                <i class="fa fa-bullhorn" aria-hidden="true"></i>
                <span>一言</span>
            </div>
            <div id="hitokoto"></div>
        </div>
    </div>
    <div class="card-widget">
        <div class="card-content">
            <div class="item-headline">
                <i class="fa fa-calendar" aria-hidden="true"></i>
                <span>今日诗词</span>
            </div>
            <div id="jinrishici-sentence"></div>
        </div>
    </div>

    <div class="card-widget">
        <div class="card-content">
            <div class="item-headline">
                <i class="fa fa-line-chart" aria-hidden="true"></i>
                <span>站点信息</span>
            </div>
            <div class="webinfo">
                <div class="webinfo-item">
                    <div class="webinfo-site-uv-name">本站访客数 :</div>
                    <div class="webinfo-site-uv-count" id="busuanzi_value_site_uv"></div>
                </div>
                <div class="webinfo-item">
                    <div class="webinfo-site-name">本站总访问量 :</div>
                    <div class="webinfo-site-pv-count" id="busuanzi_value_site_pv"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="card-widget js-toc-w" id="js-toc-w">
        <div class="card-content js-toc">
            
        </div>
    </div>
    
</div></div>
</main>
<footer id="footer">
    <div id="footer-wrap">
        <div class="copyright">&copy;2019 - 2021 BY QING SHAN KE</div>
    </div>
</footer>
</div>

<div class="fan" id="fan" style="
position: fixed;
width: 40px;
height: 120px;
right: -200px;
bottom: 0px;
transition: all 0.5s;
z-index: 99999;
 ">
    <i class="fa fa-cog fa-spin fa-2x"></i><br>
    <i class="fa fa-align-justify fa-2x" id="ff"></i><br>
    <i class="fa fa fa-arrow-up fa-2x" id="aa"></i><br>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>


  
  <script src="/js/jquery.pjax.js"></script> 

    <script type="text/javascript">
            $(function () {
                $(document).pjax('a', '#page', {
                    fragment: '#page',
                    timeout: 5000,
                    cache: false
                });
                $(document).on({
                    'pjax:click': function () {
                        
                        console.log("点击链接");
                    },
                    'pjax:start': function () {
                        
                        console.log("获取请求");
                    },
                    'pjax:end': function () {
                        
                        console.log("请求完成");
                    }
                });
            });


        </script>





<script>
  const imgArr = [
    "https://pic1.zhimg.com/80/v2-23d671bf74a246c54b1256bd2322d461_720w.webp?source=1940ef5c",
    "https://pic1.zhimg.com/80/v2-3afad658b44f596b10ec13b2b6d4299d_720w.webp?source=1940ef5c",
    "https://picx.zhimg.com/80/v2-b83d637fafb72fd13a5922aa0038bff9_720w.webp?source=1940ef5c",
    "https://pic1.zhimg.com/80/v2-3afad658b44f596b10ec13b2b6d4299d_720w.webp?source=1940ef5c",
    "https://pic1.zhimg.com/80/v2-7ee6f104979814d2bf420461e3872475_720w.webp?source=1940ef5c",
    "https://picx.zhimg.com/80/v2-585754b4ab4d49f480b833cbbbf4839f_720w.webp?source=1940ef5c",
    "https://pic1.zhimg.com/80/v2-b3d8f74192b2940a1112c93797cc0815_720w.webp?source=1940ef5c",
  ];
  var objs = document.getElementsByClassName('page-img');
  for (var i = 0; i < objs.length; i++) {
    objs[i].id = "myid" + i;
    let randNum = Math.floor(Math.random() * imgArr.length);
    var odiv = document.getElementById("myid" + i);
    odiv.style.backgroundImage = `url(${imgArr[randNum]})`;
    
    odiv.style.backgroundRepeat = "no-repeat";
    odiv.style.backgroundPosition = "0px 0px";
  }
</script>

<script>
    var a = 0;
    ff.onclick = function () {
        if (a === 0) {
            $(".js-toc-w").css("position", "fixed"); 
            $(".js-toc-w").css("bottom", "10px");
            $(".js-toc-w").css("right", "40px");

            a++;
        } else {
            $(".js-toc-w").css("position", "static");
            a--;
        }
    }

    aa.onclick = function () {
        window.scrollTo({     
            top: 0,            
            behavior: "smooth"   
        })
    }

    
    window.onload = function () {
        $(".aplayer").css("background", "rgba(0, 0, 0, 0)");
        

        
    } 
</script>
<script>
    $(window).scroll(function () {
        var scrollY = document.documentElement.scrollTop || document.body.scrollTop
        console.log(scrollY + "----------------------")
        if (scrollY > 40) {
            $('.fan').css("right", "0px");
        } else {
            $('.fan').css("right", "-220px");
        }
    });
    $(function () {
        
        var start_height = $(document).scrollTop();
        
        var navigation_height = $('.navigation').outerHeight();
        $(window).scroll(function () {
            
            var end_height = $(document).scrollTop();
            
            if (end_height > navigation_height) {
                $('.navigation').addClass('hide');
            } else {
                $('.navigation').removeClass('hide');
            }
            
            if (end_height < start_height) {
                $('.navigation').removeClass('hide');
            }
            
            start_height = $(document).scrollTop();
        });
    });
</script>

<script src="https://cdn.jsdelivr.net/npm/jquery.fancybox@2.1.5/source/jquery.fancybox.js"></script>

<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="https://cdn.jsdelivr.net/npm/instant.page@3.0.0/instantpage.js" type="module"></script>

<script src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.0/lazysizes.min.js" async></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>


<script src="https://unpkg.com/nplayer@latest/dist/index.min.js"></script>


<script src="https://v1.hitokoto.cn/?encode=js&select=%23hitokoto" defer></script>
<script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>





<script src="https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itrhx.com@3.0.8/js/maodian.js"></script>


<script>
    tocbot.init({
        
        tocSelector: '.js-toc',
        
        contentSelector: '.js-toc-content',
        
        headingSelector: 'h1, h2, h3, h4, h5 ,h6',
        
        hasInnerContainers: false,
        
    });
</script>


<script type="text/javascript">
    console.clear();
    console.log("%c 有朋自远方来, 不亦说乎.", "background:#24272A; color:#ffffff", "");
    console.log("%c Github %c", "background:#24272A; color:#ffffff", "", "https://github.com/laoxuai");
    console.log("%c 版本号: %c", "background:#24272A; color:#ffffff", "", "1.0.0");

    (function ($) {
        $.fn.snow = function (options) {
            var $flake = $('<div id="snowbox" />').css({ 'position': 'absolute', 'z-index': '9999', 'top': '-50px' }).html('&#10052;'),
                documentHeight = $(document).height(),
                documentWidth = $(document).width(),
                defaults = {
                    minSize: 10,
                    maxSize: 20,
                    newOn: 1000,
                    flakeColor: "#AFDAEF"  
                },
                options = $.extend({}, defaults, options);
            var interval = setInterval(function () {
                var startPositionLeft = Math.random() * documentWidth - 100,
                    startOpacity = 0.5 + Math.random(),
                    sizeFlake = options.minSize + Math.random() * options.maxSize,
                    endPositionTop = documentHeight - 200,
                    endPositionLeft = startPositionLeft - 500 + Math.random() * 500,
                    durationFall = documentHeight * 10 + Math.random() * 5000;
                $flake.clone().appendTo('body').css({
                    left: startPositionLeft,
                    opacity: startOpacity,
                    'font-size': sizeFlake,
                    color: options.flakeColor
                }).animate({
                    top: endPositionTop,
                    left: endPositionLeft,
                    opacity: 0.2
                }, durationFall, 'linear', function () {
                    $(this).remove()
                });
            }, options.newOn);
        };
    })(jQuery);
    $(function () {
        $.fn.snow({
            minSize: 5,  
            maxSize: 50, 
            newOn: 800   
        });
    });

    
    var OriginTitle = document.title;
    var titleTime;
    document.addEventListener('visibilitychange', function () {
        if (document.hidden) {
            
            document.title = '╭(°A°`)╮ 页面崩溃啦 ~';
            clearTimeout(titleTime);
        }
        else {
            $('[rel="icon"]').attr('href', "/favicon.ico");
            document.title = '(ฅ>ω<*ฅ) 噫又好啦 ~' + OriginTitle;
            titleTime = setTimeout(function () {
                document.title = OriginTitle;
            }, 2000);
        }
    });
</script></body>
</html>