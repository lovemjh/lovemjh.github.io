<!DOCTYPE html>
<html><head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=no">
  <meta name="description" content="MJH Blog & MEET HTML Theme">
  <title>tk-题库项目开发2</title>
  <link rel="shortcut icon" type="image/x-icon" href="/images/favicon.ico">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/jquery.fancybox@2.1.5/source/jquery.fancybox.css">
  <link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/tocbot@4.21.1/dist/tocbot.min.css">
  
  <link rel="stylesheet" href="https://npm.elemecdn.com/lxgw-wenkai-webfont@1.1.0/lxgwwenkai-regular.css" />
  <link rel="stylesheet" href="https://fastly.jsdelivr.net/gh/highlightjs/cdn-release@11.8.0/build/styles/agate.min.css">
  <script src="https://fastly.jsdelivr.net/gh/highlightjs/cdn-release@11.8.0/build/highlight.min.js"></script>
  <script>
    hljs.highlightAll();
  </script>
  
  <link rel="stylesheet" href="https://unpkg.com/animate.css@3.5.2/animate.min.css">
  <script type="text/javascript">
    if (!!window.ActiveXObject || "ActiveXObject" in window) { 
      alert('朋友，上古浏览器不支持呢~');
    }
  </script>

  <style>
    .sidebar {
      z-index: 998;
      position: fixed;
      left: -200px;
      width: 200px;
      height: 100%;
      background: #ffffff;
      transition: all .5s ease;
    }

    .sidebar .top {
      font-size: 22px;
      color: rgb(0, 0, 0);
      text-align: center;
      height: 60px;
      line-height: 60px;
      background-color: rgb(255, 255, 255);
      user-select: none;

    }

    .sidebar ul {
      list-style: none;
    }

    .sidebar ul a {
      display: block;
      height: 100%;
      width: 100%;
      text-align: center;
      line-height: 45px;
      font-size: 18px;
      color: rgb(0, 0, 0);
      box-sizing: border-box;
      border-top: 1px solid rgb(255, 0, 0);
      border-bottom: 1px solid rgb(0, 17, 255);
      transition: .4s;
    }

    .sidebar ul li:hover a {
      padding-left: 30px;
      color: #7c4242;
      border-left: 5px solid #ffffff;
      transition: all 0.5s;
    }

    .sidebar ul a i {
      margin-right: 16px;
    }

    #check {
      display: none;
    }

    label #btn,
    label #cancel {
      position: fixed;
      cursor: pointer;
      background-color: #000000;
      border-radius: 3px;
    }

    label #btn {
      left: 5px;
      top: 7px;
      font-size: 25px;
      color: #fff;
      padding: 6px 10px;
      transition: all .5s;
      z-index: 999;
    }

    label #cancel {
      z-index: 999;
      left: -145px;
      top: 10px;
      font-size: 25px;
      color: rgb(255, 255, 255);
      padding: 4px 9px;
      transition: all .5s ease;
    }

    #check:checked~.sidebar {
      left: 0;
    }

    #check:checked~label #btn {
      left: 10px;
      opacity: 0;
      pointer-events: none;
    }

    #check:checked~label #cancel {
      left: 150px;
    }







     
    ::-webkit-scrollbar {
      width: 8px;
      height: 6px
    }

     
    ::-webkit-scrollbar-track {
      background-color: transparent;
      -webkit-border-radius: 2em;
      -moz-border-radius: 2em;
      border-radius: 2em
    }

     
    ::-webkit-scrollbar-thumb {
      background-color: #30B07F;
      background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, .4) 100%, transparent 100%, transparent 50%, rgba(255, 255, 255, .4) 50%, rgba(255, 255, 255, .4) 75%, transparent 75%, transparent);
      -webkit-border-radius: 2em;
      -moz-border-radius: 2em;
      border-radius: 2em
    }






     
    .navigation {
      width: 100%;
      height: 50px;
       
      position: fixed;
      left: 0;
      top: 0;
      text-align: center;
      transition: top 0.5s;
      z-index: 999;

      background: rgba(255, 255, 255, .4) !important;
      -webkit-backdrop-filter: saturate(180%) blur(20px);
      backdrop-filter: saturate(180%) blur(20px) !important;
    }

     
    .hide {
      top: -60px;
    }



     
    .btn {
      width: 120px;
      height: 40px;
      background: linear-gradient(315deg, #a4d8fa 0%, #5eb1e9 74%);
      border: none;
      border-radius: 10px;
      font-family: 'Lato', sans-serif;
      font-weight: 500;
      font-size: smaller;
      color: #fff;
      box-shadow: inset 2px 2px 2px 0px rgba(255, 255, 255, .5),
        7px 7px 20px 0px rgba(0, 0, 0, .1),
        4px 4px 5px 0px rgba(0, 0, 0, .1);
      outline: none;
      position: relative;
      z-index: 0;
    }

    .btn::before {
      position: absolute;
      content: '';
      left: 0;
      bottom: 0;
      width: 100%;
      height: 0;
      transition: all 0.3s ease;
      border-radius: 10px;
      background: linear-gradient(315deg, #4dccc6 0%, #96e4df 74%);
      z-index: -1;
    }

    .btn:hover::before {
      top: 0;
      height: 100%;
    }

    .btn:active {
      top: 2px;
    }




     
     

     
    * {
      font-family: LXGW WenKai
    }

    * {
      font-weight: bold
    }

    body {
      font-family: LXGW WenKai;
    }




     
    .pagination {
      display: flex;
      flex-flow: row nowrap;
      justify-content: center;
      align-items: center;
      height: 50px;
      margin: 0px;
    }

    .pagination a {
      text-decoration: none;
      font-size: 22px;
      color: rgb(0, 0, 0);
    }

    .page-item {
      display: inline;
      margin-right: 20px;
    }

    #Background_animation { 
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100vh;
    }

  </style>

</head>
    <body style="background-color: rgb(229, 204, 15);">
    
<svg xmlns="http://www.w3.org/2000/svg" preserveAspectRatio="xMidYMid slice" viewBox="0 0 100 100" id="Background_animation">
  <defs>
      <style>
          @keyframes rotate {
              100% {
                  transform: rotate(360deg);
              }
          }
          .out-top {
              animation: rotate 20s linear infinite;
              transform-origin: 13px 25px;
          }
          .in-top {
              animation: rotate 10s linear infinite;
              transform-origin: 13px 25px;
          }
          .out-bottom {
              animation: rotate 25s linear infinite;
              transform-origin: 84px 93px;
          }
          .in-bottom {
              animation: rotate 15s linear infinite;
              transform-origin: 84px 93px;
          }
      </style>
  </defs>
  <path fill="#9b5de5" class="out-top" d="M37-5C25.1-14.7,5.7-19.1-9.2-10-28.5,1.8-32.7,31.1-19.8,49c15.5,21.5,52.6,22,67.2,2.3C59.4,35,53.7,8.5,37-5Z"/>
  <path fill="#f15bb5" class="in-top" d="M20.6,4.1C11.6,1.5-1.9,2.5-8,11.2-16.3,23.1-8.2,45.6,7.4,50S42.1,38.9,41,24.5C40.2,14.1,29.4,6.6,20.6,4.1Z"/>
  <path fill="#00bbf9" class="out-bottom" d="M105.9,48.6c-12.4-8.2-29.3-4.8-39.4.8-23.4,12.8-37.7,51.9-19.1,74.1s63.9,15.3,76-5.6c7.6-13.3,1.8-31.1-2.3-43.8C117.6,63.3,114.7,54.3,105.9,48.6Z"/>
  <path fill="#00f5d4" class="in-bottom" d="M102,67.1c-9.6-6.1-22-3.1-29.5,2-15.4,10.7-19.6,37.5-7.6,47.8s35.9,3.9,44.5-12.5C115.5,92.6,113.9,74.6,102,67.1Z"/>
</svg>

  <input type="checkbox" id="check">
<label for="check">
  <i class="fa fa-bars" id="btn"></i>
  <i class="fa fa-times" id="cancel"></i>
</label>
<div class="sidebar">
  <div class="top">Hi~</div>
  <ul>
    
    <li class="lii">
      <a href="/">
        <div class="burger-item">
          <i class='fa fa-home'></i> 主页
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/posts">
        <div class="burger-item">
          <i class='fa fa-archive'></i> 文章
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/categories">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> 分类
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/archive">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> 归档
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/tags">
        <div class="burger-item">
          <i class='fa fa-tags'></i> 标签
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/about">
        <div class="burger-item">
          <i class='fa fa-info-circle'></i> 关于
        </div>
      </a>
    </li>
    
  </ul>
</div><nav class="navigation">
  <ul class="ull">
    
    <li class="lii">
      <a href="/">
        <div class="burger-item">
          <i class='fa fa-home'></i> 主页
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/posts">
        <div class="burger-item">
          <i class='fa fa-archive'></i> 文章
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/categories">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> 分类
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/archive">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> 归档
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/tags">
        <div class="burger-item">
          <i class='fa fa-tags'></i> 标签
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/about">
        <div class="burger-item">
          <i class='fa fa-info-circle'></i> 关于
        </div>
      </a>
    </li>
    
  </ul>
</nav>
<div id="body-wrap">
  
  <div style="width: 100%; height: 65vh;">
    <div id="page_site-info">
      <div id="site-title">
        <input type="checkbox" id="check">
        <br>
        <span class="blogtitle"></span>
        
        
        <div class="post-header">
          <span>
            
            <i class="fa fa-calendar"></i>
            2022-05-28&nbsp;
          </span>
          <span>
            
            <i class="fa fa-calendar-check-o"></i>
            2022-05-28&nbsp;&nbsp;&nbsp;
          </span>
          <span>
            
            <i class="fa fa-edit"></i>
            10700 字
          </span>&nbsp;
          <span>
            
            <i class="fa fa-paper-plane"></i>
            22 分钟
          </span>
        </div><div class="container-ctgtag">
	<div class="taxonomy" style="display: flex; justify-content: center;">
		
		<div class="ctg" style="display: flex; justify-content: center; margin-right: 20px;">
			
			<div style="margin-right: 10px;">
				
				<a href="/categories/"></a>
			</div>
			
		</div>
		<div class="tag" style="display: flex; justify-content: center;">
			
			<div style="margin-right: 10px;">
				
				<a href="/tags/"></a></i>
			</div>
			
		</div>
	</div>
</div>

        <script src="https://fastly.jsdelivr.net/npm/typed.js@2.0.16/dist/typed.umd.min.js"></script>
        <script>
          var typed = new Typed(".blogtitle", {
            strings: ['tk-题库项目开发2'],
            startDelay: 300,
            typeSpeed: 100,
            loop: true,
            backSpeed: 50,
            showCursor: true
          });
        </script>
      </div>
    </div>
  </div>
  
<main id="content-outer">
    <div class="layout_page" id="content-inner">
        <article id="page" style="margin-right: 10px;">
            
            <div class="js-toc-content" style="height: 100%;">
                <h1 align = "center">第四章</h1>
<h1 align = "center">优学题库项目开发2</h1>
<h3 align="center">优就业.JAVA教研室</h3>
<h2 id="学习目标">学习目标</h2>
<ul>
<li>了解启动开源管理前端框架</li>
<li>掌握开发配置题目分类服务及前端维护管理功能</li>
<li>掌握开发配置题目维护后端服务及前端维护管理功能</li>
<li>掌握完成题目导入、导出功能开发</li>
<li>掌握Echarts图表入门</li>
<li>掌握统计分析功能开发</li>
</ul>
<h1 id="1启动人人开源管理前端">1、启动人人开源管理前端</h1>
<h2 id="11确认本地已经安装好nodejs">1.1、确认本地已经安装好Node.js</h2>
<p>输入指令，确认：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">node -v
</span></span></code></pre></div><p><img src="/posts/project/20220528232959/image-20220528233009896.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>node.js安装教程</p>
<p><a class="link" href="/posts/project/https://www.runoob.com/nodejs/nodejs-install-setup.html"  target="_blank" rel="noopener"
    >https://www.runoob.com/nodejs/nodejs-install-setup.html</a></p>
<h2 id="12安装前端开发工具vscode">1.2、安装前端开发工具VSCode</h2>
<p><img src="/posts/project/20220528232959/image-20220528233017887.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>下载前端代码：</p>
<p>renren-fast-vue 管理后台前端
<a class="link" href="/posts/project/https://gitee.com/hk109/renren-fast-vue.git"  target="_blank" rel="noopener"
    >https://gitee.com/hk109/renren-fast-vue.git</a></p>
<h3 id="121-打开人人开源管理前端代码所在目录">1.2.1 打开人人开源管理前端代码所在目录</h3>
<p><img src="/posts/project/20220528232959/image-20220528233033976.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="122-选中人人开源前端代码的目录">1.2.2 选中人人开源前端代码的目录，</h3>
<p><img src="/posts/project/20220528232959/image-20220528233058907.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="123打开目录效果">1.2.3打开目录效果。</h3>
<p><img src="/posts/project/20220528232959/image-20220528233106977.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="124保存工作区">1.2.4保存工作区：</h3>
<p><img src="/posts/project/20220528232959/image-20220528233113631.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="125选中工作区保存位置">1.2.5选中工作区保存位置</h3>
<p><img src="/posts/project/20220528232959/image-20220528233120365.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="126-最终保存为工作区">1.2.6 最终保存为工作区</h3>
<p><img src="/posts/project/20220528232959/image-20220528233128283.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="127禁用eslint插件">1.2.7、禁用eslint插件</h3>
<p><img src="/posts/project/20220528232959/image-20220528233135147.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="13启动前端项目">1.3、启动前端项目</h2>
<h3 id="131-进入vscode终端">1.3.1 进入VSCODE终端</h3>
<p><img src="/posts/project/20220528232959/image-20220528233141547.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>终端界面</p>
<p>npm -v
<img src="/posts/project/20220528232959/image-20220528233149673.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="132-配置cnpm">1.3.2 配置cnpm</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">npm install -g cnpm --registry=https://registry.npm.taobao.org
</span></span></code></pre></div><h3 id="133-安装node_modules依赖包">1.3.3 安装node_modules依赖包</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cnpm install
</span></span></code></pre></div><p>注意安装的饿时候，需要修改package.json，里面的node-sass的依赖版本号:^4.14.1
<img src="/posts/project/20220528232959/image-20220528233228689.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="134-打包运行前端项目">1.3.4 打包运行前端项目</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">npm run dev
</span></span></code></pre></div><h3 id="135-浏览器访问">1.3.5 浏览器访问</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">注意：renren-fast项目要先启动 
</span></span><span class="line"><span class="cl">浏览后台：http://localhost:8001
</span></span></code></pre></div><p>登录后台</p>
<p>账号：admin</p>
<p>密码：admin
<img src="/posts/project/20220528232959/image-20220528233236251.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="14配置前端使用api网关-请求后端api接口调用地址">1.4、配置前端使用API网关-请求后端API接口调用地址</h2>
<p>修改配置文件对接后端api地址：</p>
<p>文件：renren-fast-vue\static\config\index.js</p>
<p>api接口请求地址替换为题目微服务的地址</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-js" data-lang="js"><span class="line"><span class="cl"><span class="nb">window</span><span class="p">.</span><span class="nx">SITE_CONFIG</span><span class="p">[</span><span class="s1">&#39;baseUrl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;http://localhost:8080/renren-fast&#39;</span><span class="p">;</span>
</span></span><span class="line"><span class="cl"><span class="nx">替换为</span>
</span></span><span class="line"><span class="cl"><span class="nb">window</span><span class="p">.</span><span class="nx">SITE_CONFIG</span><span class="p">[</span><span class="s1">&#39;baseUrl&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;http://localhost:8888/api&#39;</span><span class="p">;</span> <span class="c1">// 网关地址
</span></span></span></code></pre></div><p><img src="/posts/project/20220528232959/image-20220528233243956.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>配置cloud-gateway转发到renren-fast的路由：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cloud</span><span class="p">:</span><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">gateway</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">routes</span><span class="p">:</span><span class="w">        
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l">renrenfast-route</span><span class="w"> </span><span class="c"># 人人后台服务路由</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">uri</span><span class="p">:</span><span class="w"> </span><span class="l">lb://renren-fast</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">predicates</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="l">Path=/api/**</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">filters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="l">RewritePath=/api/(?&lt;segment&gt;.*),/renren-fast/$\{segment}</span><span class="w">
</span></span></span></code></pre></div><p>刷新登录页面，可以正常获取验证码，请求路径为网关地址 + /api/captcha.jpg?uuid=xxxxx</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">http://localhost:8888/api/captcha.jpg?uuid=84d36089-07ae-4201-85c0-8217b032f23e
</span></span></code></pre></div><p><img src="/posts/project/20220528232959/image-20220528233252574.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="15登录跨域问题">1.5、登录跨域问题</h2>
<p>点击登录，控制台报错，登录失败：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">Access to XMLHttpRequest at &#39;http://localhost:8888/api/sys/login&#39; from origin &#39;http://localhost:8001&#39; has been blocked by CORS policy: Response to preflight request doesn&#39;t pass access control check: No &#39;Access-Control-Allow-Origin&#39; head is present on the requested resource
</span></span></code></pre></div><p>登录页面url：http://localhost:8001，点击登录访问的请求url：http://localhost:8888/api/sys/login，两个url的端口号不一样，产生了跨域问题。</p>
<h4 id="什么是跨域">什么是跨域？</h4>
<p>跨域资源共享(CORS) 是一种机制，它使用额外的 HTTP 头来告诉浏览器 让运行在一个 origin (domain) 上的Web应用被准许访问来自不同源服务器上的指定的资源。当一个资源从与该资源本身所在的服务器不同的域、协议或端口请求一个资源时，资源会发起一个跨域 HTTP 请求。</p>
<p>比如，站点 <a class="link" href="/posts/project/http://domain-a.com"  target="_blank" rel="noopener"
    >http://domain-a.com</a> 的某 HTML 页面通过 的 src 请求 <a class="link" href="/posts/project/http://domain-b.com/image.jpg"  target="_blank" rel="noopener"
    >http://domain-b.com/image.jpg</a>。网络上的许多页面都会加载来自不同域的CSS样式表，图像和脚本等资源。</p>
<p>出于安全原因，浏览器限制从脚本内发起的跨源HTTP请求。 例如，XMLHttpRequest和Fetch API遵循同源策略。 这意味着使用这些API的Web应用程序只能从加载应用程序的同一个域请求HTTP资源，除非响应报文包含了正确CORS响应头。
<img src="/posts/project/20220528232959/image-20220528233259690.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="16解决跨域问题">1.6、解决跨域问题</h2>
<p>添加响应头，配置当次请求允许跨域</p>
<p>Access-Control-Allow-Origin：支持哪些来源的请求跨域
Access-Control-Allow-Methods：支持哪些方法跨域
Access-Control-Allow-Credentials：跨域请求默认不包含cookie，设置为true可以包含cookie
Access-Control-Expose-Headers：跨域请求暴露的字段CORS请求时，XMLHttpRequest对象的getResponseHeader()方法只能拿到6个基本字段：Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma。如果想拿到其他字段，就必须在Access-Control-Expose-Headers里面指定。
Access-Control-Max-Age：表明该响应的有效时间为多少秒。在有效时间内，浏览器无
须为同一请求再次发起预检请求。请注意，浏览器自身维护了一个最大有效时间，如果
该首部字段的值超过了最大有效时间，将不会生效。</p>
<h3 id="161-添加跨域配置">1.6.1 添加跨域配置</h3>
<p>在cloud-gateway模块添加解决跨域的配置文件GatewayCorsConfiguration</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Bean</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.context.annotation.Configuration</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.web.cors.CorsConfiguration</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.web.cors.reactive.CorsWebFilter</span><span class="o">;</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">org.springframework.web.cors.reactive.UrlBasedCorsConfigurationSource</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">GatewayCorsConfiguration</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">CorsWebFilter</span> <span class="nf">corsWebFilter</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">UrlBasedCorsConfigurationSource</span> <span class="n">source</span> <span class="o">=</span> <span class="k">new</span> <span class="n">UrlBasedCorsConfigurationSource</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">CorsConfiguration</span> <span class="n">corsConfiguration</span> <span class="o">=</span> <span class="k">new</span> <span class="n">CorsConfiguration</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 配置跨域
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">corsConfiguration</span><span class="o">.</span><span class="na">addAllowedHeader</span><span class="o">(</span><span class="s">&#34;*&#34;</span><span class="o">);</span> <span class="c1">// 允许所有请求头跨域
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">corsConfiguration</span><span class="o">.</span><span class="na">addAllowedMethod</span><span class="o">(</span><span class="s">&#34;*&#34;</span><span class="o">);</span> <span class="c1">// 允许所有请求方法跨域
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">corsConfiguration</span><span class="o">.</span><span class="na">addAllowedOrigin</span><span class="o">(</span><span class="s">&#34;*&#34;</span><span class="o">);</span> <span class="c1">// 允许所有请求来源跨域
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">corsConfiguration</span><span class="o">.</span><span class="na">setAllowCredentials</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span> <span class="c1">//允许携带cookie跨域，否则跨域请求会丢失cookie信息
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="n">source</span><span class="o">.</span><span class="na">registerCorsConfiguration</span><span class="o">(</span><span class="s">&#34;/**&#34;</span><span class="o">,</span> <span class="n">corsConfiguration</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">CorsWebFilter</span><span class="o">(</span><span class="n">source</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>也可以采用配置方式，修改application.yml:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">spring</span><span class="p">:</span><span class="w"> 
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cloud</span><span class="p">:</span><span class="w">    
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">gateway</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">globalcors</span><span class="p">:</span><span class="w">   </span><span class="c">#跨域配置</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">cors-configurations</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">&#39;[/**]&#39;</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">allowCredentials</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="c">#允许跨域读取cookie</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">allowedOrigins</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;*&#34;</span><span class="w">  </span><span class="c">#允许发出跨域请求主机域名 * 任意主机</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">allowedMethods</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;*&#34;</span><span class="w">  </span><span class="c">#请求方法</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">allowedHeaders</span><span class="p">:</span><span class="w"> </span><span class="s2">&#34;*&#34;</span><span class="w">  </span><span class="c">#允许发出跨域的请求头</span><span class="w">
</span></span></span></code></pre></div><h3 id="162注释renren-fast跨域配置">1.6.2、注释renren-fast跨域配置</h3>
<p>注释renren-fast里面的跨域配置</p>
<p>文件路径：src/main/java/io/renren/config/CorsConfig.java</p>
<p>重启各个服务及网关，测试即可成功登录。
<img src="/posts/project/20220528232959/image-20220528233311434.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="163-前后端联调登录">1.6.3 前后端联调登录</h3>
<p>登录成功</p>
<p><img src="/posts/project/20220528232959/image-20220528233456137.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>查看后端服务日志</p>
<p><img src="/posts/project/20220528232959/image-20220528233524311.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>说明前端登录请求发送到了后端服务，并验证了用户名和密码是否正确。</p>
<h1 id="2开发配置题目分类服务前端维护管理功能">2、开发配置题目分类服务前端维护管理功能</h1>
<h2 id="21添加题目管理目录一级菜单">2.1、添加题目管理目录（一级菜单）</h2>
<p>选择管理界面&ndash;系统管理&ndash;菜单管理，点击 新增按钮
<img src="/posts/project/20220528232959/image-20220528233551298.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>刷新页面,就可以看到题目中心菜单
<img src="/posts/project/20220528232959/image-20220528233619632.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="22添加题目类型维护菜单二级菜单">2.2、添加题目类型维护菜单(二级菜单)</h2>
<p>选择管理界面&ndash;系统管理&ndash;菜单管理，点击 新增按钮</p>
<p>选择类型：菜单
<img src="/posts/project/20220528232959/image-20220528233710888.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>刷新，可以看到菜单
<img src="/posts/project/20220528232959/image-20220528233730447.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>可以看到数据库uxeu_admin的表sys_menu中新增了两条记录,分别对应两个菜单
<img src="/posts/project/20220528232959/image-20220528233738776.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>点击类型维护菜单,打开了链接:http://localhost:8001/#/question-type,页面显示空白页面.</p>
<h2 id="23自动生成类型维护前端页面">2.3、自动生成类型维护前端页面</h2>
<p>用renren-generator自动生成前端代码</p>
<p>注意配置数据库连接文件application.yml,指向数据库 uxue_qms</p>
<p>修改模板生成属性配置文件generator.properties</p>
<p>配置模块名和包名：
<img src="/posts/project/20220528232959/image-20220528233755862.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>重启服务，打开生成页面选择表，点击生成
<img src="/posts/project/20220528232959/image-20220528233804766.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="24拷贝前端代码到-前端工程renren-fast-vue">2.4、拷贝前端代码到 前端工程renren-fast-vue</h2>
<p>拷贝\main\resources\src\views\modules\question目录到前端目录 renren-fast-vue\src\views\modules
<img src="/posts/project/20220528232959/image-20220528233810196.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528232959/image-20220528233818805.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="25测试类型维护">2.5、测试类型维护</h2>
<p>点击类型维护菜单,可以看到请求报404</p>
<p>http://localhost:8001/#/question-type
<img src="/posts/project/20220528232959/image-20220528233829181.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>因为页面的请求都访问到renren-fast服务了,所以要修改为访问题目微服务。</p>
<p><em><strong>修改colud-gateway网关配置，配置转发题目微服务：</strong></em></p>
<p>（注意：qms-route的路由配置一定要配置在renrenfast-route之前，拥有加载顺序。）</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cloud</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">nacos</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">discovery</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">server-addr</span><span class="p">:</span><span class="w"> </span><span class="l">http://localhost:8848</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">gateway</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">routes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l">qms-route</span><span class="w"> </span><span class="c"># 题目微服务路由</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">uri</span><span class="p">:</span><span class="w"> </span><span class="l">lb://u-question</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">predicates</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="l">Path=/api/question/**</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">filters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="l">RewritePath=/api/(?&lt;segment&gt;.*),/$\{segment}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l">renrenfast-route</span><span class="w"> </span><span class="c"># 人人后台服务路由</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">uri</span><span class="p">:</span><span class="w"> </span><span class="l">lb://renren-fast</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">predicates</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="l">Path=/api/**</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">filters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="l">RewritePath=/api/(?&lt;segment&gt;.*),/renren-fast/$\{segment}</span><span class="w">
</span></span></span></code></pre></div><p>重启网关服务，再次刷新访问地址：http://localhost:8001/#/question-type</p>
<p>即可正常访问题目类型列表页：</p>
<ul>
<li>数据库插入3条测试数据</li>
<li>测试查询列表，可以看到有三条记录查询出来了</li>
</ul>
<p><img src="/posts/project/20220528232959/image-20220528233844508.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>点击 修改：</p>
<p><img src="/posts/project/20220528232959/image-20220528233857864.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>点击 确定 即可完成修改。</p>
<p>点击删除即可删除记录</p>
<p><img src="/posts/project/20220528232959/image-20220528233907678.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>弹出删除确认提示：</p>
<p><img src="/posts/project/20220528232959/image-20220528233918327.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>确定即可删除对应记录</p>
<h2 id="26开启类型维护新增批量删除权限">2.6、开启类型维护新增、批量删除权限</h2>
<p>打开前端工程renren-fast-vue找到配置文件src\utils\index.js</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="cm">/**
</span></span></span><span class="line"><span class="cl"><span class="cm"> * 是否有权限
</span></span></span><span class="line"><span class="cl"><span class="cm"> * @param {*} key
</span></span></span><span class="line"><span class="cl"><span class="cm"> */</span>
</span></span><span class="line"><span class="cl"><span class="kr">export</span> <span class="kd">function</span> <span class="nx">isAuth</span> <span class="p">(</span><span class="nx">key</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">  <span class="c1">// return JSON.parse(sessionStorage.getItem(&#39;permissions&#39;) || &#39;[]&#39;).indexOf(key) !== -1 || false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>  <span class="k">return</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>暂时不判断权限，全部返回true</p>
<p>再次访问类型维护列表页，即可看到新增按钮</p>
<p><img src="/posts/project/20220528232959/image-20220528233931156.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>去除新增创建时间、更新时间必须输入限制：</p>
<p>修改文件src/views/modules/question/type-add-or-update.vue</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"> <span class="err">dataRule:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="err">type:</span> <span class="err">[</span>
</span></span><span class="line"><span class="cl">            <span class="err">{</span> <span class="err">required:</span> <span class="err">true,</span> <span class="err">message:</span> <span class="err">&#39;类型名称不能为空&#39;,</span> <span class="err">trigger:</span> <span class="err">&#39;blur&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="err">],</span>
</span></span><span class="line"><span class="cl">          <span class="err">comments:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span> <span class="err">required:</span> <span class="err">true,</span> <span class="err">message:</span> <span class="err">&#39;备注不能为空&#39;,</span> <span class="err">trigger:</span> <span class="err">&#39;blur&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">]</span><span class="err">,</span>
</span></span><span class="line"><span class="cl">          <span class="err">logoUrl:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span> <span class="err">required:</span> <span class="err">true,</span> <span class="err">message:</span> <span class="err">&#39;类型logo路径不能为空&#39;,</span> <span class="err">trigger:</span> <span class="err">&#39;blur&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">]</span><span class="err">,</span>
</span></span><span class="line"><span class="cl">          <span class="err">delFlag:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span> <span class="err">required:</span> <span class="err">true,</span> <span class="err">message:</span> <span class="err">&#39;删除标记（0-正常，1-删除）不能为空&#39;,</span> <span class="err">trigger:</span> <span class="err">&#39;blur&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">]</span><span class="err">,</span>
</span></span><span class="line"><span class="cl">          <span class="err">createTime:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span> <span class="err">required:</span> <span class="err">false,</span> <span class="err">message:</span> <span class="err">&#39;创建时间不能为空&#39;,</span> <span class="err">trigger:</span> <span class="err">&#39;blur&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">]</span><span class="err">,</span>
</span></span><span class="line"><span class="cl">          <span class="err">updateTime:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span> <span class="err">required:</span> <span class="err">false,</span> <span class="err">message:</span> <span class="err">&#39;更新时间不能为空&#39;,</span> <span class="err">trigger:</span> <span class="err">&#39;blur&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="err">}</span>
</span></span></code></pre></div><p>把createTime、updateTime  required: true改成  required: false</p>
<p>点击新增按钮，即可弹出新增界面</p>
<p><img src="/posts/project/20220528232959/image-20220528233942684.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>批量删除测试</p>
<p><img src="/posts/project/20220528232959/image-20220528233953702.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="27配置逻辑删除">2.7、配置逻辑删除</h2>
<p>前面进行的删除都是物理删除，页可以进行逻辑删除，就是不直接把数据记录从数据库删除，而是采用设置删除标记来标识数据记录被删除。</p>
<h3 id="271所有表字段添加del_flag字段">2.7.1、所有表字段添加del_flag字段</h3>
<p>字段属性</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">del_flag tinyint(1) DEFAULT 0 COMMENT &#39;删除标记（0-正常，1-删除）&#39;,
</span></span></code></pre></div><h3 id="272修改mybatisplus配置逻辑删除">2.7.2、修改MyBatisPlus配置逻辑删除</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">mybatis-plus</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mapper-locations</span><span class="p">:</span><span class="w"> </span><span class="l">classpath:/mapper/**/*.xml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">global-config</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">db-config</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">id-type</span><span class="p">:</span><span class="w"> </span><span class="l">auto</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">logic-delete-value</span><span class="p">:</span><span class="w"> </span><span class="m">1</span><span class="w">  </span><span class="c"># 逻辑已删除值(默认为 1)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">logic-not-delete-value</span><span class="p">:</span><span class="w"> </span><span class="m">0</span><span class="w"> </span><span class="c"># 逻辑未删除值(默认为 0)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">logic-delete-field</span><span class="p">:</span><span class="w"> </span><span class="l">delFlag</span><span class="w"> </span><span class="c">#全局逻辑删除字段值 3.3.0开始支持，详情看下面。</span><span class="w">
</span></span></span></code></pre></div><h3 id="273配置springboot打印mybatis执行sql">2.7.3、配置springboot打印mybatis执行sql</h3>
<p>修改配置文件application.yml</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">logging</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">level</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">com.offcn.question</span><span class="p">:</span><span class="w"> </span><span class="l">debug</span><span class="w">
</span></span></span></code></pre></div><p>再次测试访问列表和执行删除，可以看到控制台打印sql指令</p>
<p>查询指令：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">SELECT</span><span class="w"> </span><span class="n">id</span><span class="p">,</span><span class="k">type</span><span class="p">,</span><span class="n">comments</span><span class="p">,</span><span class="n">logo_url</span><span class="p">,</span><span class="n">del_flag</span><span class="p">,</span><span class="n">create_time</span><span class="p">,</span><span class="n">update_time</span><span class="w"> </span><span class="k">FROM</span><span class="w"> </span><span class="n">qms_type</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">del_flag</span><span class="o">=</span><span class="mi">0</span><span class="w">
</span></span></span></code></pre></div><p>删除指令：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-sql" data-lang="sql"><span class="line"><span class="cl"><span class="k">UPDATE</span><span class="w"> </span><span class="n">qms_type</span><span class="w"> </span><span class="k">SET</span><span class="w"> </span><span class="n">del_flag</span><span class="o">=</span><span class="mi">1</span><span class="w"> </span><span class="k">WHERE</span><span class="w"> </span><span class="n">id</span><span class="w"> </span><span class="k">IN</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="mi">1</span><span class="w"> </span><span class="p">)</span><span class="w"> </span><span class="k">AND</span><span class="w"> </span><span class="n">del_flag</span><span class="o">=</span><span class="mi">0</span><span class="w"> 
</span></span></span></code></pre></div><p>查看数据库记录：</p>
<p><img src="/posts/project/20220528232959/image-20220528234007744.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="28模糊查询类型功能">2.8、模糊查询类型功能</h2>
<p>修改实现类TypeServiceImpl的方法queryPage</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"> <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">PageUtils</span> <span class="nf">queryPage</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//1、获取查询关键字
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>     <span class="n">String</span> <span class="n">key</span><span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span> <span class="n">params</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;key&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">     <span class="c1">//2、创建查询条件对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">QueryWrapper</span><span class="o">&lt;</span><span class="n">TypeEntity</span><span class="o">&gt;</span> <span class="n">queryWrapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QueryWrapper</span><span class="o">&lt;&gt;();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//3、设置查询条件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>       <span class="k">if</span><span class="o">(!</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">key</span><span class="o">)){</span>
</span></span><span class="line"><span class="cl">           <span class="n">queryWrapper</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">,</span><span class="n">key</span><span class="o">).</span><span class="na">or</span><span class="o">().</span><span class="na">like</span><span class="o">(</span><span class="s">&#34;type&#34;</span><span class="o">,</span><span class="n">key</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">IPage</span><span class="o">&lt;</span><span class="n">TypeEntity</span><span class="o">&gt;</span> <span class="n">page</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">page</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">                <span class="k">new</span> <span class="n">Query</span><span class="o">&lt;</span><span class="n">TypeEntity</span><span class="o">&gt;().</span><span class="na">getPage</span><span class="o">(</span><span class="n">params</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">                <span class="n">queryWrapper</span>
</span></span><span class="line"><span class="cl">        <span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">PageUtils</span><span class="o">(</span><span class="n">page</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></div><p>设置id或者类型名称模糊查询的条件</p>
<p>前端访问测试：
<img src="/posts/project/20220528232959/image-20220528234017377.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="29配置分页">2.9、配置分页</h2>
<p>修改u-question配置分页插件配置类：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Configuration</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">MyBatisConfig</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//引入分页插件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nd">@Bean</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">PaginationInterceptor</span> <span class="nf">paginationInterceptor</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">PaginationInterceptor</span> <span class="n">paginationInterceptor</span> <span class="o">=</span> <span class="k">new</span> <span class="n">PaginationInterceptor</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 设置请求的页面大于最大页后操作， true调回到首页，false 继续请求  默认false
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">paginationInterceptor</span><span class="o">.</span><span class="na">setOverflow</span><span class="o">(</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 设置最大单页限制数量，默认 500 条，-1 不受限制
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">paginationInterceptor</span><span class="o">.</span><span class="na">setLimit</span><span class="o">(</span><span class="mi">1000</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">paginationInterceptor</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>添加分页插件后的显示:</p>
<p><img src="/posts/project/20220528232959/image-20220528234025387.png"
    
    
    
    loading="lazy"
    
    
></p>
<h1 id="3开发配置题目前端维护管理功能">3、开发配置题目前端维护管理功能</h1>
<h2 id="31添加题目维护菜单二级菜单">3.1、添加题目维护菜单（二级菜单）</h2>
<p><img src="/posts/project/20220528232959/image-20220528234039387.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>刷新后台管理页面，就可以看到题目维护菜单</p>
<p><img src="/posts/project/20220528232959/image-20220528234047255.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="32拷贝代码生成器生成的题目维护的前端源码">3.2、拷贝代码生成器生成的题目维护的前端源码</h2>
<p>拷贝题目维护源码到前端工程renren-fast-vue</p>
<p><img src="/posts/project/20220528232959/image-20220528234101262.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="33测试题目维护">3.3、测试题目维护</h2>
<p><img src="/posts/project/20220528232959/image-20220528234111173.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>访问题目维护菜单，可以正常浏览到题目数据。</p>
<h2 id="34新增题目--处理题目类型下拉菜单">3.4、新增题目&ndash;处理题目类型下拉菜单</h2>
<p>打开新增题目，发现里面涉及到题目类型，需要下拉选择已经存在的题目类型。</p>
<h3 id="341获取根据分类获取题库列表数据接口">3.4.1．获取根据分类获取题库列表数据接口</h3>
<h4 id="3411编写获取题库分类接口及实现类">3.4.1.1、编写获取题库分类接口及实现类</h4>
<p>接口：TypeService 增加获取全部分类方法</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">public</span> <span class="kr">interface</span> <span class="nx">TypeService</span> <span class="kr">extends</span> <span class="nx">IService</span><span class="o">&lt;</span><span class="nx">TypeEntity</span><span class="o">&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="c1">//获取全部分类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">List</span><span class="o">&lt;</span><span class="nx">TypeEntity</span><span class="o">&gt;</span> <span class="nx">findAll</span><span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></div><p>实现类：TypeServiceImpl</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Service</span><span class="o">(</span><span class="s">&#34;typeService&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TypeServiceImpl</span> <span class="kd">extends</span> <span class="n">ServiceImpl</span><span class="o">&lt;</span><span class="n">TypeDao</span><span class="o">,</span> <span class="n">TypeEntity</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">TypeService</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">      <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">TypeEntity</span><span class="o">&gt;</span> <span class="nf">findAll</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">this</span><span class="o">.</span><span class="na">list</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h4 id="3412编写获取题库分类控制器">3.4.1.2、编写获取题库分类控制器</h4>
<p>修改TypeController，增加获取全部分类接口</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@RestController</span>
</span></span><span class="line"><span class="cl"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&#34;question/type&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">TypeController</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">TypeService</span> <span class="n">typeService</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//获取全部分类
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">&#34;findall&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">R</span> <span class="nf">findAll</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">List</span><span class="o">&lt;</span><span class="n">TypeEntity</span><span class="o">&gt;</span> <span class="n">all</span> <span class="o">=</span> <span class="n">typeService</span><span class="o">.</span><span class="na">findAll</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">R</span><span class="o">.</span><span class="na">ok</span><span class="o">().</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;data&#34;</span><span class="o">,</span><span class="n">all</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="342前端代码编写">3.4.2、前端代码编写</h3>
<p>修改question-add-or-update.vue</p>
<p>修改数据结构，定义题目类型下拉菜单数据</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">data</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">{</span>       
</span></span><span class="line"><span class="cl">        <span class="nx">options</span><span class="o">:</span> <span class="p">[],</span>
</span></span></code></pre></div><p>修改方法，当用户点击打开新增、或者修改页面的时候，调用后台接口获取全部题目类型数据</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"> <span class="nx">methods</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">init</span> <span class="p">(</span><span class="nx">id</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">dataForm</span><span class="p">.</span><span class="nx">id</span> <span class="o">=</span> <span class="nx">id</span> <span class="o">||</span> <span class="mi">0</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">visible</span> <span class="o">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">$nextTick</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="k">this</span><span class="p">.</span><span class="nx">$refs</span><span class="p">[</span><span class="s1">&#39;dataForm&#39;</span><span class="p">].</span><span class="nx">resetFields</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">           <span class="c1">//向服务器端发出一个请求，获取全部题目分类数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">this</span><span class="p">.</span><span class="nx">$http</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">            <span class="nx">url</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$http</span><span class="p">.</span><span class="nx">adornUrl</span><span class="p">(</span><span class="sb">`/question/type/findall`</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;get&#39;</span>           
</span></span><span class="line"><span class="cl">          <span class="p">}).</span><span class="nx">then</span><span class="p">(({</span><span class="nx">data</span><span class="p">})</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">           <span class="k">this</span><span class="p">.</span><span class="nx">options</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">data</span>
</span></span><span class="line"><span class="cl">          <span class="p">})</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"> <span class="p">&lt;</span><span class="nt">el-form-item</span> <span class="na">label</span><span class="o">=</span><span class="s">&#34;题目类型&#34;</span> <span class="na">prop</span><span class="o">=</span><span class="s">&#34;type&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">el-select</span> <span class="na">v-model</span><span class="o">=</span><span class="s">&#34;dataForm.type&#34;</span> <span class="na">placeholder</span><span class="o">=</span><span class="s">&#34;请选择&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">       <span class="p">&lt;</span><span class="nt">el-option</span>
</span></span><span class="line"><span class="cl">         <span class="na">v-for</span><span class="o">=</span><span class="s">&#34;item in options&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">:key</span><span class="o">=</span><span class="s">&#34;item.id&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">:label</span><span class="o">=</span><span class="s">&#34;item.type&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">:value</span><span class="o">=</span><span class="s">&#34;item.id&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">       <span class="p">&lt;/</span><span class="nt">el-option</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;/</span><span class="nt">el-select</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">el-form-item</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>点击新增、或者修改，可以看到题目类型下拉菜单成功显示</p>
<p><img src="/posts/project/20220528232959/image-20220528234129546.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="35新增题目--处理是否显示是否删除">3.5、新增题目&ndash;处理是否显示、是否删除</h2>
<p>修改页面question-add-or-update.vue</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">el-form-item</span> <span class="na">label</span><span class="o">=</span><span class="s">&#34;是否显示&#34;</span> <span class="na">prop</span><span class="o">=</span><span class="s">&#34;enable&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">el-radio</span> <span class="nt">v-model</span><span class="s">=&#34;dataForm.enable&#34; label=&#34;0&#34;&gt;不显示&lt;/el-radio&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">      &lt;el-radio v-model=&#34;dataForm.enable&#34; label=&#34;1&#34;&gt;显示&lt;/el-radio&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">    &lt;/el-form-item&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">&lt;el-form-item label=&#34;删除标记&#34; prop=&#34;delFlag&#34;&gt;
</span></span></span><span class="line"><span class="cl"><span class="s">      &lt;el-radio v-model=&#34;dataForm.delFlag&#34; label=&#34;0&#34;</span><span class="p">&gt;</span><span class="na">不删除</span><span class="err">&lt;/</span><span class="na">el</span><span class="nt">-radio</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">el-radio</span> <span class="na">v</span><span class="nt">-model</span><span class="err">=&#34;</span><span class="na">dataForm.delFlag</span><span class="err">&#34;</span> <span class="na">label</span><span class="o">=</span><span class="s">&#34;1&#34;</span> <span class="p">&gt;</span><span class="nx">删除</span><span class="o">&lt;</span><span class="err">/el-radio&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/el-form-item&gt;</span>
</span></span></code></pre></div><p>修改数据结构，定义是否显示初始化值</p>
<p><img src="/posts/project/20220528232959/image-20220528234139989.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>修改从后台接口获取数据赋值方法，把后台响应数据转换为字符串</p>
<p><img src="/posts/project/20220528232959/image-20220528234149878.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>关键点：data.question.enable + ''</p>
<p>​              data.question.delFlag + ''</p>
<p>点击新增或者修改，可以看到是否显示、是否删除成功已单选框显示</p>
<p><img src="/posts/project/20220528232959/image-20220528234205419.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="36模糊查询题目">3.6、模糊查询题目</h2>
<p>修改实现类QuestionServiceImpl的方法queryPage</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">PageUtils</span> <span class="nf">queryPage</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">params</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//1、获取查询关键字
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">String</span> <span class="n">key</span><span class="o">=</span> <span class="o">(</span><span class="n">String</span><span class="o">)</span> <span class="n">params</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;key&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//2、创建查询条件对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">QueryWrapper</span><span class="o">&lt;</span><span class="n">QuestionEntity</span><span class="o">&gt;</span> <span class="n">queryWrapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QueryWrapper</span><span class="o">&lt;&gt;();</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//3、设置查询条件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span><span class="o">(!</span><span class="n">StringUtils</span><span class="o">.</span><span class="na">isEmpty</span><span class="o">(</span><span class="n">key</span><span class="o">)){</span>
</span></span><span class="line"><span class="cl">            <span class="n">queryWrapper</span><span class="o">.</span><span class="na">eq</span><span class="o">(</span><span class="s">&#34;id&#34;</span><span class="o">,</span><span class="n">key</span><span class="o">).</span><span class="na">or</span><span class="o">().</span><span class="na">like</span><span class="o">(</span><span class="s">&#34;title&#34;</span><span class="o">,</span><span class="n">key</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="n">IPage</span><span class="o">&lt;</span><span class="n">QuestionEntity</span><span class="o">&gt;</span> <span class="n">page</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">page</span><span class="o">(</span>
</span></span><span class="line"><span class="cl">                <span class="k">new</span> <span class="n">Query</span><span class="o">&lt;</span><span class="n">QuestionEntity</span><span class="o">&gt;().</span><span class="na">getPage</span><span class="o">(</span><span class="n">params</span><span class="o">),</span>
</span></span><span class="line"><span class="cl">                <span class="n">queryWrapper</span>
</span></span><span class="line"><span class="cl">        <span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="k">new</span> <span class="n">PageUtils</span><span class="o">(</span><span class="n">page</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></div><p>测试输入id或者标题包含的关键字查询</p>
<p><img src="/posts/project/20220528232959/image-20220528234216703.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="37快速设置是否显示">3.7、快速设置是否显示</h2>
<p>想要将是否显示改为快速开关</p>
<p>修改页面question.vue添加更新状态方法</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl">    <span class="nx">methods</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 更新题目是否显示
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">updateQuestionStatus</span> <span class="p">(</span><span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="nx">data</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">          <span class="kd">let</span> <span class="p">{</span><span class="nx">id</span><span class="p">,</span> <span class="nx">enable</span><span class="p">}</span> <span class="o">=</span> <span class="nx">data</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">$http</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">           <span class="nx">url</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$http</span><span class="p">.</span><span class="nx">adornUrl</span><span class="p">(</span><span class="s1">&#39;/question/question/update&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">           <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;post&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">           <span class="nx">data</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$http</span><span class="p">.</span><span class="nx">adornData</span><span class="p">({</span><span class="nx">id</span><span class="p">,</span> <span class="nx">enable</span><span class="p">},</span> <span class="kc">false</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">}).</span><span class="nx">then</span><span class="p">(({</span> <span class="nx">data</span> <span class="p">})</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">$message</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">            <span class="nx">type</span><span class="o">:</span><span class="s1">&#39;success&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">message</span><span class="o">:</span> <span class="s1">&#39;状态更新成功&#39;</span>
</span></span><span class="line"><span class="cl">         <span class="p">})</span>
</span></span><span class="line"><span class="cl">     <span class="p">});</span>
</span></span><span class="line"><span class="cl">   <span class="p">},</span>
</span></span></code></pre></div><p>修改页面question.vue</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">el-table-column</span>
</span></span><span class="line"><span class="cl">        <span class="na">prop</span><span class="o">=</span><span class="s">&#34;enable&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="na">header</span><span class="nt">-align</span><span class="err">=&#34;</span><span class="na">center</span><span class="err">&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="na">align</span><span class="o">=</span><span class="s">&#34;center&#34;</span>
</span></span><span class="line"><span class="cl">        <span class="na">label</span><span class="o">=</span><span class="s">&#34;是否显示&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">template</span> <span class="na">slot</span><span class="nt">-scope</span><span class="err">=&#34;</span><span class="na">scope</span><span class="err">&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">         <span class="p">&lt;</span><span class="nt">el-switch</span>
</span></span><span class="line"><span class="cl">           <span class="nt">v-model</span><span class="s">=&#34;scope.row.enable&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">           :active-value=1
</span></span></span><span class="line"><span class="cl"><span class="s">           :inactive-value=0
</span></span></span><span class="line"><span class="cl"><span class="s">           active-color=&#34;#13ce66&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">           inactive-color=&#34;#ff4949&#34;
</span></span></span><span class="line"><span class="cl"><span class="s">           @change=&#34;updateQuestionStatus(scope.row)&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="err">&lt;/</span><span class="na">el</span><span class="nt">-switch</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="err">/el-table-column&gt;</span>
</span></span></code></pre></div><p>测试页面效果</p>
<p><img src="/posts/project/20220528232959/image-20220528234227737.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="38校验排序不能是小数或者小于0的数字">3.8、校验排序不能是小数或者小于0的数字</h2>
<p>修改前端页面question-add-or-update.vue</p>
<p><img src="/posts/project/20220528232959/image-20220528234239693.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528232959/image-20220528234250058.png"
    
    
    
    loading="lazy"
    
    
></p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-json" data-lang="json"><span class="line"><span class="cl"> <span class="err">var</span> <span class="err">validateOrder</span> <span class="err">=</span> <span class="err">(rule,</span> <span class="err">value,</span> <span class="err">callback)</span> <span class="err">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="err">if</span> <span class="err">(value</span> <span class="err">===</span> <span class="err">&#39;&#39;)</span> <span class="err">{</span>
</span></span><span class="line"><span class="cl">          <span class="err">callback(new</span> <span class="err">Error(&#39;请输入排序&#39;));</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span> <span class="err">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="err">if</span> <span class="err">(!(value%1</span> <span class="err">===</span> <span class="err">0)||(value&lt;0))</span> <span class="err">{</span>
</span></span><span class="line"><span class="cl">           <span class="err">callback(new</span> <span class="err">Error(&#39;排序应该是整数且大于0&#39;));</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="err">callback();</span>
</span></span><span class="line"><span class="cl">        <span class="err">}</span>
</span></span><span class="line"><span class="cl">      <span class="err">};</span>
</span></span><span class="line"><span class="cl"><span class="err">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	<span class="err">…………略</span>
</span></span><span class="line"><span class="cl"> <span class="err">dataRule:</span> <span class="err">{</span>
</span></span><span class="line"><span class="cl">    <span class="err">…………</span>
</span></span><span class="line"><span class="cl">    <span class="err">displayOrder:</span> <span class="err">[</span>
</span></span><span class="line"><span class="cl">            <span class="err">{</span> <span class="err">validator:</span> <span class="err">validateOrder,</span> <span class="err">trigger:</span> <span class="err">&#39;blur&#39;</span> <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="err">],</span>
</span></span><span class="line"><span class="cl">    <span class="err">…………</span>
</span></span><span class="line"><span class="cl"> <span class="err">},</span>
</span></span><span class="line"><span class="cl"><span class="err">}</span>
</span></span></code></pre></div><p>测试
<img src="/posts/project/20220528232959/image-20220528234257165.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>只有输入整数才能验证通过。</p>
<h2 id="39修改题目答案为多行文本框">3.9、修改题目答案为多行文本框</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">el-form-item</span> <span class="na">label</span><span class="o">=</span><span class="s">&#34;题目解答&#34;</span> <span class="na">prop</span><span class="o">=</span><span class="s">&#34;answer&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">el-input</span>  <span class="na">type</span><span class="o">=</span><span class="s">&#34;textarea&#34;</span> <span class="nt">:rows</span><span class="s">=&#34;2&#34;</span> <span class="nt">v-model</span><span class="s">=&#34;dataForm.answer&#34; placeholder=&#34;题目解答&#34;</span><span class="p">&gt;</span><span class="err">&lt;/</span><span class="na">el</span><span class="nt">-input</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/el-form-item&gt;</span>
</span></span></code></pre></div><p>效果：</p>
<p><img src="/posts/project/20220528232959/image-20220528234304599.png"
    
    
    
    loading="lazy"
    
    
></p>
<h1 id="4完成题目导入导出功能">4、完成题目导入、导出功能</h1>
<h2 id="41java操作excel类库poi">4.1、JAVA操作excel类库POI</h2>
<h3 id="1211-什么是poi">12.1.1 什么是POI？</h3>
<p>Apache POI是Apache软件基金会的开放源码函式库，POI提供API给Java程序对Microsoft Office格式档案读和写的功能。</p>
<p>· HSSF － 提供读写Microsoft Excel格式档案的功能。（.xls）</p>
<p>· XSSF － 提供读写Microsoft Excel OOXML格式档案的功能。（.xlsx）</p>
<p>· HWPF － 提供读写Microsoft Word格式档案的功能。</p>
<p>· HSLF － 提供读写Microsoft PowerPoint格式档案的功能。</p>
<p>· HDGF － 提供读写Microsoft Visio格式档案的功能。</p>
<h3 id="1212-poi官网">12.1.2 POI官网</h3>
<p><a class="link" href="/posts/project/http://poi.apache.org/"  target="_blank" rel="noopener"
    >http://poi.apache.org/</a></p>
<p>官网可以找到文档和每个版本的下载地址</p>
<h2 id="42poi入门demo">4.2、POI入门demo</h2>
<h3 id="421创建一个普通的maven项目">4.2.1．创建一个普通的maven项目</h3>
<p>项目名：excel-poi</p>
<h3 id="422pom中引入xml相关依赖">4.2.2．pom中引入xml相关依赖</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--xls--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>org.apache.poi<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>poi<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;version&gt;</span>3.9<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--xlsx--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>org.apache.poi<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>poi-ooxml<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;version&gt;</span>3.9<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--test--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>junit<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>junit<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;version&gt;</span>4.12<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependencies&gt;</span>
</span></span></code></pre></div><h3 id="423java写入excel">4.2.3．java写入excel</h3>
<h4 id="2003版写文件">2003版写文件</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.excel.poi</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExcelTest</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Test</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testWrite03</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 创建新的Excel 工作簿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Workbook</span> <span class="n">workbook</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HSSFWorkbook</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 在Excel工作簿中建一工作表，其名为缺省值 Sheet0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//Sheet sheet = workbook.createSheet();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 如要新建一名为&#34;会员登录统计&#34;的工作表，其语句为：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Sheet</span> <span class="n">sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">&#34;会员登录统计&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 创建行（row 1）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Row</span> <span class="n">row1</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 创建单元格（col 1-1）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Cell</span> <span class="n">cell11</span> <span class="o">=</span> <span class="n">row1</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">cell11</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">&#34;今日人数&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 创建单元格（col 1-2）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Cell</span> <span class="n">cell12</span> <span class="o">=</span> <span class="n">row1</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">cell12</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="mi">666</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 创建行（row 2）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Row</span> <span class="n">row2</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 创建单元格（col 2-1）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Cell</span> <span class="n">cell21</span> <span class="o">=</span> <span class="n">row2</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">cell21</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">&#34;统计时间&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//创建单元格（第三列）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Cell</span> <span class="n">cell22</span> <span class="o">=</span> <span class="n">row2</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">String</span> <span class="n">dateTime</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">().</span><span class="na">toString</span><span class="o">(</span><span class="s">&#34;yyyy-MM-dd HH:mm:ss&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">cell22</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">dateTime</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 新建一输出文件流（注意：要先创建文件夹）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">FileOutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileOutputStream</span><span class="o">(</span><span class="s">&#34;d:/excel-poi/test-write03.xls&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 把相应的Excel 工作簿存盘
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">workbook</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">out</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 操作结束，关闭文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">out</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;文件生成成功&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h4 id="2007版写文件">2007版写文件</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testWrite07</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">IOException</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 创建新的Excel 工作簿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Workbook</span> <span class="n">workbook</span> <span class="o">=</span> <span class="k">new</span> <span class="n">XSSFWorkbook</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 在Excel工作簿中建一工作表，其名为缺省值 Sheet0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="c1">//Sheet sheet = workbook.createSheet();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 如要新建一名为&#34;会员登录统计&#34;的工作表，其语句为：
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Sheet</span> <span class="n">sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">&#34;会员登录统计&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 创建行（row 1）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Row</span> <span class="n">row1</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 创建单元格（col 1-1）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Cell</span> <span class="n">cell11</span> <span class="o">=</span> <span class="n">row1</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cell11</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">&#34;今日人数&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 创建单元格（col 1-2）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Cell</span> <span class="n">cell12</span> <span class="o">=</span> <span class="n">row1</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cell12</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="mi">666</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 创建行（row 2）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Row</span> <span class="n">row2</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 创建单元格（col 2-1）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Cell</span> <span class="n">cell21</span> <span class="o">=</span> <span class="n">row2</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cell21</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">&#34;统计时间&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//创建单元格（第三列）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Cell</span> <span class="n">cell22</span> <span class="o">=</span> <span class="n">row2</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">String</span> <span class="n">dateTime</span> <span class="o">=</span> <span class="k">new</span> <span class="n">DateTime</span><span class="o">().</span><span class="na">toString</span><span class="o">(</span><span class="s">&#34;yyyy-MM-dd HH:mm:ss&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">cell22</span><span class="o">.</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">dateTime</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 新建一输出文件流（注意：要先创建文件夹）
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">FileOutputStream</span> <span class="n">out</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileOutputStream</span><span class="o">(</span><span class="s">&#34;d:/excel-poi/test-write07.xlsx&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 把相应的Excel 工作簿存盘
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">workbook</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">out</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">// 操作结束，关闭文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">out</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;文件生成成功&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>注意：如果针对不同版本的Excel使用了不适合的类库，则会报告异常
org.apache.poi.POIXMLException: org.apache.poi.openxml4j.exceptions.InvalidFormatException: Package should contain a content type part [M1.13]</p>
<h3 id="424java读取excel">4.2.4．Java读取excel</h3>
<h4 id="2003版读文件">2003版读文件</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kn">package</span> <span class="nn">com.excel.poi</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">ExcelReadTest</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Test</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">testRead03</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="s">&#34;d:/excel-poi/test-write03.xls&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Workbook</span> <span class="n">workbook</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HSSFWorkbook</span><span class="o">(</span><span class="n">is</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Sheet</span> <span class="n">sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="na">getSheetAt</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 读取第一行第一列
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Row</span> <span class="n">row</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="na">getRow</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Cell</span> <span class="n">cell</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 输出单元内容
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cell</span><span class="o">.</span><span class="na">getStringCellValue</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 操作结束，关闭文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">is</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h4 id="2007版读文件">2007版读文件</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Test</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kt">void</span> <span class="nf">testRead07</span><span class="o">()</span> <span class="kd">throws</span> <span class="n">Exception</span><span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">InputStream</span> <span class="n">is</span> <span class="o">=</span> <span class="k">new</span> <span class="n">FileInputStream</span><span class="o">(</span><span class="s">&#34;d:/excel-poi/test-write07.xlsx&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">Workbook</span> <span class="n">workbook</span> <span class="o">=</span> <span class="k">new</span> <span class="n">XSSFWorkbook</span><span class="o">(</span><span class="n">is</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">Sheet</span> <span class="n">sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="na">getSheetAt</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 读取第一行第一列
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">Row</span> <span class="n">row</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="na">getRow</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">Cell</span> <span class="n">cell</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 输出单元内容
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="n">cell</span><span class="o">.</span><span class="na">getStringCellValue</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">// 操作结束，关闭文件
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="n">is</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="43java后端代码编写">4.3、JAVA后端代码编写</h2>
<h3 id="431修改项目u-question的接口questionservice增加导入导出接口定义">4.3.1修改项目u-question的接口QuestionService增加导入、导出接口定义</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">QuestionService</span> <span class="kd">extends</span> <span class="n">IService</span><span class="o">&lt;</span><span class="n">QuestionEntity</span><span class="o">&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="n">PageUtils</span> <span class="nf">queryPage</span><span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">params</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="c1">//导入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">public</span> <span class="n">Map</span> <span class="nf">importExcel</span><span class="o">(</span><span class="n">MultipartFile</span> <span class="n">file</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">   <span class="c1">//导出
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="kd">public</span> <span class="n">Workbook</span> <span class="nf">exportExcel</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="432-修改实现类questionserviceimpl实现导入导出方法">4.3.2 修改实现类QuestionServiceImpl实现导入、导出方法</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl">  <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Map</span> <span class="nf">importExcel</span><span class="o">(</span><span class="n">MultipartFile</span> <span class="n">file</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">Map</span> <span class="n">result</span><span class="o">=</span><span class="k">new</span> <span class="n">HashMap</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">//获取上传文件名称
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">String</span> <span class="n">filename</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="na">getOriginalFilename</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">         <span class="n">String</span> <span class="n">extName</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="na">substring</span><span class="o">(</span><span class="n">filename</span><span class="o">.</span><span class="na">lastIndexOf</span><span class="o">(</span><span class="s">&#34;.&#34;</span><span class="o">)+</span><span class="mi">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="c1">//2、判断文件扩展名是否等于xlsx,xls
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="k">if</span><span class="o">(!</span><span class="n">extName</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">&#34;xls&#34;</span><span class="o">)</span> <span class="o">&amp;&amp;!</span><span class="n">extName</span><span class="o">.</span><span class="na">equals</span><span class="o">(</span><span class="s">&#34;xlsx&#34;</span><span class="o">)</span> <span class="o">){</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;result&#34;</span><span class="o">,</span><span class="kc">false</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;msg&#34;</span><span class="o">,</span><span class="s">&#34;文件扩展名不正确，导入失败&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;num&#34;</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">       <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">InputStream</span> <span class="n">inputStream</span> <span class="o">=</span> <span class="n">file</span><span class="o">.</span><span class="na">getInputStream</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//初始化创建工作簿对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">Workbook</span> <span class="n">workbook</span> <span class="o">=</span> <span class="n">WorkbookFactory</span><span class="o">.</span><span class="na">create</span><span class="o">(</span><span class="n">inputStream</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//获取第一张工作表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">Sheet</span> <span class="n">sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="na">getSheetAt</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//获取工作表里面有数据行数
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="kt">int</span> <span class="n">rows</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="na">getPhysicalNumberOfRows</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//循环表格行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span><span class="n">rows</span> <span class="o">;</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">QuestionEntity</span> <span class="n">questionEntity</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QuestionEntity</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="c1">//获取当前行
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">Row</span> <span class="n">row</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="na">getRow</span><span class="o">(</span><span class="n">i</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="c1">//获取第一个单元格的内容 标题
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>              <span class="n">String</span> <span class="n">title</span><span class="o">=</span>  <span class="n">row</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">getStringCellValue</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">              <span class="c1">//设置到题目对象标题属性
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">questionEntity</span><span class="o">.</span><span class="na">setTitle</span><span class="o">(</span><span class="n">title</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;title:&#34;</span><span class="o">+</span><span class="n">title</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="c1">//获取第二个单元格的内容 答案
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">String</span> <span class="n">answer</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">getStringCellValue</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="n">questionEntity</span><span class="o">.</span><span class="na">setAnswer</span><span class="o">(</span><span class="n">answer</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;answer:&#34;</span><span class="o">+</span><span class="n">answer</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="c1">//获取第三个单元格的内容 题目难度等级
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="kt">double</span> <span class="n">level</span> <span class="o">=</span> <span class="n">row</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="na">getNumericCellValue</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="n">questionEntity</span><span class="o">.</span><span class="na">setLevel</span><span class="o">((</span><span class="kt">int</span><span class="o">)</span><span class="n">level</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1">//获取第四个单元格的内容 paix
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">questionEntity</span><span class="o">.</span><span class="na">setDisplayOrder</span><span class="o">((</span><span class="kt">int</span><span class="o">)</span><span class="n">row</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">3</span><span class="o">).</span><span class="na">getNumericCellValue</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1">//获取副标题
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">questionEntity</span><span class="o">.</span><span class="na">setSubTitle</span><span class="o">(</span><span class="n">row</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">4</span><span class="o">).</span><span class="na">getStringCellValue</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">                <span class="c1">//题目类型
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">questionEntity</span><span class="o">.</span><span class="na">setType</span><span class="o">((</span><span class="kt">long</span><span class="o">)</span><span class="n">row</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">5</span><span class="o">).</span><span class="na">getNumericCellValue</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">                <span class="c1">//是否显示
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="n">questionEntity</span><span class="o">.</span><span class="na">setEnable</span><span class="o">((</span><span class="kt">int</span><span class="o">)</span><span class="n">row</span><span class="o">.</span><span class="na">getCell</span><span class="o">(</span><span class="mi">6</span><span class="o">).</span><span class="na">getNumericCellValue</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                <span class="c1">//调用数据库保存方法，保存题目数据到书籍
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                <span class="k">this</span><span class="o">.</span><span class="na">save</span><span class="o">(</span><span class="n">questionEntity</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;result&#34;</span><span class="o">,</span><span class="kc">true</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;msg&#34;</span><span class="o">,</span><span class="s">&#34;导入成功&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;导入成功总条数:&#34;</span><span class="o">+</span><span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;result&#34;</span><span class="o">,</span><span class="kc">false</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;msg&#34;</span><span class="o">,</span><span class="s">&#34;文件导入失败，&#34;</span><span class="o">+</span><span class="n">e</span><span class="o">.</span><span class="na">getMessage</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">result</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;num&#34;</span><span class="o">,</span><span class="mi">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">result</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">Workbook</span> <span class="nf">exportExcel</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 创建新的Excel 工作簿
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Workbook</span> <span class="n">workbook</span> <span class="o">=</span> <span class="k">new</span> <span class="n">HSSFWorkbook</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="c1">// 在Excel工作簿中建一工作表，其名为缺省值 Sheet0
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="c1">//Sheet sheet = workbook.createSheet();
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>
</span></span><span class="line"><span class="cl">        <span class="c1">// 创建工作表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="n">Sheet</span> <span class="n">sheet</span> <span class="o">=</span> <span class="n">workbook</span><span class="o">.</span><span class="na">createSheet</span><span class="o">(</span><span class="s">&#34;题库&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="n">Row</span> <span class="n">row</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="mi">0</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">&#34;题目标题&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">&#34;题目解答&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">&#34;题目难度等级&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">3</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">&#34;排序&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">4</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">&#34;副标题&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">5</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">&#34;题目类型&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">row</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">6</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="s">&#34;是否显示&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">List</span><span class="o">&lt;</span><span class="n">QuestionEntity</span><span class="o">&gt;</span> <span class="n">list</span> <span class="o">=</span> <span class="k">this</span><span class="o">.</span><span class="na">list</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="kt">int</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="o">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">list</span><span class="o">.</span><span class="na">size</span><span class="o">();</span> <span class="n">i</span><span class="o">++)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">Row</span> <span class="n">row2</span> <span class="o">=</span> <span class="n">sheet</span><span class="o">.</span><span class="na">createRow</span><span class="o">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//创建表格
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">row2</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">0</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getTitle</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">row2</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">1</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getAnswer</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">row2</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">2</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getLevel</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">row2</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">3</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getDisplayOrder</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">row2</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">4</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getSubTitle</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">row2</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">5</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getType</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">            <span class="n">row2</span><span class="o">.</span><span class="na">createCell</span><span class="o">(</span><span class="mi">6</span><span class="o">).</span><span class="na">setCellValue</span><span class="o">(</span><span class="n">list</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="n">i</span><span class="o">).</span><span class="na">getEnable</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">workbook</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></div><h3 id="433-修改控制器questioncontroller实现导入导出方法">4.3.3 修改控制器QuestionController实现导入、导出方法</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="c1">//题目上传导入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nd">@PostMapping</span><span class="o">(</span><span class="s">&#34;/upload&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">R</span> <span class="nf">upload</span><span class="o">(</span><span class="n">MultipartFile</span> <span class="n">file</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">Map</span> <span class="n">result</span> <span class="o">=</span> <span class="n">questionService</span><span class="o">.</span><span class="na">importExcel</span><span class="o">(</span><span class="n">file</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">R</span><span class="o">.</span><span class="na">ok</span><span class="o">().</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;result&#34;</span><span class="o">,</span><span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;result&#34;</span><span class="o">)).</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;msg&#34;</span><span class="o">,</span><span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;msg&#34;</span><span class="o">)).</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;num&#34;</span><span class="o">,</span><span class="n">result</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;num&#34;</span><span class="o">));</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1">//导出excel
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nd">@GetMapping</span><span class="o">(</span><span class="s">&#34;exportExcel&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kt">void</span> <span class="nf">export</span><span class="o">(</span><span class="n">String</span> <span class="n">tableName</span><span class="o">,</span> <span class="n">HttpServletResponse</span> <span class="n">response</span><span class="o">){</span>
</span></span><span class="line"><span class="cl">        <span class="n">System</span><span class="o">.</span><span class="na">out</span><span class="o">.</span><span class="na">println</span><span class="o">(</span><span class="s">&#34;导出excele&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">Workbook</span> <span class="n">workbook</span> <span class="o">=</span> <span class="n">questionService</span><span class="o">.</span><span class="na">exportExcel</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">if</span> <span class="o">(</span><span class="n">workbook</span> <span class="o">!=</span> <span class="kc">null</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="n">String</span> <span class="n">fileName</span> <span class="o">=</span> <span class="s">&#34;uxue_&#34;</span> <span class="o">+</span> <span class="k">new</span> <span class="n">SimpleDateFormat</span><span class="o">(</span><span class="s">&#34;yyyyMMddHHmmss&#34;</span><span class="o">).</span><span class="na">format</span><span class="o">(</span><span class="k">new</span> <span class="n">Date</span><span class="o">())</span> <span class="o">+</span> <span class="s">&#34;.xlsx&#34;</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="n">response</span><span class="o">.</span><span class="na">setHeader</span><span class="o">(</span><span class="s">&#34;Content-Disposition&#34;</span><span class="o">,</span> <span class="s">&#34;attachment;filename=&#34;</span> <span class="o">+</span> <span class="n">fileName</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">response</span><span class="o">.</span><span class="na">setContentType</span><span class="o">(</span><span class="s">&#34;application/octet-stream;charset=UTF-8&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="n">OutputStream</span> <span class="n">outputStream</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">outputStream</span> <span class="o">=</span> <span class="n">response</span><span class="o">.</span><span class="na">getOutputStream</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="n">workbook</span><span class="o">.</span><span class="na">write</span><span class="o">(</span><span class="n">outputStream</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">                <span class="n">outputStream</span><span class="o">.</span><span class="na">flush</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">                <span class="n">outputStream</span><span class="o">.</span><span class="na">close</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span> <span class="k">else</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">try</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">                <span class="n">response</span><span class="o">.</span><span class="na">getWriter</span><span class="o">().</span><span class="na">print</span><span class="o">(</span><span class="s">&#34;error&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span> <span class="k">catch</span> <span class="o">(</span><span class="n">Exception</span> <span class="n">e</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">               <span class="n">e</span><span class="o">.</span><span class="na">printStackTrace</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">            <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span></code></pre></div><h2 id="44前端代码编写">4.4、前端代码编写</h2>
<h3 id="441-创建导入弹窗口视图页面">4.4.1 创建导入弹窗口视图页面</h3>
<p>在renren-fast-vue前端工程/src/views/modules/question/ 目录下新增视图文件 question-import.vue</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">el-dialog</span>
</span></span><span class="line"><span class="cl">    <span class="nt">:title</span><span class="s">=&#34;&#39;导入题库&#39;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">:close-on-click-modal</span><span class="s">=&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">:visible.sync</span><span class="s">=&#34;visible&#34;</span> <span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">el-row</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;el-form-item__content&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">el-upload</span> <span class="na">ref</span><span class="o">=</span><span class="s">&#34;upload&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="na">accept</span><span class="o">=</span><span class="s">&#34;.xls,.xlsx&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="na">action</span><span class="o">=</span><span class="s">&#34;#&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">:auto-upload</span><span class="s">=&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">:multiple</span><span class="s">=&#34;false&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">:file-list</span><span class="s">=&#34;fileList&#34;</span>           
</span></span><span class="line"><span class="cl">            <span class="nt">:http-request</span><span class="s">=&#34;uploadHttpRequest&#34;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">el-button</span> <span class="na">size</span><span class="o">=</span><span class="s">&#34;small&#34;</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;primary&#34;</span><span class="p">&gt;</span><span class="nx">选择文件</span><span class="o">&lt;</span><span class="err">/el-button&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="p">&lt;</span><span class="nt">div</span> <span class="na">slot</span><span class="o">=</span><span class="s">&#34;tip&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;el-upload__tip&#34;</span><span class="p">&gt;</span><span class="nx">一次只能上传一个xls</span><span class="o">/</span><span class="nx">xlsx文件</span><span class="err">，</span><span class="nx">且不超过10M</span><span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="err">/el-upload&gt;        </span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">el-button</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;primary&#34;</span> <span class="na">size</span><span class="o">=</span><span class="s">&#34;small&#34;</span> <span class="nt">@click</span><span class="s">=&#34;submitUpload&#34;</span><span class="p">&gt;</span><span class="na">上</span> <span class="na">传</span><span class="err">&lt;/</span><span class="na">el</span><span class="nt">-button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">a</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;primary&#34;</span> <span class="na">href</span><span class="o">=</span><span class="s">&#34;/test.xls&#34;</span> <span class="na">size</span><span class="o">=</span><span class="s">&#34;small&#34;</span> <span class="p">&gt;</span><span class="nx">下载导入模板</span><span class="p">&lt;/</span><span class="nt">a</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>   
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/el-row&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/el-dialog&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">data</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">visible</span><span class="o">:</span> <span class="kc">false</span><span class="p">,</span>    
</span></span><span class="line"><span class="cl">        <span class="nx">fileList</span><span class="o">:</span> <span class="p">[],</span>        
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">methods</span><span class="o">:</span> <span class="p">{</span>     
</span></span><span class="line"><span class="cl">      <span class="nx">init</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">visible</span> <span class="o">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>   
</span></span><span class="line"><span class="cl">    <span class="c1">// param是默认参数，可以取得file文件信息，具体信息如下图
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">uploadHttpRequest</span><span class="p">(</span><span class="nx">param</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kr">const</span> <span class="nx">formData</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">FormData</span><span class="p">()</span> <span class="c1">//FormData对象，添加参数只能通过append(&#39;key&#39;, value)的形式添加
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;file&#39;</span><span class="p">,</span> <span class="nx">param</span><span class="p">.</span><span class="nx">file</span><span class="p">)</span> <span class="c1">//添加文件对象
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">formData</span><span class="p">.</span><span class="nx">append</span><span class="p">(</span><span class="s1">&#39;uploadType&#39;</span><span class="p">,</span> <span class="k">this</span><span class="p">.</span><span class="nx">rulesType</span><span class="p">)</span>        
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">$http</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">            <span class="nx">url</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$http</span><span class="p">.</span><span class="nx">adornUrl</span><span class="p">(</span><span class="sb">`/question/question/upload`</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">            <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;post&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">data</span><span class="o">:</span> <span class="nx">formData</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">contentType</span><span class="o">:</span> <span class="s1">&#39;form&#39;</span>
</span></span><span class="line"><span class="cl">          <span class="p">}).</span><span class="nx">then</span><span class="p">(</span> <span class="nx">res</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="kr">const</span> <span class="p">{</span> <span class="nx">data</span><span class="o">:</span> <span class="p">{</span> <span class="nx">code</span><span class="p">,</span> <span class="nx">mark</span><span class="p">,</span> <span class="nx">num</span><span class="p">,</span> <span class="nx">msg</span> <span class="p">}</span> <span class="p">}</span> <span class="o">=</span> <span class="nx">res</span>
</span></span><span class="line"><span class="cl">                <span class="k">if</span><span class="p">(</span><span class="nx">code</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">this</span><span class="p">.</span><span class="nx">fileList</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">                    <span class="k">this</span><span class="p">.</span><span class="nx">visible</span> <span class="o">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                  <span class="c1">//  param.onSuccess()  // 上传成功的文件显示绿色的对勾
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                  <span class="c1">//  this.uploadMark = mark
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                  <span class="c1">//this.$message.info(&#39;上传文件成功,导入条数:&#39;+num)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>                  <span class="k">this</span><span class="p">.</span><span class="nx">$message</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">                  <span class="nx">message</span><span class="o">:</span> <span class="s1">&#39;上传文件成功,导入条数:&#39;</span><span class="o">+</span><span class="nx">num</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;success&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nx">duration</span><span class="o">:</span> <span class="mi">1000</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                  <span class="nx">onClose</span><span class="o">:</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">this</span><span class="p">.</span><span class="nx">visible</span> <span class="o">=</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">                    <span class="k">this</span><span class="p">.</span><span class="nx">$emit</span><span class="p">(</span><span class="s1">&#39;refreshDataList&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                  <span class="p">}</span>
</span></span><span class="line"><span class="cl">                <span class="p">})</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span><span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                    <span class="k">this</span><span class="p">.</span><span class="nx">$message</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">msg</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="p">}</span>
</span></span><span class="line"><span class="cl">              
</span></span><span class="line"><span class="cl">            <span class="p">})</span>            
</span></span><span class="line"><span class="cl">            <span class="p">.</span><span class="k">catch</span><span class="p">(</span> <span class="nx">err</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">                <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="s1">&#39;失败&#39;</span><span class="p">,</span> <span class="nx">err</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">                <span class="nx">param</span><span class="p">.</span><span class="nx">onError</span><span class="p">()</span> <span class="c1">//上传失败的文件会从文件列表中删除
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>    
</span></span><span class="line"><span class="cl">    <span class="c1">// 点击上传：手动上传到服务器，此时会触发组件的http-request
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nx">submitUpload</span><span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">$refs</span><span class="p">.</span><span class="nx">upload</span><span class="p">.</span><span class="nx">submit</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>    
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span></code></pre></div><h3 id="442-修改题目维护页面questionvue">4.4.2 修改题目维护页面question.vue</h3>
<p>引入导入页面：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="kr">import</span> <span class="nx">ImportExcel</span> <span class="nx">from</span> <span class="s1">&#39;./question-import&#39;</span>
</span></span></code></pre></div><p>注册导入窗口：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c">&lt;!--</span> <span class="nx">导入窗口</span><span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">ImportExcel</span> <span class="nx">v</span><span class="o">-</span><span class="k">if</span><span class="o">=</span><span class="s2">&#34;importVisible&#34;</span> <span class="nx">ref</span><span class="o">=</span><span class="s2">&#34;importExcel&#34;</span> <span class="err">@</span><span class="nx">refreshDataList</span><span class="o">=</span><span class="s2">&#34;getDataList&#34;</span><span class="o">&gt;&lt;</span><span class="err">/ImportExcel&gt;</span>
</span></span></code></pre></div><p>声明允许显示导入弹窗变量</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">data</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">//是否允许显示导入窗口
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nx">importVisible</span><span class="o">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span></code></pre></div><p>把导入页面注册到当前页面组件：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="nx">components</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">AddOrUpdate</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">      <span class="nx">ImportExcel</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span></code></pre></div><p>添加导入导出点击触发方法：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c1">//导入
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">importExcelHandle</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">importVisible</span> <span class="o">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">$nextTick</span><span class="p">(()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="k">this</span><span class="p">.</span><span class="nx">$refs</span><span class="p">.</span><span class="nx">importExcel</span><span class="p">.</span><span class="nx">init</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">})</span>        
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="c1">//导出
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">exportExcelHandle</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">dom</span><span class="o">=</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;ifile&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="nx">dom</span><span class="p">.</span><span class="nx">src</span><span class="o">=</span> <span class="k">this</span><span class="p">.</span><span class="nx">$http</span><span class="p">.</span><span class="nx">adornUrl</span><span class="p">(</span><span class="s1">&#39;/question/question/exportExcel&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span></code></pre></div><p>在页面模板区域，添加 导入、导出按钮：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">el-button</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;primary&#34;</span> <span class="nt">@click</span><span class="s">=&#34;importExcelHandle()&#34;</span><span class="p">&gt;</span><span class="na">导入</span><span class="err">&lt;/</span><span class="na">el</span><span class="nt">-button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">el-button</span> <span class="na">type</span><span class="o">=</span><span class="s">&#34;success&#34;</span> <span class="nt">@click</span><span class="s">=&#34;exportExcelHandle()&#34;</span><span class="p">&gt;</span><span class="na">导出</span><span class="err">&lt;/</span><span class="na">el</span><span class="nt">-button</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">iframe</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;ifile&#34;</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;display:none&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">iframe</span><span class="p">&gt;</span>
</span></span></code></pre></div><p>导入、导出视图显示效果：</p>
<p><img src="/posts/project/20220528232959/image-20220528234344428.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>点击 导入 按钮，弹出导入弹窗：</p>
<p><img src="/posts/project/20220528232959/image-20220528234353730.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>下载导入模板，按照模板，填写数据，选中文件，点击上传，即可导入</p>
<p><img src="/posts/project/20220528232959/image-20220528234402053.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>导入模板样式：</p>
<p><img src="/posts/project/20220528232959/image-20220528234411612.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>导入成功，提示导入条数，关闭导入弹窗。</p>
<p><img src="/posts/project/20220528232959/image-20220528234421595.png"
    
    
    
    loading="lazy"
    
    
></p>
<h1 id="5echarts图表入门">5、Echarts图表入门</h1>
<h2 id="51echarts简介">5.1．Echarts简介</h2>
<p>ECahrs是百度的一个项目，用于图表展示，提供了常规的折线图、柱状图、散点图、饼图、K线图，用于统计的盒形图，用于地理数据可视化的地图、热力图、线图，用于关系数据可视化的关系图、treemap、旭日图，多维数据可视化的平行坐标，还有用于 BI 的漏斗图，仪表盘，并且支持图与图之间的混搭。
官方网站：https://echarts.apache.org/zh/index.html</p>
<h2 id="52基本使用">5.2．基本使用</h2>
<p>入门参考：官网-&gt;文档-&gt;教程-&gt;5分钟上手ECharts</p>
<h3 id="521柱状图创建">5.2.1、柱状图创建</h3>
<h4 id="1创建html页面柱图html">（1）创建html页面：柱图.html</h4>
<h4 id="2引入echarts">（2）引入ECharts</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="c">&lt;!--</span> <span class="nx">引入</span> <span class="nx">ECharts</span> <span class="nx">文件</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">script</span> <span class="nx">src</span><span class="o">=</span><span class="s2">&#34;echarts.min.js&#34;</span><span class="o">&gt;&lt;</span><span class="err">/script&gt;</span>
</span></span></code></pre></div><h4 id="3定义图表区域">（3）定义图表区域</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-html" data-lang="html"><span class="line"><span class="cl"><span class="c">&lt;!-- 为ECharts准备一个具备大小（宽高）的Dom --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;main&#34;</span> <span class="na">style</span><span class="o">=</span><span class="s">&#34;width: 600px;height:400px;&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span> 
</span></span></code></pre></div><h4 id="4渲染图表">（4）渲染图表</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">myChart</span> <span class="o">=</span> <span class="nx">echarts</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;main&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">option</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">title</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;Echarts 柱状图入门demo&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">tootip</span><span class="o">:</span> <span class="p">{},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">legend</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">data</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;销量&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">xAxis</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">data</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;衬衫&#34;</span><span class="p">,</span><span class="s2">&#34;羊毛衫&#34;</span><span class="p">,</span><span class="s2">&#34;羽绒服&#34;</span><span class="p">,</span><span class="s2">&#34;裤子&#34;</span><span class="p">,</span><span class="s2">&#34;高跟鞋&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">yAxis</span><span class="o">:</span> <span class="p">{},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">series</span><span class="o">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;销量&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">data</span><span class="o">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">6</span><span class="p">,</span><span class="mi">7</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">15</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}]</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">myChart</span><span class="p">.</span><span class="nx">setOption</span><span class="p">(</span><span class="nx">option</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/script&gt;</span>
</span></span></code></pre></div><p>测试效果：</p>
<p><img src="/posts/project/20220528232959/image-20220528234435662.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="522折线图创建">5.2.2、折线图创建</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-javascript" data-lang="javascript"><span class="line"><span class="cl"><span class="o">&lt;</span><span class="nx">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">myChart</span> <span class="o">=</span> <span class="nx">echarts</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;main&#39;</span><span class="p">));</span>
</span></span><span class="line"><span class="cl">    <span class="kd">var</span> <span class="nx">option</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">title</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">text</span><span class="o">:</span> <span class="s1">&#39;Echarts 折线图入门demo&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">tootip</span><span class="o">:</span> <span class="p">{},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">legend</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">data</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;销量&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">xAxis</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;category&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">data</span><span class="o">:</span> <span class="p">[</span><span class="s2">&#34;Mon&#34;</span><span class="p">,</span><span class="s2">&#34;Tue&#34;</span><span class="p">,</span><span class="s2">&#34;Wed&#34;</span><span class="p">,</span><span class="s2">&#34;Thu&#34;</span><span class="p">,</span><span class="s2">&#34;Fri&#34;</span><span class="p">,</span><span class="s2">&#34;Sat&#34;</span><span class="p">,</span><span class="s2">&#34;Sun&#34;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">yAxis</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;value&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="p">},</span>
</span></span><span class="line"><span class="cl">        <span class="nx">series</span><span class="o">:</span> <span class="p">[{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;销量&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;line&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">data</span><span class="o">:</span> <span class="p">[</span><span class="mi">820</span><span class="p">,</span> <span class="mi">932</span><span class="p">,</span> <span class="mi">901</span><span class="p">,</span> <span class="mi">934</span><span class="p">,</span> <span class="mi">1290</span><span class="p">,</span> <span class="mi">1330</span><span class="p">,</span> <span class="mi">1320</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}]</span>
</span></span><span class="line"><span class="cl">    <span class="p">};</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nx">myChart</span><span class="p">.</span><span class="nx">setOption</span><span class="p">(</span><span class="nx">option</span><span class="p">);</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="err">/script&gt;</span>
</span></span></code></pre></div><p><img src="/posts/project/20220528232959/image-20220528234445613.png"
    
    
    
    loading="lazy"
    
    
></p>
<h1 id="6统计分析">6、统计分析</h1>
<h2 id="61题库分类数量统计分析">6.1．题库分类数量统计分析</h2>
<h3 id="611-编写java后端代码">6.1.1 编写java后端代码</h3>
<p>打开java模块u-question ，编辑接口QuestionService新增统计分类题目数量方法</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">interface</span> <span class="nc">QuestionService</span> <span class="kd">extends</span> <span class="n">IService</span><span class="o">&lt;</span><span class="n">QuestionEntity</span><span class="o">&gt;</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">     <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="nf">countTypeQuestion</span><span class="o">();</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>编辑接口实现类QuestionServiceImpl,编写统计分类题目数量实现方法</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@Service</span><span class="o">(</span><span class="s">&#34;questionService&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">QuestionServiceImpl</span> <span class="kd">extends</span> <span class="n">ServiceImpl</span><span class="o">&lt;</span><span class="n">QuestionDao</span><span class="o">,</span> <span class="n">QuestionEntity</span><span class="o">&gt;</span> <span class="kd">implements</span> <span class="n">QuestionService</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">QuestionDao</span> <span class="n">questionDao</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Override</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="nf">countTypeQuestion</span><span class="o">()</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">QueryWrapper</span><span class="o">&lt;</span><span class="n">QuestionEntity</span><span class="o">&gt;</span> <span class="n">queryWrapper</span> <span class="o">=</span> <span class="k">new</span> <span class="n">QueryWrapper</span><span class="o">&lt;</span><span class="n">QuestionEntity</span><span class="o">&gt;().</span><span class="na">select</span><span class="o">(</span><span class="s">&#34;TYPE,COUNT(TYPE) AS num&#34;</span><span class="o">).</span><span class="na">groupBy</span><span class="o">(</span><span class="s">&#34;type&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">        <span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="n">mapList</span> <span class="o">=</span> <span class="n">questionDao</span><span class="o">.</span><span class="na">selectMaps</span><span class="o">(</span><span class="n">queryWrapper</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">mapList</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><p>编辑QuestionController,新增统计分类题目数量方法</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@RestController</span>
</span></span><span class="line"><span class="cl"><span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&#34;question/question&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">QuestionController</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">QuestionService</span> <span class="n">questionService</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nd">@Autowired</span>
</span></span><span class="line"><span class="cl">    <span class="kd">private</span> <span class="n">TypeService</span> <span class="n">typeService</span><span class="o">;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="c1">//获取按照题库分类的统计数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>    <span class="nd">@RequestMapping</span><span class="o">(</span><span class="s">&#34;countTypeQuestion&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="n">R</span> <span class="nf">countTypeQuestion</span><span class="o">(){</span>
</span></span><span class="line"><span class="cl">        <span class="n">List</span><span class="o">&lt;</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;&gt;</span> <span class="n">mapList</span> <span class="o">=</span> <span class="n">questionService</span><span class="o">.</span><span class="na">countTypeQuestion</span><span class="o">();</span>
</span></span><span class="line"><span class="cl">        <span class="k">for</span> <span class="o">(</span><span class="n">Map</span><span class="o">&lt;</span><span class="n">String</span><span class="o">,</span> <span class="n">Object</span><span class="o">&gt;</span> <span class="n">map</span> <span class="o">:</span> <span class="n">mapList</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="c1">//根据分类id，读取对应的分类数据
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>             <span class="n">Long</span> <span class="n">typeId</span> <span class="o">=</span> <span class="o">(</span><span class="n">Long</span><span class="o">)</span> <span class="n">map</span><span class="o">.</span><span class="na">get</span><span class="o">(</span><span class="s">&#34;TYPE&#34;</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">             <span class="n">TypeEntity</span> <span class="n">typeEntity</span> <span class="o">=</span> <span class="n">typeService</span><span class="o">.</span><span class="na">getById</span><span class="o">(</span><span class="n">typeId</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">            <span class="c1">//重新封装分类名称到map
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>            <span class="n">map</span><span class="o">.</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;name&#34;</span><span class="o">,</span><span class="n">typeEntity</span><span class="o">.</span><span class="na">getType</span><span class="o">());</span>
</span></span><span class="line"><span class="cl">        <span class="o">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">R</span><span class="o">.</span><span class="na">ok</span><span class="o">().</span><span class="na">put</span><span class="o">(</span><span class="s">&#34;mapList&#34;</span><span class="o">,</span><span class="n">mapList</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="612-编写前端代码">6.1.2 编写前端代码</h3>
<p>前端项目renren-fast-vue/src/views/modules/question目录 新增统计注册用户数量页面 echarts.vue</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-vue" data-lang="vue"><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">template</span><span class="p">&gt;</span> 
</span></span><span class="line"><span class="cl">  <span class="p">&lt;</span><span class="nt">div</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;mod-demo-echarts&#34;</span><span class="p">&gt;</span>   
</span></span><span class="line"><span class="cl">   
</span></span><span class="line"><span class="cl">    <span class="p">&lt;</span><span class="nt">el-row</span> <span class="nt">:gutter</span><span class="s">=&#34;20&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">      
</span></span><span class="line"><span class="cl">      <span class="p">&lt;</span><span class="nt">el-col</span> <span class="nt">:span</span><span class="s">=&#34;24&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="p">&lt;</span><span class="nt">el-card</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">          <span class="p">&lt;</span><span class="nt">div</span> <span class="na">id</span><span class="o">=</span><span class="s">&#34;J_chartBarBox&#34;</span> <span class="na">class</span><span class="o">=</span><span class="s">&#34;chart-box&#34;</span><span class="p">&gt;&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="o">&lt;</span><span class="err">/el-card&gt;</span>
</span></span><span class="line"><span class="cl">      <span class="o">&lt;</span><span class="err">/el-col&gt;      </span>
</span></span><span class="line"><span class="cl">    <span class="o">&lt;</span><span class="err">/el-row&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">&lt;/</span><span class="nt">div</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">template</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">import</span> <span class="nx">echarts</span> <span class="nx">from</span> <span class="s1">&#39;echarts&#39;</span>
</span></span><span class="line"><span class="cl">  <span class="kr">export</span> <span class="k">default</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="nx">data</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="k">return</span> <span class="p">{</span>       
</span></span><span class="line"><span class="cl">        <span class="nx">chartBar</span><span class="o">:</span> <span class="kc">null</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nx">beginTime</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nx">endTime</span><span class="o">:</span> <span class="s1">&#39;&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">         <span class="nx">mapList</span><span class="o">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">         <span class="nx">xData</span><span class="o">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">         <span class="nx">yData</span><span class="o">:</span> <span class="p">[],</span>
</span></span><span class="line"><span class="cl">         <span class="nx">btnDisabled</span><span class="o">:</span> <span class="kc">false</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">mounted</span> <span class="p">()</span> <span class="p">{</span>     
</span></span><span class="line"><span class="cl">         <span class="k">this</span><span class="p">.</span><span class="nx">create</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">activated</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 由于给echart添加了resize事件, 在组件激活时需要重新resize绘画一次, 否则出现空白bug     
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="k">if</span> <span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">chartBar</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">chartBar</span><span class="p">.</span><span class="nx">resize</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>     
</span></span><span class="line"><span class="cl">    <span class="p">},</span>
</span></span><span class="line"><span class="cl">    <span class="nx">methods</span><span class="o">:</span> <span class="p">{</span>      
</span></span><span class="line"><span class="cl">      <span class="nx">create</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">         <span class="k">this</span><span class="p">.</span> <span class="nx">getDataList</span> <span class="p">()</span>
</span></span><span class="line"><span class="cl">         <span class="k">this</span><span class="p">.</span><span class="nx">initChartBar</span><span class="p">()</span>  
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">       <span class="c1">// 获取数据列表
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">getDataList</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">dataListLoading</span> <span class="o">=</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">$http</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">          <span class="nx">url</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">$http</span><span class="p">.</span><span class="nx">adornUrl</span><span class="p">(</span><span class="s1">&#39;/question/question/countTypeQuestion&#39;</span><span class="p">),</span>
</span></span><span class="line"><span class="cl">          <span class="nx">method</span><span class="o">:</span> <span class="s1">&#39;get&#39;</span>          
</span></span><span class="line"><span class="cl">        <span class="p">}).</span><span class="nx">then</span><span class="p">(({</span><span class="nx">data</span><span class="p">})</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="k">if</span> <span class="p">(</span><span class="nx">data</span> <span class="o">&amp;&amp;</span> <span class="nx">data</span><span class="p">.</span><span class="nx">code</span> <span class="o">===</span> <span class="mi">0</span><span class="p">)</span> <span class="p">{</span>            
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="nx">mapList</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">mapList</span>   
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="nx">xData</span> <span class="o">=</span> <span class="p">[]</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="nx">yData</span> <span class="o">=</span> <span class="p">[]</span>         
</span></span><span class="line"><span class="cl">            <span class="k">for</span><span class="p">(</span><span class="kd">let</span> <span class="nx">j</span> <span class="k">in</span> <span class="k">this</span><span class="p">.</span><span class="nx">mapList</span><span class="p">){</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="nx">xData</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">mapList</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="nx">yData</span><span class="p">.</span><span class="nx">push</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">mapList</span><span class="p">[</span><span class="nx">j</span><span class="p">].</span><span class="nx">num</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">             <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">xData</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="nx">console</span><span class="p">.</span><span class="nx">log</span><span class="p">(</span><span class="k">this</span><span class="p">.</span><span class="nx">yData</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="nx">chartBar</span><span class="p">.</span><span class="nx">resize</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">          <span class="c1">// this.xData= this.mapList.map(obj =&gt; n.NAME);       
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="c1">// this.yData= this.mapList.map(obj =&gt; n.VALUE);  
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>          <span class="k">this</span><span class="p">.</span><span class="nx">chartBar</span><span class="p">.</span><span class="nx">setOption</span><span class="p">({</span>
</span></span><span class="line"><span class="cl">             <span class="nx">xAxis</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;category&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="nx">data</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">xData</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">],</span>
</span></span><span class="line"><span class="cl">          <span class="nx">yAxis</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;value&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">],</span>
</span></span><span class="line"><span class="cl">          <span class="nx">series</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;题目数量&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="nx">data</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">yData</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">]</span>
</span></span><span class="line"><span class="cl">          <span class="p">})</span>
</span></span><span class="line"><span class="cl">          <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="k">this</span><span class="p">.</span><span class="nx">mapList</span> <span class="o">=</span> <span class="p">[]</span>           
</span></span><span class="line"><span class="cl">          <span class="p">}</span>        
</span></span><span class="line"><span class="cl">        <span class="p">})</span>
</span></span><span class="line"><span class="cl">      <span class="p">},</span>
</span></span><span class="line"><span class="cl">      <span class="c1">// 柱状图
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>      <span class="nx">initChartBar</span> <span class="p">()</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="kd">var</span> <span class="nx">option</span> <span class="o">=</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="nx">tooltip</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">trigger</span><span class="o">:</span> <span class="s1">&#39;axis&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">axisPointer</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;shadow&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">},</span>
</span></span><span class="line"><span class="cl">          <span class="nx">legend</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">data</span><span class="o">:</span> <span class="p">[</span><span class="s1">&#39;题目数量&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">          <span class="p">},</span>
</span></span><span class="line"><span class="cl">          <span class="nx">grid</span><span class="o">:</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">            <span class="nx">left</span><span class="o">:</span> <span class="s1">&#39;3%&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">right</span><span class="o">:</span> <span class="s1">&#39;4%&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">bottom</span><span class="o">:</span> <span class="s1">&#39;3%&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">            <span class="nx">containLabel</span><span class="o">:</span> <span class="kc">true</span>
</span></span><span class="line"><span class="cl">          <span class="p">},</span>
</span></span><span class="line"><span class="cl">          <span class="nx">xAxis</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;category&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="nx">data</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">xData</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">],</span>
</span></span><span class="line"><span class="cl">          <span class="nx">yAxis</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;value&#39;</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">],</span>
</span></span><span class="line"><span class="cl">          <span class="nx">series</span><span class="o">:</span> <span class="p">[</span>
</span></span><span class="line"><span class="cl">            <span class="p">{</span>
</span></span><span class="line"><span class="cl">              <span class="nx">name</span><span class="o">:</span> <span class="s1">&#39;每日注册用户数&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="nx">type</span><span class="o">:</span> <span class="s1">&#39;bar&#39;</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">              <span class="nx">data</span><span class="o">:</span> <span class="k">this</span><span class="p">.</span><span class="nx">yData</span>
</span></span><span class="line"><span class="cl">            <span class="p">}</span>
</span></span><span class="line"><span class="cl">          <span class="p">]</span>
</span></span><span class="line"><span class="cl">        <span class="p">}</span>
</span></span><span class="line"><span class="cl">        <span class="k">this</span><span class="p">.</span><span class="nx">chartBar</span> <span class="o">=</span> <span class="nx">echarts</span><span class="p">.</span><span class="nx">init</span><span class="p">(</span><span class="nb">document</span><span class="p">.</span><span class="nx">getElementById</span><span class="p">(</span><span class="s1">&#39;J_chartBarBox&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">       <span class="c1">// this.chartBar.setOption(option)
</span></span></span><span class="line"><span class="cl"><span class="c1"></span>        <span class="nb">window</span><span class="p">.</span><span class="nx">addEventListener</span><span class="p">(</span><span class="s1">&#39;resize&#39;</span><span class="p">,</span> <span class="p">()</span> <span class="p">=&gt;</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">          <span class="k">this</span><span class="p">.</span><span class="nx">chartBar</span><span class="p">.</span><span class="nx">resize</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">        <span class="p">})</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>     
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">script</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="p">&lt;</span><span class="nt">style</span> <span class="na">lang</span><span class="o">=</span><span class="s">&#34;scss&#34;</span><span class="p">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="p">.</span><span class="nx">mod</span><span class="o">-</span><span class="nx">demo</span><span class="o">-</span><span class="nx">echarts</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">    <span class="o">&gt;</span> <span class="p">.</span><span class="nx">el</span><span class="o">-</span><span class="nx">alert</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">margin</span><span class="o">-</span><span class="nx">bottom</span><span class="o">:</span> <span class="mi">10</span><span class="nx">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="o">&gt;</span> <span class="p">.</span><span class="nx">el</span><span class="o">-</span><span class="nx">row</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">margin</span><span class="o">-</span><span class="nx">top</span><span class="o">:</span> <span class="o">-</span><span class="mi">10</span><span class="nx">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="nx">margin</span><span class="o">-</span><span class="nx">bottom</span><span class="o">:</span> <span class="o">-</span><span class="mi">10</span><span class="nx">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">.</span><span class="nx">el</span><span class="o">-</span><span class="nx">col</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">        <span class="nx">padding</span><span class="o">-</span><span class="nx">top</span><span class="o">:</span> <span class="mi">10</span><span class="nx">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">        <span class="nx">padding</span><span class="o">-</span><span class="nx">bottom</span><span class="o">:</span> <span class="mi">10</span><span class="nx">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">      <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">    <span class="p">.</span><span class="nx">chart</span><span class="o">-</span><span class="nx">box</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">      <span class="nx">min</span><span class="o">-</span><span class="nx">height</span><span class="o">:</span> <span class="mi">400</span><span class="nx">px</span><span class="p">;</span>
</span></span><span class="line"><span class="cl">    <span class="p">}</span>
</span></span><span class="line"><span class="cl">  <span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="p">&lt;/</span><span class="nt">style</span><span class="p">&gt;</span>
</span></span></code></pre></div><h3 id="613-配置用户注册统计菜单">6.1.3 配置用户注册统计菜单</h3>
<p><img src="/posts/project/20220528232959/image-20220528234506567.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>新增菜单后，刷新，即可查看菜单
<img src="/posts/project/20220528232959/image-20220528234513583.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>点击题目数量统计可以查看按照题目分类统计的数量柱状图
<img src="/posts/project/20220528232959/image-20220528234520645.png"
    
    
    
    loading="lazy"
    
    
></p>

            </div>
            <hr>
            <div style="text-align: center;">
                <button class="btn"><a href="https://lovemjh.github.io/posts/project/20220528231163/">← tk-题库项目基本框架搭建</a></button>
                <button class="btn"><a href="https://lovemjh.github.io/posts/project/20220528234610/">tk-题库项目开发3 →</a></button>
            </div>

            
        </article><div class="aside_content" id="aside_content">
    <div class="card-widget card-info">
        <div class="card-content">
            <div class="card-info-avatar is-center">
                <img class="avatar-img" src="http://q1.qlogo.cn/g?b=qq&nk=2409741052&s=640" alt="avatar">
                <div class="author-info__name">青山</div>
                <div class="author-info__description">悟已往之不谏 知来者之可追</div>
            </div>
            
            <div class="card-info-social-icons is-center">
                <a class="social-icon" href="https://github.com/xioyito" target="_blank">
                    <i class="fa fa-github"></i>
                </a>
            </div>
            

        </div>
    </div>


    <div class="card-widget">
        <div class="card-content">
            <meting-js auto="https://music.163.com/?from=itab#/playlist?id=8181838897.html">
            </meting-js>
        </div>
    </div>

    <div class="card-widget">
        <div class="card-content">
            <div class="item-headline">
                <i class="fa fa-bullhorn" aria-hidden="true"></i>
                <span>一言</span>
            </div>
            <div id="hitokoto"></div>
        </div>
    </div>
    <div class="card-widget">
        <div class="card-content">
            <div class="item-headline">
                <i class="fa fa-calendar" aria-hidden="true"></i>
                <span>今日诗词</span>
            </div>
            <div id="jinrishici-sentence"></div>
        </div>
    </div>

    <div class="card-widget">
        <div class="card-content">
            <div class="item-headline">
                <i class="fa fa-line-chart" aria-hidden="true"></i>
                <span>站点信息</span>
            </div>
            <div class="webinfo">
                <div class="webinfo-item">
                    <div class="webinfo-site-uv-name">本站访客数 :</div>
                    <div class="webinfo-site-uv-count" id="busuanzi_value_site_uv"></div>
                </div>
                <div class="webinfo-item">
                    <div class="webinfo-site-name">本站总访问量 :</div>
                    <div class="webinfo-site-pv-count" id="busuanzi_value_site_pv"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="card-widget js-toc-w" id="js-toc-w">
        <div class="card-content js-toc">
            
        </div>
    </div>
    
</div></div>
</main>
<footer id="footer">
    <div id="footer-wrap">
        <div class="copyright">&copy;2019 - 2021 BY QING SHAN KE</div>
    </div>
</footer>
</div>

<div class="fan" id="fan" style="
position: fixed;
width: 40px;
height: 120px;
right: -200px;
bottom: 0px;
transition: all 0.5s;
z-index: 99999;
 ">
    <i class="fa fa-cog fa-spin fa-2x"></i><br>
    <i class="fa fa-align-justify fa-2x" id="ff"></i><br>
    <i class="fa fa fa-arrow-up fa-2x" id="aa"></i><br>
</div>


<script src="https://fastly.jsdelivr.net/npm/tocbot@4.21.1/dist/tocbot.min.js"></script>
<script src="https://fastly.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>


  
  <script src="https://fastly.jsdelivr.net/npm/jquery-pjax@2.0.1/jquery.pjax.min.js"></script> 

    <script type="text/javascript">
            $(function () {
                $(document).pjax('a', '#page', {
                    fragment: '#page',
                    timeout: 5000,
                    cache: false
                });
                $(document).on({
                    'pjax:click': function () {
                        
                        console.log("点击链接");
                    },
                    'pjax:start': function () {
                        
                        console.log("获取请求");
                    },
                    'pjax:end': function () {
                        
                        console.log("请求完成");
                        addNumbers();

                }
            });
        });

    </script>

    <script>
        function addNumbers() {
            
            
            var myElement = document.getElementById('js-toc-w');
            if (window.location.href.includes('/posts/')) {
                
                console.log('地址栏中包含 "/posts/"');
                tocbot.refresh();
                myElement.style.display = 'block';
            } else {
                
                initpageimg();
                console.log('地址栏中不包含 "/posts/"');
                myElement.style.display = 'none';
            }

        }
        function initpageimg() {
            const imgArr = [
                "https://pic1.zhimg.com/80/v2-23d671bf74a246c54b1256bd2322d461_720w.webp?source=1940ef5c",
                "https://pic1.zhimg.com/80/v2-3afad658b44f596b10ec13b2b6d4299d_720w.webp?source=1940ef5c",
                "https://picx.zhimg.com/80/v2-b83d637fafb72fd13a5922aa0038bff9_720w.webp?source=1940ef5c",
                "https://pic1.zhimg.com/80/v2-3afad658b44f596b10ec13b2b6d4299d_720w.webp?source=1940ef5c",
                "https://pic1.zhimg.com/80/v2-7ee6f104979814d2bf420461e3872475_720w.webp?source=1940ef5c",
                "https://picx.zhimg.com/80/v2-585754b4ab4d49f480b833cbbbf4839f_720w.webp?source=1940ef5c",
                "https://pic1.zhimg.com/80/v2-b3d8f74192b2940a1112c93797cc0815_720w.webp?source=1940ef5c",
            ];
            var objs = document.getElementsByClassName('page-img');
            for (var i = 0; i < objs.length; i++) {
                objs[i].id = "myid" + i;
                let randNum = Math.floor(Math.random() * imgArr.length);
                var odiv = document.getElementById("myid" + i);
                odiv.style.backgroundImage = `url(${imgArr[randNum]})`;
                
                odiv.style.backgroundRepeat = "no-repeat";
                odiv.style.backgroundPosition = "0px 0px";
            }
        }
    </script>

<script>
    var a = 0;
    ff.onclick = function () {
        if (a === 0) {
            $(".js-toc-w").css("position", "fixed"); 
            $(".js-toc-w").css("bottom", "10px");
            $(".js-toc-w").css("right", "40px");

            a++;
        } else {
            $(".js-toc-w").css("position", "static");
            a--;
        }
    }

    aa.onclick = function () {
        window.scrollTo({     
            top: 0,            
            behavior: "smooth"   
        })
    }

    
    window.onload = function () {
        $(".aplayer").css("background", "rgba(0, 0, 0, 0)");
        
        addNumbers();
        
    } 
</script>
<script>
    $(window).scroll(function () {
        var scrollY = document.documentElement.scrollTop || document.body.scrollTop
        if (scrollY > 40) {
            $('.fan').css("right", "0px");
        } else {
            $('.fan').css("right", "-220px");
        }
        if (scrollY > 600) {
            $(".js-toc-w").css("position", "fixed");
            $('.js-toc-w').css("right", "0px");
            $(".js-toc-w").css("bottom", "10px");
            $(".js-toc-w").css("right", "40px");
        } else {
            $(".js-toc-w").css("position", "fixed");
            $('.js-toc-w').css("right", "-220px");
        }
    });
    $(function () {
        
        var start_height = $(document).scrollTop();
        
        var navigation_height = $('.navigation').outerHeight();
        $(window).scroll(function () {
            
            var end_height = $(document).scrollTop();
            
            if (end_height > navigation_height) {
                $('.navigation').addClass('hide');
            } else {
                $('.navigation').removeClass('hide');
            }
            
            if (end_height < start_height) {
                $('.navigation').removeClass('hide');
            }
            
            start_height = $(document).scrollTop();
        });
    });
</script>

<script src="https://fastly.jsdelivr.net/npm/jquery.fancybox@2.1.5/source/jquery.fancybox.js"></script>

<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script src="https://fastly.jsdelivr.net/npm/instant.page@3.0.0/instantpage.js" type="module"></script>

<script src="https://fastly.jsdelivr.net/npm/lazysizes@5.2.0/lazysizes.min.js" async></script>


<link rel="stylesheet" href="https://fastly.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://fastly.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>

<script src="https://fastly.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>
<script>
  
  var meting_api='https://api.injahow.cn/meting/?server=:server&type=:type&id=:id&auth=:auth&r=:r';
</script>

<script src="https://fastly.jsdelivr.net/npm/nplayer@1.0.15/dist/index.min.js"></script>


<script src="https://v1.hitokoto.cn/?encode=js&select=%23hitokoto" defer></script>
<script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>





<script src="https://fastly.jsdelivr.net/gh/TRHX/CDN-for-itrhx.com@3.0.8/js/maodian.js"></script>



<script type="text/javascript">
    
    tocbot.init({
    
    tocSelector: '.js-toc',
    
    contentSelector: '.js-toc-content',
    
    headingSelector: 'h1, h2, h3, h4, h5 ,h6',
    
    hasInnerContainers: false,
    
    });
    console.clear();
    console.log("%c 有朋自远方来, 不亦说乎.", "background:#24272A; color:#ffffff", "");
    console.log("%c Github %c", "background:#24272A; color:#ffffff", "", "https://github.com/laoxuai");
    console.log("%c 版本号: %c", "background:#24272A; color:#ffffff", "", "1.0.0");

    (function ($) {
        $.fn.snow = function (options) {
            var $flake = $('<div id="snowbox" />').css({ 'position': 'absolute', 'z-index': '9999', 'top': '-50px' }).html('&#10052;'),
                documentHeight = $(document).height(),
                documentWidth = $(document).width(),
                defaults = {
                    minSize: 10,
                    maxSize: 20,
                    newOn: 1000,
                    flakeColor: "#AFDAEF"  
                },
                options = $.extend({}, defaults, options);
            var interval = setInterval(function () {
                var startPositionLeft = Math.random() * documentWidth - 100,
                    startOpacity = 0.5 + Math.random(),
                    sizeFlake = options.minSize + Math.random() * options.maxSize,
                    endPositionTop = documentHeight - 200,
                    endPositionLeft = startPositionLeft - 500 + Math.random() * 500,
                    durationFall = documentHeight * 10 + Math.random() * 5000;
                $flake.clone().appendTo('body').css({
                    left: startPositionLeft,
                    opacity: startOpacity,
                    'font-size': sizeFlake,
                    color: options.flakeColor
                }).animate({
                    top: endPositionTop,
                    left: endPositionLeft,
                    opacity: 0.2
                }, durationFall, 'linear', function () {
                    $(this).remove()
                });
            }, options.newOn);
        };
    })(jQuery);
    $(function () {
        $.fn.snow({
            minSize: 5,  
            maxSize: 50, 
            newOn: 800   
        });
    });

    
    var OriginTitle = document.title;
    var titleTime;
    document.addEventListener('visibilitychange', function () {
        if (document.hidden) {
            
            document.title = '╭(°A°`)╮ 页面崩溃啦 ~';
            clearTimeout(titleTime);
        }
        else {
            $('[rel="icon"]').attr('href', "/favicon.ico");
            document.title = '(ฅ>ω<*ฅ) 噫又好啦 ~' + OriginTitle;
            titleTime = setTimeout(function () {
                document.title = OriginTitle;
            }, 2000);
        }
    });
</script></body>
</html>