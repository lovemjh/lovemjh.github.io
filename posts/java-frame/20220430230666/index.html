<!DOCTYPE html>
<html lang="zh-CN"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="description" content="Mybatis-1 - https://lovemjh.vercel.app/posts/java-frame/20220430230666/">
    
    <meta name="msvalidate.01" content="B46311949B856F2A7015F366FB3CE878" />
    <title>Mybatis-1</title>
    <link rel="icon" type="image/png" href="/favicon.ico">
    
    <link rel="stylesheet" href="https://lovemjh.vercel.app/style.min.824365c118b34524ce845ac2a294220354719cca11af5b27a81b04c173bbba57.css">
    
    <script type="text/javascript" src="/main.js" defer></script>
    
</head>
<body class="active-animate cool">
        <div id="header"><div class="container-header">
    <div id="vars" class="container-vars" style="display: none;">
	{
		"hasFoldAllCodeBlocks": false,
		"svgColor": "#6c757d",
		"en": false,
		"dark": false
	}
</div>
    <h1 class="title">
        
            Mybatis-1
            
        
    </h1>

    <div class="container-breadcrumb-nav">
    
    <div class="breadcrumb-nav-bar">
        <div><a href="/"><svg t="1656411084410" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2954" width="16" height="16"><path d="M947.5 390.6l-377-290c-34.5-26.5-82.6-26.5-117.1 0l-377 290c-14 10.8-16.6 30.9-5.9 44.9 10.8 14 30.9 16.6 44.9 5.9l28.5-21.9V768c0 88.2 71.8 160 160 160h80c35.3 0 64-28.7 64-64V640c0-17.6 14.4-32 32-32h64c17.6 0 32 14.4 32 32v224c0 35.3 28.7 64 64 64h80c88.2 0 160-71.8 160-160V419.4l28.5 21.9c5.8 4.5 12.7 6.6 19.5 6.6 9.6 0 19.1-4.3 25.4-12.5 10.8-13.9 8.2-34-5.8-44.8zM816 768c0 52.9-43.1 96-96 96h-80V640c0-52.9-43.1-96-96-96h-64c-52.9 0-96 43.1-96 96v224h-80c-52.9 0-96-43.1-96-96V370.2l284.5-218.8c11.5-8.8 27.5-8.8 39 0L816 370.2V768z" fill=#6c757d p-id="2955"></path></svg></a></div>
        <div><a href="/nav"><svg t="1656411531924" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5827" width="16" height="16"><path d="M849.59197473 125.23018519L139.22930586 391.72854662a23.35052669 23.35052669 0 0 0-14.95414244 21.65490745c-0.12257519 9.70384955 5.61801843 18.46795771 14.40255493 22.04306141l318.42928099 129.25528056 119.51057092 320.39047893c3.06437293 8.23295069 10.35758221 13.89182751 18.7335381 14.87242563l2.7170774 0.14300521a22.79893918 22.79893918 0 0 0 21.20546682-15.36272638l259.51158924-729.54564933a23.8612558 23.8612558 0 0 0-5.31158128-24.55584682 22.3290685 22.3290685 0 0 0-23.9021142-5.43415649zM793.65694081 211.64552314l-196.63064161 552.75171747-91.91077952-246.37564122-253.62799211-102.96295445 542.16941324-203.4131218z" p-id="5828" fill=#6c757d></path></svg></a></div>
        <div><a href="/search"><svg t="1656411627509" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1730" width="14" height="14"><path d="M469.333333 85.333333c211.968 0 384 172.032 384 384s-172.032 384-384 384-384-172.032-384-384 172.032-384 384-384z m0 682.666667c164.992 0 298.666667-133.674667 298.666667-298.666667 0-165.034667-133.674667-298.666667-298.666667-298.666666-165.034667 0-298.666667 133.632-298.666666 298.666666 0 164.992 133.632 298.666667 298.666666 298.666667z m362.026667 3.029333l120.704 120.661334-60.373333 60.373333-120.661334-120.704 60.330667-60.330667z" p-id="1731" fill=#6c757d></path></svg></a></div>
        <div><a href="/posts"><svg t="1656411724198" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5655" width="12" height="12"><path d="M811.705761 1024H212.294239c-93.1199 0-174.823046-87.570975-174.823046-187.387854V162.322018C37.471193 69.776145 112.604921 0 212.294239 0H596.190595l7.015883 5.93161c111.74388 95.479788 185.857116 170.741078 279.614824 266.093304 29.65805 30.040735 61.165743 62.122454 96.436499 97.393211l7.271006 7.334787v459.859234c-0.063781 99.816879-81.703145 187.387854-174.823046 187.387854zM212.294239 49.94033c-72.391155 0-124.882716 47.261538-124.882716 112.381688v674.290128c0 71.94469 59.507443 137.383743 124.882716 137.383743h599.411522c65.311492 0 124.882716-65.439053 124.882716-137.383743V397.417876c-32.528184-32.464404-61.73977-62.250016-89.356836-90.377328-90.951355-92.418312-163.278729-165.957521-269.601245-257.163999H212.294239z" fill=#6c757d p-id="5656"></path><path d="M936.588477 449.526752h-212.326129c-99.753099 0-187.324073-81.703145-187.324073-174.823046V49.94033a25.002055 25.002055 0 0 1 49.94033 0v224.763376c0 65.311492 65.502834 124.882716 137.383743 124.882716h212.326129a25.002055 25.002055 0 1 1 0 49.94033z" fill=#6c757d p-id="5657"></path></svg></a></div>
        <div><a href="/archive"><svg t="1656411795742" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7334" width="12" height="12"><path d="M884.224 522.24H504.32V141.824c0-16.896-13.824-30.72-30.72-30.72-120.32 0-233.472 47.616-317.952 134.144S26.112 445.952 29.184 566.784c2.56 114.688 49.152 222.72 131.072 304.128 81.92 81.408 189.952 128 304.64 130.56h10.24c117.76 0 227.84-45.568 312.32-128.512 86.528-85.504 133.632-199.68 132.608-321.024-0.512-2.048-1.536-29.696-35.84-29.696z m-140.288 307.712c-74.752 73.728-173.056 112.64-277.504 110.592-205.824-4.608-370.688-169.472-375.296-374.784-3.072-104.448 35.84-202.752 108.544-277.504 65.536-67.072 151.552-107.52 243.712-114.688v378.88c0 16.896 13.824 30.72 30.72 30.72 129.024 0 311.296 0 382.976 0.512-6.144 93.184-46.08 179.712-113.152 246.272z" fill=#6c757d p-id="7335"></path><path d="M603.136 11.264c-8.192-0.512-15.872 3.072-22.016 8.704-5.632 5.632-9.216 13.824-9.216 22.016v378.88c0 16.896 13.824 30.72 30.72 30.72h378.88c16.896 0 30.72-13.824 30.72-30.72 0-223.744-183.808-407.552-409.088-409.6z m30.208 378.88V74.24c167.424 16.384 301.056 150.016 315.904 315.904h-315.904z" fill=#6c757d p-id="7336"></path></svg></a></div>
        <div id="light-dark" style="cursor: pointer;"><a><svg t="1656411842215" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5086" width="12" height="12"><path d="M1007.492874 384.513055c-8.795694-34.58307-21.189627-67.666874-36.682043-99.05151-2.698679-5.397358-10.894667-3.498287-10.894666 2.598728v0.299853c0 32.484098-6.896624 63.868734-19.890263 92.554691-10.694764 23.488501-25.487523 45.077933-43.978471 64.068635-41.779547 42.679107-99.05151 66.967217-158.722299 67.26707-61.869712 0.299853-119.941284-24.188159-162.920244-68.966238-40.280281-41.979449-62.56937-98.251902-62.269516-156.323473 0.399804-59.270984 23.588452-114.94373 65.567901-156.823229 19.59041-19.59041 42.179351-35.082826 66.667364-46.077443C672.956643 71.166451 704.041426 64.469729 736.125719 64.469729h1.299364c6.097015 0 8.096037-8.096037 2.598728-10.794715C708.739126 37.982696 675.655322 25.488812 641.172203 16.493216 599.492607 5.598549 555.714038-0.098662 510.536154 0.001289 222.37722 0.700947-7.41029 237.38508 0.185992 525.444064c7.096526 271.667008 225.889418 490.559851 497.456474 497.856279 287.559228 7.796183 524.14341-220.891864 525.842579-508.551044 0.299853-44.977981-5.297407-88.656599-15.992171-130.236244z m-83.15929 301.552378c-22.588942 53.27392-54.873137 101.250434-95.953027 142.330323-41.179841 41.179841-89.056403 73.464036-142.330324 95.953027-55.172991 23.288599-113.744317 35.182777-174.314666 35.182777s-119.141675-11.794226-174.314666-35.182777c-53.27392-22.588942-101.250434-54.873137-142.330323-95.953027-41.179841-41.179841-73.464036-89.056403-95.953027-142.330323C75.749001 630.892442 63.954774 572.221164 63.954774 511.750767s11.794226-119.141675 35.182777-174.314666c22.588942-53.27392 54.873137-101.250434 95.953027-142.330323 41.179841-41.179841 89.056403-73.464036 142.330323-95.953027C392.593892 75.7642 451.26517 63.969974 511.735567 63.969974c13.99315 0 27.886348 0.599706 41.679596 1.89907C489.246577 118.643209 448.266638 198.704016 448.266638 288.360126c0 159.022152 128.836929 287.859081 287.859081 287.859081 89.156354 0 168.817357-40.580134 221.691473-104.149015 1.099462 13.09359 1.699168 26.387082 1.699168 39.680575 0 60.470397-11.794226 119.141675-35.182776 174.314666z" p-id="5087" fill=#6c757d></path></svg></a></div>
        
    </div>

    
</div>

            <div id="toc">ğŸ“œ</div>
        
    
    
</div>
</div>
        <div id="content">












<div class="container-main 
     container-page 
">

    <div class="desc">
        
        <span>
            
            <svg t="1656736000388" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7409" width="12" height="12"><path d="M524.885333 338.986667L200.362667 663.466667c-17.28 15.274667-27.989333 36.693333-29.696 56.234666v133.76l130.730666 0.085334c22.784-1.621333 43.989333-12.245333 61.013334-31.701334l322.688-322.645333-160.213334-160.213333z m60.373334-60.330667l160.170666 160.213333 102.144-102.144a19.712 19.712 0 0 0 0-27.861333L715.093333 176.426667a19.456 19.456 0 0 0-27.605333 0L585.258667 278.613333zM701.312 85.333333c27.946667 0 54.741333 11.136 74.282667 30.848l132.309333 132.309334a105.045333 105.045333 0 0 1 0 148.565333L424.874667 879.957333c-29.824 34.346667-72.106667 55.466667-120.448 58.794667H85.333333v-42.666667l0.128-179.84c3.626667-44.970667 24.576-86.826667 56.448-114.944l485.12-485.034666A104.789333 104.789333 0 0 1 701.269333 85.333333z" p-id="7410" fill="#adb5bd"></path></svg>
            2022-03-20&nbsp;
        </span>
        <span>
            
            <svg t="1656737270708" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="23838" width="11" height="11"><path d="M824.264 95.36c0-23.859 25.043-44.16 48.902-44.16s49.714 20.301 49.714 44.16v190.08c0 23.859-19.054 52.868-42.913 52.868h-190.08c-23.859 0-46.696-25.96-46.696-49.819s22.55-46.249 46.409-46.249h82.025C702.344 175.534 610.22 155.853 512 155.853c-206.775 0-360.398 149.372-360.398 356.147 0 206.775 153.623 358.23 360.398 358.23 206.775 0 357.467-151.455 357.467-358.23 0-23.859 23.634-50.706 53.413-50.706 29.78 0 49.92 26.847 49.92 50.706 0 254.493-206.307 460.8-460.8 460.8-254.493 0-460.8-206.307-460.8-460.8C51.2 257.507 257.507 51.2 512 51.2c122.4 0 226.684 33.296 312.264 117.369 0.358 0.351 0.358-24.052 0-73.209z" p-id="23839" fill="#adb5bd"></path></svg>
            2022-03-20&nbsp;&nbsp;&nbsp;
        </span>
        <span>
            
            <svg t="1656737548689" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="33866" width="12" height="12"><path d="M832.038608 64.662657H192.030028C121.255125 64.662657 63.940169 121.98845 63.940169 192.694717v446.793671C63.940169 710.205493 121.255125 767.643272 192.030028 767.643272h133.353183a63.940169 63.940169 0 0 1 55.219742 31.576328l76.099638 129.83828c12.358154 21.093031 33.790754 31.626903 55.216129 31.626903s42.832688-10.544709 55.198067-31.619678l76.222461-129.870792a63.940169 63.940169 0 0 1 55.212517-31.551041h133.54103c70.576219 0 127.732228-57.289669 127.732227-127.800865V192.391272C959.825022 121.85479 902.643727 64.662657 832.038608 64.662657zM895.884854 639.842407A63.85347 63.85347 0 0 1 832.092795 703.703103h-133.54103a127.753903 127.753903 0 0 0-110.349172 63.09847l-76.222461 129.856342a0.274545 0.274545 0 0 1 0-0.050574h-0.032512s-0.021675 0.061411-0.032512 0.061412l-76.1466-129.85273A127.804477 127.804477 0 0 0 325.383211 703.703103H192.030028A64.207489 64.207489 0 0 1 127.880338 639.488388V192.694717A64.102729 64.102729 0 0 1 192.030028 128.602826h640.00858A63.799284 63.799284 0 0 1 895.884854 192.391272v447.451135z" fill="#adb5bd" p-id="33867"></path><path d="M608.154093 288.092004A31.970084 31.970084 0 0 0 576.184009 320.062089v160.078006l-134.650049-179.278119A31.970084 31.970084 0 0 0 384.002258 320.062089v255.760676a31.970084 31.970084 0 0 0 63.940169 0v-159.958796l134.650048 179.274507a31.970084 31.970084 0 0 0 57.531703-19.200113V320.062089a31.970084 31.970084 0 0 0-31.970085-31.970085z" fill="#adb5bd" p-id="33868"></path></svg>
            9772 å­—</span>&nbsp;
        <span>
            
            <svg t="1656737462334" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="32892" width="12" height="12"><path d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667z m0 810.666666c-204.8 0-373.333333-168.533333-373.333333-373.333333S307.2 138.666667 512 138.666667 885.333333 307.2 885.333333 512 716.8 885.333333 512 885.333333z" p-id="32893" fill="#adb5bd"></path><path d="M695.466667 567.466667l-151.466667-70.4V277.333333c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v238.933334c0 12.8 6.4 23.466667 19.2 29.866666l170.666667 81.066667c4.266667 2.133333 8.533333 2.133333 12.8 2.133333 12.8 0 23.466667-6.4 29.866666-19.2 6.4-14.933333 0-34.133333-17.066666-42.666666z" p-id="32894" fill="#adb5bd"></path></svg>
            20 åˆ†é’Ÿ</span><div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
			<a href="/categories/"></a>
			
		</div>
		<div class="tag">
			
			 - 
			
			<a href="/tags/"></a>
			
		</div>
	</div>
</div>
    </div>
    
    <div class="toc">
        
        <div class="page-operation">
            <div><a href="#"><img src="/imgs/icons/arrow-up-circle.svg" alt=""></a></div>
            <div><a href="https://lovemjh.vercel.app/posts/blog/20220430231095/"><img src="/imgs/icons/arrow-left-circle.svg" alt=""></a></div>
            <div><a href="https://lovemjh.vercel.app/posts/java-frame/20220430230955/"><img src="/imgs/icons/arrow-right-circle.svg" alt=""></a></div>
        </div>
        
        <nav id="TableOfContents">
  <ul>
    <li><a href="#mybatisç¯å¢ƒæ­å»º">Mybatisç¯å¢ƒæ­å»º</a>
      <ul>
        <li><a href="#å‰æœŸå‡†å¤‡">å‰æœŸå‡†å¤‡</a>
          <ul>
            <li><a href="#åˆ›å»ºæ•°æ®åº“">åˆ›å»ºæ•°æ®åº“</a></li>
            <li><a href="#åˆ›å»ºmaven-javaé¡¹ç›®">åˆ›å»ºmaven Javaé¡¹ç›®</a></li>
            <li><a href="#å¯¼å…¥ä¾èµ–">å¯¼å…¥ä¾èµ–</a></li>
          </ul>
        </li>
        <li><a href="#æ­å»ºé¡¹ç›®ç¯å¢ƒ">æ­å»ºé¡¹ç›®ç¯å¢ƒ</a>
          <ul>
            <li><a href="#ç¼–å†™userå®ä½“ç±»">ç¼–å†™Userå®ä½“ç±»</a></li>
            <li><a href="#ç¼–å†™æŒä¹…å±‚useræ¥å£">ç¼–å†™æŒä¹…å±‚Useræ¥å£</a></li>
            <li><a href="#ç¼–å†™æŒä¹…å±‚useræ¥å£æ˜ å°„æ–‡ä»¶userdaoxml">ç¼–å†™æŒä¹…å±‚Useræ¥å£æ˜ å°„æ–‡ä»¶UserDao.xml</a></li>
            <li><a href="#ç¼–å†™mybatisä¸»é…ç½®æ–‡ä»¶sqlmapconfigxml">ç¼–å†™mybatisä¸»é…ç½®æ–‡ä»¶SqlMapConfig.xml</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#mybatistå…¥é—¨æ¡ˆä¾‹">Mybatistå…¥é—¨æ¡ˆä¾‹</a>
      <ul>
        <li><a href="#å…¥é—¨æ¡ˆä¾‹ç¼–å†™">å…¥é—¨æ¡ˆä¾‹ç¼–å†™</a>
          <ul>
            <li><a href="#ç¼–å†™å·¥å…·ç±»è¯»å–é…ç½®æ–‡ä»¶">ç¼–å†™å·¥å…·ç±»è¯»å–é…ç½®æ–‡ä»¶</a></li>
            <li><a href="#ä½¿ç”¨ä»£ç†å¯¹è±¡æ“ä½œæ•°æ®åº“">ä½¿ç”¨ä»£ç†å¯¹è±¡æ“ä½œæ•°æ®åº“</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#mybatisæ‰§è¡ŒåŸç†åˆ†æ">Mybatisæ‰§è¡ŒåŸç†åˆ†æ</a>
      <ul>
        <li><a href="#é…ç½®æ–‡ä»¶åˆ†æ">é…ç½®æ–‡ä»¶åˆ†æ</a></li>
        <li><a href="#åº•å±‚æºç åˆ†æ">åº•å±‚æºç åˆ†æ</a></li>
        <li><a href="#æ‰§è¡ŒåŸç†å›¾">æ‰§è¡ŒåŸç†å›¾</a></li>
      </ul>
    </li>
    <li><a href="#mybatisåŸºäºä»£ç†daoå®ç°crudæ“ä½œ">MyBatisåŸºäºä»£ç†Daoå®ç°CRUDæ“ä½œ</a>
      <ul>
        <li><a href="#æ•°æ®ä¿å­˜">æ•°æ®ä¿å­˜</a>
          <ul>
            <li><a href="#å®šä¹‰æ•°æ®æ·»åŠ çš„æ¥å£æ–¹æ³•adduser">å®šä¹‰æ•°æ®æ·»åŠ çš„æ¥å£æ–¹æ³•addUser</a></li>
            <li><a href="#é…ç½®æ–‡ä»¶ä¸­é…ç½®å¯¹åº”çš„sql">é…ç½®æ–‡ä»¶ä¸­é…ç½®å¯¹åº”çš„sql</a></li>
            <li><a href="#æ·»åŠ æµ‹è¯•æ–¹æ³•">æ·»åŠ æµ‹è¯•æ–¹æ³•</a></li>
          </ul>
        </li>
        <li><a href="#æ•°æ®æ›´æ–°">æ•°æ®æ›´æ–°</a>
          <ul>
            <li><a href="#å®šä¹‰æ•°æ®æ›´æ–°çš„æ¥å£æ–¹æ³•updateuser">å®šä¹‰æ•°æ®æ›´æ–°çš„æ¥å£æ–¹æ³•updateUser</a></li>
            <li><a href="#é…ç½®æ–‡ä»¶ä¸­é…ç½®å¯¹åº”çš„sql-1">é…ç½®æ–‡ä»¶ä¸­é…ç½®å¯¹åº”çš„sql</a></li>
            <li><a href="#æ·»åŠ æµ‹è¯•æ–¹æ³•-1">æ·»åŠ æµ‹è¯•æ–¹æ³•</a></li>
          </ul>
        </li>
        <li><a href="#æ•°æ®åˆ é™¤">æ•°æ®åˆ é™¤</a>
          <ul>
            <li><a href="#å®šä¹‰æ•°æ®åˆ é™¤çš„æ¥å£æ–¹æ³•deleteuser">å®šä¹‰æ•°æ®åˆ é™¤çš„æ¥å£æ–¹æ³•deleteUser</a></li>
            <li><a href="#é…ç½®æ–‡ä»¶ä¸­é…ç½®å¯¹åº”çš„sql-2">é…ç½®æ–‡ä»¶ä¸­é…ç½®å¯¹åº”çš„sql</a></li>
            <li><a href="#æ·»åŠ æµ‹è¯•æ–¹æ³•-2">æ·»åŠ æµ‹è¯•æ–¹æ³•</a></li>
          </ul>
        </li>
        <li><a href="#å’Œçš„åŒºåˆ«">#{}å’Œ${}çš„åŒºåˆ«</a></li>
        <li><a href="#mybatiså®ç°æ¨¡ç³ŠæŸ¥è¯¢">MyBatiså®ç°æ¨¡ç³ŠæŸ¥è¯¢</a>
          <ul>
            <li><a href="#æ·»åŠ æ¨¡ç³ŠæŸ¥è¯¢çš„æ¥å£æ–¹æ³•likesearchusers">æ·»åŠ æ¨¡ç³ŠæŸ¥è¯¢çš„æ¥å£æ–¹æ³•likeSearchUsers</a></li>
            <li><a href="#é…ç½®æ¥å£æ–¹æ³•å¯¹åº”çš„sqlæ–‡ä»¶">é…ç½®æ¥å£æ–¹æ³•å¯¹åº”çš„sqlæ–‡ä»¶</a>
              <ul>
                <li><a href="#é…ç½®å ä½ç¬¦æ–¹å¼">é…ç½®å ä½ç¬¦æ–¹å¼#</a></li>
                <li><a href="#é…ç½®æ‹¼æ¥å­—ç¬¦ä¸²æ–¹å¼">é…ç½®æ‹¼æ¥å­—ç¬¦ä¸²æ–¹å¼$</a></li>
                <li><a href="#é…ç½®mysqlå‡½æ•°æ–¹å¼concat">é…ç½®mysqlå‡½æ•°æ–¹å¼concat</a></li>
              </ul>
            </li>
            <li><a href="#æ¨¡ç³ŠæŸ¥è¯¢æµ‹è¯•">æ¨¡ç³ŠæŸ¥è¯¢æµ‹è¯•</a></li>
          </ul>
        </li>
        <li><a href="#mybatisçš„å‚æ•°å¤„ç†">MyBatisçš„å‚æ•°å¤„ç†</a>
          <ul>
            <li><a href="#parametertype-é…ç½®å‚æ•°">parameterType é…ç½®å‚æ•°</a>
              <ul>
                <li><a href="#å‚æ•°çš„ä½¿ç”¨è¯´æ˜">å‚æ•°çš„ä½¿ç”¨è¯´æ˜</a></li>
                <li><a href="#å‚æ•°é…ç½®çš„æ³¨æ„äº‹é¡¹">å‚æ•°é…ç½®çš„æ³¨æ„äº‹é¡¹</a></li>
              </ul>
            </li>
            <li><a href="#ä¼ é€’-pojo-åŒ…è£…å¯¹è±¡">ä¼ é€’ pojo åŒ…è£…å¯¹è±¡</a>
              <ul>
                <li><a href="#ç¼–å†™queryvo">ç¼–å†™QueryVo</a></li>
                <li><a href="#ç¼–å†™æŒä¹…å±‚æ¥å£usermapper">ç¼–å†™æŒä¹…å±‚æ¥å£UserMapper</a></li>
                <li><a href="#é…ç½®æ¥å£æ–¹æ³•å¯¹åº”çš„sqlæ–‡ä»¶-1">é…ç½®æ¥å£æ–¹æ³•å¯¹åº”çš„sqlæ–‡ä»¶</a></li>
                <li><a href="#æµ‹è¯•queryvoå¯¹è±¡ä½œä¸ºå‚æ•°">æµ‹è¯•QueryVoå¯¹è±¡ä½œä¸ºå‚æ•°</a></li>
              </ul>
            </li>
            <li><a href="#mapé›†åˆæ•°æ®ä½œä¸ºå‚æ•°çš„å¤„ç†æ–¹å¼">mapé›†åˆæ•°æ®ä½œä¸ºå‚æ•°çš„å¤„ç†æ–¹å¼</a>
              <ul>
                <li><a href="#æ·»åŠ æ¥å£æ–¹æ³•å‚æ•°ä½¿ç”¨mapé›†åˆ">æ·»åŠ æ¥å£æ–¹æ³•å‚æ•°ä½¿ç”¨mapé›†åˆ</a></li>
                <li><a href="#é…ç½®æ¥å£å¯¹åº”çš„sqlé…ç½®">é…ç½®æ¥å£å¯¹åº”çš„sqlé…ç½®</a></li>
                <li><a href="#æµ‹è¯•mapé›†åˆä½œä¸ºå‚æ•°">æµ‹è¯•mapé›†åˆä½œä¸ºå‚æ•°</a></li>
              </ul>
            </li>
            <li><a href="#paramæ–¹å¼è§£å†³å¤šå‚æ•°å¤„ç†">@Paramæ–¹å¼è§£å†³å¤šå‚æ•°å¤„ç†</a>
              <ul>
                <li><a href="#paramæ³¨è§£çš„ä»‹ç»">@Paramæ³¨è§£çš„ä»‹ç»</a></li>
                <li><a href="#æ·»åŠ æ¥å£æ–¹æ³•å‚æ•°ä½¿ç”¨mapé›†åˆ-1">æ·»åŠ æ¥å£æ–¹æ³•å‚æ•°ä½¿ç”¨mapé›†åˆ</a></li>
                <li><a href="#é…ç½®æ¥å£å¯¹åº”çš„sqlé…ç½®-1">é…ç½®æ¥å£å¯¹åº”çš„sqlé…ç½®</a></li>
                <li><a href="#æµ‹è¯•æ³¨è§£æ–¹æ³•">æµ‹è¯•æ³¨è§£æ–¹æ³•</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#mybatisæŸ¥è¯¢ç»“æœå°è£…">MyBatisæŸ¥è¯¢ç»“æœå°è£…</a>
          <ul>
            <li><a href="#resulttypeç»“æœç±»å‹">resultTypeç»“æœç±»å‹</a>
              <ul>
                <li><a href="#resulttypeå±æ€§ä»‹ç»">resultTypeå±æ€§ä»‹ç»</a></li>
                <li><a href="#resulttypeå±æ€§çš„ä½¿ç”¨">resultTypeå±æ€§çš„ä½¿ç”¨</a>
                  <ul>
                    <li><a href="#åŸºæœ¬ç±»å‹">åŸºæœ¬ç±»å‹</a></li>
                    <li><a href="#å®ä½“ç±»å‹">å®ä½“ç±»å‹</a></li>
                    <li><a href="#ç‰¹æ®Šæƒ…å†µ">ç‰¹æ®Šæƒ…å†µ</a></li>
                  </ul>
                </li>
              </ul>
            </li>
            <li><a href="#resultmapè‡ªå®šä¹‰ç»“æœç±»å‹">resultMapè‡ªå®šä¹‰ç»“æœç±»å‹</a>
              <ul>
                <li><a href="#resultmapæ ‡ç­¾ä»‹ç»">resultMapæ ‡ç­¾ä»‹ç»</a></li>
                <li><a href="#å®šä¹‰æ¥å£æ–¹æ³•getuserbyid">å®šä¹‰æ¥å£æ–¹æ³•getUserById</a></li>
                <li><a href="#åœ¨sqlçš„é…ç½®æ–‡ä»¶ä¸­å®šä¹‰resultmap">åœ¨sqlçš„é…ç½®æ–‡ä»¶ä¸­å®šä¹‰resultMap</a></li>
                <li><a href="#ä½¿ç”¨å®šä¹‰çš„resultmapé…ç½®æŸ¥è¯¢çš„sqlè¯­å¥">ä½¿ç”¨å®šä¹‰çš„resultMapé…ç½®æŸ¥è¯¢çš„sqlè¯­å¥</a></li>
                <li><a href="#æµ‹è¯•æŸ¥è¯¢ç»“æœ">æµ‹è¯•æŸ¥è¯¢ç»“æœ</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#sqlmapconfigxmlé…ç½®æ–‡ä»¶å†…å®¹è§£æ">SqlMapConfig.xmlé…ç½®æ–‡ä»¶å†…å®¹è§£æ</a>
          <ul>
            <li><a href="#æ ‡ç­¾çš„é…ç½®è§„èŒƒæŸ¥çœ‹dtdè§„èŒƒæ–‡ä»¶">æ ‡ç­¾çš„é…ç½®è§„èŒƒï¼ŒæŸ¥çœ‹dtdè§„èŒƒæ–‡ä»¶</a></li>
            <li><a href="#propertiesæ ‡ç­¾è¯¦è§£">propertiesæ ‡ç­¾è¯¦è§£</a>
              <ul>
                <li><a href="#æ–°å»ºä¸€ä¸ªdbconfigpropertieså±æ€§æ–‡ä»¶">æ–°å»ºä¸€ä¸ªdbconfig.propertieså±æ€§æ–‡ä»¶</a></li>
                <li><a href="#åœ¨sqlmapperconfigxmlä¸­å¯ä»¥å¼•ç”¨å±æ€§æ–‡ä»¶ä¸­keyçš„å€¼">åœ¨SqlMapperConfig.xmlä¸­å¯ä»¥å¼•ç”¨å±æ€§æ–‡ä»¶ä¸­keyçš„å€¼</a></li>
              </ul>
            </li>
            <li><a href="#typealiasesæ ‡ç­¾è¯¦è§£">typeAliasesæ ‡ç­¾è¯¦è§£</a>
              <ul>
                <li><a href="#åœ¨sqlmapperconfigxmlä¸­å®šä¹‰åˆ«å">åœ¨SqlMapperConfig.xmlä¸­å®šä¹‰åˆ«å</a></li>
                <li><a href="#åœ¨usermapperxmlä¸­ä½¿ç”¨åˆ«å">åœ¨userMapper.xmlä¸­ä½¿ç”¨åˆ«å</a></li>
              </ul>
            </li>
            <li><a href="#mappersæ˜ å°„å™¨æ ‡ç­¾è¯¦è§£">mappersæ˜ å°„å™¨æ ‡ç­¾è¯¦è§£</a></li>
          </ul>
        </li>
        <li><a href="#mybatisè‡ªåŠ¨è¿”å›ä¸»é”®å€¼">MyBatisè‡ªåŠ¨è¿”å›ä¸»é”®å€¼</a>
          <ul>
            <li><a href="#è¿”å›ä¸»é”®å€¼æŠ€æœ¯çš„ä¸šåŠ¡åº”ç”¨åœºæ™¯">è¿”å›ä¸»é”®å€¼æŠ€æœ¯çš„ä¸šåŠ¡åº”ç”¨åœºæ™¯</a></li>
            <li><a href="#æ¥å£ä¸­ç¼–å†™adduseræ–¹æ³•">æ¥å£ä¸­ç¼–å†™addUseræ–¹æ³•</a></li>
            <li><a href="#åœ¨sqlçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æ¥å£æ–¹æ³•å¯¹åº”çš„sqlé…ç½®">åœ¨sqlçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æ¥å£æ–¹æ³•å¯¹åº”çš„sqlé…ç½®</a></li>
            <li><a href="#åœ¨sqlæ ‡ç­¾ä¸Šæ·»åŠ è¿”å›è‡ªå¢é•¿çš„ä¸»é”®å€¼çš„é…ç½®">åœ¨sqlæ ‡ç­¾ä¸Šæ·»åŠ è¿”å›è‡ªå¢é•¿çš„ä¸»é”®å€¼çš„é…ç½®</a></li>
            <li><a href="#æµ‹è¯•">æµ‹è¯•</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
    </div>

    <div class='content  content '>
        <h1 id="mybatisç¯å¢ƒæ­å»º">Mybatisç¯å¢ƒæ­å»º</h1>
<h2 id="å‰æœŸå‡†å¤‡">å‰æœŸå‡†å¤‡</h2>
<h3 id="åˆ›å»ºæ•°æ®åº“">åˆ›å»ºæ•°æ®åº“</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Sql" data-lang="Sql"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">create</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">table</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">user</span>(<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>id<span style="color:#bbb"> </span><span style="color:#0086b3">int</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">not</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">null</span><span style="color:#bbb"> </span>auto_increment,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>name<span style="color:#bbb"> </span><span style="color:#0086b3">varchar</span>(<span style="color:#099">30</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>gender<span style="color:#bbb"> </span><span style="color:#0086b3">varchar</span>(<span style="color:#099">6</span>),<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>age<span style="color:#bbb"> </span><span style="color:#0086b3">int</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>birthday<span style="color:#bbb"> </span><span style="color:#0086b3">date</span>,<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">primary</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">key</span>(id)<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>);<span style="color:#bbb"> 
</span></span></span></code></pre></div><h3 id="åˆ›å»ºmaven-javaé¡¹ç›®">åˆ›å»ºmaven Javaé¡¹ç›®</h3>
<blockquote>
<p>æ‰“å¼€Idear&ndash;&gt;é€‰æ‹©File&ndash;&gt;é€‰æ‹©new&ndash;&gt;é€‰æ‹©project</p>
</blockquote>
<h3 id="å¯¼å…¥ä¾èµ–">å¯¼å…¥ä¾èµ–</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>dependencies<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">&lt;</span>dependency<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">&lt;</span>groupId<span style="color:#000;font-weight:bold">&gt;</span>org<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mybatis</span><span style="color:#000;font-weight:bold">&lt;/</span>groupId<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">&lt;</span>artifactId<span style="color:#000;font-weight:bold">&gt;</span>mybatis<span style="color:#000;font-weight:bold">&lt;/</span>artifactId<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">&lt;</span>version<span style="color:#000;font-weight:bold">&gt;</span>3<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">4</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">6</span><span style="color:#000;font-weight:bold">&lt;/</span>version<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">&lt;/</span>dependency<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">&lt;</span>dependency<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">&lt;</span>groupId<span style="color:#000;font-weight:bold">&gt;</span>mysql<span style="color:#000;font-weight:bold">&lt;/</span>groupId<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">&lt;</span>artifactId<span style="color:#000;font-weight:bold">&gt;</span>mysql<span style="color:#000;font-weight:bold">-</span>connector<span style="color:#000;font-weight:bold">-</span>java<span style="color:#000;font-weight:bold">&lt;/</span>artifactId<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">&lt;</span>version<span style="color:#000;font-weight:bold">&gt;</span>5<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">1</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">47</span><span style="color:#000;font-weight:bold">&lt;/</span>version<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">&lt;</span>scope<span style="color:#000;font-weight:bold">&gt;</span>runtime<span style="color:#000;font-weight:bold">&lt;/</span>scope<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">&lt;/</span>dependency<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">&lt;</span>dependency<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">&lt;</span>groupId<span style="color:#000;font-weight:bold">&gt;</span>junit<span style="color:#000;font-weight:bold">&lt;/</span>groupId<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">&lt;</span>artifactId<span style="color:#000;font-weight:bold">&gt;</span>junit<span style="color:#000;font-weight:bold">&lt;/</span>artifactId<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">&lt;</span>version<span style="color:#000;font-weight:bold">&gt;</span>4<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">12</span><span style="color:#000;font-weight:bold">&lt;/</span>version<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">&lt;</span>scope<span style="color:#000;font-weight:bold">&gt;</span>test<span style="color:#000;font-weight:bold">&lt;/</span>scope<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">&lt;/</span>dependency<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">&lt;</span>dependency<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">&lt;</span>groupId<span style="color:#000;font-weight:bold">&gt;</span>log4j<span style="color:#000;font-weight:bold">&lt;/</span>groupId<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">&lt;</span>artifactId<span style="color:#000;font-weight:bold">&gt;</span>log4j<span style="color:#000;font-weight:bold">&lt;/</span>artifactId<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">&lt;</span>version<span style="color:#000;font-weight:bold">&gt;</span>1<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">2</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">17</span><span style="color:#000;font-weight:bold">&lt;/</span>version<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">&lt;/</span>dependency<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;/</span>dependencies<span style="color:#000;font-weight:bold">&gt;</span>
</span></span></code></pre></div><h2 id="æ­å»ºé¡¹ç›®ç¯å¢ƒ">æ­å»ºé¡¹ç›®ç¯å¢ƒ</h2>
<h3 id="ç¼–å†™userå®ä½“ç±»">ç¼–å†™Userå®ä½“ç±»</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">package</span> <span style="color:#555">cn.offcn.entity</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">java.io.Serializable</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">java.util.Date</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">User</span>  <span style="color:#000;font-weight:bold">implements</span> Serializable <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">private</span> Integer id<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">private</span> String name<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">private</span> String gender<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">private</span> Integer age<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">private</span> Date birthday<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#900;font-weight:bold">User</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#900;font-weight:bold">User</span><span style="color:#000;font-weight:bold">(</span>String name<span style="color:#000;font-weight:bold">,</span> String gender<span style="color:#000;font-weight:bold">,</span> Integer age<span style="color:#000;font-weight:bold">,</span> Date birthday<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">name</span> <span style="color:#000;font-weight:bold">=</span> name<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">gender</span> <span style="color:#000;font-weight:bold">=</span> gender<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">age</span> <span style="color:#000;font-weight:bold">=</span> age<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">birthday</span> <span style="color:#000;font-weight:bold">=</span> birthday<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//ç”Ÿæˆgetterå’Œsetteræ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="ç¼–å†™æŒä¹…å±‚useræ¥å£">ç¼–å†™æŒä¹…å±‚Useræ¥å£</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">interface</span> <span style="color:#458;font-weight:bold">UserDao</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">     * æŸ¥è¯¢æ‰€æœ‰Userå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">     * @return è¿”å›Listé›†åˆ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> List<span style="color:#000;font-weight:bold">&lt;</span>User<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#900;font-weight:bold">queryAllUsers</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="ç¼–å†™æŒä¹…å±‚useræ¥å£æ˜ å°„æ–‡ä»¶userdaoxml">ç¼–å†™æŒä¹…å±‚Useræ¥å£æ˜ å°„æ–‡ä»¶UserDao.xml</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Xml" data-lang="Xml"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">&lt;!DOCTYPE mapper
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">  PUBLIC &#34;-//mybatis.org//DTD Mapper 3.0//EN&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">  &#34;http://mybatis.org/dtd/mybatis-3-mapper.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;mapper</span> <span style="color:#008080">namespace=</span><span style="color:#d14">&#34;cn.offcn.dao.UserDao&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!--é…ç½®æŸ¥è¯¢çš„sqlè¯­å¥--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;select</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;queryAllUsers&#34;</span> <span style="color:#008080">resultType=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>   select * from user
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/select&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/mapper&gt;</span>
</span></span></code></pre></div><h3 id="ç¼–å†™mybatisä¸»é…ç½®æ–‡ä»¶sqlmapconfigxml">ç¼–å†™mybatisä¸»é…ç½®æ–‡ä»¶SqlMapConfig.xml</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Xml" data-lang="Xml"><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">&lt;!DOCTYPE configuration
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">  PUBLIC &#34;-//mybatis.org//DTD Config 3.0//EN&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#999;font-weight:bold;font-style:italic">  &#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;configuration&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- é…ç½® mybatisçš„ç¯å¢ƒ --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;environments</span> <span style="color:#008080">default=</span><span style="color:#d14">&#34;development&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!-- é…ç½®ç¯å¢ƒ --&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;environment</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;development&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#998;font-style:italic">&lt;!-- é…ç½®äº‹åŠ¡çš„ç±»å‹ --&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000080">&lt;transactionManager</span> <span style="color:#008080">type=</span><span style="color:#d14">&#34;JDBC&#34;</span><span style="color:#000080">&gt;&lt;/transactionManager&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#998;font-style:italic">&lt;!-- é…ç½®è¿æ¥æ•°æ®åº“çš„ä¿¡æ¯:ç”¨çš„æ˜¯æ•°æ®æºã€è¿æ¥æ± ã€‘--&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000080">&lt;dataSource</span> <span style="color:#008080">type=</span><span style="color:#d14">&#34;POOLED&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;driver&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;com.mysql.jdbc.Driver&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;url&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;jdbc:mysql://localhost:3306/mybatis001&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;username&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;root&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;password&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;root&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000080">&lt;/dataSource&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;/environment&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/environments&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!--  æ³¨å†ŒUserDaoæ¥å“æ˜ å°„æ–‡ä»¶ä½ç½® --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;mappers&gt;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000080">&lt;mapper</span> <span style="color:#008080">resource=</span><span style="color:#d14">&#34;cn/offcn/dao/UserDao.xml&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/mappers&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/configuration&gt;</span>
</span></span></code></pre></div><h1 id="mybatistå…¥é—¨æ¡ˆä¾‹">Mybatistå…¥é—¨æ¡ˆä¾‹</h1>
<h2 id="å…¥é—¨æ¡ˆä¾‹ç¼–å†™">å…¥é—¨æ¡ˆä¾‹ç¼–å†™</h2>
<h3 id="ç¼–å†™å·¥å…·ç±»è¯»å–é…ç½®æ–‡ä»¶">ç¼–å†™å·¥å…·ç±»è¯»å–é…ç½®æ–‡ä»¶</h3>
<p>åˆ©ç”¨Mybatiså¯¹æ•°æ®åº“è¿›è¡Œæ“ä½œæ—¶ï¼Œéƒ½éœ€è¦äº§ç”ŸMybatisæ€»é…ç½®æ–‡ä»¶çš„è¾“å…¥æµå¯¹è±¡ã€æ„å»ºSqlSessionFactoryBuilderå¯¹è±¡ã€è°ƒç”¨buildæ–¹æ³•è¿›äº§ç”ŸSqlSessionFactoryå·¥å‚å¯¹è±¡ã€è°ƒç”¨å·¥å‚ç±»openSession()æ–¹æ³•åˆ›å»ºSqlSessionå¯¹è±¡ï¼Œä»£ç å†—ä½™é‡å¤§ï¼Œæ­¥èšé¢‡æœ‰ç¹çï¼Œæ‰€ä»¥æˆ‘ä»¬å¯¹äº§ç”ŸSqlSessionå¯¹è±¡åˆ©ç”¨å·¥å…·ç±»è¿›è¡Œä¼˜åŒ–ã€‚</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">package</span> <span style="color:#555">cn.offcn</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">org.apache.ibatis.io.Resources</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">org.apache.ibatis.session.SqlSession</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">org.apache.ibatis.session.SqlSessionFactory</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">org.apache.ibatis.session.SqlSessionFactoryBuilder</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">java.io.InputStream</span><span style="color:#000;font-weight:bold">;</span> 
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">MyBatisUtils</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//å®šä¹‰é™æ€å˜é‡sqlSessionFactory
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">static</span>  SqlSessionFactory sqlSessionFactory<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//åˆ›å»ºé™æ€å—ï¼Œå½“MyBatisUtilsç±»è¢«åŠ è½½æ—¶ï¼Œè‡ªåŠ¨æ‰§è¡Œè¯¥é™æ€å—ï¼Œå§‹åˆæ•°æ®ã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">static</span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">try</span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#998;font-style:italic">//è·å–mybatisä¸»é…ç½®æ–‡ä»¶SqlMapperConfig.xmlçš„è¾“å…¥æµ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>      InputStream inputStream<span style="color:#000;font-weight:bold">=</span> Resources<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getResourceAsStream</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;SqlMapperConfig.xml&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>      <span style="color:#998;font-style:italic">//åˆ›å»ºSqlSessionFactoryBuilderæ„å»ºè€…å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>      SqlSessionFactoryBuilder sqlSessionFactoryBuilder <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> SqlSessionFactoryBuilder<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>      <span style="color:#998;font-style:italic">//è°ƒç”¨buildæ–¹æ³•è¿”å›SqlSessionFactoryå·¥å‚å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>      sqlSessionFactory <span style="color:#000;font-weight:bold">=</span> sqlSessionFactoryBuilder<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">build</span><span style="color:#000;font-weight:bold">(</span>inputStream<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span><span style="color:#000;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span>Exception e<span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>       e<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">printStackTrace</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>      System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;åˆå§‹åŒ–æ•°æ®å¤±å¤±è´¥&#34;</span><span style="color:#000;font-weight:bold">+</span>e<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMessage</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//åˆ›å»ºgetSqlSessionFactoryæ–¹æ³•è¿”å›SqlSessionFactoryå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> SqlSessionFactory <span style="color:#900;font-weight:bold">getSqlSessionFactory</span><span style="color:#000;font-weight:bold">(){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> sqlSessionFactory<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//åˆ›å»ºä¸€ä¸ªSqlSessionå¯¹è±¡å¹¶è¿”å›
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> SqlSession <span style="color:#900;font-weight:bold">getSession</span><span style="color:#000;font-weight:bold">(){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> sqlSessionFactory<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">openSession</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//å…³é—­SqlSessionæ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">close</span><span style="color:#000;font-weight:bold">(</span>SqlSession session<span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">if</span><span style="color:#000;font-weight:bold">(</span>session<span style="color:#000;font-weight:bold">!=</span><span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> session<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="ä½¿ç”¨ä»£ç†å¯¹è±¡æ“ä½œæ•°æ®åº“">ä½¿ç”¨ä»£ç†å¯¹è±¡æ“ä½œæ•°æ®åº“</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">UserTest</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testQueryAllUsers</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span>  Exception<span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">//1.è·å–mybatisä¸»é…ç½®æ–‡ä»¶SqlMapperConfig.xmlçš„è¾“å…¥æµ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  InputStream inputStream<span style="color:#000;font-weight:bold">=</span>Resources<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getResourceAsStream</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;SqlMapperConfig.xml&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">//2.åˆ›å»ºSqlSessionFactoryBuilderæ„å»ºè€…å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  SqlSessionFactoryBuilder sqlSessionFactoryBuilder <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> SqlSessionFactoryBuilder<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">//3.è°ƒç”¨buildæ–¹æ³•è¿”å›SqlSessionFactoryå·¥å‚å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  SqlSessionFactory sqlSessionFactory <span style="color:#000;font-weight:bold">=</span> sqlSessionFactoryBuilder<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">build</span><span style="color:#000;font-weight:bold">(</span>inputStream<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">//4.è°ƒç”¨sqlSessionFactoryçš„openSessionæ–¹æ³•è¿”å›ä¸€ä¸ªSessionå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  SqlSession sqlSession <span style="color:#000;font-weight:bold">=</span> sqlSessionFactory<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">openSession</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">//5.è°ƒç”¨SqlSession åˆ›å»º UserDaoæ¥å£çš„ä»£ç†å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  UserDao userDao <span style="color:#000;font-weight:bold">=</span> sqlSession<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>UserDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">//6.è°ƒç”¨ä»£ç†å¯¹è±¡çš„queryAllUsersæ–¹æ³•æŸ¥è¯¢æ‰€æœ‰User
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  List<span style="color:#000;font-weight:bold">&lt;</span>User<span style="color:#000;font-weight:bold">&gt;</span> users <span style="color:#000;font-weight:bold">=</span> userDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">queryAllUsers</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  users<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">forEach</span><span style="color:#000;font-weight:bold">(</span>System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">::</span>print<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">//7.é‡Šæ”¾èµ„æº
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  sqlSession<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  inputStream<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testQueryAllUsers2</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span>  Exception<span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span> <span style="color:#998;font-style:italic">//è°ƒç”¨MyBatisUtilså·¥å…·åˆ›å»ºSqlSessionå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  SqlSession sqlSession <span style="color:#000;font-weight:bold">=</span> MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSession</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">//è°ƒç”¨SqlSession åˆ›å»º UserDaoæ¥å£çš„ä»£ç†å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  UserDao userDao <span style="color:#000;font-weight:bold">=</span> sqlSession<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>UserDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">//è°ƒç”¨ä»£ç†å¯¹è±¡çš„queryAllUsersæ–¹æ³•æŸ¥è¯¢æ‰€æœ‰User
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  List<span style="color:#000;font-weight:bold">&lt;</span>User<span style="color:#000;font-weight:bold">&gt;</span> users <span style="color:#000;font-weight:bold">=</span> userDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">queryAllUsers</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  users<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">forEach</span><span style="color:#000;font-weight:bold">(</span>System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">::</span>print<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">//é‡Šæ”¾èµ„æº
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  sqlSession<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  inputStream<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h1 id="mybatisæ‰§è¡ŒåŸç†åˆ†æ">Mybatisæ‰§è¡ŒåŸç†åˆ†æ</h1>
<h2 id="é…ç½®æ–‡ä»¶åˆ†æ">é…ç½®æ–‡ä»¶åˆ†æ</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>1<span style="color:#000;font-weight:bold">.</span> æ ¸å¿ƒé…ç½®æ–‡ä»¶
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;?</span>xml version<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;1.0&#34;</span> encoding<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;UTF-8&#34;</span><span style="color:#000;font-weight:bold">?&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!</span>DOCTYPE configuration
</span></span><span style="display:flex;"><span>        PUBLIC <span style="color:#d14">&#34;-//mybatis.org//DTD Config 3.0//EN&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#d14">&#34;http://mybatis.org/dtd/mybatis-3-config.dtd&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>configuration<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">&lt;!--</span> é…ç½® mybatis çš„ç¯å¢ƒ <span style="color:#000;font-weight:bold">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">&lt;</span>environments <span style="color:#000;font-weight:bold">default</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;development&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">&lt;!--</span> é…ç½®çš„ç¯å¢ƒ <span style="color:#000;font-weight:bold">--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">&lt;</span>environment id<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;development&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">&lt;!--</span> é…ç½®äº‹åŠ¡çš„ç±»å‹ <span style="color:#000;font-weight:bold">--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">&lt;</span>transactionManager type<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;JDBC&#34;</span><span style="color:#000;font-weight:bold">&gt;&lt;/</span>transactionManager<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">&lt;!--</span> é…ç½®è¿æ¥æ•°æ®åº“çš„ä¿¡æ¯<span style="color:#000;font-weight:bold">:</span>ç”¨çš„æ˜¯æ•°æ®æº<span style="color:#a61717;background-color:#e3d2d2">ã€</span>è¿æ¥æ± <span style="color:#000;font-weight:bold">)</span><span style="color:#a61717;background-color:#e3d2d2">ã€‘</span><span style="color:#000;font-weight:bold">--&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">&lt;</span>dataSource type<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;POOLED&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">&lt;</span>property name<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;driver&#34;</span> value<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;com.mysql.jdbc.Driver&#34;</span><span style="color:#000;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">&lt;</span>property name<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;url&#34;</span> value<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;jdbc:mysql://localhost:3306/mybatis001&#34;</span><span style="color:#000;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">&lt;</span>property name<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;username&#34;</span> value<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;root&#34;</span><span style="color:#000;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">&lt;</span>property name<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;password&#34;</span> value<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;root&#34;</span><span style="color:#000;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">&lt;/</span>dataSource<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">&lt;/</span>environment<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">&lt;/</span>environments<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">&lt;!--</span>  æ³¨å†ŒUserDaoæ¥å“æ˜ å°„æ–‡ä»¶ä½ç½® <span style="color:#000;font-weight:bold">--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">&lt;</span>mappers<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">&lt;</span>mapper resource<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;cn/offcn/dao/UserDao.xml&#34;</span><span style="color:#000;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">&lt;/</span>mappers<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;/</span>configuration<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>æ ¸å¿ƒé…ç½®æ–‡ä»¶å‚æ•°è¯¦è§£<span style="color:#a61717;background-color:#e3d2d2">ï¼š</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">)</span>environmentæ ‡ç­¾ä¸­çš„idå±æ€§å€¼å¿…é¡»å’Œenvironmentsæ ‡ç­¾ä¸­çš„defaultå±æ€§ä¸€è‡´<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">(</span>2<span style="color:#000;font-weight:bold">)</span>äº‹åŠ¡ç®¡ç†å™¨<span style="color:#a61717;background-color:#e3d2d2">ï¼š</span>
</span></span><span style="display:flex;"><span>    ç¬¬ä¸€ç§é‡‡ç”¨JDBCäº‹åŠ¡ç±»å‹<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>ç›´æ¥ä½¿ç”¨äº† JDBCçš„æäº¤å’Œå›æ»šè®¾æ–½<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>å®ƒä¾èµ–ä»æ•°æ®æºè·å¾—çš„è¿æ¥æ¥ç®¡ç†äº‹åŠ¡ä½œç”¨åŸŸ<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span>    ç¬¬äºŒç§é‡‡ç”¨MANAGEDäº‹åŠ¡ç±»å‹<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>å®ƒä»ä¸æäº¤æˆ–å›æ»šä¸€ä¸ªè¿æ¥<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>è€Œæ˜¯è®©å®¹å™¨æ¥ç®¡ç†äº‹åŠ¡çš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸ<span style="color:#a61717;background-color:#e3d2d2">ï¼ˆ</span>æ¯”å¦‚ JEE åº”ç”¨æœåŠ¡å™¨çš„ä¸Šä¸‹æ–‡<span style="color:#a61717;background-color:#e3d2d2">ï¼‰ã€‚</span>é»˜è®¤æƒ…å†µä¸‹å®ƒä¼šå…³é—­è¿æ¥<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>ç„¶è€Œä¸€äº›å®¹å™¨å¹¶ä¸å¸Œæœ›è¿æ¥è¢«å…³é—­<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>å› æ­¤éœ€è¦å°† closeConnection å±æ€§è®¾ç½®ä¸º <span style="color:#000;font-weight:bold">false</span> æ¥é˜»æ­¢é»˜è®¤çš„å…³é—­è¡Œä¸º<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>ä¾‹å¦‚<span style="color:#000;font-weight:bold">:</span> 
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">&lt;</span>transactionManager type<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;MANAGED&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>       <span style="color:#000;font-weight:bold">&lt;</span>property name<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;closeConnection&#34;</span> value<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;false&#34;</span><span style="color:#000;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">&lt;/</span>transactionManager<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">(</span>3<span style="color:#000;font-weight:bold">)</span> æ•°æ®æº<span style="color:#a61717;background-color:#e3d2d2">ï¼ˆ</span>dataSource<span style="color:#a61717;background-color:#e3d2d2">ï¼‰</span>
</span></span><span style="display:flex;"><span>    dataSourceå…ƒç´ ä½¿ç”¨æ ‡å‡†çš„JDBCæ•°æ®æºæ¥å£æ¥é…ç½®JDBCè¿æ¥å¯¹è±¡çš„èµ„æº<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>å¤§å¤šæ•° MyBatis åº”ç”¨ç¨‹åºä¼šæŒ‰ç¤ºä¾‹ä¸­çš„ä¾‹å­æ¥é…ç½®æ•°æ®æº<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>     è™½ç„¶æ•°æ®æºé…ç½®æ˜¯å¯é€‰çš„<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>ä½†å¦‚æœè¦å¯ç”¨å»¶è¿ŸåŠ è½½ç‰¹æ€§<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>å°±å¿…é¡»é…ç½®æ•°æ®æº<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span>    æœ‰ä¸‰ç§å†…å»ºçš„æ•°æ®æºç±»å‹<span style="color:#a61717;background-color:#e3d2d2">ï¼ˆ</span>ä¹Ÿå°±æ˜¯ type<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;[UNPOOLED|POOLED|JNDI]&#34;</span><span style="color:#a61717;background-color:#e3d2d2">ï¼‰</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    UNPOOLED<span style="color:#a61717;background-color:#e3d2d2">â€“</span> è¿™ä¸ªæ•°æ®æºçš„å®ç°ä¼šæ¯æ¬¡è¯·æ±‚æ—¶æ‰“å¼€å’Œå…³é—­è¿æ¥<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>è™½ç„¶æœ‰ç‚¹æ…¢<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>ä½†å¯¹é‚£äº›æ•°æ®åº“è¿æ¥å¯ç”¨æ€§è¦æ±‚ä¸é«˜çš„ç®€å•åº”ç”¨ç¨‹åºæ¥è¯´<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span> æ€§èƒ½è¡¨ç°åˆ™ä¾èµ–äºä½¿ç”¨çš„æ•°æ®åº“<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>å¯¹æŸäº›æ•°æ®åº“æ¥è¯´<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>ä½¿ç”¨è¿æ¥æ± å¹¶ä¸é‡è¦<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>è¿™ä¸ªé…ç½®å°±å¾ˆé€‚åˆè¿™ç§æƒ…å½¢<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    POOLED<span style="color:#a61717;background-color:#e3d2d2">â€“</span> è¿™ç§æ•°æ®æºçš„å®ç°åˆ©ç”¨<span style="color:#a61717;background-color:#e3d2d2">â€œ</span>æ± <span style="color:#a61717;background-color:#e3d2d2">â€</span>çš„æ¦‚å¿µå°† JDBC è¿æ¥å¯¹è±¡ç»„ç»‡èµ·æ¥<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>é¿å…äº†åˆ›å»ºæ–°çš„è¿æ¥å®ä¾‹æ—¶æ‰€å¿…éœ€çš„åˆå§‹åŒ–å’Œè®¤è¯æ—¶é—´<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span> è¿™ç§å¤„ç†æ–¹å¼å¾ˆæµè¡Œ<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>èƒ½ä½¿å¹¶å‘ Web åº”ç”¨å¿«é€Ÿå“åº”è¯·æ±‚<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    JNDI <span style="color:#a61717;background-color:#e3d2d2">â€“</span> è¿™ä¸ªæ•°æ®æºå®ç°æ˜¯ä¸ºäº†èƒ½åœ¨å¦‚ EJB æˆ–åº”ç”¨æœåŠ¡å™¨è¿™ç±»å®¹å™¨ä¸­ä½¿ç”¨<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>å®¹å™¨å¯ä»¥é›†ä¸­æˆ–åœ¨å¤–éƒ¨é…ç½®æ•°æ®æº<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>ç„¶åæ”¾ç½®ä¸€ä¸ªJNDIä¸Šä¸‹æ–‡çš„æ•°æ®æºå¼•ç”¨<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">(</span>5<span style="color:#000;font-weight:bold">)</span> mapperä¸­çš„resourceå±æ€§ç”¨äºæŒ‡å®šæ˜ å°„æ–‡ä»¶çš„ä½ç½®<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>mapperä¸­æœ‰å¤šä¸ªå±æ€§å¯ä»¥æè¿°æ˜ å°„æ–‡ä»¶<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>åˆ†åˆ«ä¸º<span style="color:#a61717;background-color:#e3d2d2">ï¼š</span>
</span></span><span style="display:flex;"><span>        resource<span style="color:#000;font-weight:bold">=</span><span style="color:#a61717;background-color:#e3d2d2">â€œ</span>cn<span style="color:#000;font-weight:bold">/</span>offcn<span style="color:#000;font-weight:bold">/</span>dao<span style="color:#000;font-weight:bold">/</span>UserDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">xml</span><span style="color:#a61717;background-color:#e3d2d2">â€</span> æ–‡ä»¶åœ¨å¤šçº§ç›®å½•ä¸­è¦ç”¨åˆ†éš”ç¬¦<span style="color:#a61717;background-color:#e3d2d2">â€œ</span><span style="color:#000;font-weight:bold">/</span><span style="color:#a61717;background-color:#e3d2d2">â€</span>éš”å¼€<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span>        class<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;cn.offcn.dao.UserDao&#34;</span>  æŒ‡å®šUserDaoæ¥å£æ–‡ä»¶ä½ç½®<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>ä½†æ­¤æ—¶UserDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">xmlå¿…é¡»å’Œæ¥å£å¤„åœ¨åŒä¸€ä¸ªåŒ…ä¸­å¹¶ä¸”æ–‡ä»¶åè¦</span> ç›¸åŒ<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>2<span style="color:#000;font-weight:bold">.</span> æ˜ å°„æ–‡ä»¶
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>mapper namespace<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;cn.offcn.dao.UserDao&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!--</span>é…ç½®æŸ¥è¯¢çš„sqlè¯­å¥<span style="color:#000;font-weight:bold">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>select id<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;queryAllUsers&#34;</span> resultType<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>         select <span style="color:#000;font-weight:bold">*</span> from user
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;/</span>select<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;/</span>mapper<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>æ˜ å°„æ–‡ä»¶å‚æ•°è¯¦è§£<span style="color:#a61717;background-color:#e3d2d2">ï¼š</span> 
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">)</span> namespaceå¿…é¡»ä¸ºæ¥å£çš„å®Œå…¨é™å®šå<span style="color:#a61717;background-color:#e3d2d2">ï¼ˆ</span>å³åŒ…å<span style="color:#000;font-weight:bold">+</span>ç±»åçš„æ ¼å¼<span style="color:#a61717;background-color:#e3d2d2">ï¼‰ã€‚</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span>2<span style="color:#000;font-weight:bold">)</span> selectæ ‡ç­¾ä¸­çš„idå¿…é¡»å’Œæ¥å£ä¸­å£°æ˜çš„æ–¹æ³•åŒå<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">(</span>3<span style="color:#000;font-weight:bold">)</span> å¦‚æœæ¥å£ä¸­æ–¹æ³•æœ‰è¿”å›å€¼<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>resyultTypeå¿…é¡»è·Ÿæ–¹æ³•è¿”å›å€¼ä¸€è‡´å¹¶é‡‡ç”¨è¿”å›å€¼çš„å®Œå…¨é™å®šåæ¥è¡¨ç¤º<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span></code></pre></div><h2 id="åº•å±‚æºç åˆ†æ">åº•å±‚æºç åˆ†æ</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>1<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">åˆ©ç”¨Resourcesçš„getResourceAsStreamæ–¹æ³•è¯»å–mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶</span><span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>è¯¥é…ç½®æ–‡ä»¶ä¸­æ³¨å†Œæ•°æ®æº<span style="color:#a61717;background-color:#e3d2d2">ã€</span>dataSource<span style="color:#a61717;background-color:#e3d2d2">ã€‘</span>å’Œæ˜ å°„æ–‡ä»¶çš„ä½ç½®<span style="color:#a61717;background-color:#e3d2d2">ã€</span>mappersæ ‡ç­¾ä¸­çš„mapperå­æ ‡ç­¾çš„resourceå±æ€§<span style="color:#a61717;background-color:#e3d2d2">ã€‘ã€‚</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>dataSource type<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;POOLED&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">&lt;</span>property name<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;driver&#34;</span> value<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;com.mysql.jdbc.Driver&#34;</span><span style="color:#000;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">&lt;</span>property name<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;url&#34;</span> value<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;jdbc:mysql://localhost:3306/mybatis001&#34;</span><span style="color:#000;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">&lt;</span>property name<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;username&#34;</span> value<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;root&#34;</span><span style="color:#000;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">&lt;</span>property name<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;password&#34;</span> value<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;root&#34;</span><span style="color:#000;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;/</span>dataSource<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>mappers<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>mapper resource<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;cn/offcn/dao/UserDao.xml&#34;</span><span style="color:#000;font-weight:bold">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;/</span>mappers<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>2<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">å±•å¼€æ˜ å°„æ–‡ä»¶</span><span style="color:#a61717;background-color:#e3d2d2">ã€</span>UserDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">xml</span><span style="color:#a61717;background-color:#e3d2d2">ã€‘</span>ä¸­å®šä¹‰äº†æŸ¥è¯¢æ–¹æ³•<span style="color:#a61717;background-color:#e3d2d2">ã€</span>æŸ¥è¯¢æ—¶æ‰€å°è£…ç»“æœç±»å‹å’Œæ‰€è¦æ‰§è¡Œçš„sqlè¯­å¥<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>select id<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;queryAllUsers&#34;</span> resultType<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>   select <span style="color:#000;font-weight:bold">*</span> from user
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;/</span>select<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>3<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">ä½¿ç”¨æ„å»ºè€…æ¨¡å¼SqlSessionFactoryBuilderç±»çš„buildæ–¹æ³•åˆ›å»ºSqlSessionFactoryå¯¹è±¡</span><span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>åœ¨buildæ–¹æ³•ä¸­ä»å­—èŠ‚è¾“å…¥æµä¸­è§£ææ•°æ®<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span>SqlSessionFactoryBuilder sqlSessionFactoryBuilder <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> SqlSessionFactoryBuilder<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>sqlSessionFactory <span style="color:#000;font-weight:bold">=</span> sqlSessionFactoryBuilder<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">build</span><span style="color:#000;font-weight:bold">(</span>inputStream<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//SqlSessionFactoryBuilderæºç :
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//SqlSessionFactoryBuilderçš„buildæ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">public</span> SqlSessionFactory <span style="color:#900;font-weight:bold">build</span><span style="color:#000;font-weight:bold">(</span>InputStream inputStream<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">build</span><span style="color:#000;font-weight:bold">((</span>InputStream<span style="color:#000;font-weight:bold">)</span>inputStream<span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">(</span>Properties<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> SqlSessionFactory <span style="color:#900;font-weight:bold">build</span><span style="color:#000;font-weight:bold">(</span>InputStream inputStream<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">build</span><span style="color:#000;font-weight:bold">((</span>InputStream<span style="color:#000;font-weight:bold">)</span>inputStream<span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">(</span>Properties<span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> SqlSessionFactory <span style="color:#900;font-weight:bold">build</span><span style="color:#000;font-weight:bold">(</span>InputStream inputStream<span style="color:#000;font-weight:bold">,</span> String environment<span style="color:#000;font-weight:bold">,</span> Properties properties<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  SqlSessionFactory var5<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      XMLConfigBuilder parser <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> XMLConfigBuilder<span style="color:#000;font-weight:bold">(</span>inputStream<span style="color:#000;font-weight:bold">,</span> environment<span style="color:#000;font-weight:bold">,</span> properties<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>      var5 <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">build</span><span style="color:#000;font-weight:bold">(</span>parser<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">parse</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span>Exception var14<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">throw</span> ExceptionFactory<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">wrapException</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Error building SqlSession.&#34;</span><span style="color:#000;font-weight:bold">,</span> var14<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">finally</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      ErrorContext<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">instance</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">reset</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          inputStream<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span>IOException var13<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> var5<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> SqlSessionFactory <span style="color:#900;font-weight:bold">build</span><span style="color:#000;font-weight:bold">(</span>Configuration config<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">new</span> DefaultSqlSessionFactory<span style="color:#000;font-weight:bold">(</span>config<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//XMLConfigBuilderç±»çš„æ„é€ æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">public</span> <span style="color:#900;font-weight:bold">XMLConfigBuilder</span><span style="color:#000;font-weight:bold">(</span>InputStream inputStream<span style="color:#000;font-weight:bold">,</span> String environment<span style="color:#000;font-weight:bold">,</span> Properties props<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">new</span> XPathParser<span style="color:#000;font-weight:bold">(</span>inputStream<span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">true</span><span style="color:#000;font-weight:bold">,</span> props<span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">new</span> XMLMapperEntityResolver<span style="color:#000;font-weight:bold">()),</span> environment<span style="color:#000;font-weight:bold">,</span>props<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#900;font-weight:bold">XPathParser</span><span style="color:#000;font-weight:bold">(</span>InputStream inputStream<span style="color:#000;font-weight:bold">,</span> <span style="color:#458;font-weight:bold">boolean</span> validation<span style="color:#000;font-weight:bold">,</span> Properties variables<span style="color:#000;font-weight:bold">,</span> EntityResolver entityResolver<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">commonConstructor</span><span style="color:#000;font-weight:bold">(</span>validation<span style="color:#000;font-weight:bold">,</span> variables<span style="color:#000;font-weight:bold">,</span> entityResolver<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">document</span> <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createDocument</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">new</span> InputSource<span style="color:#000;font-weight:bold">(</span>inputStream<span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ä¸Šè¿°ä»£ç ä¸­æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åˆ›å»ºäº†ä¸€ä¸ªXMLConfigBuilderå¯¹è±¡ç”¨æ¥è§£æXML<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>æŠŠé…ç½®æ–‡ä»¶ä¸­æ‰€æœ‰æ ‡ç­¾åŠæ ‡ç­¾ä¸­å±æ€§å€¼æ”¾å°è£…åˆ°Configurationå¯¹è±¡ä¸­å¹¶è¿”å›SqlSessionFactoryå¯¹è±¡<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>4<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">è°ƒç”¨SqlSessionFactoryå¯¹è±¡çš„openSessionæ–¹æ³•è¿”å›ä¸€ä¸ªSqlSessionå¯¹è±¡</span><span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>SqlSessionFactoryæ˜¯ä¸€ä¸ªæ¥å£<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>æˆ‘ä»¬æ‰¾åˆ°å®ƒçš„å®ç°ç±»
</span></span><span style="display:flex;"><span>DefaultSqlSessionFactoryç±»<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>ç‚¹å‡»å®ƒçš„openSessionæ–¹æ³•<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>æ‰“å¼€openSessionFromDataSourceæ–¹æ³•<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//DefaultSqlSessionFactoryæºç :
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">private</span> SqlSession <span style="color:#900;font-weight:bold">openSessionFromDataSource</span><span style="color:#000;font-weight:bold">(</span>ExecutorType execType<span style="color:#000;font-weight:bold">,</span> TransactionIsolationLevel level<span style="color:#000;font-weight:bold">,</span>      <span style="color:#458;font-weight:bold">boolean</span> autoCommit<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  Transaction tx <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  DefaultSqlSession var8<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      Environment environment <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">configuration</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getEnvironment</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>      TransactionFactory transactionFactory <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getTransactionFactoryFromEnvironment</span><span style="color:#000;font-weight:bold">(</span>environment<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>      <span style="color:#998;font-style:italic">//åˆ›å»ºä¸€ä¸ªæ–°äº‹åŠ¡ï¼Œä»ç¯å¢ƒä¸­æ‰¾åˆ°æ•°æ®æºã€‚
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>      tx <span style="color:#000;font-weight:bold">=</span> transactionFactory<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">newTransaction</span><span style="color:#000;font-weight:bold">(</span>environment<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getDataSource</span><span style="color:#000;font-weight:bold">(),</span> level<span style="color:#000;font-weight:bold">,</span> autoCommit<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>      Executor executor <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">configuration</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">newExecutor</span><span style="color:#000;font-weight:bold">(</span>tx<span style="color:#000;font-weight:bold">,</span> execType<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>      <span style="color:#998;font-style:italic">//åˆ›å»ºä¸€ä¸ªDefaultSqlSessionå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>      var8 <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> DefaultSqlSession<span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">configuration</span><span style="color:#000;font-weight:bold">,</span> executor<span style="color:#000;font-weight:bold">,</span> autoCommit<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span>Exception var12<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">closeTransaction</span><span style="color:#000;font-weight:bold">(</span>tx<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">throw</span> ExceptionFactory<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">wrapException</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Error opening session.  Cause: &#34;</span> <span style="color:#000;font-weight:bold">+</span> var12<span style="color:#000;font-weight:bold">,</span> var12<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">finally</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>      ErrorContext<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">instance</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">reset</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> var8<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>5<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">è°ƒç”¨sqlSession</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>UserDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">)</span>æ–¹æ³•è¿”å›ä¸€ä¸ªUserDaoæ¥å£çš„ä»£ç†ç±»å¯¹è±¡<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//DefaultSqlSessionæºç :
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">&lt;</span>T<span style="color:#000;font-weight:bold">&gt;</span> T <span style="color:#900;font-weight:bold">getMapper</span><span style="color:#000;font-weight:bold">(</span>Class<span style="color:#000;font-weight:bold">&lt;</span>T<span style="color:#000;font-weight:bold">&gt;</span> type<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">return</span> configuration<span style="color:#000;font-weight:bold">.&lt;</span>T<span style="color:#000;font-weight:bold">&gt;</span>getMapper<span style="color:#000;font-weight:bold">(</span>type<span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//Configurationç±»æºç :
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">&lt;</span>T<span style="color:#000;font-weight:bold">&gt;</span> T <span style="color:#900;font-weight:bold">getMapper</span><span style="color:#000;font-weight:bold">(</span>Class<span style="color:#000;font-weight:bold">&lt;</span>T<span style="color:#000;font-weight:bold">&gt;</span> type<span style="color:#000;font-weight:bold">,</span> SqlSession sqlSession<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">return</span> mapperRegistry<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>type<span style="color:#000;font-weight:bold">,</span> sqlSession<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//MapperRegistryç±»æºç :
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">&lt;</span>T<span style="color:#000;font-weight:bold">&gt;</span> T <span style="color:#900;font-weight:bold">getMapper</span><span style="color:#000;font-weight:bold">(</span>Class<span style="color:#000;font-weight:bold">&lt;</span>T<span style="color:#000;font-weight:bold">&gt;</span> type<span style="color:#000;font-weight:bold">,</span> SqlSession sqlSession<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">final</span> MapperProxyFactory<span style="color:#000;font-weight:bold">&lt;</span>T<span style="color:#000;font-weight:bold">&gt;</span> mapperProxyFactory <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span>MapperProxyFactory<span style="color:#000;font-weight:bold">&lt;</span>T<span style="color:#000;font-weight:bold">&gt;)</span> knownMappers<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span>type<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>mapperProxyFactory <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">throw</span> <span style="color:#000;font-weight:bold">new</span> BindingException<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Type &#34;</span> <span style="color:#000;font-weight:bold">+</span> type <span style="color:#000;font-weight:bold">+</span> <span style="color:#d14">&#34; is not known to the MapperRegistry.&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">return</span> mapperProxyFactory<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">newInstance</span><span style="color:#000;font-weight:bold">(</span>sqlSession<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span>Exception e<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">throw</span> <span style="color:#000;font-weight:bold">new</span> BindingException<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Error getting mapper instance. Cause: &#34;</span> <span style="color:#000;font-weight:bold">+</span> e<span style="color:#000;font-weight:bold">,</span> e<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//MapperProxyFactoryç±»æºç :
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">public</span> T <span style="color:#900;font-weight:bold">newInstance</span><span style="color:#000;font-weight:bold">(</span>SqlSession sqlSession<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">final</span> MapperProxy<span style="color:#000;font-weight:bold">&lt;</span>T<span style="color:#000;font-weight:bold">&gt;</span> mapperProxy <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> MapperProxy<span style="color:#000;font-weight:bold">&lt;</span>T<span style="color:#000;font-weight:bold">&gt;(</span>sqlSession<span style="color:#000;font-weight:bold">,</span> mapperInterface<span style="color:#000;font-weight:bold">,</span> methodCache<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">return</span> newInstance<span style="color:#000;font-weight:bold">(</span>mapperProxy<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//é€šè¿‡Proxyçš„newProxyInstanceæ–¹æ³•åˆ›å»ºä»£ç†å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">protected</span> T <span style="color:#900;font-weight:bold">newInstance</span><span style="color:#000;font-weight:bold">(</span>MapperProxy<span style="color:#000;font-weight:bold">&lt;</span>T<span style="color:#000;font-weight:bold">&gt;</span> mapperProxy<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">(</span>T<span style="color:#000;font-weight:bold">)</span> Proxy<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">newProxyInstance</span><span style="color:#000;font-weight:bold">(</span>mapperInterface<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getClassLoader</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#000;font-weight:bold">new</span> Class<span style="color:#000;font-weight:bold">[]</span> <span style="color:#000;font-weight:bold">{</span> mapperInterface <span style="color:#000;font-weight:bold">},</span> mapperProxy<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//MapperProxyç±»æºç :
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//invokeå›è°ƒæ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">public</span> Object <span style="color:#900;font-weight:bold">invoke</span><span style="color:#000;font-weight:bold">(</span>Object proxy<span style="color:#000;font-weight:bold">,</span> Method method<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">[]</span> args<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Throwable <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>Object<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">equals</span><span style="color:#000;font-weight:bold">(</span>method<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getDeclaringClass</span><span style="color:#000;font-weight:bold">()))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> method<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">invoke</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">,</span> args<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>isDefaultMethod<span style="color:#000;font-weight:bold">(</span>method<span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">return</span> invokeDefaultMethod<span style="color:#000;font-weight:bold">(</span>proxy<span style="color:#000;font-weight:bold">,</span> method<span style="color:#000;font-weight:bold">,</span> args<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span>Throwable t<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">throw</span> ExceptionUtil<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">unwrapThrowable</span><span style="color:#000;font-weight:bold">(</span>t<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">final</span> MapperMethod mapperMethod <span style="color:#000;font-weight:bold">=</span> cachedMapperMethod<span style="color:#000;font-weight:bold">(</span>method<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨æ‰§è¡Œå™¨excuteæ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">return</span> mapperMethod<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">execute</span><span style="color:#000;font-weight:bold">(</span>sqlSession<span style="color:#000;font-weight:bold">,</span> args<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//MapperMethodç±»æºç :
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">public</span> Object <span style="color:#900;font-weight:bold">execute</span><span style="color:#000;font-weight:bold">(</span>SqlSession sqlSession<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">[]</span> args<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>Object result<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">switch</span> <span style="color:#000;font-weight:bold">(</span>command<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getType</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">case</span> INSERT<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>Object param <span style="color:#000;font-weight:bold">=</span> method<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">convertArgsToSqlCommandParam</span><span style="color:#000;font-weight:bold">(</span>args<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  result <span style="color:#000;font-weight:bold">=</span> rowCountResult<span style="color:#000;font-weight:bold">(</span>sqlSession<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">insert</span><span style="color:#000;font-weight:bold">(</span>command<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getName</span><span style="color:#000;font-weight:bold">(),</span> param<span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">break</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">case</span> UPDATE<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  Object param <span style="color:#000;font-weight:bold">=</span> method<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">convertArgsToSqlCommandParam</span><span style="color:#000;font-weight:bold">(</span>args<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  result <span style="color:#000;font-weight:bold">=</span> rowCountResult<span style="color:#000;font-weight:bold">(</span>sqlSession<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">update</span><span style="color:#000;font-weight:bold">(</span>command<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getName</span><span style="color:#000;font-weight:bold">(),</span> param<span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">break</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">case</span> DELETE<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  Object param <span style="color:#000;font-weight:bold">=</span> method<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">convertArgsToSqlCommandParam</span><span style="color:#000;font-weight:bold">(</span>args<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  result <span style="color:#000;font-weight:bold">=</span> rowCountResult<span style="color:#000;font-weight:bold">(</span>sqlSession<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">delete</span><span style="color:#000;font-weight:bold">(</span>command<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getName</span><span style="color:#000;font-weight:bold">(),</span> param<span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">break</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">case</span> SELECT<span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>method<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">returnsVoid</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">&amp;&amp;</span> method<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">hasResultHandler</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    executeWithResultHandler<span style="color:#000;font-weight:bold">(</span>sqlSession<span style="color:#000;font-weight:bold">,</span> args<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    result <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>method<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">returnsMany</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    result <span style="color:#000;font-weight:bold">=</span> executeForMany<span style="color:#000;font-weight:bold">(</span>sqlSession<span style="color:#000;font-weight:bold">,</span> args<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>method<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">returnsMap</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    result <span style="color:#000;font-weight:bold">=</span> executeForMap<span style="color:#000;font-weight:bold">(</span>sqlSession<span style="color:#000;font-weight:bold">,</span> args<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>method<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">returnsCursor</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    result <span style="color:#000;font-weight:bold">=</span> executeForCursor<span style="color:#000;font-weight:bold">(</span>sqlSession<span style="color:#000;font-weight:bold">,</span> args<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    Object param <span style="color:#000;font-weight:bold">=</span> method<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">convertArgsToSqlCommandParam</span><span style="color:#000;font-weight:bold">(</span>args<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    result <span style="color:#000;font-weight:bold">=</span> sqlSession<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">selectOne</span><span style="color:#000;font-weight:bold">(</span>command<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getName</span><span style="color:#000;font-weight:bold">(),</span> param<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">break</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">case</span> FLUSH<span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>  result <span style="color:#000;font-weight:bold">=</span> sqlSession<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">flushStatements</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">break</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">default</span><span style="color:#000;font-weight:bold">:</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">throw</span> <span style="color:#000;font-weight:bold">new</span> BindingException<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Unknown execution method for: &#34;</span> <span style="color:#000;font-weight:bold">+</span> command<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getName</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>result <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">null</span> <span style="color:#000;font-weight:bold">&amp;&amp;</span> method<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getReturnType</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">isPrimitive</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">&amp;&amp;</span> <span style="color:#000;font-weight:bold">!</span>method<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">returnsVoid</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">throw</span> <span style="color:#000;font-weight:bold">new</span> BindingException<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Mapper method &#39;&#34;</span> <span style="color:#000;font-weight:bold">+</span> command<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getName</span><span style="color:#000;font-weight:bold">()</span> 
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">+</span> <span style="color:#d14">&#34; attempted to return null from a method with a primitive return type (&#34;</span> <span style="color:#000;font-weight:bold">+</span> method<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getReturnType</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">+</span> <span style="color:#d14">&#34;).&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> result<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="æ‰§è¡ŒåŸç†å›¾">æ‰§è¡ŒåŸç†å›¾</h2>
<p><img src="/posts/Java-frame/file:/D:/Meet/Documents/Java%E5%AD%A6%E4%B9%A0/java%E7%AC%AC%E4%B8%89%E9%98%B6%E6%AE%B5/day01/01-%E7%AC%94%E8%AE%B0/images/mybatis%E6%89%A7%E8%A1%8C%E5%8E%9F%E7%90%86%E5%9B%BE.bmp?lastModify=1651586424"
    
    
    
    loading="lazy"
    
    
></p>
<h1 id="mybatisåŸºäºä»£ç†daoå®ç°crudæ“ä½œ">MyBatisåŸºäºä»£ç†Daoå®ç°CRUDæ“ä½œ</h1>
<h2 id="æ•°æ®ä¿å­˜">æ•°æ®ä¿å­˜</h2>
<h3 id="å®šä¹‰æ•°æ®æ·»åŠ çš„æ¥å£æ–¹æ³•adduser">å®šä¹‰æ•°æ®æ·»åŠ çš„æ¥å£æ–¹æ³•addUser</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">UserDao</span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">   æ–°å¢æ·»åŠ ç”¨æˆ·æ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">addUser</span><span style="color:#000;font-weight:bold">(</span>User user<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="é…ç½®æ–‡ä»¶ä¸­é…ç½®å¯¹åº”çš„sql">é…ç½®æ–‡ä»¶ä¸­é…ç½®å¯¹åº”çš„sql</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Xml" data-lang="Xml"><span style="display:flex;"><span><span style="color:#000080">&lt;insert</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;addUser&#34;</span> <span style="color:#008080">parameterType=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>insert into user(name,gender,age,birthday) values (#{name},#{gender},#{age},#{birthday})
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/insert&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>#{}ä¸ºmybatisçš„å ä½ç¬¦ï¼Œå¦‚æœæ–¹æ³•ä¸­ä¼ é€’çš„å‚æ•°ä¸ºå®ä½“ç±»ç±»å‹ï¼Œ#{å®ä½“ç±»å±æ€§}
</span></span></code></pre></div><h3 id="æ·»åŠ æµ‹è¯•æ–¹æ³•">æ·»åŠ æµ‹è¯•æ–¹æ³•</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testAddUser</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span>  Exception<span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è·å–SqlSessionå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>SqlSession session <span style="color:#000;font-weight:bold">=</span> MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSession</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨SqlSession åˆ›å»º UserDaoæ¥å£çš„ä»£ç†å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>UserDao userDao <span style="color:#000;font-weight:bold">=</span> session<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>UserDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//åˆ›å»ºUserå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>User user<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">new</span> User<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;ä½•æ™“&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#d14">&#34;ç”·&#34;</span><span style="color:#000;font-weight:bold">,</span>22<span style="color:#000;font-weight:bold">,</span><span style="color:#000;font-weight:bold">new</span> Date<span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨addUseræ–¹æ³•è¿›è¡Œä¿å­˜
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>userDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">addUser</span><span style="color:#000;font-weight:bold">(</span>user<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//å…³é—­è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">(</span>session<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="æ•°æ®æ›´æ–°">æ•°æ®æ›´æ–°</h2>
<h3 id="å®šä¹‰æ•°æ®æ›´æ–°çš„æ¥å£æ–¹æ³•updateuser">å®šä¹‰æ•°æ®æ›´æ–°çš„æ¥å£æ–¹æ³•updateUser</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">     * æ›´æ–°userå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">     * @param user
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">updateUser</span><span style="color:#000;font-weight:bold">(</span>User user<span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><h3 id="é…ç½®æ–‡ä»¶ä¸­é…ç½®å¯¹åº”çš„sql-1">é…ç½®æ–‡ä»¶ä¸­é…ç½®å¯¹åº”çš„sql</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Xml" data-lang="Xml"><span style="display:flex;"><span><span style="color:#000080">&lt;update</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;updateUser&#34;</span> <span style="color:#008080">parameterType=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>update user set name=#{name},gender=#{gender},age=#{age},birthday=#{birthday}  where id=#{id}
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/update&gt;</span>
</span></span></code></pre></div><h3 id="æ·»åŠ æµ‹è¯•æ–¹æ³•-1">æ·»åŠ æµ‹è¯•æ–¹æ³•</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Test</span>  
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testUpdateUser</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span> Â Exception<span style="color:#000;font-weight:bold">{</span>  
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è·å–SqlSessionå¯¹è±¡  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>SqlSession session <span style="color:#000;font-weight:bold">=</span> MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSession</span><span style="color:#000;font-weight:bold">();</span>  
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨SqlSession åˆ›å»º UserDaoæ¥å£çš„ä»£ç†å¯¹è±¡  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>UserDao userDao <span style="color:#000;font-weight:bold">=</span> session<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>UserDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">);</span>  
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//åˆ›å»ºUserå¯¹è±¡  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>User user<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">new</span> User<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;ä½•æ™“é£&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#d14">&#34;å¥³&#34;</span><span style="color:#000;font-weight:bold">,</span>21<span style="color:#000;font-weight:bold">,</span><span style="color:#000;font-weight:bold">new</span> Date<span style="color:#000;font-weight:bold">());</span>  
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//æŒ‡å®šè¦æ›´æ–°id  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>user<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setId</span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">);</span>  
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨updateUseræ–¹æ³•è¿›è¡Œä¿®æ”¹  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>userDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">updateUser</span><span style="color:#000;font-weight:bold">(</span>user<span style="color:#000;font-weight:bold">);</span>  
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//å…³é—­è¿æ¥  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">(</span>session<span style="color:#000;font-weight:bold">);</span>  
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="æ•°æ®åˆ é™¤">æ•°æ®åˆ é™¤</h2>
<h3 id="å®šä¹‰æ•°æ®åˆ é™¤çš„æ¥å£æ–¹æ³•deleteuser">å®šä¹‰æ•°æ®åˆ é™¤çš„æ¥å£æ–¹æ³•deleteUser</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">     * æ ¹æ®idåˆ é™¤æŒ‡å®šuser
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">     * @param id
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">     */</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">deleteUser</span><span style="color:#000;font-weight:bold">(</span>Integer id<span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><h3 id="é…ç½®æ–‡ä»¶ä¸­é…ç½®å¯¹åº”çš„sql-2">é…ç½®æ–‡ä»¶ä¸­é…ç½®å¯¹åº”çš„sql</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Xml" data-lang="Xml"><span style="display:flex;"><span><span style="color:#000080">&lt;delete</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;deleteUser&#34;</span> <span style="color:#008080">parameterType=</span><span style="color:#d14">&#34;int&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>delete from user where id=#{id}
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/delete&gt;</span>
</span></span></code></pre></div><h3 id="æ·»åŠ æµ‹è¯•æ–¹æ³•-2">æ·»åŠ æµ‹è¯•æ–¹æ³•</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testDeleteUser</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span>  Exception<span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">//è·å–SqlSessionå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  SqlSession session <span style="color:#000;font-weight:bold">=</span> MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSession</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">//è°ƒç”¨SqlSession åˆ›å»º UserDaoæ¥å£çš„ä»£ç†å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  UserDao userDao <span style="color:#000;font-weight:bold">=</span> session<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>UserDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">//è°ƒç”¨deleteUseræ–¹æ³•è¿›è¡Œåˆ é™¤
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  userDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">deleteUser</span><span style="color:#000;font-weight:bold">(</span>2<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">//å…³é—­è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">(</span>session<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="å’Œçš„åŒºåˆ«">#{}å’Œ${}çš„åŒºåˆ«</h2>
<pre tabindex="0"><code>1.#{}æ˜¯é¢„ç¼–è¯‘å¤„ç†ï¼Œ${}æ˜¯å­—ç¬¦ä¸²æ›¿æ¢ã€‚  
2.Mybatisåœ¨å¤„ç†${}æ—¶ï¼Œå°±æ˜¯æŠŠ${}æ›¿æ¢æˆå˜é‡çš„å€¼ã€‚  
3.Mybatisåœ¨å¤„ç†#{}æ—¶ï¼Œä¼šå°† sql ä¸­çš„#{}æ›¿æ¢ä¸º?å·ï¼Œè°ƒç”¨ PreparedStatement çš„ set æ–¹æ³•æ¥èµ‹å€¼ã€‚  
4.ä½¿ç”¨#{}å¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢ SQL æ³¨å…¥ï¼Œæé«˜ç³»ç»Ÿå®‰å…¨æ€§ã€‚
</code></pre><h2 id="mybatiså®ç°æ¨¡ç³ŠæŸ¥è¯¢">MyBatiså®ç°æ¨¡ç³ŠæŸ¥è¯¢</h2>
<p>æ¨¡ç³ŠæŸ¥è¯¢åœ¨æˆ‘ä»¬å¼€å‘ä¸­æ˜¯ä¸€é¡¹å¿…ä¸å¯ç¼ºå°‘çš„é‡è¦å†…å®¹ã€‚å¯¹äºæˆ‘ä»¬mybatiså®ç°æ¨¡ç³ŠæŸ¥è¯¢æœ‰ä¸‰ç§æ–¹å¼ï¼Œä»¥ä¸‹å…·ä½“çš„å®ç°æ­¥èšï¼š</p>
<h3 id="æ·»åŠ æ¨¡ç³ŠæŸ¥è¯¢çš„æ¥å£æ–¹æ³•likesearchusers">æ·»åŠ æ¨¡ç³ŠæŸ¥è¯¢çš„æ¥å£æ–¹æ³•likeSearchUsers</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">/**  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    * æ ¹æ®nameæ¨¡ç³ŠæŸ¥è¯¢  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    * @param name  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    * @return  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">    */</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> List<span style="color:#000;font-weight:bold">&lt;</span>User<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#900;font-weight:bold">likeSearcherUsers</span><span style="color:#000;font-weight:bold">(</span>String name<span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><h3 id="é…ç½®æ¥å£æ–¹æ³•å¯¹åº”çš„sqlæ–‡ä»¶">é…ç½®æ¥å£æ–¹æ³•å¯¹åº”çš„sqlæ–‡ä»¶</h3>
<h4 id="é…ç½®å ä½ç¬¦æ–¹å¼">é…ç½®å ä½ç¬¦æ–¹å¼#</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Xml" data-lang="Xml"><span style="display:flex;"><span><span style="color:#000080">&lt;select</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;likeSearcherUsers&#34;</span> <span style="color:#008080">parameterType=</span><span style="color:#d14">&#34;String&#34;</span> <span style="color:#008080">resultType=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    select * from user where name like â€™%â€˜ #{name} â€™%â€˜
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/select&gt;</span>
</span></span></code></pre></div><h4 id="é…ç½®æ‹¼æ¥å­—ç¬¦ä¸²æ–¹å¼">é…ç½®æ‹¼æ¥å­—ç¬¦ä¸²æ–¹å¼$</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Xml" data-lang="Xml"><span style="display:flex;"><span><span style="color:#000080">&lt;select</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;likeSearcherUsers&#34;</span> <span style="color:#008080">parameterType=</span><span style="color:#d14">&#34;String&#34;</span> <span style="color:#008080">resultType=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000080">&gt;</span>  
</span></span><span style="display:flex;"><span>    select * from user where name like &#39;%${value}%&#39;  
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/select&gt;</span>  
</span></span></code></pre></div><p>æˆ‘ä»¬åœ¨ä¸Šé¢å°†åŸæ¥çš„#{}å ä½ç¬¦ï¼Œæ”¹æˆäº†<code>${value}</code>ã€‚æ³¨æ„å¦‚æœç”¨æ¨¡ç³ŠæŸ¥è¯¢çš„è¿™ç§å†™æ³•ï¼Œé‚£ä¹ˆ<code>${value}</code>çš„å†™æ³•å°±æ˜¯å›ºå®šçš„ï¼Œä¸èƒ½å†™æˆå…¶å®ƒåå­—ã€‚</p>
<h4 id="é…ç½®mysqlå‡½æ•°æ–¹å¼concat">é…ç½®mysqlå‡½æ•°æ–¹å¼concat</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Xml" data-lang="Xml"><span style="display:flex;"><span><span style="color:#000080">&lt;select</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;likeSearcherUsers&#34;</span> <span style="color:#008080">parameterType=</span><span style="color:#d14">&#34;String&#34;</span> <span style="color:#008080">resultType=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000080">&gt;</span>  
</span></span><span style="display:flex;"><span>    select * from user where name like concat(&#39;%&#39;,#{name},&#39;%&#39;)  
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/select&gt;</span>
</span></span></code></pre></div><h3 id="æ¨¡ç³ŠæŸ¥è¯¢æµ‹è¯•">æ¨¡ç³ŠæŸ¥è¯¢æµ‹è¯•</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Test</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testSearcherUser</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span> Â Exception<span style="color:#000;font-weight:bold">{</span>  
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//è·å–SqlSessionå¯¹è±¡  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        SqlSession session <span style="color:#000;font-weight:bold">=</span> MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSession</span><span style="color:#000;font-weight:bold">();</span>  
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//è°ƒç”¨SqlSession åˆ›å»º UserDaoæ¥å£çš„ä»£ç†å¯¹è±¡  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        UserDao userDao <span style="color:#000;font-weight:bold">=</span> session<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>UserDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">);</span>  
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//è°ƒç”¨likeSearcherUsersræ–¹æ³•è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        List<span style="color:#000;font-weight:bold">&lt;</span>User<span style="color:#000;font-weight:bold">&gt;</span> userList <span style="color:#000;font-weight:bold">=</span> userDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">likeSearcherUsers</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;å¼ &#34;</span><span style="color:#000;font-weight:bold">);</span>  
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//éå†è¾“å‡º  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        userList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">forEach</span><span style="color:#000;font-weight:bold">(</span>System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">::</span>print<span style="color:#000;font-weight:bold">);</span>  
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//å…³é—­è¿æ¥  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">(</span>session<span style="color:#000;font-weight:bold">);</span>  
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="mybatisçš„å‚æ•°å¤„ç†">MyBatisçš„å‚æ•°å¤„ç†</h2>
<h3 id="parametertype-é…ç½®å‚æ•°">parameterType é…ç½®å‚æ•°</h3>
<h4 id="å‚æ•°çš„ä½¿ç”¨è¯´æ˜">å‚æ•°çš„ä½¿ç”¨è¯´æ˜</h4>
<p>ä¸Šä¸€ç« èŠ‚ä¸­å·²ç»ä»‹ç»äº†SQLè¯­å¥ä¼ å‚ï¼Œä½¿ç”¨æ ‡ç­¾çš„ parameterType å±æ€§æ¥è®¾å®šã€‚è¯¥å±æ€§çš„å–å€¼å¯ä»¥æ˜¯åŸºæœ¬ç±»å‹ï¼Œå¼•ç”¨ç±»å‹ï¼ˆä¾‹å¦‚:String ç±»å‹ï¼‰ï¼Œè¿˜å¯ä»¥æ˜¯å®ä½“ç±»ç±»å‹ï¼ˆPOJO ç±»ï¼‰ã€‚åŒæ—¶ä¹Ÿå¯ä»¥ä½¿ç”¨å®ä½“ç±»çš„åŒ…è£…ç±»ï¼Œæœ¬ç« èŠ‚å°†ä»‹ç»å¦‚ä½•ä½¿ç”¨å®ä½“ç±»çš„åŒ…è£…ç±»ä½œä¸ºå‚æ•°ä¼ é€’ã€‚</p>
<h4 id="å‚æ•°é…ç½®çš„æ³¨æ„äº‹é¡¹">å‚æ•°é…ç½®çš„æ³¨æ„äº‹é¡¹</h4>
<ul>
<li>åŸºæœ¬ç±»å‹å’ŒStringå¯ä»¥ç›´æ¥å†™ç±»å‹åç§°ä¹Ÿå¯ä»¥ä½¿ç”¨åŒ…å.ç±»åçš„æ–¹å¼ï¼Œä¾‹å¦‚ï¼šjava.lang.Stringã€‚</li>
<li>å®ä½“ç±»ç±»å‹ï¼Œç›®å‰æˆ‘ä»¬åªèƒ½ä½¿ç”¨å…¨é™å®šç±»åã€‚</li>
<li>ç©¶å…¶åŸå› ï¼Œæ˜¯mybaitsåœ¨åŠ è½½æ—¶å·²ç»æŠŠå¸¸ç”¨çš„æ•°æ®ç±»å‹æ³¨å†Œäº†åˆ«åï¼Œä»è€Œæˆ‘ä»¬åœ¨ä½¿ç”¨æ—¶å¯ä»¥ä¸å†™åŒ…åï¼Œè€Œæˆ‘ä»¬çš„æ˜¯å®ä½“ç±»å¹¶æ²¡æœ‰æ³¨å†Œåˆ«åï¼Œæ‰€ä»¥å¿…é¡»å†™å…¨é™å®šç±»åã€‚åœ¨ä»Šå¤©è¯¾ç¨‹çš„æœ€åä¸€ä¸ªç« èŠ‚ä¸­å°†è®²è§£å¦‚ä½•æ³¨å†Œå®ä½“ç±»çš„åˆ«åã€‚</li>
<li>mybatis çš„å®˜æ–¹æ–‡æ¡£çš„è¯´æ˜è¯·å‚è€ƒä¸‹é¢è¡¨æ ¼æ•°æ®ã€‚</li>
</ul>
<table>
<thead>
<tr>
<th><strong>åˆ«å</strong></th>
<th><strong>æ˜ å°„çš„ç±»å‹</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>_byte</td>
<td>byte</td>
</tr>
<tr>
<td>_long</td>
<td>long</td>
</tr>
<tr>
<td>_short</td>
<td>short</td>
</tr>
<tr>
<td>_int</td>
<td>int</td>
</tr>
<tr>
<td>_integer</td>
<td>int</td>
</tr>
<tr>
<td>_double</td>
<td>double</td>
</tr>
<tr>
<td>_float</td>
<td>float</td>
</tr>
<tr>
<td>_boolean</td>
<td>boolean</td>
</tr>
<tr>
<td>string</td>
<td>String</td>
</tr>
<tr>
<td>byte</td>
<td>Byte</td>
</tr>
<tr>
<td>long</td>
<td>Long</td>
</tr>
<tr>
<td>short</td>
<td>Short</td>
</tr>
<tr>
<td>int</td>
<td>Integer</td>
</tr>
<tr>
<td>integer</td>
<td>Integer</td>
</tr>
<tr>
<td>double</td>
<td>Double</td>
</tr>
<tr>
<td>float</td>
<td>Float</td>
</tr>
<tr>
<td>boolean</td>
<td>Boolean</td>
</tr>
<tr>
<td>date</td>
<td>Date</td>
</tr>
<tr>
<td>decimal</td>
<td>BigDecimal</td>
</tr>
<tr>
<td>bigdecimal</td>
<td>BigDecimal</td>
</tr>
<tr>
<td>object</td>
<td>Object</td>
</tr>
<tr>
<td>map</td>
<td>Map</td>
</tr>
<tr>
<td>hashmap</td>
<td>HashMap</td>
</tr>
<tr>
<td>list</td>
<td>List</td>
</tr>
<tr>
<td>arraylist</td>
<td>ArrayList</td>
</tr>
<tr>
<td>collection</td>
<td>Collection</td>
</tr>
<tr>
<td>iterator</td>
<td>Iterator</td>
</tr>
</tbody>
</table>
<p>è¿™äº›éƒ½æ˜¯æ”¯æŒçš„é»˜è®¤åˆ«åã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥ä»æºç è§’åº¦æ¥çœ‹å®ƒä»¬åˆ†åˆ«éƒ½æ˜¯å¦‚ä½•å®šä¹‰å‡ºæ¥çš„ã€‚å¯ä»¥å‚è€ƒ TypeAliasRegistery.class çš„æºç </p>
<h3 id="ä¼ é€’-pojo-åŒ…è£…å¯¹è±¡">ä¼ é€’ pojo åŒ…è£…å¯¹è±¡</h3>
<p>å¼€å‘ä¸­é€šè¿‡ pojo ä¼ é€’æŸ¥è¯¢æ¡ä»¶ ï¼ŒæŸ¥è¯¢æ¡ä»¶æ˜¯ç»¼åˆçš„æŸ¥è¯¢æ¡ä»¶ï¼Œä¸ä»…åŒ…æ‹¬ç”¨æˆ·æŸ¥è¯¢æ¡ä»¶è¿˜åŒ…æ‹¬å…¶å®ƒçš„æŸ¥è¯¢æ¡ä»¶ï¼ˆæ¯”å¦‚å°†ç”¨æˆ·è´­ä¹°å•†å“ä¿¡æ¯ä¹Ÿä½œä¸ºæŸ¥è¯¢æ¡ä»¶ï¼‰ï¼Œè¿™æ—¶å¯ä»¥ä½¿ç”¨åŒ…è£…å¯¹è±¡ä¼ é€’è¾“å…¥å‚æ•°ï¼ŒPojo ç±»ä¸­åŒ…å« pojoã€‚
éœ€æ±‚ï¼šæ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ï¼ŒæŸ¥è¯¢æ¡ä»¶æ”¾åˆ° QueryVo çš„ user å±æ€§ä¸­ã€‚</p>
<h4 id="ç¼–å†™queryvo">ç¼–å†™QueryVo</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">package</span> <span style="color:#555">cn.offcn.entity</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">QueryVo</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">private</span> User user<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> User <span style="color:#900;font-weight:bold">getUser</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">return</span> user<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">setUser</span><span style="color:#000;font-weight:bold">(</span>User user<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">user</span> <span style="color:#000;font-weight:bold">=</span> user<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="ç¼–å†™æŒä¹…å±‚æ¥å£usermapper">ç¼–å†™æŒä¹…å±‚æ¥å£UserMapper</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">interface</span> <span style="color:#458;font-weight:bold">UserMapper</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> List<span style="color:#000;font-weight:bold">&lt;</span>User<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#900;font-weight:bold">getUserByLikeName</span><span style="color:#000;font-weight:bold">(</span>QueryVo queryVo<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="é…ç½®æ¥å£æ–¹æ³•å¯¹åº”çš„sqlæ–‡ä»¶-1">é…ç½®æ¥å£æ–¹æ³•å¯¹åº”çš„sqlæ–‡ä»¶</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Xml" data-lang="Xml"><span style="display:flex;"><span><span style="color:#000080">&lt;select</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;getUserByLikeName&#34;</span> <span style="color:#008080">parameterType=</span><span style="color:#d14">&#34;cn.offcn.entity.QueryVo&#34;</span> <span style="color:#008080">resultType=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    select * from user where name like #{user.name}
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/select&gt;</span>
</span></span></code></pre></div><h4 id="æµ‹è¯•queryvoå¯¹è±¡ä½œä¸ºå‚æ•°">æµ‹è¯•QueryVoå¯¹è±¡ä½œä¸ºå‚æ•°</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testGetUserByLikeName</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span>  Exception<span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è·å–SqlSessionå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>SqlSession session <span style="color:#000;font-weight:bold">=</span> MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSession</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨SqlSession åˆ›å»º UserDaoæ¥å£çš„ä»£ç†å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>UserMapper userMapper <span style="color:#000;font-weight:bold">=</span> session<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>UserMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//åˆ›å»ºUserå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>User user<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">new</span> User<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>user<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setName</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;%æ%&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>QueryVo queryVo<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">new</span> QueryVo<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>queryVo<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setUser</span><span style="color:#000;font-weight:bold">(</span>user<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨deleteUseræ–¹æ³•è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>List<span style="color:#000;font-weight:bold">&lt;</span>User<span style="color:#000;font-weight:bold">&gt;</span> userList <span style="color:#000;font-weight:bold">=</span> userMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getUserByLikeName</span><span style="color:#000;font-weight:bold">(</span>queryVo<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>userList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">forEach</span><span style="color:#000;font-weight:bold">(</span>System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">::</span>print<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//å…³é—­è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">(</span>session<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="mapé›†åˆæ•°æ®ä½œä¸ºå‚æ•°çš„å¤„ç†æ–¹å¼">mapé›†åˆæ•°æ®ä½œä¸ºå‚æ•°çš„å¤„ç†æ–¹å¼</h3>
<h4 id="æ·»åŠ æ¥å£æ–¹æ³•å‚æ•°ä½¿ç”¨mapé›†åˆ">æ·»åŠ æ¥å£æ–¹æ³•å‚æ•°ä½¿ç”¨mapé›†åˆ</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> List<span style="color:#000;font-weight:bold">&lt;</span>User<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#900;font-weight:bold">getUserByGenderAndAge</span><span style="color:#000;font-weight:bold">(</span>Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span>Object<span style="color:#000;font-weight:bold">&gt;</span> map<span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><h4 id="é…ç½®æ¥å£å¯¹åº”çš„sqlé…ç½®">é…ç½®æ¥å£å¯¹åº”çš„sqlé…ç½®</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Xml" data-lang="Xml"><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!--#{}ä¸­å‚æ•°å¿…é¡»å’ŒMapé›†åˆä¸­çš„keyä¿å­˜ä¸€è‡´ï¼Œè¡¨ç¤ºå–Mapé›†åˆä¸­æŒ‡å®škeyçš„å€¼ã€‚--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;select</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;getUserByGenderAndAge&#34;</span> <span style="color:#008080">parameterType=</span><span style="color:#d14">&#34;java.util.Map&#34;</span> <span style="color:#008080">resultType=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    select * from user where gender=#{sex} and age=#{age}
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/select&gt;</span>
</span></span></code></pre></div><h4 id="æµ‹è¯•mapé›†åˆä½œä¸ºå‚æ•°">æµ‹è¯•mapé›†åˆä½œä¸ºå‚æ•°</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testGetUserByGenderAndAge</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span>  Exception<span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è·å–SqlSessionå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>SqlSession session <span style="color:#000;font-weight:bold">=</span> MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSession</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨SqlSession åˆ›å»º UserDaoæ¥å£çš„ä»£ç†å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>UserMapper userMapper <span style="color:#000;font-weight:bold">=</span> session<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>UserMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span>Object<span style="color:#000;font-weight:bold">&gt;</span> map<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">new</span> HashMap<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span>Object<span style="color:#000;font-weight:bold">&gt;();</span>
</span></span><span style="display:flex;"><span>map<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;sex&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#d14">&#34;ç”·&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>map<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;age&#34;</span><span style="color:#000;font-weight:bold">,</span>22<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>List<span style="color:#000;font-weight:bold">&lt;</span>User<span style="color:#000;font-weight:bold">&gt;</span> userList <span style="color:#000;font-weight:bold">=</span> userMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getUserByGenderAndAge</span><span style="color:#000;font-weight:bold">(</span>map<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>userList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">forEach</span><span style="color:#000;font-weight:bold">(</span>System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">::</span>print<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//å…³é—­è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">(</span>session<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="paramæ–¹å¼è§£å†³å¤šå‚æ•°å¤„ç†">@Paramæ–¹å¼è§£å†³å¤šå‚æ•°å¤„ç†</h3>
<h4 id="paramæ³¨è§£çš„ä»‹ç»">@Paramæ³¨è§£çš„ä»‹ç»</h4>
<p><code>@Param</code>æ³¨è§£ç”¨äºç»™æ–¹æ³•å†…çš„å‚æ•°å–åˆ«å,å½“æ–¹æ³•ä¸­æ‹¥æœ‰å¤šä¸ªå‚æ•°æ—¶ï¼Œæˆ‘ä»¬æ— æ³•ä¸€æ¬¡æ€§å°†è¿™äº›å‚æ•°è¿›è¡Œä¼ é€’ï¼Œå°¤å…¶å¤šä¸ªå‚æ•°å…·æœ‰ä¸åŒçš„æ•°æ®ç±»å‹æ—¶æ— æ³•ä¼ é€’ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨<code>@Param</code>ç»™æ¯ä¸ªæ–¹æ³•ä¸­çš„å‚æ•°å–ä¸€ä¸ªåˆ«åï¼Œåœ¨æ˜ å°„æ–‡ä»¶ä¸­ä½¿ç”¨åˆ«åè¿›è¡Œå–å€¼ã€‚</p>
<h4 id="æ·»åŠ æ¥å£æ–¹æ³•å‚æ•°ä½¿ç”¨mapé›†åˆ-1">æ·»åŠ æ¥å£æ–¹æ³•å‚æ•°ä½¿ç”¨mapé›†åˆ</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> List<span style="color:#000;font-weight:bold">&lt;</span>User<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#900;font-weight:bold">getUserByGenderAndBirthday</span><span style="color:#000;font-weight:bold">(</span><span style="color:#3c5d5d;font-weight:bold">@Param</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;gen&#34;</span><span style="color:#000;font-weight:bold">)</span> String gender<span style="color:#000;font-weight:bold">,</span>Param<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;birth&#34;</span><span style="color:#000;font-weight:bold">)</span> Date birthday<span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><h4 id="é…ç½®æ¥å£å¯¹åº”çš„sqlé…ç½®-1">é…ç½®æ¥å£å¯¹åº”çš„sqlé…ç½®</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Xml" data-lang="Xml"><span style="display:flex;"><span><span style="color:#000080">&lt;select</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;getUserByGenderAndBirthday&#34;</span> <span style="color:#008080">resultType=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    select * from user where gender=#{gen} and age=#{birth}
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/select&gt;</span>
</span></span></code></pre></div><h4 id="æµ‹è¯•æ³¨è§£æ–¹æ³•">æµ‹è¯•æ³¨è§£æ–¹æ³•</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testGetUserByGenderAndBithday</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span>  Exception<span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è·å–SqlSessionå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>SqlSession session <span style="color:#000;font-weight:bold">=</span> MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSession</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨SqlSession åˆ›å»º UserDaoæ¥å£çš„ä»£ç†å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>UserMapper userMapper <span style="color:#000;font-weight:bold">=</span> session<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>UserMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>Calendar calendar <span style="color:#000;font-weight:bold">=</span> Calendar<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getInstance</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>calendar<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">set</span><span style="color:#000;font-weight:bold">(</span>Calendar<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">YEAR</span><span style="color:#000;font-weight:bold">,</span>1997<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>calendar<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">set</span><span style="color:#000;font-weight:bold">(</span>Calendar<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">DAY_OF_MONTH</span><span style="color:#000;font-weight:bold">,</span>10<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>calendar<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">set</span><span style="color:#000;font-weight:bold">(</span>Calendar<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">DAY_OF_MONTH</span><span style="color:#000;font-weight:bold">,</span>12<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>Date birthday<span style="color:#000;font-weight:bold">=</span>calendar<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getTime</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>List<span style="color:#000;font-weight:bold">&lt;</span>User<span style="color:#000;font-weight:bold">&gt;</span> userList <span style="color:#000;font-weight:bold">=</span> userMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getUserByGenderAndBirthday</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;å¥³&#34;</span><span style="color:#000;font-weight:bold">,</span>birthday<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>userList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">forEach</span><span style="color:#000;font-weight:bold">(</span>System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">::</span>print<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//å…³é—­è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">(</span>session<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="mybatisæŸ¥è¯¢ç»“æœå°è£…">MyBatisæŸ¥è¯¢ç»“æœå°è£…</h2>
<h3 id="resulttypeç»“æœç±»å‹">resultTypeç»“æœç±»å‹</h3>
<h4 id="resulttypeå±æ€§ä»‹ç»">resultTypeå±æ€§ä»‹ç»</h4>
<p>resultType å±æ€§å¯ä»¥æŒ‡å®šç»“æœé›†çš„ç±»å‹ï¼Œå®ƒæ”¯æŒåŸºæœ¬ç±»å‹å’Œå®ä½“ç±»ç±»å‹ã€‚æˆ‘ä»¬åœ¨å‰é¢çš„ CRUD æ¡ˆä¾‹ä¸­å·²ç»å¯¹æ­¤å±æ€§è¿›è¡Œè¿‡åº”ç”¨äº†ã€‚éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå®ƒå’Œ parameterType ä¸€æ ·ï¼Œå¦‚æœæ³¨å†Œè¿‡ç±»å‹åˆ«åçš„ï¼Œå¯ä»¥ç›´æ¥ä½¿ç”¨åˆ«åã€‚æ²¡æœ‰æ³¨å†Œè¿‡çš„å¿…é¡»ä½¿ç”¨å…¨é™å®šç±»åã€‚ä¾‹å¦‚ï¼šæˆ‘ä»¬çš„å®ä½“ç±»æ­¤æ—¶å¿…é¡»æ˜¯å…¨é™å®šç±»åï¼ˆä»Šå¤©æœ€åä¸€ä¸ªç« èŠ‚ä¼šè®²è§£å¦‚ä½•é…ç½®å®ä½“ç±»çš„åˆ«åï¼‰åŒæ—¶ï¼Œå½“æ˜¯å®ä½“ç±»åç§°æ˜¯ï¼Œè¿˜æœ‰ä¸€ä¸ªè¦æ±‚ï¼Œå®ä½“ç±»ä¸­çš„å±æ€§åç§°å¿…é¡»å’ŒæŸ¥è¯¢è¯­å¥ä¸­çš„åˆ—åä¿æŒä¸€è‡´ï¼Œå¦åˆ™æ— æ³•å®ç°å°è£…ã€‚</p>
<h4 id="resulttypeå±æ€§çš„ä½¿ç”¨">resultTypeå±æ€§çš„ä½¿ç”¨</h4>
<h5 id="åŸºæœ¬ç±»å‹">åŸºæœ¬ç±»å‹</h5>
<ul>
<li>ç¼–å†™daoæ¥å£æ–¹æ³•getTotalRecordså‚æ•°æ˜¯åŸºæœ¬ç±»å‹</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">* ç»Ÿè®¡æ‰€æœ‰è®°å½•æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">* @return
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">int</span> <span style="color:#900;font-weight:bold">getTotalRecords</span><span style="color:#000;font-weight:bold">();</span>
</span></span></code></pre></div><ul>
<li>é…ç½®æ¥å£æ–¹æ³•å¯¹åº”çš„sqlè¯­å¥</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Xml" data-lang="Xml"><span style="display:flex;"><span><span style="color:#000080">&lt;select</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;getTotalRecords&#34;</span> <span style="color:#008080">resultType=</span><span style="color:#d14">&#34;int&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    select count(*) from user
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/select&gt;</span>
</span></span></code></pre></div><ul>
<li>æµ‹è¯•æŸ¥è¯¢ç»“æœ</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testGetTotalRecords</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span>  Exception<span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è·å–SqlSessionå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>SqlSession session <span style="color:#000;font-weight:bold">=</span> MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSession</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨SqlSession åˆ›å»º UserDaoæ¥å£çš„ä»£ç†å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>UserMapper userMapper <span style="color:#000;font-weight:bold">=</span> session<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>UserMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨getTotalRecordsç»Ÿè®¡è®°å½•æ•°
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#458;font-weight:bold">int</span> totalRecords<span style="color:#000;font-weight:bold">=</span> userMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getTotalRecords</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//æ‰“å°totalRecords
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;æ€»è®°å½•æ•°:&#34;</span><span style="color:#000;font-weight:bold">+</span>totalRecords<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//å…³é—­è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">(</span>session<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h5 id="å®ä½“ç±»å‹">å®ä½“ç±»å‹</h5>
<ul>
<li>ç¼–å†™daoæ¥å£æ–¹æ³•getAllInfoå‚æ•°æ˜¯å¯¹è±¡ç±»å‹</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> List<span style="color:#000;font-weight:bold">&lt;</span>User<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#900;font-weight:bold">getUsers</span><span style="color:#000;font-weight:bold">();</span>
</span></span></code></pre></div><ul>
<li>é…ç½®æ¥å£æ–¹æ³•å¯¹åº”çš„sqlè¯­å¥</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Xml" data-lang="Xml"><span style="display:flex;"><span><span style="color:#000080">&lt;select</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;getUsers&#34;</span> <span style="color:#008080">resultType=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    select * from user
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/select&gt;</span>
</span></span></code></pre></div><ul>
<li>æµ‹è¯•æŸ¥è¯¢ç»“æœ</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testGetUser</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span>  Exception<span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è·å–SqlSessionå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>SqlSession session <span style="color:#000;font-weight:bold">=</span> MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSession</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨SqlSession åˆ›å»º UserDaoæ¥å£çš„ä»£ç†å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>UserMapper userMapper <span style="color:#000;font-weight:bold">=</span> session<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>UserMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨getUsersæŸ¥è¯¢æ‰€æœ‰è®°å½•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>List<span style="color:#000;font-weight:bold">&lt;</span>User<span style="color:#000;font-weight:bold">&gt;</span> userList <span style="color:#000;font-weight:bold">=</span> userMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getUsers</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//éå†ç»“æœ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>userList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">forEach</span><span style="color:#000;font-weight:bold">(</span>System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">::</span>print<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//å…³é—­è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">(</span>session<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h5 id="ç‰¹æ®Šæƒ…å†µ">ç‰¹æ®Šæƒ…å†µ</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span>å¦‚æœä¸ªä¿®æ”¹äº†å®ä½“ç±»Userä¸­çš„idå±æ€§å€¼<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>æ¯”å¦‚ä¿®æ”¹æˆäº†userId<span style="color:#000;font-weight:bold">,</span>æ­¤æ—¶æŸ¥è¯¢å‡ºçš„ç»“æœæ²¡æœ‰æŠŠè¡¨ä¸­çš„idå€¼æ˜ å°„åˆ°userIdå±æ€§ä¸­<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>å› ä¸ºå±æ€§å’Œè¡¨ä¸­çš„åˆ—åä¸ä¸€è‡´<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>å†…éƒ¨æ— æ³•ç”¨åå°„æŠ€æœ¯è¿›è¡Œæ˜ å°„<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>æ‰€ä»¥ä¸ºç©º<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">User</span>  <span style="color:#000;font-weight:bold">implements</span> Serializable <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">private</span> Integer userId<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">private</span> String userName<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">private</span> String gender<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">private</span> Integer age<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">private</span> Date userBirthday<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#900;font-weight:bold">User</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#900;font-weight:bold">User</span><span style="color:#000;font-weight:bold">(</span>String userName<span style="color:#000;font-weight:bold">,</span> String gender<span style="color:#000;font-weight:bold">,</span> Integer age<span style="color:#000;font-weight:bold">,</span> Date userBirthday<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">userName</span> <span style="color:#000;font-weight:bold">=</span> userName<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">gender</span> <span style="color:#000;font-weight:bold">=</span> gender<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">age</span> <span style="color:#000;font-weight:bold">=</span> age<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">birthday</span> <span style="color:#000;font-weight:bold">=</span> userBirthday<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> Integer <span style="color:#900;font-weight:bold">getUserId</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">return</span> userId<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">setUserId</span><span style="color:#000;font-weight:bold">(</span>Integer userId<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">userId</span> <span style="color:#000;font-weight:bold">=</span> userId<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//ç”Ÿæˆå…¶å®ƒå±æ€§çš„getterå’Œsetteræ–¹æ³•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testGetUser</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span>  Exception<span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è·å–SqlSessionå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>SqlSession session <span style="color:#000;font-weight:bold">=</span> MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSession</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨SqlSession åˆ›å»º UserDaoæ¥å£çš„ä»£ç†å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>UserMapper userMapper <span style="color:#000;font-weight:bold">=</span> session<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>UserMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨getUsersæŸ¥è¯¢æ‰€æœ‰è®°å½•
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>List<span style="color:#000;font-weight:bold">&lt;</span>User<span style="color:#000;font-weight:bold">&gt;</span> userList <span style="color:#000;font-weight:bold">=</span> userMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getUsers</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//éå†ç»“æœ
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>userList<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">forEach</span><span style="color:#000;font-weight:bold">(</span>System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">::</span>print<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//å…³é—­è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">(</span>session<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>ç»è¿‡ä¸Šè¿°æµ‹è¯•ç»“æœå‘ç°userIdå±æ€§ä¸ºnull<span style="color:#000;font-weight:bold">,</span>æ²¡æœ‰è¢«èµ‹ä¸Šå€¼<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span>è§£å†³æ–¹æ¡ˆ<span style="color:#a61717;background-color:#e3d2d2">ï¼š</span>ä¿®æ”¹æ˜ å°„é…ç½®<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>é‡‡ç”¨åˆ«åè®¾ç½®<span style="color:#a61717;background-color:#e3d2d2">ï¼Œ</span>è®©ç»“æœé›†ä¸­çš„åˆ—ä¸å®ä½“ç±»ä¸­çš„å±æ€§å¯¹åº”<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>select id<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;getUsers&#34;</span> resultType<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>select id userId<span style="color:#000;font-weight:bold">,</span>name userName<span style="color:#000;font-weight:bold">,</span>gender gender<span style="color:#000;font-weight:bold">,</span>age age<span style="color:#000;font-weight:bold">,</span>birthday userBirthday from user
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;/</span>select<span style="color:#000;font-weight:bold">&gt;</span>
</span></span></code></pre></div><h3 id="resultmapè‡ªå®šä¹‰ç»“æœç±»å‹">resultMapè‡ªå®šä¹‰ç»“æœç±»å‹</h3>
<h4 id="resultmapæ ‡ç­¾ä»‹ç»">resultMapæ ‡ç­¾ä»‹ç»</h4>
<p>resultMap æ ‡ç­¾å¯ä»¥å»ºç«‹æŸ¥è¯¢çš„åˆ—åå’Œå®ä½“ç±»çš„å±æ€§åç§°ä¸ä¸€è‡´æ—¶å»ºç«‹å¯¹åº”å…³ç³»ã€‚ä»è€Œå®ç°å°è£…ã€‚åœ¨ select æ ‡ç­¾ä¸­ä½¿ç”¨ resultMap å±æ€§æŒ‡å®šå¼•ç”¨å³å¯ã€‚åŒæ—¶ resultMap å¯ä»¥å®ç°å°†æŸ¥è¯¢ç»“æœæ˜ å°„ä¸ºå¤æ‚ç±»å‹çš„ pojoï¼Œæ¯”å¦‚åœ¨æŸ¥è¯¢ç»“æœæ˜ å°„å¯¹è±¡ä¸­åŒ…æ‹¬ pojo å’Œ list å®ç°ä¸€å¯¹ä¸€æŸ¥è¯¢å’Œä¸€å¯¹å¤šæŸ¥è¯¢ã€‚</p>
<h4 id="å®šä¹‰æ¥å£æ–¹æ³•getuserbyid">å®šä¹‰æ¥å£æ–¹æ³•getUserById</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">* æ ¹æ®idæŸ¥è¯¢æŒ‡å®šUserå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">* @param id
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">* @return
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> User <span style="color:#900;font-weight:bold">getUserById</span><span style="color:#000;font-weight:bold">(</span><span style="color:#458;font-weight:bold">int</span> id<span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><h4 id="åœ¨sqlçš„é…ç½®æ–‡ä»¶ä¸­å®šä¹‰resultmap">åœ¨sqlçš„é…ç½®æ–‡ä»¶ä¸­å®šä¹‰resultMap</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Xml" data-lang="Xml"><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;select</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;getUserById&#34;</span> <span style="color:#008080">parameterType=</span><span style="color:#d14">&#34;int&#34;</span> <span style="color:#008080">resultMap=</span><span style="color:#d14">&#34;UserResultMap&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>    select * from user where userId=#{id}
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/select&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;resultMap</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;UserResultMap&#34;</span> <span style="color:#008080">type=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/resultMap&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>æ­¤å¤„æˆ‘ä»¬ä½¿ç”¨resultMapè€Œä¸æ˜¯resultType, resultTypeæ˜¯ç›´æ¥å†™ç»“æœç±»å‹ï¼ŒresultMapæ˜¯æ˜ å°„ç»“æœé›†ä¸ç±»ä¸­å±æ€§å¯¹åº”å…³ç³»ã€‚
</span></span><span style="display:flex;"><span>resultMapæ ‡ç­¾ä¸­çš„idè¡¨ç¤ºä¸€ä¸ªå”¯ä¸€æ ‡è®°æ˜¯resultMapçš„åç§°ã€‚
</span></span><span style="display:flex;"><span>type: è¡¨ç¤ºè¯¥resultMapè¿”å›çš„ç±»å‹ã€‚
</span></span></code></pre></div><h4 id="ä½¿ç”¨å®šä¹‰çš„resultmapé…ç½®æŸ¥è¯¢çš„sqlè¯­å¥">ä½¿ç”¨å®šä¹‰çš„resultMapé…ç½®æŸ¥è¯¢çš„sqlè¯­å¥</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Xml" data-lang="Xml"><span style="display:flex;"><span><span style="color:#000080">&lt;resultMap</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;UserResultMap&#34;</span> <span style="color:#008080">type=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;id</span> <span style="color:#008080">column=</span><span style="color:#d14">&#34;id&#34;</span> <span style="color:#008080">property=</span><span style="color:#d14">&#34;userId&#34;</span><span style="color:#000080">&gt;&lt;/id&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;result</span> <span style="color:#008080">column=</span><span style="color:#d14">&#34;name&#34;</span> <span style="color:#008080">property=</span><span style="color:#d14">&#34;userName&#34;</span><span style="color:#000080">&gt;&lt;/result&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;result</span> <span style="color:#008080">column=</span><span style="color:#d14">&#34;gender&#34;</span> <span style="color:#008080">property=</span><span style="color:#d14">&#34;gender&#34;</span><span style="color:#000080">&gt;&lt;/result&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;result</span> <span style="color:#008080">column=</span><span style="color:#d14">&#34;age&#34;</span> <span style="color:#008080">property=</span><span style="color:#d14">&#34;age&#34;</span><span style="color:#000080">&gt;&lt;/result&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;result</span> <span style="color:#008080">column=</span><span style="color:#d14">&#34;birthday&#34;</span> <span style="color:#008080">property=</span><span style="color:#d14">&#34;userBirthday&#34;</span><span style="color:#000080">&gt;&lt;/result&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/resultMap&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>id æ ‡ç­¾ï¼šç”¨äºæŒ‡å®šä¸»é”®å­—æ®µ
</span></span><span style="display:flex;"><span>result æ ‡ç­¾ï¼šç”¨äºæŒ‡å®šéä¸»é”®å­—æ®µ
</span></span><span style="display:flex;"><span>column å±æ€§ï¼šç”¨äºæŒ‡å®šæ•°æ®åº“åˆ—å
</span></span><span style="display:flex;"><span>property å±æ€§ï¼šç”¨äºæŒ‡å®šå®ä½“ç±»å±æ€§åç§°
</span></span></code></pre></div><h4 id="æµ‹è¯•æŸ¥è¯¢ç»“æœ">æµ‹è¯•æŸ¥è¯¢ç»“æœ</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testGetUserById</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span>  Exception<span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è·å–SqlSessionå¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>SqlSession session <span style="color:#000;font-weight:bold">=</span> MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSession</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨SqlSession åˆ›å»º UserDaoæ¥å£çš„ä»£ç†å¯¹è±¡
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>UserMapper userMapper <span style="color:#000;font-weight:bold">=</span> session<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>UserMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//æŸ¥è¯¢user
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>User user <span style="color:#000;font-weight:bold">=</span> userMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getUserById</span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//æ‰“å°user
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span>user<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//å…³é—­è¿æ¥
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">(</span>session<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="sqlmapconfigxmlé…ç½®æ–‡ä»¶å†…å®¹è§£æ">SqlMapConfig.xmlé…ç½®æ–‡ä»¶å†…å®¹è§£æ</h2>
<p>åœ¨ä¸»é…ç½®SqlMapConfig.xmlä¸­ï¼Œå®šä¹‰äº†å¾ˆå¤šæ ‡ç­¾ï¼Œæˆ‘ä»¬ç°åœ¨åªæ˜¯ä½¿ç”¨äº†ä¸€éƒ¨åˆ†æ ‡ç­¾ ï¼Œä¸»é…ç½®æ–‡ä»¶ä¸­å¯ä»¥å‡ºç°çš„æ ‡ç­¾ ç”¨dtdæ–‡ ä»¶è¿›è¡Œçº¦æŸã€‚ä¸‹é¢ä»‹ç»å…¶å®ƒæ ‡ç­¾çš„ä½¿ç”¨å«ä¹‰ã€‚</p>
<h3 id="æ ‡ç­¾çš„é…ç½®è§„èŒƒæŸ¥çœ‹dtdè§„èŒƒæ–‡ä»¶">æ ‡ç­¾çš„é…ç½®è§„èŒƒï¼ŒæŸ¥çœ‹dtdè§„èŒƒæ–‡ä»¶</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dtd" data-lang="dtd"><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">&lt;</span><span style="color:#000;font-weight:bold">?</span><span style="color:#a61717;background-color:#e3d2d2">xml</span> <span style="color:#a61717;background-color:#e3d2d2">version=</span><span style="color:#d14">&#34;1.0&#34;</span> <span style="color:#a61717;background-color:#e3d2d2">encoding=</span><span style="color:#d14">&#34;UTF-8&#34;</span> <span style="color:#000;font-weight:bold">?</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!--
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">Copyright 2009-2016 the original author or authors.
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">Licensed under the Apache License, Version 2.0 (the &#34;License&#34;);
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">you may not use this file except in compliance with the License.
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">You may obtain a copy of the License at
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">http://www.apache.org/licenses/LICENSE-2.0
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">Unless required by applicable law or agreed to in writing, software
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">distributed under the License is distributed on an &#34;AS IS&#34; BASIS,
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">See the License for the specific language governing permissions and
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">limitations under the License.
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">configuration</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000080">properties</span><span style="color:#000;font-weight:bold">?,</span> <span style="color:#000080">settings</span><span style="color:#000;font-weight:bold">?,</span> <span style="color:#000080">typeAliases</span><span style="color:#000;font-weight:bold">?,</span> <span style="color:#000080">typeHandlers</span><span style="color:#000;font-weight:bold">?,</span> <span style="color:#000080">objectFactory</span><span style="color:#000;font-weight:bold">?,</span> <span style="color:#000080">objectWrapperFactory</span><span style="color:#000;font-weight:bold">?,</span> <span style="color:#000080">reflectorFactory</span><span style="color:#000;font-weight:bold">?,</span> <span style="color:#000080">plugins</span><span style="color:#000;font-weight:bold">?,</span> <span style="color:#000080">environments</span><span style="color:#000;font-weight:bold">?,</span> <span style="color:#000080">databaseIdProvider</span><span style="color:#000;font-weight:bold">?,</span> <span style="color:#000080">mappers</span><span style="color:#000;font-weight:bold">?)</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">databaseIdProvider</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000080">property</span><span style="color:#000;font-weight:bold">*)</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ATTLIST</span> <span style="color:#000080">databaseIdProvider</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">type</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#REQUIRED</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">properties</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000080">property</span><span style="color:#000;font-weight:bold">*)</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ATTLIST</span> <span style="color:#000080">properties</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">resource</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#IMPLIED</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">url</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#IMPLIED</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">property</span> <span style="color:#000;font-weight:bold">EMPTY</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ATTLIST</span> <span style="color:#000080">property</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">name</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#REQUIRED</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">value</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#REQUIRED</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">settings</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000080">setting</span><span style="color:#000;font-weight:bold">+)</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">setting</span> <span style="color:#000;font-weight:bold">EMPTY</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ATTLIST</span> <span style="color:#000080">setting</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">name</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#REQUIRED</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">value</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#REQUIRED</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">typeAliases</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000080">typeAlias</span><span style="color:#000;font-weight:bold">*,</span><span style="color:#000080">package</span><span style="color:#000;font-weight:bold">*)</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">typeAlias</span> <span style="color:#000;font-weight:bold">EMPTY</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ATTLIST</span> <span style="color:#000080">typeAlias</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">type</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#REQUIRED</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">alias</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#IMPLIED</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">typeHandlers</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000080">typeHandler</span><span style="color:#000;font-weight:bold">*,</span><span style="color:#000080">package</span><span style="color:#000;font-weight:bold">*)</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">typeHandler</span> <span style="color:#000;font-weight:bold">EMPTY</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ATTLIST</span> <span style="color:#000080">typeHandler</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">javaType</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#IMPLIED</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">jdbcType</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#IMPLIED</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">handler</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#REQUIRED</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">objectFactory</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000080">property</span><span style="color:#000;font-weight:bold">*)</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ATTLIST</span> <span style="color:#000080">objectFactory</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">type</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#REQUIRED</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">objectWrapperFactory</span> <span style="color:#000;font-weight:bold">EMPTY</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ATTLIST</span> <span style="color:#000080">objectWrapperFactory</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">type</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#REQUIRED</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">reflectorFactory</span> <span style="color:#000;font-weight:bold">EMPTY</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ATTLIST</span> <span style="color:#000080">reflectorFactory</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">type</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#REQUIRED</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">plugins</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000080">plugin</span><span style="color:#000;font-weight:bold">+)</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">plugin</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000080">property</span><span style="color:#000;font-weight:bold">*)</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ATTLIST</span> <span style="color:#000080">plugin</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">interceptor</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#REQUIRED</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">environments</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000080">environment</span><span style="color:#000;font-weight:bold">+)</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ATTLIST</span> <span style="color:#000080">environments</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">default</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#REQUIRED</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">environment</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000080">transactionManager</span><span style="color:#000;font-weight:bold">,</span><span style="color:#000080">dataSource</span><span style="color:#000;font-weight:bold">)</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ATTLIST</span> <span style="color:#000080">environment</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">id</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#REQUIRED</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">transactionManager</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000080">property</span><span style="color:#000;font-weight:bold">*)</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ATTLIST</span> <span style="color:#000080">transactionManager</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">type</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#REQUIRED</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">dataSource</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000080">property</span><span style="color:#000;font-weight:bold">*)</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ATTLIST</span> <span style="color:#000080">dataSource</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">type</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#REQUIRED</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">mappers</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000080">mapper</span><span style="color:#000;font-weight:bold">*,</span><span style="color:#000080">package</span><span style="color:#000;font-weight:bold">*)</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">mapper</span> <span style="color:#000;font-weight:bold">EMPTY</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ATTLIST</span> <span style="color:#000080">mapper</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">resource</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#IMPLIED</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">url</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#IMPLIED</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">class</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#IMPLIED</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ELEMENT</span> <span style="color:#000080">package</span> <span style="color:#000;font-weight:bold">EMPTY</span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;!ATTLIST</span> <span style="color:#000080">package</span>
</span></span><span style="display:flex;"><span><span style="color:#008080">name</span> <span style="color:#000;font-weight:bold">CDATA</span> <span style="color:#000;font-weight:bold">#REQUIRED</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&gt;</span>
</span></span></code></pre></div><h3 id="propertiesæ ‡ç­¾è¯¦è§£">propertiesæ ‡ç­¾è¯¦è§£</h3>
<p>åœ¨ä½¿ç”¨ properties æ ‡ç­¾é…ç½®æ—¶,åœ¨xmlä¸­å¯ä»¥å¼•ç”¨propertieså±æ€§æ–‡ä»¶ä¸­keyçš„å€¼ï¼Œæ—¥åä¿®æ”¹propertieså±æ€§æ–‡ ä»¶ä¸­keyçš„å€¼æ—¶ï¼Œä¸ç”¨ä¿®æ”¹xmlæ–‡ä»¶ï¼Œä»è€Œæé«˜äº†æ•ˆç‡ã€‚</p>
<h4 id="æ–°å»ºä¸€ä¸ªdbconfigpropertieså±æ€§æ–‡ä»¶">æ–°å»ºä¸€ä¸ªdbconfig.propertieså±æ€§æ–‡ä»¶</h4>
<pre tabindex="0"><code class="language-properties" data-lang="properties">jdbc.driver=com.mysql.jdbc.Driver
jdbc.url=jdbc:mysql:///mybatis001
jdbc.username=root
jdbc.password=root
</code></pre><h4 id="åœ¨sqlmapperconfigxmlä¸­å¯ä»¥å¼•ç”¨å±æ€§æ–‡ä»¶ä¸­keyçš„å€¼">åœ¨SqlMapperConfig.xmlä¸­å¯ä»¥å¼•ç”¨å±æ€§æ–‡ä»¶ä¸­keyçš„å€¼</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#000080">&lt;properties</span> <span style="color:#008080">resource=</span><span style="color:#d14">&#34;dbconfig.properties&#34;</span><span style="color:#000080">&gt;&lt;/properties&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;dataSource</span> <span style="color:#008080">type=</span><span style="color:#d14">&#34;POOLED&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;driver&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;${jdbc.driver}&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;url&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;${jdbc.url}&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;username&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;${jdbc.username}&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;property</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;password&#34;</span> <span style="color:#008080">value=</span><span style="color:#d14">&#34;${jdbc.password}&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/dataSource&gt;</span>
</span></span></code></pre></div><h3 id="typealiasesæ ‡ç­¾è¯¦è§£">typeAliasesæ ‡ç­¾è¯¦è§£</h3>
<p>åœ¨å‰é¢æˆ‘ä»¬è®²çš„ Mybatis æ”¯æŒçš„é»˜è®¤åˆ«åï¼Œæˆ‘ä»¬ä¹Ÿå¯ä»¥é‡‡ç”¨è‡ªå®šä¹‰åˆ«åæ–¹å¼æ¥å¼€å‘ã€‚</p>
<h4 id="åœ¨sqlmapperconfigxmlä¸­å®šä¹‰åˆ«å">åœ¨SqlMapperConfig.xmlä¸­å®šä¹‰åˆ«å</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#000080">&lt;typeAliases&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- å•ä¸ªåˆ«åå®šä¹‰ --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;typeAlias</span> <span style="color:#008080">alias=</span><span style="color:#d14">&#34;user&#34;</span> <span style="color:#008080">type=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- æ‰¹é‡åˆ«åå®šä¹‰ï¼Œæ‰«ææ•´ä¸ªåŒ…ä¸‹çš„ç±»ï¼Œåˆ«åä¸ºç±»åï¼ˆé¦–å­—æ¯å¤§å†™æˆ–å°å†™éƒ½å¯ä»¥ï¼‰ --&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;package</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34;cn.offcn.entity&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;package</span> <span style="color:#008080">name=</span><span style="color:#d14">&#34; å…¶å®ƒåŒ… &#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/typeAliases&gt;</span>
</span></span></code></pre></div><h4 id="åœ¨usermapperxmlä¸­ä½¿ç”¨åˆ«å">åœ¨userMapper.xmlä¸­ä½¿ç”¨åˆ«å</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#000080">&lt;select</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;getUsers&#34;</span> <span style="color:#008080">resultType=</span><span style="color:#d14">&#34;user&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>select * from user
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/select&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;select</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;getUserById&#34;</span> <span style="color:#008080">parameterType=</span><span style="color:#d14">&#34;int&#34;</span> <span style="color:#008080">resultMap=</span><span style="color:#d14">&#34;UserResultMap&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span>select * from user where userId=#{id}
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/select&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;resultMap</span> <span style="color:#008080">id=</span><span style="color:#d14">&#34;UserResultMap&#34;</span> <span style="color:#008080">type=</span><span style="color:#d14">&#34;user&#34;</span><span style="color:#000080">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;id</span> <span style="color:#008080">column=</span><span style="color:#d14">&#34;id&#34;</span> <span style="color:#008080">property=</span><span style="color:#d14">&#34;userId&#34;</span><span style="color:#000080">&gt;&lt;/id&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;result</span> <span style="color:#008080">column=</span><span style="color:#d14">&#34;name&#34;</span> <span style="color:#008080">property=</span><span style="color:#d14">&#34;userName&#34;</span><span style="color:#000080">&gt;&lt;/result&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;result</span> <span style="color:#008080">column=</span><span style="color:#d14">&#34;gender&#34;</span> <span style="color:#008080">property=</span><span style="color:#d14">&#34;gender&#34;</span><span style="color:#000080">&gt;&lt;/result&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;result</span> <span style="color:#008080">column=</span><span style="color:#d14">&#34;age&#34;</span> <span style="color:#008080">property=</span><span style="color:#d14">&#34;age&#34;</span><span style="color:#000080">&gt;&lt;/result&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;result</span> <span style="color:#008080">column=</span><span style="color:#d14">&#34;birthday&#34;</span> <span style="color:#008080">property=</span><span style="color:#d14">&#34;userBirthday&#34;</span><span style="color:#000080">&gt;&lt;/result&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/resultMap&gt;</span>
</span></span></code></pre></div><h3 id="mappersæ˜ å°„å™¨æ ‡ç­¾è¯¦è§£">mappersæ˜ å°„å™¨æ ‡ç­¾è¯¦è§£</h3>
<p>mappersæ˜ å°„å™¨ç”¨äºæŒ‡å®šæ˜ å°„æ–‡ä»¶çš„ä½ç½®ã€‚</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!--ä½¿ç”¨ç›¸å¯¹äºç±»è·¯å¾„çš„èµ„æº--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;mappers&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;mapper</span> <span style="color:#008080">resource=</span><span style="color:#d14">&#34;cn/offcn/dao/UserDao.xml&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/mappers&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!--ä½¿ç”¨mapperæ¥å£ç±»è·¯å¾„--&gt;</span>
</span></span><span style="display:flex;"><span>å¦‚ï¼š<span style="color:#000080">&lt;mapper</span> <span style="color:#008080">class=</span><span style="color:#d14">&#34;cn.offcn.dao.UserDao&#34;</span><span style="color:#000080">/&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>æ³¨æ„ï¼šæ­¤ç§æ–¹æ³•è¦æ±‚mapperæ¥å£åç§°å’Œmapperæ˜ å°„æ–‡ä»¶åç§°ç›¸åŒï¼Œä¸”æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸­ã€‚
</span></span></code></pre></div><h2 id="mybatisè‡ªåŠ¨è¿”å›ä¸»é”®å€¼">MyBatisè‡ªåŠ¨è¿”å›ä¸»é”®å€¼</h2>
<h3 id="è¿”å›ä¸»é”®å€¼æŠ€æœ¯çš„ä¸šåŠ¡åº”ç”¨åœºæ™¯">è¿”å›ä¸»é”®å€¼æŠ€æœ¯çš„ä¸šåŠ¡åº”ç”¨åœºæ™¯</h3>
<p>å¯¹äºè‡ªå¢ä¸»é”®åœ¨æŸäº›ä¸šåŠ¡ä¸­ä¿å­˜ä¸€ä¸ªå¯¹è±¡åï¼Œéœ€è¦ä½¿ç”¨åˆ°è¿™ä¸ªä¸»é”®å®Œæˆåç»­çš„ä¸šåŠ¡é€»è¾‘ï¼Œæ¯”å¦‚ï¼šè¦ä¿å­˜è®¢å•åï¼Œè¿˜è¦ä¿å­˜è®¢å•é¡¹ä¿¡æ¯ï¼Œè®¢å•é¡¹ç›¸ä¿¡éœ€è¦ç”¨åˆ°è®¢å•ä¸»é”®ã€‚æ‰€ä»¥åº”ç”¨åœºåˆå¾ˆå¤šï¼Œä¸‹é¢æˆ‘ä»¬æ¥åº”ç”¨ä¸€ä¸‹è¿”å›ä¸»é”®å€¼æ“ä½œã€‚</p>
<h3 id="æ¥å£ä¸­ç¼–å†™adduseræ–¹æ³•">æ¥å£ä¸­ç¼–å†™addUseræ–¹æ³•</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Java" data-lang="Java"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/**  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">* ä¿å­˜userå¯¹è±¡  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">* @param user  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">*/</span>  
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">saveUser</span><span style="color:#000;font-weight:bold">(</span>User user<span style="color:#000;font-weight:bold">);</span>
</span></span></code></pre></div><h3 id="åœ¨sqlçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æ¥å£æ–¹æ³•å¯¹åº”çš„sqlé…ç½®">åœ¨sqlçš„é…ç½®æ–‡ä»¶ä¸­æ·»åŠ æ¥å£æ–¹æ³•å¯¹åº”çš„sqlé…ç½®</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Sql" data-lang="Sql"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">select</span><span style="color:#bbb"> </span>id<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;saveUser&#34;</span><span style="color:#bbb"> </span>parameterType<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000;font-weight:bold">&gt;</span><span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">insert</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">into</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">user</span><span style="color:#bbb"> </span>(name,gender,age,birthday)<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">values</span>(<span style="color:#000;font-weight:bold">#</span><span style="color:#a61717;background-color:#e3d2d2">{</span>name<span style="color:#a61717;background-color:#e3d2d2">}</span>,<span style="color:#000;font-weight:bold">#</span><span style="color:#a61717;background-color:#e3d2d2">{</span>gender<span style="color:#a61717;background-color:#e3d2d2">}</span>,<span style="color:#000;font-weight:bold">#</span><span style="color:#a61717;background-color:#e3d2d2">{</span>age<span style="color:#a61717;background-color:#e3d2d2">}</span>,<span style="color:#000;font-weight:bold">#</span><span style="color:#a61717;background-color:#e3d2d2">{</span>birthday<span style="color:#a61717;background-color:#e3d2d2">}</span>)<span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#000;font-weight:bold">select</span><span style="color:#000;font-weight:bold">&gt;</span><span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="åœ¨sqlæ ‡ç­¾ä¸Šæ·»åŠ è¿”å›è‡ªå¢é•¿çš„ä¸»é”®å€¼çš„é…ç½®">åœ¨sqlæ ‡ç­¾ä¸Šæ·»åŠ è¿”å›è‡ªå¢é•¿çš„ä¸»é”®å€¼çš„é…ç½®</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-Sql" data-lang="Sql"><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">ç¬¬ä¸€ç§æ–¹å¼</span>:<span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">insert</span><span style="color:#bbb"> </span>id<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;saveUser&#34;</span><span style="color:#bbb"> </span>parameterType<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#bbb"> </span>useGeneratedKeys<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;true&#34;</span><span style="color:#bbb"> </span>keyProperty<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;id&#34;</span><span style="color:#000;font-weight:bold">&gt;</span><span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">insert</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">into</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">user</span><span style="color:#bbb"> </span>(name,gender,age,birthday)<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">values</span>(<span style="color:#000;font-weight:bold">#</span><span style="color:#a61717;background-color:#e3d2d2">{</span>name<span style="color:#a61717;background-color:#e3d2d2">}</span>,<span style="color:#000;font-weight:bold">#</span><span style="color:#a61717;background-color:#e3d2d2">{</span>gender<span style="color:#a61717;background-color:#e3d2d2">}</span>,<span style="color:#000;font-weight:bold">#</span><span style="color:#a61717;background-color:#e3d2d2">{</span>age<span style="color:#a61717;background-color:#e3d2d2">}</span>,<span style="color:#000;font-weight:bold">#</span><span style="color:#a61717;background-color:#e3d2d2">{</span>birthday<span style="color:#a61717;background-color:#e3d2d2">}</span>)<span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#000;font-weight:bold">insert</span><span style="color:#000;font-weight:bold">&gt;</span><span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>useGeneratedKeys:<span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">è¡¨ç¤ºå¼€å¯è·å–è‡ªå¢ä¸»é”®å€¼ã€‚</span><span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>keyProperty<span style="color:#a61717;background-color:#e3d2d2">ï¼š</span><span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">è¡¨ç¤ºä»è¡¨ä¸­å–åˆ°ä¸»é”®å€¼åèµ‹ç»™</span>Userç±»ä¸­çš„å“ªä¸ªå±æ€§<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span><span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#a61717;background-color:#e3d2d2">ç¬¬äºŒç§æ–¹å¼</span>:<span style="color:#a61717;background-color:#e3d2d2">ä½¿ç”¨</span>selectKeyæ ‡ç­¾å’Œmysqlå†…ç½®å‡½æ•°<span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#000;font-weight:bold">insert</span><span style="color:#bbb"> </span>id<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;saveUser&#34;</span><span style="color:#bbb"> </span>parameterType<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;cn.offcn.entity.User&#34;</span><span style="color:#000;font-weight:bold">&gt;</span><span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">&lt;</span>selectKey<span style="color:#bbb"> </span>keyColumn<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;id&#34;</span><span style="color:#bbb"> </span>keyProperty<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;id&#34;</span><span style="color:#bbb"> </span>resultType<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;int&#34;</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">order</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;AFTER&#34;</span><span style="color:#000;font-weight:bold">&gt;</span><span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">select</span><span style="color:#bbb"> </span>last_insert_id()<span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">&lt;/</span>selectKey<span style="color:#000;font-weight:bold">&gt;</span><span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">insert</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">into</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">user</span><span style="color:#bbb"> </span>(name,gender,age,birthday)<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">values</span>(<span style="color:#000;font-weight:bold">#</span><span style="color:#a61717;background-color:#e3d2d2">{</span>name<span style="color:#a61717;background-color:#e3d2d2">}</span>,<span style="color:#000;font-weight:bold">#</span><span style="color:#a61717;background-color:#e3d2d2">{</span>gender<span style="color:#a61717;background-color:#e3d2d2">}</span>,<span style="color:#000;font-weight:bold">#</span><span style="color:#a61717;background-color:#e3d2d2">{</span>age<span style="color:#a61717;background-color:#e3d2d2">}</span>,<span style="color:#000;font-weight:bold">#</span><span style="color:#a61717;background-color:#e3d2d2">{</span>birthday<span style="color:#a61717;background-color:#e3d2d2">}</span>)<span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">&lt;/</span><span style="color:#000;font-weight:bold">insert</span><span style="color:#000;font-weight:bold">&gt;</span><span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>keyColumn:<span style="color:#a61717;background-color:#e3d2d2">æŒ‡å®šå–æ•°æ®åº“ä¸­å“ªä¸€åˆ—çš„å€¼ï¼ˆé€šå¸¸æŒ‡ä¸»é”®åˆ—ï¼‰ã€‚</span><span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>keyProperty<span style="color:#a61717;background-color:#e3d2d2">ï¼š</span><span style="color:#bbb"> </span><span style="color:#a61717;background-color:#e3d2d2">è¡¨ç¤ºå–å‡ºä¸»é”®å€¼åèµ‹å€¼</span>Userå¯¹è±¡çš„å“ªä¸ªå±æ€§<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span><span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>resultType<span style="color:#a61717;background-color:#e3d2d2">ï¼š</span><span style="color:#bbb">  </span><span style="color:#a61717;background-color:#e3d2d2">è¡¨ç¤ºå¯¹è±¡çš„å±æ€§ç±»å‹</span><span style="color:#bbb">  
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000;font-weight:bold">order</span><span style="color:#a61717;background-color:#e3d2d2">ï¼šè¡¨ç¤ºå®Œå</span>sqlè¯­å¥ä¹‹å‰è¿˜æ˜¯ä¹‹åæŠŠä¸»é”®å€¼èµ‹ç»™å®ä½“ç±»å¯¹åº”å±æ€§<span style="color:#a61717;background-color:#e3d2d2">ã€‚</span><span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="æµ‹è¯•">æµ‹è¯•</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Test</span>  
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testsaveUser</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span> Â Exception<span style="color:#000;font-weight:bold">{</span>  
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è·å–SqlSessionå¯¹è±¡  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>SqlSession session <span style="color:#000;font-weight:bold">=</span> MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSession</span><span style="color:#000;font-weight:bold">();</span>  
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//è°ƒç”¨SqlSession åˆ›å»º UserDaoæ¥å£çš„ä»£ç†å¯¹è±¡  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>UserMapper userMapper <span style="color:#000;font-weight:bold">=</span> session<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMapper</span><span style="color:#000;font-weight:bold">(</span>UserMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">);</span>  
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//åˆ›å»ºUserå¯¹è±¡  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>User user<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">new</span> User<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;åˆ˜å¤‡&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#d14">&#34;ç”·&#34;</span><span style="color:#000;font-weight:bold">,</span>30<span style="color:#000;font-weight:bold">,</span><span style="color:#000;font-weight:bold">new</span> Date<span style="color:#000;font-weight:bold">());</span>  
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//ä¿å­˜Userå¯¹è±¡  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>userMapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">saveUser</span><span style="color:#000;font-weight:bold">(</span>user<span style="color:#000;font-weight:bold">);</span>  
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//æ‰“å°userçš„idå±æ€§å€¼  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span>user<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getId</span><span style="color:#000;font-weight:bold">());</span>  
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//æäº¤äº‹åŠ¡  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>session<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">commit</span><span style="color:#000;font-weight:bold">();</span>  
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//å…³é—­è¿æ¥  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>MyBatisUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">(</span>session<span style="color:#000;font-weight:bold">);</span>  
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div>
    </div>

    

    


    <div class="container-prevnext">
    <div><a href="https://lovemjh.vercel.app/posts/blog/20220430231095/">â† Hexoæ­å»º</a></div>
    <div><a href="https://lovemjh.vercel.app/posts/java-frame/20220430230955/">æ¡†æ¶æ¦‚è¿°  â†’</a></div>
</div>
</div>

        </div>
        <div id="footer"><div class="container-footer">
    
    <a href="//beian.miit.gov.cn" target="_blank">
        
        è±«ICPå¤‡2022002918å·
        
    </a>
    <a id="s" href="/secrets">&nbsp;</a>
</div></div>
    </body>
</html>
