<!DOCTYPE html>
<html><head>
  
  
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=5,user-scalable=no">

  <title>tk-题库项目基本框架搭建</title>
  <meta name="description" content="MJH Blog & MEET HTML Theme">
  
  <link rel="shortcut icon" type="image/x-icon" href="images/favicon.png">
  <link rel="stylesheet" href="/css/style.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jquery.fancybox@2.1.5/source/jquery.fancybox.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.4/tocbot.css">
  <link href="https://cdn.bootcss.com/highlight.js/9.12.0/styles/monokai.min.css" rel="stylesheet">
  <script src="https://cdn.bootcss.com/highlight.js/9.12.0/highlight.min.js"></script>
  <script>hljs.initHighlightingOnLoad();</script>
  <script type="text/javascript">
    if (!!window.ActiveXObject || "ActiveXObject" in window) { 
      alert('朋友，上古浏览器不支持呢~');
    }
  </script>
  <style>
    .highlight {
      overflow-x: auto;
    }

    pre {
      position: relative;
      padding: 30px 10px 10px 10px;
      border-width: 1px;
      border-color:#7c4242;
    }

    .post-content pre code {
      font-family: Consolas;
    }

    pre::after {
      display: block;
      content: " ";
      position: absolute;
      border-radius: 50%;
      background: #ff5f56;
      width: 12px;
      height: 12px;
      top: 0;
      left: 12px;
      margin-top: 12px;
      -webkit-box-shadow: 20px 0 #ffbd2e, 40px 0 #27c93f;
      box-shadow: 20px 0 #ffbd2e, 40px 0 #27c93f;
    }










    html,
    body {
      overflow-x: hidden;
      -webkit-overflow-scrolling: touch;
    }

    .page-list {
      height: 18em;
      background-color: rgba(255, 255, 255, 0);
      border-radius: 20px;
      margin-bottom: 2em;
      box-shadow: 2px 4px 6px #000;
      display: flex;
    }

    .page-img {
      float: left;
      display: block;
      width: 40%;
      height: 100%;
      border-radius: 20px 0px 0px 20px;
      background-color: yellow;
      background-image: url(https://api.ixiaowai.cn/api/api.php);
      background-repeat: no-repeat;
      background-size: 100% 100%;
      -moz-background-size: 100% 100%;
    }

    .page-mian {
      float: left;
      display: block;
      width: 60%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0);
       
      padding: 0% 2% 0% 2%;
    }

    .page-Title a {
      text-decoration: none;
      font-size: 22px;
      color: rgb(0, 0, 0);
    }

    .page-Content a {
      text-decoration: none;
      font-size: 16px;
      color: rgb(0, 0, 0);
    }


    .ull {
      display: flex;
      flex-flow: row nowrap;
      justify-content: center;
      align-items: center;
      background-color: rgba(0, 0, 0, 0.263);
      height: 50px;
      margin: 0px;
    }

    .ull a {
      text-decoration: none;
      font-size: 22px;
      color: rgb(255, 255, 255);
    }

    .lii {
      display: inline;
      margin-right: 20px;
    }

    .btn {
      width: 120px;
      height: 40px;
      background: linear-gradient(315deg, #a4d8fa 0%, #5eb1e9 74%);
      border: none;
      border-radius: 10px;
      font-family: 'Lato', sans-serif;
      font-weight: 500;
      font-size: smaller;
      color: #fff;
      box-shadow: inset 2px 2px 2px 0px rgba(255, 255, 255, .5),
        7px 7px 20px 0px rgba(0, 0, 0, .1),
        4px 4px 5px 0px rgba(0, 0, 0, .1);
      outline: none;
      position: relative;
      z-index: 0;
    }

    .btn::before {
      position: absolute;
      content: '';
      left: 0;
      bottom: 0;
      width: 100%;
      height: 0;
      transition: all 0.3s ease;
      border-radius: 10px;
      background: linear-gradient(315deg, #4dccc6 0%, #96e4df 74%);
      z-index: -1;
    }

    .btn:hover::before {
      top: 0;
      height: 100%;
    }

    .btn:active {
      top: 2px;
    }










    @media screen and (max-width: 1080px) {

       
      .navigation {
        display: none;
      }

      .page-list {
        height: 25em;
        background-color: rgba(255, 255, 255, 0);
        border-radius: 20px;
        margin-bottom: 2em;
        box-shadow: 2px 4px 6px #000;
        display: block;
      }

      .page-img {
        width: 100%;
        height: 40%;
        border-radius: 20px 20px 0px 0px;
        background-color: yellow;
        background-image: url(https://api.ixiaowai.cn/api/api.php);
        background-repeat: no-repeat;
        background-size: 100% 100%;
        -moz-background-size: 100% 100%;
      }

      .page-mian {
        width: 100%;
        height: 60%;
        background-color: rgba(0, 0, 0, 0);
         
        padding: 0% 2% 0% 2%;
      }

    }
  </style>




  <style>
    a.toc-link {
      color: currentColor;
      height: auto;
    }

     
    ::-webkit-scrollbar {
      width: 8px;
      height: 6px
    }

     
    ::-webkit-scrollbar-track {
      background-color: transparent;
      -webkit-border-radius: 2em;
      -moz-border-radius: 2em;
      border-radius: 2em
    }

     
    ::-webkit-scrollbar-thumb {
      background-color: #30B07F;
      background-image: -webkit-linear-gradient(45deg, rgba(255, 255, 255, .4) 100%, transparent 100%, transparent 50%, rgba(255, 255, 255, .4) 50%, rgba(255, 255, 255, .4) 75%, transparent 75%, transparent);
      -webkit-border-radius: 2em;
      -moz-border-radius: 2em;
      border-radius: 2em
    }
  </style>
  <style>
    .sidebar {
      z-index: 998;
      position: fixed;
      left: -200px;
      width: 200px;
      height: 100%;
      background: #ffffff;
      transition: all .5s ease;
    }

    .sidebar .top {
      font-size: 22px;
      color: rgb(0, 0, 0);
      text-align: center;
      height: 60px;
      line-height: 60px;
      background-color: rgb(255, 255, 255);
      user-select: none;

    }

    .sidebar ul {
      list-style: none;
    }

    .sidebar ul a {
      display: block;
      height: 100%;
      width: 100%;
      text-align: center;
      line-height: 45px;
      font-size: 18px;
      color: rgb(0, 0, 0);
      box-sizing: border-box;
      border-top: 1px solid rgb(255, 0, 0);
      border-bottom: 1px solid rgb(0, 17, 255);
      transition: .4s;
    }

    ul li:hover a {
      padding-left: 30px;
      color: #7c4242;
      border-left: 5px solid #ffffff;
      transition: all 0.5s;
    }

    .sidebar ul a i {
      margin-right: 16px;
    }

    #check {
      display: none;
    }

    label #btn,
    label #cancel {
      position: fixed;
      cursor: pointer;
      background-color: #000000;
      border-radius: 3px;
    }

    label #btn {
      left: 5px;
      top: 7px;
      font-size: 25px;
      color: #fff;
      padding: 6px 10px;
      transition: all .5s;
      z-index: 999;
    }

    label #cancel {
      z-index: 999;
      left: -145px;
      top: 10px;
      font-size: 25px;
      color: rgb(255, 255, 255);
      padding: 4px 9px;
      transition: all .5s ease;
    }

    #check:checked~.sidebar {
      left: 0;
    }

    #check:checked~label #btn {
      left: 10px;
      opacity: 0;
      pointer-events: none;
    }

    #check:checked~label #cancel {
      left: 150px;
    }

     
    .navigation {
      width: 100%;
      height: 50px;
      background-color: rgba(208, 240, 121, 0.184);
      position: fixed;
      left: 0;
      top: 0;
      text-align: center;
      transition: top 0.5s;
      z-index: 999;
    }

     
    .hide {
      top: -60px;
    }
  </style>
</head><body style="background-image:url(https://api.ixiaowai.cn/api/api.php); 
    background-repeat: no-repeat;
    background-size: 100% 100%;
    -moz-background-size: 100% 100%;
    background-attachment:fixed"><input type="checkbox" id="check">
<label for="check">
  <i class="fa fa-bars" id="btn"></i>
  <i class="fa fa-times" id="cancel"></i>
</label>
<div class="sidebar">
  <div class="top">Hi~</div>
  <ul>
    
    <li class="lii">
      <a href="/">
        <div class="burger-item">
          <i class='fa fa-home'></i> Home
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/posts">
        <div class="burger-item">
          <i class='fa fa-book'></i> Posts
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/archive">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> Archive
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/categories">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> Categories
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/tags">
        <div class="burger-item">
          <i class='fa fa-tags'></i> Tags
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/about">
        <div class="burger-item">
          <i class='fa fa-info-circle'></i> About
        </div>
      </a>
    </li>
    
  </ul>
</div>
<div id="body-wrap content"><nav class="navigation">
  <ul class="ull">
    
    <li class="lii">
      <a href="/">
        <div class="burger-item">
          <i class='fa fa-home'></i> Home
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/posts">
        <div class="burger-item">
          <i class='fa fa-book'></i> Posts
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/archive">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> Archive
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/categories">
        <div class="burger-item">
          <i class='fa fa-folder-open'></i> Categories
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/tags">
        <div class="burger-item">
          <i class='fa fa-tags'></i> Tags
        </div>
      </a>
    </li>
    
    <li class="lii">
      <a href="/about">
        <div class="burger-item">
          <i class='fa fa-info-circle'></i> About
        </div>
      </a>
    </li>
    
  </ul>
</nav>
  <div style="width: 100%; height: 65vh;">
    <div id="page_site-info">
      <div id="site-title">
        <input type="checkbox" id="check">
        <br>
        <span class="blogtitle"></span>
        
        
        <div class="post-header">
          <span>
            
            <i class="fa fa-calendar"></i>
            2022-05-28&nbsp;
          </span>
          <span>
            
            <i class="fa fa-calendar-check-o"></i>
            2022-05-28&nbsp;&nbsp;&nbsp;
          </span>
          <span>
            
            <i class="fa fa-edit"></i>
            4977 字
          </span>&nbsp;
          <span>
            
            <i class="fa fa-paper-plane"></i>
            10 分钟
          </span>
        </div><div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
		</div>
		<div class="tag">
			
			 - 
			
			<a href="/tags/"></a>
			
		</div>
	</div>
</div>

        <script src="https://cdn.jsdelivr.net/npm/typed.js@2.0.11"></script>
        <script>
          var typed = new Typed(".blogtitle", {
            strings: ['tk-题库项目基本框架搭建'],
            startDelay: 300,
            typeSpeed: 100,
            loop: true,
            backSpeed: 50,
            showCursor: true
          });
        </script>
      </div>
    </div>
  </div>
  
<main id="content-outer">
    <div class="layout_page" id="content-inner">
        <article id="page" style="margin-right: 10px;">
            <div class="js-toc-content">
                <h1 align = "center">第三章</h1>
<h1 align = "center">优学题库项目基本框架搭建</h1>
<h3 align="center">优就业.JAVA教研室</h3>
<h2 id="学习目标">学习目标</h2>
<ul>
<li>了解优学题库项目介绍</li>
<li>理解项目搭建</li>
<li>理解搭建管理后台</li>
<li>理解逆向生成代码</li>
<li>掌握模块工程配置</li>
<li>掌握搭建Nacos注册中心</li>
<li>掌握注册各个微服务到Nacos</li>
<li>掌握搭建网关服务</li>
</ul>
<h1 id="1-优学在线考试题库系统介绍">1. 优学在线考试题库系统介绍</h1>
<h2 id="11-项目介绍">1.1 项目介绍</h2>
<p>中公教育集团作为一家上市培训企业，每天服务于几千万学员，涉及题库类型丰富多样，具有海量的题目信息。</p>
<p>优学题库项目正是基于这样的背景下诞生的一套题库系统，系统支持自定义题库类型，可以满足广大学员对于各类型题型的学习使用。优学题库系统采用SpringCloud Alibaba分布式架构体系，基于VUE前后端分离技术实现后台管理，基于微信小程序实现移动端应用。</p>
<h2 id="12-系统界面">1.2 系统界面</h2>
<h3 id="1用户移动端">1、用户移动端</h3>
<p><img src="/posts/project/20220528231163/image-20220528231414878.png"
    
    
    
    loading="lazy"
    
    
>
<img src="/posts/project/20220528231163/image-20220528231426845.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528231163/image-20220528231440221.png"
    
    
    
    loading="lazy"
    
    
>
<img src="/posts/project/20220528231163/image-20220528231451074.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="2系统管理端">2、系统管理端</h3>
<p><img src="/posts/project/20220528231163/image-20220528231459048.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528231163/image-20220528231508676.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528231163/image-20220528231516504.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528231163/image-20220528231522873.png"
    
    
    
    loading="lazy"
    
    
></p>
<h1 id="2-搭建项目">2. 搭建项目</h1>
<p><strong>功能架构</strong>
<img src="/posts/project/20220528231163/image-20220528231533307.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><strong>技术架构图</strong>
<img src="/posts/project/20220528231163/image-20220528231541528.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="21-项目结构说明">2.1 项目结构说明</h2>
<p>核心是microservice这块儿，它分两类微服务：</p>
<ul>
<li>
<p>后台CRUD微服务</p>
<ol>
<li>
<p>content：内容管理系统（product） 10001</p>
</li>
<li>
<p>member：会员管理系统（user）10002</p>
</li>
<li>
<p>question：题库管理系统（warehouse） 10003</p>
</li>
</ol>
</li>
</ul>
<p>后端采用:Springboot+SpringCloud GateWay+Mybatis plus+Nacos</p>
<p>前端采用：Vue+Element ui+Node.js</p>
<p>数据层：mysql、redis、rabbitmq、阿里OSS</p>
<p>后台管理前端：uxue-admin（1000）</p>
<p>网关：uxue-gateway（8888）</p>
<h2 id="22-数据准备">2.2 数据准备</h2>
<p>把课前资料中的数据文件导入数据库：
<img src="/posts/project/20220528231163/image-20220528231552137.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>导入数据库之后：
<img src="/posts/project/20220528231163/image-20220528231601829.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>uxue_admin:管理后台数据库</p>
<p>uxue_cms:广告内容服务数据库</p>
<p>uxue_qms:题目服务数据库</p>
<p>uxue_ums:会员服务数据库</p>
<p>注意数据库版本：5.7</p>
<h2 id="23-git安装和配置">2.3. git安装和配置</h2>
<h4 id="231-什么是git">2.3.1 什么是Git</h4>
<p>Git是一款免费、开源的分布式版本控制系统，用于敏捷高效地处理任何或小或大的项目。
Git 是 Linus Torvalds 为了帮助管理 Linux 内核开发而开发的一个开放源码的版本控制软件。</p>
<h4 id="232-git相关软件下载">2.3.2 Git相关软件下载</h4>
<p>Git的下载页面：  <a class="link" href="/posts/project/https://git-scm.com/"  target="_blank" rel="noopener"
    >https://git-scm.com/</a>       目前最新版：Git-2.13.0   注意下载对应操作系统位数的安装包。</p>
<h4 id="233-git安装与配置">2.3.3 Git安装与配置</h4>
<p>1、选中GIT安装包，Git-2.13.0-64-bit.exe  单击右键，弹出对话框，点击【解除锁定】。
<img src="/posts/project/20220528231163/image-20220528231609956.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>2、双击GIT安装包，Git-2.13.0-64-bit.exe 开始安装（如有安全告警，点击运行）
<img src="/posts/project/20220528231163/image-20220528231616732.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>3、出现授权信息页面，点击下一步即可
<img src="/posts/project/20220528231163/image-20220528231624824.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>4、接下来逐步点击【Next】即可安装成功
<img src="/posts/project/20220528231163/image-20220528231632123.png"
    
    
    
    loading="lazy"
    
    
></p>
<h4 id="234--git成功">2.3.4  git成功</h4>
<p>在命令行输入命令</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">git --version
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">屏幕显示：git version 2.13.0.windows.1
</span></span></code></pre></div><p>出现上面的版本号提示表示git安装成功。</p>
<h4 id="235-git配置">2.3.5 Git配置</h4>
<p>配置当前开发者名称、邮箱、默认推送方式</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">git config --global user.name <span class="s2">&#34;offcn-java&#34;</span>
</span></span><span class="line"><span class="cl">git config --global user.email <span class="s2">&#34;myqq@qq.com&#34;</span>
</span></span><span class="line"><span class="cl">git config --global push.default simple
</span></span></code></pre></div><p>注意&ndash;global 参数 表示全局配置。</p>
<p>查看配置是否生效：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git config -l
</span></span></code></pre></div><p>查看配置是否正确
<img src="/posts/project/20220528231163/image-20220528231642571.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="23-使用gitee创建仓库">2.3. 使用gitee创建仓库</h2>
<h4 id="231-申请gitee账号">2.3.1 申请gitee账号</h4>
<p>访问地址：https://gitee.com/signup  注册账号
<img src="/posts/project/20220528231163/image-20220528231649197.png"
    
    
    
    loading="lazy"
    
    
></p>
<h4 id="232登录gitee创建仓库">2.3.2.登录gitee创建仓库</h4>
<p><img src="/posts/project/20220528231163/image-20220528231658448.png"
    
    
    
    loading="lazy"
    
    
>
<img src="/posts/project/20220528231163/image-20220528231711751.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528231163/image-20220528231719653.png"
    
    
    
    loading="lazy"
    
    
></p>
<h4 id="233-克隆项目到本地">2.3.3 克隆项目到本地：</h4>
<p>找到项目克隆地址：
<img src="/posts/project/20220528231163/image-20220528231730922.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>在命令执行命令克隆项目到本地:</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git clone https://gitee.com/hk109/uxue.git
</span></span></code></pre></div><p><img src="/posts/project/20220528231163/image-20220528231737264.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="24-项目初始创建">2.4. 项目初始创建</h2>
<p>把资料/基础工程中的文件
<img src="/posts/project/20220528231163/image-20220528231747813.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>copy到 clone下来的uxue工程中
<img src="/posts/project/20220528231163/image-20220528231753894.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>接下来在idea中导入uxue工程：
<img src="/posts/project/20220528231163/image-20220528231801056.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528231163/image-20220528231808540.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>点击“OK”，一路下一步：项目成功导入到Idea
<img src="/posts/project/20220528231163/image-20220528231816889.png"
    
    
    
    loading="lazy"
    
    
></p>
<h4 id="241-在idea的terminal窗口查看git状态">2.4.1 在idea的Terminal窗口，查看git状态：</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git status
</span></span></code></pre></div><p><img src="/posts/project/20220528231163/image-20220528231827734.png"
    
    
    
    loading="lazy"
    
    
></p>
<h4 id="242-把当前项目新增文件添加到待处理列表">2.4.2 把当前项目新增文件添加到待处理列表</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git add .
</span></span></code></pre></div><h4 id="243-提交当前项目到git本地仓库">2.4.3 提交当前项目到git本地仓库</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git commit -m &#34;优学题库系统&#34;
</span></span></code></pre></div><p><img src="/posts/project/20220528231163/image-20220528231840561.png"
    
    
    
    loading="lazy"
    
    
></p>
<h4 id="244-推送到远程仓库">2.4.4 推送到远程仓库：</h4>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git push origin master
</span></span></code></pre></div><p><img src="/posts/project/20220528231163/image-20220528232101074.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>效果：</p>
<p><img src="/posts/project/20220528231163/image-20220528232108988.png"
    
    
    
    loading="lazy"
    
    
></p>
<div style="page-break-after: always;"></div>
<h2 id="25-创建项目模块">2.5. 创建项目模块</h2>
<h3 id="251-创建广告内容服务模块">2.5.1. 创建广告内容服务模块</h3>
<p><img src="/posts/project/20220528231163/image-20220528232117827.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528231163/image-20220528232123799.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528231163/image-20220528232130666.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528231163/image-20220528232137279.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>创建完成：
<img src="/posts/project/20220528231163/image-20220528232143745.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>项目统一定义springCloud和spring cloud alibaba版本及初始化依赖：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;properties&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;java.version&gt;</span>1.8<span class="nt">&lt;/java.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;spring-cloud-alibaba.version&gt;</span>2.2.0.RELEASE<span class="nt">&lt;/spring-cloud-alibaba.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;spring-cloud.version&gt;</span>Hoxton.RELEASE<span class="nt">&lt;/spring-cloud.version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/properties&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-web<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-openfeign<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-test<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;exclusions&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;exclusion&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;groupId&gt;</span>org.junit.vintage<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;artifactId&gt;</span>junit-vintage-engine<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;/exclusion&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/exclusions&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependencies&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependencyManagement&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>spring-cloud-dependencies<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>${spring-cloud.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>com.alibaba.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>spring-cloud-alibaba-dependencies<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>${spring-cloud-alibaba.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependencies&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependencyManagement&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;build&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;plugins&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;plugin&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/plugin&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/plugins&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/build&gt;</span>
</span></span></code></pre></div><h3 id="252-创建会员服务模块">2.5.2. 创建会员服务模块</h3>
<p>新建模块：
<img src="/posts/project/20220528231163/image-20220528232153845.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528231163/image-20220528232158804.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>其他项，参考广告内容服务模块。</p>
<h3 id="253-创建题目服务模块">2.5.3. 创建题目服务模块</h3>
<p><img src="/posts/project/20220528231163/image-20220528232206539.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528231163/image-20220528232214200.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>其他项参考广告内容服务模块</p>
<h3 id="254-完整工程">2.5.4. 完整工程</h3>
<p><img src="/posts/project/20220528231163/image-20220528232224539.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>设置uxue父工程管理相关子模块，修改pom.xml</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;modules&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;module&gt;</span>u-context<span class="nt">&lt;/module&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;module&gt;</span>u-member<span class="nt">&lt;/module&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;module&gt;</span>u-question<span class="nt">&lt;/module&gt;</span>   
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/modules&gt;</span>
</span></span></code></pre></div><p>修改后刷新maven
<img src="/posts/project/20220528231163/image-20220528232232486.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>接下来把这些新模块push到gitee。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">git add .
</span></span><span class="line"><span class="cl">git commit -m <span class="s2">&#34;创建后台工程&#34;</span>
</span></span><span class="line"><span class="cl">git push origin master
</span></span></code></pre></div><p><img src="/posts/project/20220528231163/image-20220528232238099.png"
    
    
    
    loading="lazy"
    
    
></p>
<h1 id="3搭建管理后台">3、搭建管理后台</h1>
<p>管理后台使用人人开源的后台管理框架，完成快速搭建。</p>
<h2 id="31下载人人开源后台管理框架">3.1、下载人人开源后台管理框架</h2>
<p>renren-fast 管理后台后端（服务端）
<a class="link" href="/posts/project/https://gitee.com/renrenio/renren-fast.git"  target="_blank" rel="noopener"
    >https://gitee.com/renrenio/renren-fast.git</a></p>
<p>renren-fast-vue 管理后台前端（VUE前端界面）
<a class="link" href="/posts/project/https://gitee.com/renrenio/renren-fast-vue.git"  target="_blank" rel="noopener"
    >https://gitee.com/renrenio/renren-fast-vue.git</a></p>
<h2 id="32添加人人开源管理后端代码到java项目">3.2、添加人人开源管理后端代码到java项目</h2>
<p>拷贝文件夹renren-fast到uxue根目录
<img src="/posts/project/20220528231163/image-20220528232246065.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>POM文件 添加模块管理</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;module&gt;renren-fast&lt;/module&gt;
</span></span></code></pre></div><p>刷新项目maven
<img src="/posts/project/20220528231163/image-20220528232253791.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="33修改renren-fast-服务的配置文件">3.3、修改renren-fast 服务的配置文件</h2>
<p>文件路径：src/main/resources/application-dev.yml</p>
<p>修改数据库连接为自己的mysql数据库连接</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yml" data-lang="yml"><span class="line"><span class="cl"><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">datasource</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">type</span><span class="p">:</span><span class="w"> </span><span class="l">com.alibaba.druid.pool.DruidDataSource</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">druid</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">driver-class-name</span><span class="p">:</span><span class="w"> </span><span class="l">com.mysql.cj.jdbc.Driver</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l">jdbc:mysql://localhost:3306/uxue_admin?useUnicode=true&amp;characterEncoding=UTF-8&amp;serverTimezone=Asia/Shanghai</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l">root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l">root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">initial-size</span><span class="p">:</span><span class="w"> </span><span class="m">10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">max-active</span><span class="p">:</span><span class="w"> </span><span class="m">100</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">min-idle</span><span class="p">:</span><span class="w"> </span><span class="m">10</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">max-wait</span><span class="p">:</span><span class="w"> </span><span class="m">60000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">pool-prepared-statements</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">max-pool-prepared-statement-per-connection-size</span><span class="p">:</span><span class="w"> </span><span class="m">20</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">time-between-eviction-runs-millis</span><span class="p">:</span><span class="w"> </span><span class="m">60000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">min-evictable-idle-time-millis</span><span class="p">:</span><span class="w"> </span><span class="m">300000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c">#Oracle需要打开注释</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="c">#validation-query: SELECT 1 FROM DUAL</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">test-while-idle</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">test-on-borrow</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">test-on-return</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">stat-view-servlet</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">enabled</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">url-pattern</span><span class="p">:</span><span class="w"> </span><span class="l">/druid/*</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c">#login-username: admin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="c">#login-password: admin</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span><span class="nt">filter</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">stat</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="nt">log-slow-sql</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="nt">slow-sql-millis</span><span class="p">:</span><span class="w"> </span><span class="m">1000</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="nt">merge-sql</span><span class="p">:</span><span class="w"> </span><span class="kc">false</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span><span class="nt">wall</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                    </span><span class="nt">config</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                        </span><span class="nt">multi-statement-allow</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w">
</span></span></span></code></pre></div><h2 id="34启动renren-fast服务">3.4、启动renren-fast服务</h2>
<p>运行renren-fast后台
<img src="/posts/project/20220528231163/image-20220528232301879.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>启动运行成功：
<img src="/posts/project/20220528231163/image-20220528232308212.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="35测试服务运行状态">3.5、测试服务运行状态</h2>
<p>浏览器输入：http://localhost:8080/renren-fast/</p>
<p>显示结果：
<img src="/posts/project/20220528231163/image-20220528232314470.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>结果如上所示，则表示服务运行正常。另外结果里面的invalid token说明权限不足，不是指服务不正常。</p>
<h1 id="4-逆向工程生成代码">4. 逆向工程生成代码</h1>
<h2 id="41下载代码生成器框架">4.1、下载代码生成器框架</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">git clone https://gitee.com/renrenio/renren-generator.git
</span></span></code></pre></div><h2 id="42导入生成器代码到uxue项目">4.2、导入生成器代码到uxue项目</h2>
<p>拷贝文件夹renren-fast到uxue项目根目录
<img src="/posts/project/20220528231163/image-20220528232321171.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>POM文件 添加依赖</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;module&gt;renren-generator&lt;/module&gt;
</span></span></code></pre></div><p>最终uxue项目结构：
<img src="/posts/project/20220528231163/image-20220528232328373.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="43逆向生成管理前后端代码">4.3、逆向生成管理前后端代码</h2>
<p>下面以生成context广告内容服务的代码为例，其他模块操作类似！！！！！！！</p>
<h3 id="431-修改配置">4.3.1. 修改配置</h3>
<p>（1）、修改application.yml，把数据库及其连接信息改成广告的数据库：uxue_cms
<img src="/posts/project/20220528231163/image-20220528232335628.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>（2）、修改generator.properties：
<img src="/posts/project/20220528231163/image-20220528232340696.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>（3）、修改controller模板文件</p>
<p>src/main/resources/template/Controller.java.vm</p>
<p>暂时删除引入的包，后面再引入</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">//import org.apache.shiro.authz.annotation.RequiresPermissions;
</span></span></code></pre></div><p>注释RequiresPermissions注解，后面再引入</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">//@RequiresPermissions(&#34;${moduleName}:${pathName}:list&#34;)
</span></span></code></pre></div><h3 id="432-启动逆向工程">4.3.2. 启动逆向工程</h3>
<p>启动RenrenApplication：
<img src="/posts/project/20220528231163/image-20220528232352054.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>启动成功，监听端口号为80。浏览器访问，点击renren-fast,出现生成界面，可以看到数据表
<img src="/posts/project/20220528231163/image-20220528232357719.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>选中全部表，点击生成代码按钮，即可生成一个压缩包，被下载下来：
<img src="/posts/project/20220528231163/image-20220528232403217.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>找到压缩包。</p>
<h3 id="433-把文件copy到对应工程">4.3.3. 把文件copy到对应工程</h3>
<ol>
<li>
<p>打开压缩包，压缩包/main/java下的com目录，copy到u-context模块的src/main/java：
<img src="/posts/project/20220528231163/image-20220528232409260.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>效果如下：</p>
</li>
</ol>
<p><img src="/posts/project/20220528231163/image-20220528232457245.png"
    
    
    
    loading="lazy"
    
    
></p>
<ol start="2">
<li>
<p>把压缩包/main/resources下的mapper目录，copy到ucontext模块的src/java/resources目录下：
<img src="/posts/project/20220528231163/image-20220528232503662.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>如下：</p>
</li>
</ol>
<p><img src="/posts/project/20220528231163/image-20220528232515100.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="44添加common-模块">4.4、添加common 模块</h2>
<p>因为自动生成的代码引用了一些工具类，而我们的项目中没有，所以需要加个common模块添加一些工具类
<img src="/posts/project/20220528231163/image-20220528232522852.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>在uxue项目新建子模块u-common</p>
<p>New Module: 选择Maven
<img src="/posts/project/20220528231163/image-20220528232536141.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528231163/image-20220528232543024.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528231163/image-20220528232549340.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528231163/image-20220528232555938.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="441修改u-common模块的依赖">4.4.1、修改u-common模块的依赖</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--mybatis-plus DAO层工具 https://mp.baomidou.com/--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>com.baomidou<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>mybatis-plus<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;version&gt;</span>3.3.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--mybatis-plus整合springboot依赖包--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;groupId&gt;</span>com.baomidou<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;artifactId&gt;</span>mybatis-plus-boot-starter<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">   <span class="nt">&lt;version&gt;</span>3.4.2<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--添加mysql驱动--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>mysql<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>mysql-connector-java<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;version&gt;</span>5.1.32<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--lombok 不需要写getter,setter方法了--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>org.projectlombok<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>lombok<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;version&gt;</span>1.18.12<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--httpcore 依赖--&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>org.apache.httpcomponents<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>httpcore<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;version&gt;</span>4.4.12<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--commons-lang 依赖 --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>commons-lang<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>commons-lang<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;version&gt;</span>2.6<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="c">&lt;!--  导入servlet-api 依赖  --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>javax.servlet<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>servlet-api<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;version&gt;</span>2.5<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;scope&gt;</span>provided<span class="nt">&lt;/scope&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependencies&gt;</span>
</span></span></code></pre></div><h3 id="442u-common模块添加工具类">4.4.2、u-common模块添加工具类</h3>
<p>添加包:com.offcn.common.utils</p>
<p>从renren-fast项目copy文件:</p>
<p>Constans.java、PageUtils.java、Query.java、R.java、RRException.java
<img src="/posts/project/20220528231163/image-20220528232605717.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>添加包:com.offcn.common.xss</p>
<p>从renren-fast项目copy文件: HTMLFilter.java、SQLFilter.java
<img src="/posts/project/20220528231163/image-20220528232612819.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>修改SQLFilter引入的RRException类所在的包为common下的。</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import com.offcn.common.utils.RRException;
</span></span></code></pre></div><p>修改类Query,把引入类SQLFilter,修改所在包为common下的：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">import com.offcn.common.xss.SQLFilter;
</span></span></code></pre></div><p>最终u-common目录结构如下：
<img src="/posts/project/20220528231163/image-20220528232624466.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="443u-context模块引入u-common依赖">4.4.3、u-context模块引入u-common依赖</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.offcn<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>u-common<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;version&gt;</span>1.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h3 id="444解决u-common编译错误">4.4.4、解决u-common编译错误</h3>
<p>执行mvn install 出现下面的错误：
<img src="/posts/project/20220528231163/image-20220528232631425.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>解决方案，修改模块pom.xml增加maven编译插件，指定jdk版本为1.8</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;build&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;plugins&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;plugin&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>org.apache.maven.plugins<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>maven-compiler-plugin<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>3.7.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;configuration&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;source&gt;</span>1.8<span class="nt">&lt;/source&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;target&gt;</span>1.8<span class="nt">&lt;/target&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;encoding&gt;</span>UTF-8<span class="nt">&lt;/encoding&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;/configuration&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/plugin&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/plugins&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/build&gt;</span>
</span></span></code></pre></div><h2 id="45生成其他服务的代码">4.5、生成其他服务的代码</h2>
<p>参考u-context的代码生成方式，生成其他模块的代码</p>
<table>
<thead>
<tr>
<th>服务名称</th>
<th>对应数据库名称</th>
<th>模块名称</th>
<th>监听端口</th>
</tr>
</thead>
<tbody>
<tr>
<td>广告内容服务</td>
<td>uxue_cms</td>
<td>u-context</td>
<td>10001</td>
</tr>
<tr>
<td>会员服务</td>
<td>uxue_ums</td>
<td>u-member</td>
<td>10002</td>
</tr>
<tr>
<td>题目服务</td>
<td>uxue_qms</td>
<td>u-question</td>
<td>10003</td>
</tr>
</tbody>
</table>
<h1 id="5模块工程的配置">5、模块工程的配置</h1>
<p>后台管理模块，每个工程的配置方式基本一样。下面还是以u-context工程为例：</p>
<h2 id="51配置依赖">5.1、配置依赖</h2>
<p>每个服务到要依赖u-common包</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"> <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.offcn<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>u-common<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;version&gt;</span>1.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl"> <span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h2 id="52-工程参数配置">5.2、 工程参数配置</h2>
<p>application.yml配置文件：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">server</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">10001</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">datasource</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">url</span><span class="p">:</span><span class="w"> </span><span class="l">jdbc:mysql://localhost:3306/uxue_cms?serverTimezone=GMT%2B8&amp;characterEncoding=utf-8</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">username</span><span class="p">:</span><span class="w"> </span><span class="l">root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">password</span><span class="p">:</span><span class="w"> </span><span class="l">root</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">driver-class-name</span><span class="p">:</span><span class="w"> </span><span class="l">com.mysql.jdbc.Driver</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">mybatis-plus</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">mapper-locations</span><span class="p">:</span><span class="w"> </span><span class="l">classpath:/mapper/**/*.xml</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">global-config</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">db-config</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">id-type</span><span class="p">:</span><span class="w"> </span><span class="l">auto</span><span class="w">
</span></span></span></code></pre></div><h2 id="53在引导类上添加注解">5.3、在引导类上添加注解</h2>
<p>在u-context工程的主启动类（UContextApplication）上添加注解：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@SpringBootApplication</span>
</span></span><span class="line"><span class="cl"><span class="nd">@MapperScan</span><span class="o">(</span><span class="s">&#34;com.offcn.context.dao&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UContextApplication</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">UContextApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="54测试">5.4、测试</h2>
<p>启动主启动类，访问地址：http://localhost:10001/context/news/list
<img src="/posts/project/20220528231163/image-20220528232645724.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="55-参照u-context完成其他模块">5.5、 参照u-context完成其他模块</h2>
<p>其他模块都按照u-context的方式完成搭建。(其中学习服务和渠道服务省略)</p>
<table>
<thead>
<tr>
<th>服务名称</th>
<th>对应数据库名称</th>
<th>模块名称</th>
<th>监听端口</th>
</tr>
</thead>
<tbody>
<tr>
<td>广告内容服务</td>
<td>uxue_cms</td>
<td>u-context</td>
<td>10001</td>
</tr>
<tr>
<td>会员服务</td>
<td>uxue_ums</td>
<td>u-member</td>
<td>10002</td>
</tr>
<tr>
<td>题目服务</td>
<td>uxue_qms</td>
<td>u-question</td>
<td>10003</td>
</tr>
<tr>
<td><img src="/posts/project/20220528231163/image-20220528232651484.png"
    
    
    
    loading="lazy"
    
    
></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<p>全部服务测试地址：</p>
<p>http://localhost:10001/context/banner/list
http://localhost:10002/member/member/list
http://localhost:10003/question/question/list</p>
<h1 id="6搭建注册中心nacos">6、搭建注册中心Nacos</h1>
<h2 id="61-启动nacos服务">6.1 启动nacos服务</h2>
<p><strong>Linux/Unix/Mac</strong></p>
<p>启动命令(standalone代表着单机模式运行，非集群模式):</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">sh startup.sh -m standalone
</span></span></code></pre></div><p><strong>Windows</strong></p>
<p>启动命令：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">cmd startup.cmd -m standalone
</span></span></code></pre></div><p>或者双击startup.cmd运行文件。</p>
<p>访问：http://localhost:8848/nacos</p>
<p>用户名密码：nacos/nacos
<img src="/posts/project/20220528231163/image-20220528232658929.png"
    
    
    
    loading="lazy"
    
    
></p>
<h1 id="7注册各个微服务到nacos">7、注册各个微服务到Nacos</h1>
<h2 id="71修改u-context服务的pomxml引入注册到nacos所需依赖包">7.1、修改u-context服务的pom.xml引入注册到Nacos所需依赖包</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.alibaba.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h2 id="72修改配置文件applicationyml">7.2、修改配置文件application.yml</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl">spring:
</span></span><span class="line"><span class="cl">  application:
</span></span><span class="line"><span class="cl">    name: u-context
</span></span><span class="line"><span class="cl">  cloud:
</span></span><span class="line"><span class="cl">    nacos:
</span></span><span class="line"><span class="cl">      discovery:
</span></span><span class="line"><span class="cl">        server-addr: localhost:8848
</span></span></code></pre></div><h2 id="73修改主启动类添加注解">7.3、修改主启动类，添加注解</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@SpringBootApplication</span>
</span></span><span class="line"><span class="cl"><span class="nd">@MapperScan</span><span class="o">(</span><span class="s">&#34;com.offcn.context.dao&#34;</span><span class="o">)</span>
</span></span><span class="line"><span class="cl"><span class="nd">@EnableDiscoveryClient</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">UContextApplication</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">        <span class="n">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">UContextApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">    <span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h2 id="74启动主启动类查看nacos管理控制台成功注册">7.4、启动主启动类，查看nacos管理控制台，成功注册</h2>
<p><img src="/posts/project/20220528231163/image-20220528232706811.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="75注册人人管理后台服务到nacos">7.5、注册人人管理后台服务到Nacos</h2>
<p>配置模块renren-fast模块注册到nacos</p>
<h3 id="751引入nacos客户端依赖">7.5.1、引入nacos客户端依赖</h3>
<p>修改模块renren-fast的pom.xml</p>
<p>首先定义spring cloud alibaba的版本</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;properties&gt;</span>		
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;spring-cloud-alibaba.version&gt;</span>2.2.0.RELEASE<span class="nt">&lt;/spring-cloud-alibaba.version&gt;</span>		
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/properties&gt;</span>
</span></span></code></pre></div><p>引入spring cloud alibaba的依赖管理：</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;dependencyManagement&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">				<span class="nt">&lt;groupId&gt;</span>com.alibaba.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">				<span class="nt">&lt;artifactId&gt;</span>spring-cloud-alibaba-dependencies<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">				<span class="nt">&lt;version&gt;</span>${spring-cloud-alibaba.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">				<span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
</span></span><span class="line"><span class="cl">				<span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">		<span class="nt">&lt;/dependencies&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependencyManagement&gt;</span>
</span></span></code></pre></div><p>最后引入springcloudalibaba 注册到nacos的客户端依赖包</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="nt">&lt;groupId&gt;</span>com.alibaba.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">			<span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h3 id="752修改配置文件">7.5.2、修改配置文件</h3>
<p>修改配置文件application.yml声明应用名称</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">application</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">renren-fast</span><span class="w">
</span></span></span></code></pre></div><p>修改配置文件application-dev.yml，指定nacos服务器地址</p>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">cloud</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">       </span><span class="nt">nacos</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">           </span><span class="nt">discovery</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">               </span><span class="nt">server-addr</span><span class="p">:</span><span class="w"> </span><span class="l">http://localhost:8848</span><span class="w">
</span></span></span></code></pre></div><h3 id="753修改主启动类renrenapplication增加允许注册发现注解">7.5.3、修改主启动类RenrenApplication，增加允许注册发现注解</h3>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-java" data-lang="java"><span class="line"><span class="cl"><span class="nd">@SpringBootApplication</span>
</span></span><span class="line"><span class="cl"><span class="nd">@EnableDiscoveryClient</span>
</span></span><span class="line"><span class="cl"><span class="kd">public</span> <span class="kd">class</span> <span class="nc">RenrenApplication</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">	<span class="kd">public</span> <span class="kd">static</span> <span class="kt">void</span> <span class="nf">main</span><span class="o">(</span><span class="n">String</span><span class="o">[]</span> <span class="n">args</span><span class="o">)</span> <span class="o">{</span>
</span></span><span class="line"><span class="cl">		<span class="n">SpringApplication</span><span class="o">.</span><span class="na">run</span><span class="o">(</span><span class="n">RenrenApplication</span><span class="o">.</span><span class="na">class</span><span class="o">,</span> <span class="n">args</span><span class="o">);</span>
</span></span><span class="line"><span class="cl">	<span class="o">}</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="o">}</span>
</span></span></code></pre></div><h3 id="754启动主启动类查看服务是否注册到nacos">7.5.4、启动主启动类，查看服务是否注册到nacos</h3>
<p><img src="/posts/project/20220528231163/image-20220528232716475.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="76注册其他微服务到nacos">7.6、注册其他微服务到Nacos</h2>
<p>其他微服务和u-context服务一样的配置，全部注册到Nacos
<img src="/posts/project/20220528231163/image-20220528232722565.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="77注册到nacos失败">7.7、注册到nacos失败</h2>
<p>有的时候nacos服务器已经启动了，但是依然注册失败，</p>
<p>访问http://localhost:8848/nacos/v1/ns/instance 地址 提示如下：
<img src="/posts/project/20220528231163/image-20220528232727871.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>解决办法：把nacos服务器停掉，删除 nacos/data/protocol 目录
<img src="/posts/project/20220528231163/image-20220528232732789.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>然后重启nacos即可</p>
<h1 id="8-搭建网关服务">8、 搭建网关服务</h1>
<p><strong>nacos容器内的所有服务，可以直接相互访问。nacos外的服务，为了保证安全，必须通过网关访问后台各个管理模块</strong>
<img src="/posts/project/20220528231163/image-20220528232757159.png"
    
    
    
    loading="lazy"
    
    
>
<img src="/posts/project/20220528231163/image-20220528232806531.png"
    
    
    
    loading="lazy"
    
    
>
<img src="/posts/project/20220528231163/image-20220528232813994.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="81网关依赖配置文件pomxml">8.1、网关依赖配置文件pom.xml:</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-xml" data-lang="xml"><span class="line"><span class="cl"><span class="cp">&lt;?xml version=&#34;1.0&#34; encoding=&#34;UTF-8&#34;?&gt;</span>
</span></span><span class="line"><span class="cl"><span class="nt">&lt;project</span> <span class="na">xmlns=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0&#34;</span> <span class="na">xmlns:xsi=</span><span class="s">&#34;http://www.w3.org/2001/XMLSchema-instance&#34;</span>
</span></span><span class="line"><span class="cl">         <span class="na">xsi:schemaLocation=</span><span class="s">&#34;http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd&#34;</span><span class="nt">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;modelVersion&gt;</span>4.0.0<span class="nt">&lt;/modelVersion&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;parent&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-parent<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;version&gt;</span>2.3.7.RELEASE<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;relativePath/&gt;</span> <span class="c">&lt;!-- lookup parent from repository --&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/parent&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;groupId&gt;</span>com.offcn<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;artifactId&gt;</span>cloud-gateway<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;version&gt;</span>1.0<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;name&gt;</span>cloud-gateway<span class="nt">&lt;/name&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;description&gt;</span>Demo project for Spring Boot<span class="nt">&lt;/description&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;properties&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;java.version&gt;</span>1.8<span class="nt">&lt;/java.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;spring-cloud.version&gt;</span>Hoxton.SR9<span class="nt">&lt;/spring-cloud.version&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;spring-cloud-alibaba.version&gt;</span>2.2.3.RELEASE<span class="nt">&lt;/spring-cloud-alibaba.version&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/properties&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-gateway<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-boot-starter-test<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;scope&gt;</span>test<span class="nt">&lt;/scope&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;exclusions&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;exclusion&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;groupId&gt;</span>org.junit.vintage<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                    <span class="nt">&lt;artifactId&gt;</span>junit-vintage-engine<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;/exclusion&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/exclusions&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;groupId&gt;</span>com.alibaba.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;artifactId&gt;</span>spring-cloud-starter-alibaba-nacos-discovery<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependencies&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;dependencyManagement&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;dependencies&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>org.springframework.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>spring-cloud-dependencies<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>${spring-cloud.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;dependency&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>com.alibaba.cloud<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>spring-cloud-alibaba-dependencies<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;version&gt;</span>${spring-cloud-alibaba.version}<span class="nt">&lt;/version&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;type&gt;</span>pom<span class="nt">&lt;/type&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;scope&gt;</span>import<span class="nt">&lt;/scope&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/dependency&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/dependencies&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/dependencyManagement&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;build&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;plugins&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;plugin&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;groupId&gt;</span>org.springframework.boot<span class="nt">&lt;/groupId&gt;</span>
</span></span><span class="line"><span class="cl">                <span class="nt">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span class="nt">&lt;/artifactId&gt;</span>
</span></span><span class="line"><span class="cl">            <span class="nt">&lt;/plugin&gt;</span>
</span></span><span class="line"><span class="cl">        <span class="nt">&lt;/plugins&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="nt">&lt;/build&gt;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="nt">&lt;/project&gt;</span>
</span></span></code></pre></div><h2 id="82applicationyml配置路由转发">8.2、application.yml配置路由转发：</h2>
<div class="highlight"><pre tabindex="0" class="chroma"><code class="language-yaml" data-lang="yaml"><span class="line"><span class="cl"><span class="nt">server</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">port</span><span class="p">:</span><span class="w"> </span><span class="m">8888</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="nt">spring</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">cloud</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">nacos</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">discovery</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span><span class="nt">server-addr</span><span class="p">:</span><span class="w"> </span><span class="l">localhost:8848</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">gateway</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">      </span><span class="nt">routes</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l">cms-route</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">uri</span><span class="p">:</span><span class="w"> </span><span class="l">lb://u-context</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">predicates</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="l">Path=/context/**</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">filters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">            </span>- <span class="l">RewritePath=/(?&lt;segment&gt;.*),/$\{segment}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l">qms-route</span><span class="w"> </span><span class="c"># 题目微服务路由</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">uri</span><span class="p">:</span><span class="w"> </span><span class="l">lb://u-question</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">predicates</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span>- <span class="l">Path=/question/**</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">filters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">              </span>- <span class="l">RewritePath=/(?&lt;segment&gt;.*),/$\{segment}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l">ums-route</span><span class="w"> </span><span class="c"># 用户微服务路由</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">uri</span><span class="p">:</span><span class="w"> </span><span class="l">lb://u-member</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">predicates</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">Path=/member/**</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">filters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">RewritePath=/(?&lt;segment&gt;.*),/$\{segment}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">        </span>- <span class="nt">id</span><span class="p">:</span><span class="w"> </span><span class="l">renrenfast-route</span><span class="w"> </span><span class="c"># 人人后台服务路由</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">uri</span><span class="p">:</span><span class="w"> </span><span class="l">lb://renren-fast</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">predicates</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">Path=/renren-fast/**</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">          </span><span class="nt">filters</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">                </span>- <span class="l">RewritePath=/renren-fast/(?&lt;segment&gt;.*),/renren-fast/$\{segment}</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">  </span><span class="nt">application</span><span class="p">:</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">    </span><span class="nt">name</span><span class="p">:</span><span class="w"> </span><span class="l">gateway</span><span class="w">
</span></span></span></code></pre></div><h2 id="83测试网关转发">8.3、测试网关转发</h2>
<p><img src="/posts/project/20220528231163/image-20220528232829033.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>测试各个微服务经过网关转发调用是否正常</p>
<table>
<thead>
<tr>
<th>服务名称</th>
<th>测试地址</th>
</tr>
</thead>
<tbody>
<tr>
<td>内容微服务</td>
<td>http://localhost:8888/context/banner/list</td>
</tr>
<tr>
<td>题目微服务</td>
<td>http://localhost:8888/question/question/list</td>
</tr>
<tr>
<td>用户微服务</td>
<td>http://localhost:8888/member/member/list</td>
</tr>
<tr>
<td>人人后台服务</td>
<td>http://localhost:8888/renren-fast/captcha.jpg?uuid=84d36089-07ae-4201-85c0-8217b032f21c</td>
</tr>
</tbody>
</table>

            </div>
            <hr>
            <div style="text-align: center;">
                <button class="btn"><a href="https://lovemjh.github.io/posts/project/20220528224436/">← tk-服务网关、Sentinel、Sleuth</a></button>
                <button class="btn"><a href="https://lovemjh.github.io/posts/project/20220528232959/">tk-题库项目开发2  →</a></button>
            </div>
        </article><div class="aside_content" id="aside_content">
    <div class="card-widget card-info">
        <div class="card-content">
            <div class="card-info-avatar is-center">
                <img class="avatar-img" src="http://q1.qlogo.cn/g?b=qq&nk=2409741052&s=640" alt="avatar">
                <div class="author-info__name">青山客</div>
                <div class="author-info__description">晓梦云码支付 <s>三网云端免挂/QQ/支付宝/微信</s>pay.yzfyd.cn</div>
            </div>
            <div class="card-info-social-icons is-center">
                <a class="social-icon" href="https://yzfyd.cn" target="_blank">
                    <i class="fa fa-github"></i>
                </a>
            </div>
        </div>
    </div>


    <div class="card-widget card-announcement">
        <div class="card-content">
            <meting-js auto="https://y.qq.com/n/yqq/playlist/7713574197.html">
            </meting-js>
        </div>
    </div>

    <div class="card-widget card-announcement">
        <div class="card-content">
            <div class="item-headline">
                <i class="fa fa-bullhorn" aria-hidden="true"></i>
                <span>一言</span>
            </div>
            <div id="hitokoto"></div>
        </div>
    </div>
    <div class="card-widget card-announcement">
        <div class="card-content">
            <div class="item-headline">
                <i class="fa fa-calendar" aria-hidden="true"></i>
                <span>今日诗词</span>
            </div>
            <div id="jinrishici-sentence"></div>
        </div>
    </div>

    <div class="card-widget card-webinfo">
        <div class="card-content">
            <div class="item-headline">
                <i class="fa fa-line-chart" aria-hidden="true"></i>
                <span>站点信息</span>
            </div>
            <div class="webinfo">
                <div class="webinfo-item">
                    <div class="webinfo-site-uv-name">本站访客数 :</div>
                    <div class="webinfo-site-uv-count" id="busuanzi_value_site_uv"></div>
                </div>
                <div class="webinfo-item">
                    <div class="webinfo-site-name">本站总访问量 :</div>
                    <div class="webinfo-site-pv-count" id="busuanzi_value_site_pv"></div>
                </div>
            </div>
        </div>
    </div>
    
    <div class="card-widget js-toc-w" id="js-toc-w">
        <div class="card-content js-toc">
            
        </div>
    </div>
    
</div></div>
</main>
<footer id="footer">
    <div id="footer-wrap">
        <div class="copyright">&copy;2019 - 2021 BY QING SHAN KE</div>
    </div>
</footer>
</div>
<div class="fan" id="fan" style="
position: fixed;
width: 40px;
height: 120px;
right: 0px;
bottom: 0px;
transition: all 0.5s;
z-index: 99999;
 ">

    <i class="fa fa-cog fa-spin fa-2x"></i><br>
    <i class="fa fa-align-justify fa-2x" id="ff"></i><br>
    <i class="fa fa fa-arrow-up fa-2x" id="aa"></i><br>
</div>


<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.11.1/tocbot.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
<script>

    var a = 0;
    ff.onclick = function () {

        if (a === 0) {
            $(".js-toc-w").css("position", "fixed"); 
            $(".js-toc-w").css("bottom", "10px");
            $(".js-toc-w").css("right", "40px");
            a++;
        } else {
            $(".js-toc-w").css("position", "static");
            a--;
        }

    }
    

    aa.onclick = function () {
        window.scrollTo({     
            top: 0,            
            behavior: "smooth"   
        })
    }



</script>
<script>
    $(window).scroll(function () {
        var scrollY = document.documentElement.scrollTop || document.body.scrollTop
        
        if (scrollY > 40) {
            $('.fan').css("right", "0px");
        } else {
            $('.fan').css("right", "-220px");
        }
    });

    $(function () {
        
        var start_height = $(document).scrollTop();
        
        var navigation_height = $('.navigation').outerHeight();
        $(window).scroll(function () {
            
            var end_height = $(document).scrollTop();
            
            if (end_height > navigation_height) {
                $('.navigation').addClass('hide');
            } else {
                $('.navigation').removeClass('hide');
            }
            
            if (end_height < start_height) {
                $('.navigation').removeClass('hide');
            }
            
            start_height = $(document).scrollTop();
        });
    });
</script>
<script>
    
    
    
    
    
    

    
    

    
    
    
    
    
    
    
    

    

</script>
<script src="https://cdn.jsdelivr.net/npm/jquery.fancybox@2.1.5/source/jquery.fancybox.js"></script>
<script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
<script src="https://cdn.jsdelivr.net/npm/instant.page@3.0.0/instantpage.js" type="module"></script>
<script src="https://cdn.jsdelivr.net/npm/lazysizes@5.2.0/lazysizes.min.js" async></script>


<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.css">
<script src="https://cdn.jsdelivr.net/npm/aplayer/dist/APlayer.min.js"></script>

<script src="https://cdn.jsdelivr.net/npm/meting@2/dist/Meting.min.js"></script>


<script src="https://unpkg.com/nplayer@latest/dist/index.min.js"></script>


<script src="https://v1.hitokoto.cn/?encode=js&select=%23hitokoto" defer></script>
<script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>





<script src="https://cdn.jsdelivr.net/gh/TRHX/CDN-for-itrhx.com@3.0.8/js/maodian.js"></script>


<script>
    tocbot.init({
        
        tocSelector: '.js-toc',
        
        contentSelector: '.js-toc-content',
        
        headingSelector: 'h1, h2, h3, h4, h5 ,h6',
        
        hasInnerContainers: false,
        
    });
</script>


<script type="text/javascript">
    console.clear();
    console.log("%c 有朋自远方来, 不亦说乎.", "background:#24272A; color:#ffffff", "");
    console.log("%c Github %c", "background:#24272A; color:#ffffff", "", "https://github.com/laoxuai");
    console.log("%c 版本号: %c", "background:#24272A; color:#ffffff", "", "1.0.0");

    (function ($) {
        $.fn.snow = function (options) {
            var $flake = $('<div id="snowbox" />').css({ 'position': 'absolute', 'z-index': '9999', 'top': '-50px' }).html('&#10052;'),
                documentHeight = $(document).height(),
                documentWidth = $(document).width(),
                defaults = {
                    minSize: 10,
                    maxSize: 20,
                    newOn: 1000,
                    flakeColor: "#AFDAEF"  
                },
                options = $.extend({}, defaults, options);
            var interval = setInterval(function () {
                var startPositionLeft = Math.random() * documentWidth - 100,
                    startOpacity = 0.5 + Math.random(),
                    sizeFlake = options.minSize + Math.random() * options.maxSize,
                    endPositionTop = documentHeight - 200,
                    endPositionLeft = startPositionLeft - 500 + Math.random() * 500,
                    durationFall = documentHeight * 10 + Math.random() * 5000;
                $flake.clone().appendTo('body').css({
                    left: startPositionLeft,
                    opacity: startOpacity,
                    'font-size': sizeFlake,
                    color: options.flakeColor
                }).animate({
                    top: endPositionTop,
                    left: endPositionLeft,
                    opacity: 0.2
                }, durationFall, 'linear', function () {
                    $(this).remove()
                });
            }, options.newOn);
        };
    })(jQuery);
    $(function () {
        $.fn.snow({
            minSize: 5,  
            maxSize: 50, 
            newOn: 800   
        });
    });

    
    var OriginTitle = document.title;
    var titleTime;
    document.addEventListener('visibilitychange', function () {
        if (document.hidden) {
            
            document.title = '╭(°A°`)╮ 页面崩溃啦 ~';
            clearTimeout(titleTime);
        }
        else {
            $('[rel="icon"]').attr('href', "/favicon.ico");
            document.title = '(ฅ>ω<*ฅ) 噫又好啦 ~' + OriginTitle;
            titleTime = setTimeout(function () {
                document.title = OriginTitle;
            }, 2000);
        }
    });
</script></body>
</html>
