<!DOCTYPE html>
<html lang="zh-CN"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="description" content="tk-题库项目开发2 - https://lovemjh.vercel.app/posts/project/20220528232959/">
    
    <meta name="msvalidate.01" content="B46311949B856F2A7015F366FB3CE878" />
    <title>tk-题库项目开发2</title>
    <link rel="icon" type="image/png" href="/favicon.ico">
    
    <link rel="stylesheet" href="https://lovemjh.vercel.app/style.min.ef012369a26adc2a21396230b3395dfcd5975a3082a65b82785cbc0b446f2a2c.css">
    
    <script type="text/javascript" src="/main.js" defer></script>
    
</head>
<body class="active-animate cool">
        <div id="header"><div class="container-header">
    <div id="vars" class="container-vars" style="display: none;">
	{
		"hasFoldAllCodeBlocks": false,
		"svgColor": "#6c757d",
		"en": false,
		"dark": false
	}
</div>
    <h1 class="title">
        
            tk-题库项目开发2
            
        
    </h1>

    <div class="container-breadcrumb-nav">
    
    <div class="breadcrumb-nav-bar">
        <div><a href="/"><svg t="1656411084410" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2954" width="16" height="16"><path d="M947.5 390.6l-377-290c-34.5-26.5-82.6-26.5-117.1 0l-377 290c-14 10.8-16.6 30.9-5.9 44.9 10.8 14 30.9 16.6 44.9 5.9l28.5-21.9V768c0 88.2 71.8 160 160 160h80c35.3 0 64-28.7 64-64V640c0-17.6 14.4-32 32-32h64c17.6 0 32 14.4 32 32v224c0 35.3 28.7 64 64 64h80c88.2 0 160-71.8 160-160V419.4l28.5 21.9c5.8 4.5 12.7 6.6 19.5 6.6 9.6 0 19.1-4.3 25.4-12.5 10.8-13.9 8.2-34-5.8-44.8zM816 768c0 52.9-43.1 96-96 96h-80V640c0-52.9-43.1-96-96-96h-64c-52.9 0-96 43.1-96 96v224h-80c-52.9 0-96-43.1-96-96V370.2l284.5-218.8c11.5-8.8 27.5-8.8 39 0L816 370.2V768z" fill=#6c757d p-id="2955"></path></svg></a></div>
        <div><a href="/nav"><svg t="1656411531924" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5827" width="16" height="16"><path d="M849.59197473 125.23018519L139.22930586 391.72854662a23.35052669 23.35052669 0 0 0-14.95414244 21.65490745c-0.12257519 9.70384955 5.61801843 18.46795771 14.40255493 22.04306141l318.42928099 129.25528056 119.51057092 320.39047893c3.06437293 8.23295069 10.35758221 13.89182751 18.7335381 14.87242563l2.7170774 0.14300521a22.79893918 22.79893918 0 0 0 21.20546682-15.36272638l259.51158924-729.54564933a23.8612558 23.8612558 0 0 0-5.31158128-24.55584682 22.3290685 22.3290685 0 0 0-23.9021142-5.43415649zM793.65694081 211.64552314l-196.63064161 552.75171747-91.91077952-246.37564122-253.62799211-102.96295445 542.16941324-203.4131218z" p-id="5828" fill=#6c757d></path></svg></a></div>
        <div><a href="/search"><svg t="1656411627509" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1730" width="14" height="14"><path d="M469.333333 85.333333c211.968 0 384 172.032 384 384s-172.032 384-384 384-384-172.032-384-384 172.032-384 384-384z m0 682.666667c164.992 0 298.666667-133.674667 298.666667-298.666667 0-165.034667-133.674667-298.666667-298.666667-298.666666-165.034667 0-298.666667 133.632-298.666666 298.666666 0 164.992 133.632 298.666667 298.666666 298.666667z m362.026667 3.029333l120.704 120.661334-60.373333 60.373333-120.661334-120.704 60.330667-60.330667z" p-id="1731" fill=#6c757d></path></svg></a></div>
        <div><a href="/posts"><svg t="1656411724198" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5655" width="12" height="12"><path d="M811.705761 1024H212.294239c-93.1199 0-174.823046-87.570975-174.823046-187.387854V162.322018C37.471193 69.776145 112.604921 0 212.294239 0H596.190595l7.015883 5.93161c111.74388 95.479788 185.857116 170.741078 279.614824 266.093304 29.65805 30.040735 61.165743 62.122454 96.436499 97.393211l7.271006 7.334787v459.859234c-0.063781 99.816879-81.703145 187.387854-174.823046 187.387854zM212.294239 49.94033c-72.391155 0-124.882716 47.261538-124.882716 112.381688v674.290128c0 71.94469 59.507443 137.383743 124.882716 137.383743h599.411522c65.311492 0 124.882716-65.439053 124.882716-137.383743V397.417876c-32.528184-32.464404-61.73977-62.250016-89.356836-90.377328-90.951355-92.418312-163.278729-165.957521-269.601245-257.163999H212.294239z" fill=#6c757d p-id="5656"></path><path d="M936.588477 449.526752h-212.326129c-99.753099 0-187.324073-81.703145-187.324073-174.823046V49.94033a25.002055 25.002055 0 0 1 49.94033 0v224.763376c0 65.311492 65.502834 124.882716 137.383743 124.882716h212.326129a25.002055 25.002055 0 1 1 0 49.94033z" fill=#6c757d p-id="5657"></path></svg></a></div>
        <div><a href="/archive"><svg t="1656411795742" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7334" width="12" height="12"><path d="M884.224 522.24H504.32V141.824c0-16.896-13.824-30.72-30.72-30.72-120.32 0-233.472 47.616-317.952 134.144S26.112 445.952 29.184 566.784c2.56 114.688 49.152 222.72 131.072 304.128 81.92 81.408 189.952 128 304.64 130.56h10.24c117.76 0 227.84-45.568 312.32-128.512 86.528-85.504 133.632-199.68 132.608-321.024-0.512-2.048-1.536-29.696-35.84-29.696z m-140.288 307.712c-74.752 73.728-173.056 112.64-277.504 110.592-205.824-4.608-370.688-169.472-375.296-374.784-3.072-104.448 35.84-202.752 108.544-277.504 65.536-67.072 151.552-107.52 243.712-114.688v378.88c0 16.896 13.824 30.72 30.72 30.72 129.024 0 311.296 0 382.976 0.512-6.144 93.184-46.08 179.712-113.152 246.272z" fill=#6c757d p-id="7335"></path><path d="M603.136 11.264c-8.192-0.512-15.872 3.072-22.016 8.704-5.632 5.632-9.216 13.824-9.216 22.016v378.88c0 16.896 13.824 30.72 30.72 30.72h378.88c16.896 0 30.72-13.824 30.72-30.72 0-223.744-183.808-407.552-409.088-409.6z m30.208 378.88V74.24c167.424 16.384 301.056 150.016 315.904 315.904h-315.904z" fill=#6c757d p-id="7336"></path></svg></a></div>
        <div id="light-dark" style="cursor: pointer;"><a><svg t="1656411842215" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5086" width="12" height="12"><path d="M1007.492874 384.513055c-8.795694-34.58307-21.189627-67.666874-36.682043-99.05151-2.698679-5.397358-10.894667-3.498287-10.894666 2.598728v0.299853c0 32.484098-6.896624 63.868734-19.890263 92.554691-10.694764 23.488501-25.487523 45.077933-43.978471 64.068635-41.779547 42.679107-99.05151 66.967217-158.722299 67.26707-61.869712 0.299853-119.941284-24.188159-162.920244-68.966238-40.280281-41.979449-62.56937-98.251902-62.269516-156.323473 0.399804-59.270984 23.588452-114.94373 65.567901-156.823229 19.59041-19.59041 42.179351-35.082826 66.667364-46.077443C672.956643 71.166451 704.041426 64.469729 736.125719 64.469729h1.299364c6.097015 0 8.096037-8.096037 2.598728-10.794715C708.739126 37.982696 675.655322 25.488812 641.172203 16.493216 599.492607 5.598549 555.714038-0.098662 510.536154 0.001289 222.37722 0.700947-7.41029 237.38508 0.185992 525.444064c7.096526 271.667008 225.889418 490.559851 497.456474 497.856279 287.559228 7.796183 524.14341-220.891864 525.842579-508.551044 0.299853-44.977981-5.297407-88.656599-15.992171-130.236244z m-83.15929 301.552378c-22.588942 53.27392-54.873137 101.250434-95.953027 142.330323-41.179841 41.179841-89.056403 73.464036-142.330324 95.953027-55.172991 23.288599-113.744317 35.182777-174.314666 35.182777s-119.141675-11.794226-174.314666-35.182777c-53.27392-22.588942-101.250434-54.873137-142.330323-95.953027-41.179841-41.179841-73.464036-89.056403-95.953027-142.330323C75.749001 630.892442 63.954774 572.221164 63.954774 511.750767s11.794226-119.141675 35.182777-174.314666c22.588942-53.27392 54.873137-101.250434 95.953027-142.330323 41.179841-41.179841 89.056403-73.464036 142.330323-95.953027C392.593892 75.7642 451.26517 63.969974 511.735567 63.969974c13.99315 0 27.886348 0.599706 41.679596 1.89907C489.246577 118.643209 448.266638 198.704016 448.266638 288.360126c0 159.022152 128.836929 287.859081 287.859081 287.859081 89.156354 0 168.817357-40.580134 221.691473-104.149015 1.099462 13.09359 1.699168 26.387082 1.699168 39.680575 0 60.470397-11.794226 119.141675-35.182776 174.314666z" p-id="5087" fill=#6c757d></path></svg></a></div>
        
    </div>

    
</div>

            <div id="toc">📜</div>
        
    
    
</div>
</div>
        <div id="content">












<div class="container-main 
     container-page 
">

    <div class="desc">
        
        <span>
            
            <svg t="1656736000388" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7409" width="12" height="12"><path d="M524.885333 338.986667L200.362667 663.466667c-17.28 15.274667-27.989333 36.693333-29.696 56.234666v133.76l130.730666 0.085334c22.784-1.621333 43.989333-12.245333 61.013334-31.701334l322.688-322.645333-160.213334-160.213333z m60.373334-60.330667l160.170666 160.213333 102.144-102.144a19.712 19.712 0 0 0 0-27.861333L715.093333 176.426667a19.456 19.456 0 0 0-27.605333 0L585.258667 278.613333zM701.312 85.333333c27.946667 0 54.741333 11.136 74.282667 30.848l132.309333 132.309334a105.045333 105.045333 0 0 1 0 148.565333L424.874667 879.957333c-29.824 34.346667-72.106667 55.466667-120.448 58.794667H85.333333v-42.666667l0.128-179.84c3.626667-44.970667 24.576-86.826667 56.448-114.944l485.12-485.034666A104.789333 104.789333 0 0 1 701.269333 85.333333z" p-id="7410" fill="#adb5bd"></path></svg>
            2022-05-28&nbsp;
        </span>
        <span>
            
            <svg t="1656737270708" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="23838" width="11" height="11"><path d="M824.264 95.36c0-23.859 25.043-44.16 48.902-44.16s49.714 20.301 49.714 44.16v190.08c0 23.859-19.054 52.868-42.913 52.868h-190.08c-23.859 0-46.696-25.96-46.696-49.819s22.55-46.249 46.409-46.249h82.025C702.344 175.534 610.22 155.853 512 155.853c-206.775 0-360.398 149.372-360.398 356.147 0 206.775 153.623 358.23 360.398 358.23 206.775 0 357.467-151.455 357.467-358.23 0-23.859 23.634-50.706 53.413-50.706 29.78 0 49.92 26.847 49.92 50.706 0 254.493-206.307 460.8-460.8 460.8-254.493 0-460.8-206.307-460.8-460.8C51.2 257.507 257.507 51.2 512 51.2c122.4 0 226.684 33.296 312.264 117.369 0.358 0.351 0.358-24.052 0-73.209z" p-id="23839" fill="#adb5bd"></path></svg>
            2022-05-28&nbsp;&nbsp;&nbsp;
        </span>
        <span>
            
            <svg t="1656737548689" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="33866" width="12" height="12"><path d="M832.038608 64.662657H192.030028C121.255125 64.662657 63.940169 121.98845 63.940169 192.694717v446.793671C63.940169 710.205493 121.255125 767.643272 192.030028 767.643272h133.353183a63.940169 63.940169 0 0 1 55.219742 31.576328l76.099638 129.83828c12.358154 21.093031 33.790754 31.626903 55.216129 31.626903s42.832688-10.544709 55.198067-31.619678l76.222461-129.870792a63.940169 63.940169 0 0 1 55.212517-31.551041h133.54103c70.576219 0 127.732228-57.289669 127.732227-127.800865V192.391272C959.825022 121.85479 902.643727 64.662657 832.038608 64.662657zM895.884854 639.842407A63.85347 63.85347 0 0 1 832.092795 703.703103h-133.54103a127.753903 127.753903 0 0 0-110.349172 63.09847l-76.222461 129.856342a0.274545 0.274545 0 0 1 0-0.050574h-0.032512s-0.021675 0.061411-0.032512 0.061412l-76.1466-129.85273A127.804477 127.804477 0 0 0 325.383211 703.703103H192.030028A64.207489 64.207489 0 0 1 127.880338 639.488388V192.694717A64.102729 64.102729 0 0 1 192.030028 128.602826h640.00858A63.799284 63.799284 0 0 1 895.884854 192.391272v447.451135z" fill="#adb5bd" p-id="33867"></path><path d="M608.154093 288.092004A31.970084 31.970084 0 0 0 576.184009 320.062089v160.078006l-134.650049-179.278119A31.970084 31.970084 0 0 0 384.002258 320.062089v255.760676a31.970084 31.970084 0 0 0 63.940169 0v-159.958796l134.650048 179.274507a31.970084 31.970084 0 0 0 57.531703-19.200113V320.062089a31.970084 31.970084 0 0 0-31.970085-31.970085z" fill="#adb5bd" p-id="33868"></path></svg>
            10700 字</span>&nbsp;
        <span>
            
            <svg t="1656737462334" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="32892" width="12" height="12"><path d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667z m0 810.666666c-204.8 0-373.333333-168.533333-373.333333-373.333333S307.2 138.666667 512 138.666667 885.333333 307.2 885.333333 512 716.8 885.333333 512 885.333333z" p-id="32893" fill="#adb5bd"></path><path d="M695.466667 567.466667l-151.466667-70.4V277.333333c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v238.933334c0 12.8 6.4 23.466667 19.2 29.866666l170.666667 81.066667c4.266667 2.133333 8.533333 2.133333 12.8 2.133333 12.8 0 23.466667-6.4 29.866666-19.2 6.4-14.933333 0-34.133333-17.066666-42.666666z" p-id="32894" fill="#adb5bd"></path></svg>
            22 分钟</span><div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
			<a href="/categories/"></a>
			
		</div>
		<div class="tag">
			
			 - 
			
			<a href="/tags/"></a>
			
		</div>
	</div>
</div>
    </div>
    
    <div class="toc">
        
        <div class="page-operation">
            <div><a href="#"><img src="/imgs/icons/arrow-up-circle.svg" alt=""></a></div>
            <div><a href="https://lovemjh.vercel.app/posts/project/20220528231163/"><img src="/imgs/icons/arrow-left-circle.svg" alt=""></a></div>
            <div><a href="https://lovemjh.vercel.app/posts/project/20220528234610/"><img src="/imgs/icons/arrow-right-circle.svg" alt=""></a></div>
        </div>
        
        <nav id="TableOfContents">
  <ul>
    <li>
      <ul>
        <li><a href="#学习目标">学习目标</a></li>
      </ul>
    </li>
    <li><a href="#1启动人人开源管理前端">1、启动人人开源管理前端</a>
      <ul>
        <li><a href="#11确认本地已经安装好nodejs">1.1、确认本地已经安装好Node.js</a></li>
        <li><a href="#12安装前端开发工具vscode">1.2、安装前端开发工具VSCode</a>
          <ul>
            <li><a href="#121-打开人人开源管理前端代码所在目录">1.2.1 打开人人开源管理前端代码所在目录</a></li>
            <li><a href="#122-选中人人开源前端代码的目录">1.2.2 选中人人开源前端代码的目录，</a></li>
            <li><a href="#123打开目录效果">1.2.3打开目录效果。</a></li>
            <li><a href="#124保存工作区">1.2.4保存工作区：</a></li>
            <li><a href="#125选中工作区保存位置">1.2.5选中工作区保存位置</a></li>
            <li><a href="#126-最终保存为工作区">1.2.6 最终保存为工作区</a></li>
            <li><a href="#127禁用eslint插件">1.2.7、禁用eslint插件</a></li>
          </ul>
        </li>
        <li><a href="#13启动前端项目">1.3、启动前端项目</a>
          <ul>
            <li><a href="#131-进入vscode终端">1.3.1 进入VSCODE终端</a></li>
            <li><a href="#132-配置cnpm">1.3.2 配置cnpm</a></li>
            <li><a href="#133-安装node_modules依赖包">1.3.3 安装node_modules依赖包</a></li>
            <li><a href="#134-打包运行前端项目">1.3.4 打包运行前端项目</a></li>
            <li><a href="#135-浏览器访问">1.3.5 浏览器访问</a></li>
          </ul>
        </li>
        <li><a href="#14配置前端使用api网关-请求后端api接口调用地址">1.4、配置前端使用API网关-请求后端API接口调用地址</a></li>
        <li><a href="#15登录跨域问题">1.5、登录跨域问题</a>
          <ul>
            <li>
              <ul>
                <li><a href="#什么是跨域">什么是跨域？</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#16解决跨域问题">1.6、解决跨域问题</a>
          <ul>
            <li><a href="#161-添加跨域配置">1.6.1 添加跨域配置</a></li>
            <li><a href="#162注释renren-fast跨域配置">1.6.2、注释renren-fast跨域配置</a></li>
            <li><a href="#163-前后端联调登录">1.6.3 前后端联调登录</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#2开发配置题目分类服务前端维护管理功能">2、开发配置题目分类服务前端维护管理功能</a>
      <ul>
        <li><a href="#21添加题目管理目录一级菜单">2.1、添加题目管理目录（一级菜单）</a></li>
        <li><a href="#22添加题目类型维护菜单二级菜单">2.2、添加题目类型维护菜单(二级菜单)</a></li>
        <li><a href="#23自动生成类型维护前端页面">2.3、自动生成类型维护前端页面</a></li>
        <li><a href="#24拷贝前端代码到-前端工程renren-fast-vue">2.4、拷贝前端代码到 前端工程renren-fast-vue</a></li>
        <li><a href="#25测试类型维护">2.5、测试类型维护</a></li>
        <li><a href="#26开启类型维护新增批量删除权限">2.6、开启类型维护新增、批量删除权限</a></li>
        <li><a href="#27配置逻辑删除">2.7、配置逻辑删除</a>
          <ul>
            <li><a href="#271所有表字段添加del_flag字段">2.7.1、所有表字段添加del_flag字段</a></li>
            <li><a href="#272修改mybatisplus配置逻辑删除">2.7.2、修改MyBatisPlus配置逻辑删除</a></li>
            <li><a href="#273配置springboot打印mybatis执行sql">2.7.3、配置springboot打印mybatis执行sql</a></li>
          </ul>
        </li>
        <li><a href="#28模糊查询类型功能">2.8、模糊查询类型功能</a></li>
        <li><a href="#29配置分页">2.9、配置分页</a></li>
      </ul>
    </li>
    <li><a href="#3开发配置题目前端维护管理功能">3、开发配置题目前端维护管理功能</a>
      <ul>
        <li><a href="#31添加题目维护菜单二级菜单">3.1、添加题目维护菜单（二级菜单）</a></li>
        <li><a href="#32拷贝代码生成器生成的题目维护的前端源码">3.2、拷贝代码生成器生成的题目维护的前端源码</a></li>
        <li><a href="#33测试题目维护">3.3、测试题目维护</a></li>
        <li><a href="#34新增题目--处理题目类型下拉菜单">3.4、新增题目&ndash;处理题目类型下拉菜单</a>
          <ul>
            <li><a href="#341获取根据分类获取题库列表数据接口">3.4.1．获取根据分类获取题库列表数据接口</a>
              <ul>
                <li><a href="#3411编写获取题库分类接口及实现类">3.4.1.1、编写获取题库分类接口及实现类</a></li>
                <li><a href="#3412编写获取题库分类控制器">3.4.1.2、编写获取题库分类控制器</a></li>
              </ul>
            </li>
            <li><a href="#342前端代码编写">3.4.2、前端代码编写</a></li>
          </ul>
        </li>
        <li><a href="#35新增题目--处理是否显示是否删除">3.5、新增题目&ndash;处理是否显示、是否删除</a></li>
        <li><a href="#36模糊查询题目">3.6、模糊查询题目</a></li>
        <li><a href="#37快速设置是否显示">3.7、快速设置是否显示</a></li>
        <li><a href="#38校验排序不能是小数或者小于0的数字">3.8、校验排序不能是小数或者小于0的数字</a></li>
        <li><a href="#39修改题目答案为多行文本框">3.9、修改题目答案为多行文本框</a></li>
      </ul>
    </li>
    <li><a href="#4完成题目导入导出功能">4、完成题目导入、导出功能</a>
      <ul>
        <li><a href="#41java操作excel类库poi">4.1、JAVA操作excel类库POI</a>
          <ul>
            <li><a href="#1211-什么是poi">12.1.1 什么是POI？</a></li>
            <li><a href="#1212-poi官网">12.1.2 POI官网</a></li>
          </ul>
        </li>
        <li><a href="#42poi入门demo">4.2、POI入门demo</a>
          <ul>
            <li><a href="#421创建一个普通的maven项目">4.2.1．创建一个普通的maven项目</a></li>
            <li><a href="#422pom中引入xml相关依赖">4.2.2．pom中引入xml相关依赖</a></li>
            <li><a href="#423java写入excel">4.2.3．java写入excel</a>
              <ul>
                <li><a href="#2003版写文件">2003版写文件</a></li>
                <li><a href="#2007版写文件">2007版写文件</a></li>
              </ul>
            </li>
            <li><a href="#424java读取excel">4.2.4．Java读取excel</a>
              <ul>
                <li><a href="#2003版读文件">2003版读文件</a></li>
                <li><a href="#2007版读文件">2007版读文件</a></li>
              </ul>
            </li>
          </ul>
        </li>
        <li><a href="#43java后端代码编写">4.3、JAVA后端代码编写</a>
          <ul>
            <li><a href="#431修改项目u-question的接口questionservice增加导入导出接口定义">4.3.1修改项目u-question的接口QuestionService增加导入、导出接口定义</a></li>
            <li><a href="#432-修改实现类questionserviceimpl实现导入导出方法">4.3.2 修改实现类QuestionServiceImpl实现导入、导出方法</a></li>
            <li><a href="#433-修改控制器questioncontroller实现导入导出方法">4.3.3 修改控制器QuestionController实现导入、导出方法</a></li>
          </ul>
        </li>
        <li><a href="#44前端代码编写">4.4、前端代码编写</a>
          <ul>
            <li><a href="#441-创建导入弹窗口视图页面">4.4.1 创建导入弹窗口视图页面</a></li>
            <li><a href="#442-修改题目维护页面questionvue">4.4.2 修改题目维护页面question.vue</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#5echarts图表入门">5、Echarts图表入门</a>
      <ul>
        <li><a href="#51echarts简介">5.1．Echarts简介</a></li>
        <li><a href="#52基本使用">5.2．基本使用</a>
          <ul>
            <li><a href="#521柱状图创建">5.2.1、柱状图创建</a>
              <ul>
                <li><a href="#1创建html页面柱图html">（1）创建html页面：柱图.html</a></li>
                <li><a href="#2引入echarts">（2）引入ECharts</a></li>
                <li><a href="#3定义图表区域">（3）定义图表区域</a></li>
                <li><a href="#4渲染图表">（4）渲染图表</a></li>
              </ul>
            </li>
            <li><a href="#522折线图创建">5.2.2、折线图创建</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#6统计分析">6、统计分析</a>
      <ul>
        <li><a href="#61题库分类数量统计分析">6.1．题库分类数量统计分析</a>
          <ul>
            <li><a href="#611-编写java后端代码">6.1.1 编写java后端代码</a></li>
            <li><a href="#612-编写前端代码">6.1.2 编写前端代码</a></li>
            <li><a href="#613-配置用户注册统计菜单">6.1.3 配置用户注册统计菜单</a></li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
    </div>

    <div class='content  content '>
        <h1 align = "center">第四章</h1>
<h1 align = "center">优学题库项目开发2</h1>
<h3 align="center">优就业.JAVA教研室</h3>
<h2 id="学习目标">学习目标</h2>
<ul>
<li>了解启动开源管理前端框架</li>
<li>掌握开发配置题目分类服务及前端维护管理功能</li>
<li>掌握开发配置题目维护后端服务及前端维护管理功能</li>
<li>掌握完成题目导入、导出功能开发</li>
<li>掌握Echarts图表入门</li>
<li>掌握统计分析功能开发</li>
</ul>
<h1 id="1启动人人开源管理前端">1、启动人人开源管理前端</h1>
<h2 id="11确认本地已经安装好nodejs">1.1、确认本地已经安装好Node.js</h2>
<p>输入指令，确认：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-shell" data-lang="shell"><span style="display:flex;"><span>node -v
</span></span></code></pre></div><p><img src="/posts/project/20220528232959/image-20220528233009896.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>node.js安装教程</p>
<p><a class="link" href="/posts/project/https://www.runoob.com/nodejs/nodejs-install-setup.html"  target="_blank" rel="noopener"
    >https://www.runoob.com/nodejs/nodejs-install-setup.html</a></p>
<h2 id="12安装前端开发工具vscode">1.2、安装前端开发工具VSCode</h2>
<p><img src="/posts/project/20220528232959/image-20220528233017887.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>下载前端代码：</p>
<p>renren-fast-vue 管理后台前端
<a class="link" href="/posts/project/https://gitee.com/hk109/renren-fast-vue.git"  target="_blank" rel="noopener"
    >https://gitee.com/hk109/renren-fast-vue.git</a></p>
<h3 id="121-打开人人开源管理前端代码所在目录">1.2.1 打开人人开源管理前端代码所在目录</h3>
<p><img src="/posts/project/20220528232959/image-20220528233033976.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="122-选中人人开源前端代码的目录">1.2.2 选中人人开源前端代码的目录，</h3>
<p><img src="/posts/project/20220528232959/image-20220528233058907.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="123打开目录效果">1.2.3打开目录效果。</h3>
<p><img src="/posts/project/20220528232959/image-20220528233106977.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="124保存工作区">1.2.4保存工作区：</h3>
<p><img src="/posts/project/20220528232959/image-20220528233113631.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="125选中工作区保存位置">1.2.5选中工作区保存位置</h3>
<p><img src="/posts/project/20220528232959/image-20220528233120365.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="126-最终保存为工作区">1.2.6 最终保存为工作区</h3>
<p><img src="/posts/project/20220528232959/image-20220528233128283.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="127禁用eslint插件">1.2.7、禁用eslint插件</h3>
<p><img src="/posts/project/20220528232959/image-20220528233135147.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="13启动前端项目">1.3、启动前端项目</h2>
<h3 id="131-进入vscode终端">1.3.1 进入VSCODE终端</h3>
<p><img src="/posts/project/20220528232959/image-20220528233141547.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>终端界面</p>
<p>npm -v
<img src="/posts/project/20220528232959/image-20220528233149673.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="132-配置cnpm">1.3.2 配置cnpm</h3>
<pre tabindex="0"><code>npm install -g cnpm --registry=https://registry.npm.taobao.org
</code></pre><h3 id="133-安装node_modules依赖包">1.3.3 安装node_modules依赖包</h3>
<pre tabindex="0"><code>cnpm install
</code></pre><p>注意安装的饿时候，需要修改package.json，里面的node-sass的依赖版本号:^4.14.1
<img src="/posts/project/20220528232959/image-20220528233228689.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="134-打包运行前端项目">1.3.4 打包运行前端项目</h3>
<pre tabindex="0"><code>npm run dev
</code></pre><h3 id="135-浏览器访问">1.3.5 浏览器访问</h3>
<pre tabindex="0"><code>注意：renren-fast项目要先启动 
浏览后台：http://localhost:8001
</code></pre><p>登录后台</p>
<p>账号：admin</p>
<p>密码：admin
<img src="/posts/project/20220528232959/image-20220528233236251.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="14配置前端使用api网关-请求后端api接口调用地址">1.4、配置前端使用API网关-请求后端API接口调用地址</h2>
<p>修改配置文件对接后端api地址：</p>
<p>文件：renren-fast-vue\static\config\index.js</p>
<p>api接口请求地址替换为题目微服务的地址</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-js" data-lang="js"><span style="display:flex;"><span><span style="color:#0086b3">window</span>.SITE_CONFIG[<span style="color:#d14">&#39;baseUrl&#39;</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;http://localhost:8080/renren-fast&#39;</span>;
</span></span><span style="display:flex;"><span>替换为
</span></span><span style="display:flex;"><span><span style="color:#0086b3">window</span>.SITE_CONFIG[<span style="color:#d14">&#39;baseUrl&#39;</span>] <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#39;http://localhost:8888/api&#39;</span>; <span style="color:#998;font-style:italic">// 网关地址
</span></span></span></code></pre></div><p><img src="/posts/project/20220528232959/image-20220528233243956.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>配置cloud-gateway转发到renren-fast的路由：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yml" data-lang="yml"><span style="display:flex;"><span><span style="color:#000080">spring</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">cloud</span>:<span style="color:#bbb">    
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">gateway</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">routes</span>:<span style="color:#bbb">        
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>- <span style="color:#000080">id</span>:<span style="color:#bbb"> </span>renrenfast-route<span style="color:#bbb"> </span><span style="color:#998;font-style:italic"># 人人后台服务路由</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#000080">uri</span>:<span style="color:#bbb"> </span>lb://renren-fast<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#000080">predicates</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>- Path=/api/**<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#000080">filters</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>- RewritePath=/api/(?&lt;segment&gt;.*),/renren-fast/$\{segment}<span style="color:#bbb">
</span></span></span></code></pre></div><p>刷新登录页面，可以正常获取验证码，请求路径为网关地址 + /api/captcha.jpg?uuid=xxxxx</p>
<pre tabindex="0"><code>http://localhost:8888/api/captcha.jpg?uuid=84d36089-07ae-4201-85c0-8217b032f23e
</code></pre><p><img src="/posts/project/20220528232959/image-20220528233252574.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="15登录跨域问题">1.5、登录跨域问题</h2>
<p>点击登录，控制台报错，登录失败：</p>
<pre tabindex="0"><code>Access to XMLHttpRequest at &#39;http://localhost:8888/api/sys/login&#39; from origin &#39;http://localhost:8001&#39; has been blocked by CORS policy: Response to preflight request doesn&#39;t pass access control check: No &#39;Access-Control-Allow-Origin&#39; head is present on the requested resource
</code></pre><p>登录页面url：http://localhost:8001，点击登录访问的请求url：http://localhost:8888/api/sys/login，两个url的端口号不一样，产生了跨域问题。</p>
<h4 id="什么是跨域">什么是跨域？</h4>
<p>跨域资源共享(CORS) 是一种机制，它使用额外的 HTTP 头来告诉浏览器 让运行在一个 origin (domain) 上的Web应用被准许访问来自不同源服务器上的指定的资源。当一个资源从与该资源本身所在的服务器不同的域、协议或端口请求一个资源时，资源会发起一个跨域 HTTP 请求。</p>
<p>比如，站点 <a class="link" href="/posts/project/http://domain-a.com"  target="_blank" rel="noopener"
    >http://domain-a.com</a> 的某 HTML 页面通过 的 src 请求 <a class="link" href="/posts/project/http://domain-b.com/image.jpg"  target="_blank" rel="noopener"
    >http://domain-b.com/image.jpg</a>。网络上的许多页面都会加载来自不同域的CSS样式表，图像和脚本等资源。</p>
<p>出于安全原因，浏览器限制从脚本内发起的跨源HTTP请求。 例如，XMLHttpRequest和Fetch API遵循同源策略。 这意味着使用这些API的Web应用程序只能从加载应用程序的同一个域请求HTTP资源，除非响应报文包含了正确CORS响应头。
<img src="/posts/project/20220528232959/image-20220528233259690.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="16解决跨域问题">1.6、解决跨域问题</h2>
<p>添加响应头，配置当次请求允许跨域</p>
<p>Access-Control-Allow-Origin：支持哪些来源的请求跨域
Access-Control-Allow-Methods：支持哪些方法跨域
Access-Control-Allow-Credentials：跨域请求默认不包含cookie，设置为true可以包含cookie
Access-Control-Expose-Headers：跨域请求暴露的字段CORS请求时，XMLHttpRequest对象的getResponseHeader()方法只能拿到6个基本字段：Cache-Control、Content-Language、Content-Type、Expires、Last-Modified、Pragma。如果想拿到其他字段，就必须在Access-Control-Expose-Headers里面指定。
Access-Control-Max-Age：表明该响应的有效时间为多少秒。在有效时间内，浏览器无
须为同一请求再次发起预检请求。请注意，浏览器自身维护了一个最大有效时间，如果
该首部字段的值超过了最大有效时间，将不会生效。</p>
<h3 id="161-添加跨域配置">1.6.1 添加跨域配置</h3>
<p>在cloud-gateway模块添加解决跨域的配置文件GatewayCorsConfiguration</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">org.springframework.context.annotation.Bean</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">org.springframework.context.annotation.Configuration</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">org.springframework.web.cors.CorsConfiguration</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">org.springframework.web.cors.reactive.CorsWebFilter</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> <span style="color:#555">org.springframework.web.cors.reactive.UrlBasedCorsConfigurationSource</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">GatewayCorsConfiguration</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> CorsWebFilter <span style="color:#900;font-weight:bold">corsWebFilter</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        UrlBasedCorsConfigurationSource source <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> UrlBasedCorsConfigurationSource<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        CorsConfiguration corsConfiguration <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> CorsConfiguration<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 配置跨域
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        corsConfiguration<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">addAllowedHeader</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;*&#34;</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#998;font-style:italic">// 允许所有请求头跨域
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        corsConfiguration<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">addAllowedMethod</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;*&#34;</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#998;font-style:italic">// 允许所有请求方法跨域
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        corsConfiguration<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">addAllowedOrigin</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;*&#34;</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#998;font-style:italic">// 允许所有请求来源跨域
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        corsConfiguration<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setAllowCredentials</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">true</span><span style="color:#000;font-weight:bold">);</span> <span style="color:#998;font-style:italic">//允许携带cookie跨域，否则跨域请求会丢失cookie信息
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>        source<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">registerCorsConfiguration</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;/**&#34;</span><span style="color:#000;font-weight:bold">,</span> corsConfiguration<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">new</span> CorsWebFilter<span style="color:#000;font-weight:bold">(</span>source<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>也可以采用配置方式，修改application.yml:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000080">spring</span>:<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">cloud</span>:<span style="color:#bbb">    
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">gateway</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">globalcors</span>:<span style="color:#bbb">   </span><span style="color:#998;font-style:italic">#跨域配置</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">cors-configurations</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#000080">&#39;[/**]&#39;</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span><span style="color:#000080">allowCredentials</span>:<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">true</span><span style="color:#bbb"> </span><span style="color:#998;font-style:italic">#允许跨域读取cookie</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span><span style="color:#000080">allowedOrigins</span>:<span style="color:#bbb"> </span><span style="color:#d14">&#34;*&#34;</span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic">#允许发出跨域请求主机域名 * 任意主机</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span><span style="color:#000080">allowedMethods</span>:<span style="color:#bbb"> </span><span style="color:#d14">&#34;*&#34;</span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic">#请求方法</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span><span style="color:#000080">allowedHeaders</span>:<span style="color:#bbb"> </span><span style="color:#d14">&#34;*&#34;</span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic">#允许发出跨域的请求头</span><span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="162注释renren-fast跨域配置">1.6.2、注释renren-fast跨域配置</h3>
<p>注释renren-fast里面的跨域配置</p>
<p>文件路径：src/main/java/io/renren/config/CorsConfig.java</p>
<p>重启各个服务及网关，测试即可成功登录。
<img src="/posts/project/20220528232959/image-20220528233311434.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="163-前后端联调登录">1.6.3 前后端联调登录</h3>
<p>登录成功</p>
<p><img src="/posts/project/20220528232959/image-20220528233456137.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>查看后端服务日志</p>
<p><img src="/posts/project/20220528232959/image-20220528233524311.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>说明前端登录请求发送到了后端服务，并验证了用户名和密码是否正确。</p>
<h1 id="2开发配置题目分类服务前端维护管理功能">2、开发配置题目分类服务前端维护管理功能</h1>
<h2 id="21添加题目管理目录一级菜单">2.1、添加题目管理目录（一级菜单）</h2>
<p>选择管理界面&ndash;系统管理&ndash;菜单管理，点击 新增按钮
<img src="/posts/project/20220528232959/image-20220528233551298.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>刷新页面,就可以看到题目中心菜单
<img src="/posts/project/20220528232959/image-20220528233619632.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="22添加题目类型维护菜单二级菜单">2.2、添加题目类型维护菜单(二级菜单)</h2>
<p>选择管理界面&ndash;系统管理&ndash;菜单管理，点击 新增按钮</p>
<p>选择类型：菜单
<img src="/posts/project/20220528232959/image-20220528233710888.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>刷新，可以看到菜单
<img src="/posts/project/20220528232959/image-20220528233730447.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>可以看到数据库uxeu_admin的表sys_menu中新增了两条记录,分别对应两个菜单
<img src="/posts/project/20220528232959/image-20220528233738776.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>点击类型维护菜单,打开了链接:http://localhost:8001/#/question-type,页面显示空白页面.</p>
<h2 id="23自动生成类型维护前端页面">2.3、自动生成类型维护前端页面</h2>
<p>用renren-generator自动生成前端代码</p>
<p>注意配置数据库连接文件application.yml,指向数据库 uxue_qms</p>
<p>修改模板生成属性配置文件generator.properties</p>
<p>配置模块名和包名：
<img src="/posts/project/20220528232959/image-20220528233755862.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>重启服务，打开生成页面选择表，点击生成
<img src="/posts/project/20220528232959/image-20220528233804766.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="24拷贝前端代码到-前端工程renren-fast-vue">2.4、拷贝前端代码到 前端工程renren-fast-vue</h2>
<p>拷贝\main\resources\src\views\modules\question目录到前端目录 renren-fast-vue\src\views\modules
<img src="/posts/project/20220528232959/image-20220528233810196.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528232959/image-20220528233818805.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="25测试类型维护">2.5、测试类型维护</h2>
<p>点击类型维护菜单,可以看到请求报404</p>
<p>http://localhost:8001/#/question-type
<img src="/posts/project/20220528232959/image-20220528233829181.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>因为页面的请求都访问到renren-fast服务了,所以要修改为访问题目微服务。</p>
<p><em><strong>修改colud-gateway网关配置，配置转发题目微服务：</strong></em></p>
<p>（注意：qms-route的路由配置一定要配置在renrenfast-route之前，拥有加载顺序。）</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000080">spring</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">cloud</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">nacos</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">discovery</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span><span style="color:#000080">server-addr</span>:<span style="color:#bbb"> </span>http://localhost:8848<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">gateway</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">routes</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>- <span style="color:#000080">id</span>:<span style="color:#bbb"> </span>qms-route<span style="color:#bbb"> </span><span style="color:#998;font-style:italic"># 题目微服务路由</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#000080">uri</span>:<span style="color:#bbb"> </span>lb://u-question<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#000080">predicates</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>- Path=/api/question/**<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#000080">filters</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>- RewritePath=/api/(?&lt;segment&gt;.*),/$\{segment}<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">        </span>- <span style="color:#000080">id</span>:<span style="color:#bbb"> </span>renrenfast-route<span style="color:#bbb"> </span><span style="color:#998;font-style:italic"># 人人后台服务路由</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#000080">uri</span>:<span style="color:#bbb"> </span>lb://renren-fast<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#000080">predicates</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>- Path=/api/**<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">          </span><span style="color:#000080">filters</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">            </span>- RewritePath=/api/(?&lt;segment&gt;.*),/renren-fast/$\{segment}<span style="color:#bbb">
</span></span></span></code></pre></div><p>重启网关服务，再次刷新访问地址：http://localhost:8001/#/question-type</p>
<p>即可正常访问题目类型列表页：</p>
<ul>
<li>数据库插入3条测试数据</li>
<li>测试查询列表，可以看到有三条记录查询出来了</li>
</ul>
<p><img src="/posts/project/20220528232959/image-20220528233844508.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>点击 修改：</p>
<p><img src="/posts/project/20220528232959/image-20220528233857864.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>点击 确定 即可完成修改。</p>
<p>点击删除即可删除记录</p>
<p><img src="/posts/project/20220528232959/image-20220528233907678.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>弹出删除确认提示：</p>
<p><img src="/posts/project/20220528232959/image-20220528233918327.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>确定即可删除对应记录</p>
<h2 id="26开启类型维护新增批量删除权限">2.6、开启类型维护新增、批量删除权限</h2>
<p>打开前端工程renren-fast-vue找到配置文件src\utils\index.js</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#998;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"> * 是否有权限
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"> * @param {*} key
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"> */</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">export</span> <span style="color:#000;font-weight:bold">function</span> isAuth (key) {
</span></span><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">// return JSON.parse(sessionStorage.getItem(&#39;permissions&#39;) || &#39;[]&#39;).indexOf(key) !== -1 || false
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>  <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>暂时不判断权限，全部返回true</p>
<p>再次访问类型维护列表页，即可看到新增按钮</p>
<p><img src="/posts/project/20220528232959/image-20220528233931156.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>去除新增创建时间、更新时间必须输入限制：</p>
<p>修改文件src/views/modules/question/type-add-or-update.vue</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span> <span style="color:#a61717;background-color:#e3d2d2">dataRule:</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#a61717;background-color:#e3d2d2">type:</span> <span style="color:#a61717;background-color:#e3d2d2">[</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a61717;background-color:#e3d2d2">{</span> <span style="color:#a61717;background-color:#e3d2d2">required:</span> <span style="color:#a61717;background-color:#e3d2d2">true,</span> <span style="color:#a61717;background-color:#e3d2d2">message:</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;类型名称不能为空&#39;,</span> <span style="color:#a61717;background-color:#e3d2d2">trigger:</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;blur&#39;</span> }
</span></span><span style="display:flex;"><span>          <span style="color:#a61717;background-color:#e3d2d2">],</span>
</span></span><span style="display:flex;"><span>          <span style="color:#a61717;background-color:#e3d2d2">comments:</span> [
</span></span><span style="display:flex;"><span>            { <span style="color:#a61717;background-color:#e3d2d2">required:</span> <span style="color:#a61717;background-color:#e3d2d2">true,</span> <span style="color:#a61717;background-color:#e3d2d2">message:</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;备注不能为空&#39;,</span> <span style="color:#a61717;background-color:#e3d2d2">trigger:</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;blur&#39;</span> }
</span></span><span style="display:flex;"><span>          ]<span style="color:#a61717;background-color:#e3d2d2">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#a61717;background-color:#e3d2d2">logoUrl:</span> [
</span></span><span style="display:flex;"><span>            { <span style="color:#a61717;background-color:#e3d2d2">required:</span> <span style="color:#a61717;background-color:#e3d2d2">true,</span> <span style="color:#a61717;background-color:#e3d2d2">message:</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;类型logo路径不能为空&#39;,</span> <span style="color:#a61717;background-color:#e3d2d2">trigger:</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;blur&#39;</span> }
</span></span><span style="display:flex;"><span>          ]<span style="color:#a61717;background-color:#e3d2d2">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#a61717;background-color:#e3d2d2">delFlag:</span> [
</span></span><span style="display:flex;"><span>            { <span style="color:#a61717;background-color:#e3d2d2">required:</span> <span style="color:#a61717;background-color:#e3d2d2">true,</span> <span style="color:#a61717;background-color:#e3d2d2">message:</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;删除标记（0-正常，1-删除）不能为空&#39;,</span> <span style="color:#a61717;background-color:#e3d2d2">trigger:</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;blur&#39;</span> }
</span></span><span style="display:flex;"><span>          ]<span style="color:#a61717;background-color:#e3d2d2">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#a61717;background-color:#e3d2d2">createTime:</span> [
</span></span><span style="display:flex;"><span>            { <span style="color:#a61717;background-color:#e3d2d2">required:</span> <span style="color:#a61717;background-color:#e3d2d2">false,</span> <span style="color:#a61717;background-color:#e3d2d2">message:</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;创建时间不能为空&#39;,</span> <span style="color:#a61717;background-color:#e3d2d2">trigger:</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;blur&#39;</span> }
</span></span><span style="display:flex;"><span>          ]<span style="color:#a61717;background-color:#e3d2d2">,</span>
</span></span><span style="display:flex;"><span>          <span style="color:#a61717;background-color:#e3d2d2">updateTime:</span> [
</span></span><span style="display:flex;"><span>            { <span style="color:#a61717;background-color:#e3d2d2">required:</span> <span style="color:#a61717;background-color:#e3d2d2">false,</span> <span style="color:#a61717;background-color:#e3d2d2">message:</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;更新时间不能为空&#39;,</span> <span style="color:#a61717;background-color:#e3d2d2">trigger:</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;blur&#39;</span> }
</span></span><span style="display:flex;"><span>          ]
</span></span><span style="display:flex;"><span>        <span style="color:#a61717;background-color:#e3d2d2">}</span>
</span></span></code></pre></div><p>把createTime、updateTime  required: true改成  required: false</p>
<p>点击新增按钮，即可弹出新增界面</p>
<p><img src="/posts/project/20220528232959/image-20220528233942684.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>批量删除测试</p>
<p><img src="/posts/project/20220528232959/image-20220528233953702.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="27配置逻辑删除">2.7、配置逻辑删除</h2>
<p>前面进行的删除都是物理删除，页可以进行逻辑删除，就是不直接把数据记录从数据库删除，而是采用设置删除标记来标识数据记录被删除。</p>
<h3 id="271所有表字段添加del_flag字段">2.7.1、所有表字段添加del_flag字段</h3>
<p>字段属性</p>
<pre tabindex="0"><code>del_flag tinyint(1) DEFAULT 0 COMMENT &#39;删除标记（0-正常，1-删除）&#39;,
</code></pre><h3 id="272修改mybatisplus配置逻辑删除">2.7.2、修改MyBatisPlus配置逻辑删除</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000080">mybatis-plus</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">mapper-locations</span>:<span style="color:#bbb"> </span>classpath:/mapper/**/*.xml<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">global-config</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">db-config</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">id-type</span>:<span style="color:#bbb"> </span>auto<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">logic-delete-value</span>:<span style="color:#bbb"> </span><span style="color:#099">1</span><span style="color:#bbb">  </span><span style="color:#998;font-style:italic"># 逻辑已删除值(默认为 1)</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">logic-not-delete-value</span>:<span style="color:#bbb"> </span><span style="color:#099">0</span><span style="color:#bbb"> </span><span style="color:#998;font-style:italic"># 逻辑未删除值(默认为 0)</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">      </span><span style="color:#000080">logic-delete-field</span>:<span style="color:#bbb"> </span>delFlag<span style="color:#bbb"> </span><span style="color:#998;font-style:italic">#全局逻辑删除字段值 3.3.0开始支持，详情看下面。</span><span style="color:#bbb">
</span></span></span></code></pre></div><h3 id="273配置springboot打印mybatis执行sql">2.7.3、配置springboot打印mybatis执行sql</h3>
<p>修改配置文件application.yml</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000080">logging</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">level</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">com.offcn.question</span>:<span style="color:#bbb"> </span>debug<span style="color:#bbb">
</span></span></span></code></pre></div><p>再次测试访问列表和执行删除，可以看到控制台打印sql指令</p>
<p>查询指令：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">SELECT</span><span style="color:#bbb"> </span>id,<span style="color:#000;font-weight:bold">type</span>,comments,logo_url,del_flag,create_time,update_time<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">FROM</span><span style="color:#bbb"> </span>qms_type<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">WHERE</span><span style="color:#bbb"> </span>del_flag<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span><span style="color:#bbb">
</span></span></span></code></pre></div><p>删除指令：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sql" data-lang="sql"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">UPDATE</span><span style="color:#bbb"> </span>qms_type<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">SET</span><span style="color:#bbb"> </span>del_flag<span style="color:#000;font-weight:bold">=</span><span style="color:#099">1</span><span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">WHERE</span><span style="color:#bbb"> </span>id<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">IN</span><span style="color:#bbb"> </span>(<span style="color:#bbb"> </span><span style="color:#099">1</span><span style="color:#bbb"> </span>)<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">AND</span><span style="color:#bbb"> </span>del_flag<span style="color:#000;font-weight:bold">=</span><span style="color:#099">0</span><span style="color:#bbb"> 
</span></span></span></code></pre></div><p>查看数据库记录：</p>
<p><img src="/posts/project/20220528232959/image-20220528234007744.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="28模糊查询类型功能">2.8、模糊查询类型功能</h2>
<p>修改实现类TypeServiceImpl的方法queryPage</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span> <span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> PageUtils <span style="color:#900;font-weight:bold">queryPage</span><span style="color:#000;font-weight:bold">(</span>Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">&gt;</span> params<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//1、获取查询关键字
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>     String key<span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">)</span> params<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;key&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>     <span style="color:#998;font-style:italic">//2、创建查询条件对象
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        QueryWrapper<span style="color:#000;font-weight:bold">&lt;</span>TypeEntity<span style="color:#000;font-weight:bold">&gt;</span> queryWrapper <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> QueryWrapper<span style="color:#000;font-weight:bold">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//3、设置查询条件
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>       <span style="color:#000;font-weight:bold">if</span><span style="color:#000;font-weight:bold">(!</span>StringUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">isEmpty</span><span style="color:#000;font-weight:bold">(</span>key<span style="color:#000;font-weight:bold">)){</span>
</span></span><span style="display:flex;"><span>           queryWrapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">eq</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>key<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">or</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">like</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;type&#34;</span><span style="color:#000;font-weight:bold">,</span>key<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        IPage<span style="color:#000;font-weight:bold">&lt;</span>TypeEntity<span style="color:#000;font-weight:bold">&gt;</span> page <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">page</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">new</span> Query<span style="color:#000;font-weight:bold">&lt;</span>TypeEntity<span style="color:#000;font-weight:bold">&gt;().</span><span style="color:#008080">getPage</span><span style="color:#000;font-weight:bold">(</span>params<span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>                queryWrapper
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">new</span> PageUtils<span style="color:#000;font-weight:bold">(</span>page<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>设置id或者类型名称模糊查询的条件</p>
<p>前端访问测试：
<img src="/posts/project/20220528232959/image-20220528234017377.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="29配置分页">2.9、配置分页</h2>
<p>修改u-question配置分页插件配置类：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">MyBatisConfig</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">//引入分页插件
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#3c5d5d;font-weight:bold">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> PaginationInterceptor <span style="color:#900;font-weight:bold">paginationInterceptor</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        PaginationInterceptor paginationInterceptor <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> PaginationInterceptor<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 设置请求的页面大于最大页后操作， true调回到首页，false 继续请求  默认false
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        paginationInterceptor<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setOverflow</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">true</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 设置最大单页限制数量，默认 500 条，-1 不受限制
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        paginationInterceptor<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setLimit</span><span style="color:#000;font-weight:bold">(</span>1000<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> paginationInterceptor<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>添加分页插件后的显示:</p>
<p><img src="/posts/project/20220528232959/image-20220528234025387.png"
    
    
    
    loading="lazy"
    
    
></p>
<h1 id="3开发配置题目前端维护管理功能">3、开发配置题目前端维护管理功能</h1>
<h2 id="31添加题目维护菜单二级菜单">3.1、添加题目维护菜单（二级菜单）</h2>
<p><img src="/posts/project/20220528232959/image-20220528234039387.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>刷新后台管理页面，就可以看到题目维护菜单</p>
<p><img src="/posts/project/20220528232959/image-20220528234047255.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="32拷贝代码生成器生成的题目维护的前端源码">3.2、拷贝代码生成器生成的题目维护的前端源码</h2>
<p>拷贝题目维护源码到前端工程renren-fast-vue</p>
<p><img src="/posts/project/20220528232959/image-20220528234101262.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="33测试题目维护">3.3、测试题目维护</h2>
<p><img src="/posts/project/20220528232959/image-20220528234111173.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>访问题目维护菜单，可以正常浏览到题目数据。</p>
<h2 id="34新增题目--处理题目类型下拉菜单">3.4、新增题目&ndash;处理题目类型下拉菜单</h2>
<p>打开新增题目，发现里面涉及到题目类型，需要下拉选择已经存在的题目类型。</p>
<h3 id="341获取根据分类获取题库列表数据接口">3.4.1．获取根据分类获取题库列表数据接口</h3>
<h4 id="3411编写获取题库分类接口及实现类">3.4.1.1、编写获取题库分类接口及实现类</h4>
<p>接口：TypeService 增加获取全部分类方法</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">interface</span> TypeService <span style="color:#000;font-weight:bold">extends</span> IService<span style="color:#000;font-weight:bold">&lt;</span>TypeEntity<span style="color:#000;font-weight:bold">&gt;</span> {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>     <span style="color:#998;font-style:italic">//获取全部分类
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    List<span style="color:#000;font-weight:bold">&lt;</span>TypeEntity<span style="color:#000;font-weight:bold">&gt;</span> findAll();
</span></span><span style="display:flex;"><span>}
</span></span></code></pre></div><p>实现类：TypeServiceImpl</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Service</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;typeService&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">TypeServiceImpl</span> <span style="color:#000;font-weight:bold">extends</span> ServiceImpl<span style="color:#000;font-weight:bold">&lt;</span>TypeDao<span style="color:#000;font-weight:bold">,</span> TypeEntity<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#000;font-weight:bold">implements</span> TypeService <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>      <span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> List<span style="color:#000;font-weight:bold">&lt;</span>TypeEntity<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#900;font-weight:bold">findAll</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">list</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="3412编写获取题库分类控制器">3.4.1.2、编写获取题库分类控制器</h4>
<p>修改TypeController，增加获取全部分类接口</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@RestController</span>
</span></span><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@RequestMapping</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;question/type&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">TypeController</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> TypeService typeService<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">//获取全部分类
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#3c5d5d;font-weight:bold">@GetMapping</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;findall&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> R <span style="color:#900;font-weight:bold">findAll</span><span style="color:#000;font-weight:bold">(){</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        List<span style="color:#000;font-weight:bold">&lt;</span>TypeEntity<span style="color:#000;font-weight:bold">&gt;</span> all <span style="color:#000;font-weight:bold">=</span> typeService<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">findAll</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> R<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">ok</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;data&#34;</span><span style="color:#000;font-weight:bold">,</span>all<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="342前端代码编写">3.4.2、前端代码编写</h3>
<p>修改question-add-or-update.vue</p>
<p>修改数据结构，定义题目类型下拉菜单数据</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">export</span> <span style="color:#000;font-weight:bold">default</span> {
</span></span><span style="display:flex;"><span>    data () {
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">return</span> {       
</span></span><span style="display:flex;"><span>        options<span style="color:#000;font-weight:bold">:</span> [],
</span></span></code></pre></div><p>修改方法，当用户点击打开新增、或者修改页面的时候，调用后台接口获取全部题目类型数据</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span> methods<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>      init (id) {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">this</span>.dataForm.id <span style="color:#000;font-weight:bold">=</span> id <span style="color:#000;font-weight:bold">||</span> <span style="color:#099">0</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">this</span>.visible <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">this</span>.$nextTick(() =&gt; {
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">this</span>.$refs[<span style="color:#d14">&#39;dataForm&#39;</span>].resetFields()
</span></span><span style="display:flex;"><span>           <span style="color:#998;font-style:italic">//向服务器端发出一个请求，获取全部题目分类数据
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>          <span style="color:#000;font-weight:bold">this</span>.$http({
</span></span><span style="display:flex;"><span>            url<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">this</span>.$http.adornUrl(<span style="color:#d14">`/question/type/findall`</span>),
</span></span><span style="display:flex;"><span>            method<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;get&#39;</span>           
</span></span><span style="display:flex;"><span>          }).then(({data}) =&gt; {
</span></span><span style="display:flex;"><span>           <span style="color:#000;font-weight:bold">this</span>.options <span style="color:#000;font-weight:bold">=</span> data.data
</span></span><span style="display:flex;"><span>          })
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span> &lt;<span style="color:#000080">el-form-item</span> <span style="color:#008080">label</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;题目类型&#34;</span> <span style="color:#008080">prop</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;type&#34;</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#000080">el-select</span> <span style="color:#008080">v-model</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;dataForm.type&#34;</span> <span style="color:#008080">placeholder</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;请选择&#34;</span>&gt;
</span></span><span style="display:flex;"><span>       &lt;<span style="color:#000080">el-option</span>
</span></span><span style="display:flex;"><span>         <span style="color:#008080">v-for</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;item in options&#34;</span>
</span></span><span style="display:flex;"><span>         <span style="color:#008080">:key</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;item.id&#34;</span>
</span></span><span style="display:flex;"><span>         <span style="color:#008080">:label</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;item.type&#34;</span>
</span></span><span style="display:flex;"><span>         <span style="color:#008080">:value</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;item.id&#34;</span>&gt;
</span></span><span style="display:flex;"><span>       &lt;/<span style="color:#000080">el-option</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;/<span style="color:#000080">el-select</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#000080">el-form-item</span>&gt;
</span></span></code></pre></div><p>点击新增、或者修改，可以看到题目类型下拉菜单成功显示</p>
<p><img src="/posts/project/20220528232959/image-20220528234129546.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="35新增题目--处理是否显示是否删除">3.5、新增题目&ndash;处理是否显示、是否删除</h2>
<p>修改页面question-add-or-update.vue</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vue" data-lang="vue"><span style="display:flex;"><span>&lt;<span style="color:#000080">el-form-item</span> <span style="color:#008080">label</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;是否显示&#34;</span> <span style="color:#008080">prop</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;enable&#34;</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#000080">el-radio</span> <span style="color:#000080">v-model</span><span style="color:#d14">=&#34;dataForm.enable&#34; label=&#34;0&#34;&gt;不显示&lt;/el-radio&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">      &lt;el-radio v-model=&#34;dataForm.enable&#34; label=&#34;1&#34;&gt;显示&lt;/el-radio&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">    &lt;/el-form-item&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">&lt;el-form-item label=&#34;删除标记&#34; prop=&#34;delFlag&#34;&gt;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">      &lt;el-radio v-model=&#34;dataForm.delFlag&#34; label=&#34;0&#34;</span>&gt;<span style="color:#008080">不删除</span><span style="color:#a61717;background-color:#e3d2d2">&lt;/</span><span style="color:#008080">el</span><span style="color:#000080">-radio</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#000080">el-radio</span> <span style="color:#008080">v</span><span style="color:#000080">-model</span><span style="color:#a61717;background-color:#e3d2d2">=&#34;</span><span style="color:#008080">dataForm.delFlag</span><span style="color:#a61717;background-color:#e3d2d2">&#34;</span> <span style="color:#008080">label</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;1&#34;</span> &gt;删除<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#a61717;background-color:#e3d2d2">/el-radio&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#a61717;background-color:#e3d2d2">/el-form-item&gt;</span>
</span></span></code></pre></div><p>修改数据结构，定义是否显示初始化值</p>
<p><img src="/posts/project/20220528232959/image-20220528234139989.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>修改从后台接口获取数据赋值方法，把后台响应数据转换为字符串</p>
<p><img src="/posts/project/20220528232959/image-20220528234149878.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>关键点：data.question.enable + ''</p>
<p>​              data.question.delFlag + ''</p>
<p>点击新增或者修改，可以看到是否显示、是否删除成功已单选框显示</p>
<p><img src="/posts/project/20220528232959/image-20220528234205419.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="36模糊查询题目">3.6、模糊查询题目</h2>
<p>修改实现类QuestionServiceImpl的方法queryPage</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> PageUtils <span style="color:#900;font-weight:bold">queryPage</span><span style="color:#000;font-weight:bold">(</span>Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">&gt;</span> params<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//1、获取查询关键字
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        String key<span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">)</span> params<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;key&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//2、创建查询条件对象
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        QueryWrapper<span style="color:#000;font-weight:bold">&lt;</span>QuestionEntity<span style="color:#000;font-weight:bold">&gt;</span> queryWrapper <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> QueryWrapper<span style="color:#000;font-weight:bold">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//3、设置查询条件
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">if</span><span style="color:#000;font-weight:bold">(!</span>StringUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">isEmpty</span><span style="color:#000;font-weight:bold">(</span>key<span style="color:#000;font-weight:bold">)){</span>
</span></span><span style="display:flex;"><span>            queryWrapper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">eq</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;id&#34;</span><span style="color:#000;font-weight:bold">,</span>key<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">or</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">like</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;title&#34;</span><span style="color:#000;font-weight:bold">,</span>key<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        IPage<span style="color:#000;font-weight:bold">&lt;</span>QuestionEntity<span style="color:#000;font-weight:bold">&gt;</span> page <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">page</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">new</span> Query<span style="color:#000;font-weight:bold">&lt;</span>QuestionEntity<span style="color:#000;font-weight:bold">&gt;().</span><span style="color:#008080">getPage</span><span style="color:#000;font-weight:bold">(</span>params<span style="color:#000;font-weight:bold">),</span>
</span></span><span style="display:flex;"><span>                queryWrapper
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">new</span> PageUtils<span style="color:#000;font-weight:bold">(</span>page<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>测试输入id或者标题包含的关键字查询</p>
<p><img src="/posts/project/20220528232959/image-20220528234216703.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="37快速设置是否显示">3.7、快速设置是否显示</h2>
<p>想要将是否显示改为快速开关</p>
<p>修改页面question.vue添加更新状态方法</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>    methods<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#998;font-style:italic">// 更新题目是否显示
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>      updateQuestionStatus (data) {
</span></span><span style="display:flex;"><span>          console.log(data)
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">let</span> {id, enable} <span style="color:#000;font-weight:bold">=</span> data
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">this</span>.$http({
</span></span><span style="display:flex;"><span>           url<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">this</span>.$http.adornUrl(<span style="color:#d14">&#39;/question/question/update&#39;</span>),
</span></span><span style="display:flex;"><span>           method<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;post&#39;</span>,
</span></span><span style="display:flex;"><span>           data<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">this</span>.$http.adornData({id, enable}, <span style="color:#000;font-weight:bold">false</span>)
</span></span><span style="display:flex;"><span>      }).then(({ data }) =&gt; {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">this</span>.$message({
</span></span><span style="display:flex;"><span>            type<span style="color:#000;font-weight:bold">:</span><span style="color:#d14">&#39;success&#39;</span>,
</span></span><span style="display:flex;"><span>            message<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;状态更新成功&#39;</span>
</span></span><span style="display:flex;"><span>         })
</span></span><span style="display:flex;"><span>     });
</span></span><span style="display:flex;"><span>   },
</span></span></code></pre></div><p>修改页面question.vue</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vue" data-lang="vue"><span style="display:flex;"><span>      &lt;<span style="color:#000080">el-table-column</span>
</span></span><span style="display:flex;"><span>        <span style="color:#008080">prop</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;enable&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#008080">header</span><span style="color:#000080">-align</span><span style="color:#a61717;background-color:#e3d2d2">=&#34;</span><span style="color:#008080">center</span><span style="color:#a61717;background-color:#e3d2d2">&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#008080">align</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;center&#34;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#008080">label</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;是否显示&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#000080">template</span> <span style="color:#008080">slot</span><span style="color:#000080">-scope</span><span style="color:#a61717;background-color:#e3d2d2">=&#34;</span><span style="color:#008080">scope</span><span style="color:#a61717;background-color:#e3d2d2">&#34;</span>&gt;
</span></span><span style="display:flex;"><span>         &lt;<span style="color:#000080">el-switch</span>
</span></span><span style="display:flex;"><span>           <span style="color:#000080">v-model</span><span style="color:#d14">=&#34;scope.row.enable&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">           :active-value=1
</span></span></span><span style="display:flex;"><span><span style="color:#d14">           :inactive-value=0
</span></span></span><span style="display:flex;"><span><span style="color:#d14">           active-color=&#34;#13ce66&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">           inactive-color=&#34;#ff4949&#34;
</span></span></span><span style="display:flex;"><span><span style="color:#d14">           @change=&#34;updateQuestionStatus(scope.row)&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#a61717;background-color:#e3d2d2">&lt;/</span><span style="color:#008080">el</span><span style="color:#000080">-switch</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;/<span style="color:#000080">template</span>&gt;
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#a61717;background-color:#e3d2d2">/el-table-column&gt;</span>
</span></span></code></pre></div><p>测试页面效果</p>
<p><img src="/posts/project/20220528232959/image-20220528234227737.png"
    
    
    
    loading="lazy"
    
    
></p>
<h2 id="38校验排序不能是小数或者小于0的数字">3.8、校验排序不能是小数或者小于0的数字</h2>
<p>修改前端页面question-add-or-update.vue</p>
<p><img src="/posts/project/20220528232959/image-20220528234239693.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/project/20220528232959/image-20220528234250058.png"
    
    
    
    loading="lazy"
    
    
></p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-json" data-lang="json"><span style="display:flex;"><span> <span style="color:#a61717;background-color:#e3d2d2">var</span> <span style="color:#a61717;background-color:#e3d2d2">validateOrder</span> <span style="color:#a61717;background-color:#e3d2d2">=</span> <span style="color:#a61717;background-color:#e3d2d2">(rule,</span> <span style="color:#a61717;background-color:#e3d2d2">value,</span> <span style="color:#a61717;background-color:#e3d2d2">callback)</span> <span style="color:#a61717;background-color:#e3d2d2">=&gt;</span> {
</span></span><span style="display:flex;"><span>        <span style="color:#a61717;background-color:#e3d2d2">if</span> <span style="color:#a61717;background-color:#e3d2d2">(value</span> <span style="color:#a61717;background-color:#e3d2d2">===</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;&#39;)</span> <span style="color:#a61717;background-color:#e3d2d2">{</span>
</span></span><span style="display:flex;"><span>          <span style="color:#a61717;background-color:#e3d2d2">callback(new</span> <span style="color:#a61717;background-color:#e3d2d2">Error(&#39;请输入排序&#39;));</span>
</span></span><span style="display:flex;"><span>        } <span style="color:#a61717;background-color:#e3d2d2">else</span> {
</span></span><span style="display:flex;"><span>          <span style="color:#a61717;background-color:#e3d2d2">if</span> <span style="color:#a61717;background-color:#e3d2d2">(!(value%1</span> <span style="color:#a61717;background-color:#e3d2d2">===</span> <span style="color:#a61717;background-color:#e3d2d2">0)||(value&lt;0))</span> <span style="color:#a61717;background-color:#e3d2d2">{</span>
</span></span><span style="display:flex;"><span>           <span style="color:#a61717;background-color:#e3d2d2">callback(new</span> <span style="color:#a61717;background-color:#e3d2d2">Error(&#39;排序应该是整数且大于0&#39;));</span>
</span></span><span style="display:flex;"><span>          }
</span></span><span style="display:flex;"><span>          <span style="color:#a61717;background-color:#e3d2d2">callback();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#a61717;background-color:#e3d2d2">}</span>
</span></span><span style="display:flex;"><span>      <span style="color:#a61717;background-color:#e3d2d2">};</span>
</span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">return</span> {
</span></span><span style="display:flex;"><span>	<span style="color:#a61717;background-color:#e3d2d2">…………略</span>
</span></span><span style="display:flex;"><span> <span style="color:#a61717;background-color:#e3d2d2">dataRule:</span> <span style="color:#a61717;background-color:#e3d2d2">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a61717;background-color:#e3d2d2">…………</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a61717;background-color:#e3d2d2">displayOrder:</span> <span style="color:#a61717;background-color:#e3d2d2">[</span>
</span></span><span style="display:flex;"><span>            <span style="color:#a61717;background-color:#e3d2d2">{</span> <span style="color:#a61717;background-color:#e3d2d2">validator:</span> <span style="color:#a61717;background-color:#e3d2d2">validateOrder,</span> <span style="color:#a61717;background-color:#e3d2d2">trigger:</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;blur&#39;</span> }
</span></span><span style="display:flex;"><span>          <span style="color:#a61717;background-color:#e3d2d2">],</span>
</span></span><span style="display:flex;"><span>    <span style="color:#a61717;background-color:#e3d2d2">…………</span>
</span></span><span style="display:flex;"><span> <span style="color:#a61717;background-color:#e3d2d2">},</span>
</span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">}</span>
</span></span></code></pre></div><p>测试
<img src="/posts/project/20220528232959/image-20220528234257165.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>只有输入整数才能验证通过。</p>
<h2 id="39修改题目答案为多行文本框">3.9、修改题目答案为多行文本框</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vue" data-lang="vue"><span style="display:flex;"><span>&lt;<span style="color:#000080">el-form-item</span> <span style="color:#008080">label</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;题目解答&#34;</span> <span style="color:#008080">prop</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;answer&#34;</span>&gt;
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#000080">el-input</span>  <span style="color:#008080">type</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;textarea&#34;</span> <span style="color:#000080">:rows</span><span style="color:#d14">=&#34;2&#34;</span> <span style="color:#000080">v-model</span><span style="color:#d14">=&#34;dataForm.answer&#34; placeholder=&#34;题目解答&#34;</span>&gt;<span style="color:#a61717;background-color:#e3d2d2">&lt;/</span><span style="color:#008080">el</span><span style="color:#000080">-input</span>&gt;
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#a61717;background-color:#e3d2d2">/el-form-item&gt;</span>
</span></span></code></pre></div><p>效果：</p>
<p><img src="/posts/project/20220528232959/image-20220528234304599.png"
    
    
    
    loading="lazy"
    
    
></p>
<h1 id="4完成题目导入导出功能">4、完成题目导入、导出功能</h1>
<h2 id="41java操作excel类库poi">4.1、JAVA操作excel类库POI</h2>
<h3 id="1211-什么是poi">12.1.1 什么是POI？</h3>
<p>Apache POI是Apache软件基金会的开放源码函式库，POI提供API给Java程序对Microsoft Office格式档案读和写的功能。</p>
<p>· HSSF － 提供读写Microsoft Excel格式档案的功能。（.xls）</p>
<p>· XSSF － 提供读写Microsoft Excel OOXML格式档案的功能。（.xlsx）</p>
<p>· HWPF － 提供读写Microsoft Word格式档案的功能。</p>
<p>· HSLF － 提供读写Microsoft PowerPoint格式档案的功能。</p>
<p>· HDGF － 提供读写Microsoft Visio格式档案的功能。</p>
<h3 id="1212-poi官网">12.1.2 POI官网</h3>
<p><a class="link" href="/posts/project/http://poi.apache.org/"  target="_blank" rel="noopener"
    >http://poi.apache.org/</a></p>
<p>官网可以找到文档和每个版本的下载地址</p>
<h2 id="42poi入门demo">4.2、POI入门demo</h2>
<h3 id="421创建一个普通的maven项目">4.2.1．创建一个普通的maven项目</h3>
<p>项目名：excel-poi</p>
<h3 id="422pom中引入xml相关依赖">4.2.2．pom中引入xml相关依赖</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span><span style="color:#000080">&lt;dependencies&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!--xls--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;groupId&gt;</span>org.apache.poi<span style="color:#000080">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;artifactId&gt;</span>poi<span style="color:#000080">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;version&gt;</span>3.9<span style="color:#000080">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!--xlsx--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;groupId&gt;</span>org.apache.poi<span style="color:#000080">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;artifactId&gt;</span>poi-ooxml<span style="color:#000080">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;version&gt;</span>3.9<span style="color:#000080">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!--test--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;groupId&gt;</span>junit<span style="color:#000080">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;artifactId&gt;</span>junit<span style="color:#000080">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;version&gt;</span>4.12<span style="color:#000080">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;/dependencies&gt;</span>
</span></span></code></pre></div><h3 id="423java写入excel">4.2.3．java写入excel</h3>
<h4 id="2003版写文件">2003版写文件</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">package</span> <span style="color:#555">com.excel.poi</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">ExcelTest</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testWrite03</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span> IOException <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 创建新的Excel 工作簿
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        Workbook workbook <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> HSSFWorkbook<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 在Excel工作簿中建一工作表，其名为缺省值 Sheet0
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#998;font-style:italic">//Sheet sheet = workbook.createSheet();
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 如要新建一名为&#34;会员登录统计&#34;的工作表，其语句为：
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        Sheet sheet <span style="color:#000;font-weight:bold">=</span> workbook<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createSheet</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;会员登录统计&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 创建行（row 1）
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        Row row1 <span style="color:#000;font-weight:bold">=</span> sheet<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createRow</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 创建单元格（col 1-1）
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        Cell cell11 <span style="color:#000;font-weight:bold">=</span> row1<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        cell11<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;今日人数&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 创建单元格（col 1-2）
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        Cell cell12 <span style="color:#000;font-weight:bold">=</span> row1<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        cell12<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span>666<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 创建行（row 2）
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        Row row2 <span style="color:#000;font-weight:bold">=</span> sheet<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createRow</span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 创建单元格（col 2-1）
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        Cell cell21 <span style="color:#000;font-weight:bold">=</span> row2<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        cell21<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;统计时间&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//创建单元格（第三列）
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        Cell cell22 <span style="color:#000;font-weight:bold">=</span> row2<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        String dateTime <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> DateTime<span style="color:#000;font-weight:bold">().</span><span style="color:#008080">toString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;yyyy-MM-dd HH:mm:ss&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        cell22<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span>dateTime<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 新建一输出文件流（注意：要先创建文件夹）
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        FileOutputStream out <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> FileOutputStream<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;d:/excel-poi/test-write03.xls&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 把相应的Excel 工作簿存盘
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        workbook<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">write</span><span style="color:#000;font-weight:bold">(</span>out<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 操作结束，关闭文件
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        out<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;文件生成成功&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="2007版写文件">2007版写文件</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testWrite07</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span> IOException <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 创建新的Excel 工作簿
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    Workbook workbook <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> XSSFWorkbook<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 在Excel工作簿中建一工作表，其名为缺省值 Sheet0
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#998;font-style:italic">//Sheet sheet = workbook.createSheet();
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 如要新建一名为&#34;会员登录统计&#34;的工作表，其语句为：
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    Sheet sheet <span style="color:#000;font-weight:bold">=</span> workbook<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createSheet</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;会员登录统计&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 创建行（row 1）
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    Row row1 <span style="color:#000;font-weight:bold">=</span> sheet<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createRow</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 创建单元格（col 1-1）
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    Cell cell11 <span style="color:#000;font-weight:bold">=</span> row1<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    cell11<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;今日人数&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 创建单元格（col 1-2）
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    Cell cell12 <span style="color:#000;font-weight:bold">=</span> row1<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    cell12<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span>666<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 创建行（row 2）
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    Row row2 <span style="color:#000;font-weight:bold">=</span> sheet<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createRow</span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 创建单元格（col 2-1）
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    Cell cell21 <span style="color:#000;font-weight:bold">=</span> row2<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    cell21<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;统计时间&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">//创建单元格（第三列）
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    Cell cell22 <span style="color:#000;font-weight:bold">=</span> row2<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    String dateTime <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> DateTime<span style="color:#000;font-weight:bold">().</span><span style="color:#008080">toString</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;yyyy-MM-dd HH:mm:ss&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    cell22<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span>dateTime<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 新建一输出文件流（注意：要先创建文件夹）
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    FileOutputStream out <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> FileOutputStream<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;d:/excel-poi/test-write07.xlsx&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 把相应的Excel 工作簿存盘
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    workbook<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">write</span><span style="color:#000;font-weight:bold">(</span>out<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 操作结束，关闭文件
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    out<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;文件生成成功&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>注意：如果针对不同版本的Excel使用了不适合的类库，则会报告异常
org.apache.poi.POIXMLException: org.apache.poi.openxml4j.exceptions.InvalidFormatException: Package should contain a content type part [M1.13]</p>
<h3 id="424java读取excel">4.2.4．Java读取excel</h3>
<h4 id="2003版读文件">2003版读文件</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">package</span> <span style="color:#555">com.excel.poi</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">ExcelReadTest</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testRead03</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span> Exception<span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        InputStream is <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> FileInputStream<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;d:/excel-poi/test-write03.xls&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        Workbook workbook <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> HSSFWorkbook<span style="color:#000;font-weight:bold">(</span>is<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        Sheet sheet <span style="color:#000;font-weight:bold">=</span> workbook<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSheetAt</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 读取第一行第一列
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        Row row <span style="color:#000;font-weight:bold">=</span> sheet<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getRow</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        Cell cell <span style="color:#000;font-weight:bold">=</span> row<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getCell</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 输出单元内容
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span>cell<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getStringCellValue</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 操作结束，关闭文件
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        is<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="2007版读文件">2007版读文件</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">testRead07</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">throws</span> Exception<span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    InputStream is <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> FileInputStream<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;d:/excel-poi/test-write07.xlsx&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    Workbook workbook <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> XSSFWorkbook<span style="color:#000;font-weight:bold">(</span>is<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    Sheet sheet <span style="color:#000;font-weight:bold">=</span> workbook<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSheetAt</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 读取第一行第一列
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    Row row <span style="color:#000;font-weight:bold">=</span> sheet<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getRow</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    Cell cell <span style="color:#000;font-weight:bold">=</span> row<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getCell</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 输出单元内容
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span>cell<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getStringCellValue</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 操作结束，关闭文件
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    is<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="43java后端代码编写">4.3、JAVA后端代码编写</h2>
<h3 id="431修改项目u-question的接口questionservice增加导入导出接口定义">4.3.1修改项目u-question的接口QuestionService增加导入、导出接口定义</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">interface</span> <span style="color:#458;font-weight:bold">QuestionService</span> <span style="color:#000;font-weight:bold">extends</span> IService<span style="color:#000;font-weight:bold">&lt;</span>QuestionEntity<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    PageUtils <span style="color:#900;font-weight:bold">queryPage</span><span style="color:#000;font-weight:bold">(</span>Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">&gt;</span> params<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">//导入
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">public</span> Map <span style="color:#900;font-weight:bold">importExcel</span><span style="color:#000;font-weight:bold">(</span>MultipartFile file<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>   <span style="color:#998;font-style:italic">//导出
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#000;font-weight:bold">public</span> Workbook <span style="color:#900;font-weight:bold">exportExcel</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="432-修改实现类questionserviceimpl实现导入导出方法">4.3.2 修改实现类QuestionServiceImpl实现导入、导出方法</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>  <span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> Map <span style="color:#900;font-weight:bold">importExcel</span><span style="color:#000;font-weight:bold">(</span>MultipartFile file<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        Map result<span style="color:#000;font-weight:bold">=</span><span style="color:#000;font-weight:bold">new</span> HashMap<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//获取上传文件名称
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        String filename <span style="color:#000;font-weight:bold">=</span> file<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getOriginalFilename</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>         String extName <span style="color:#000;font-weight:bold">=</span> filename<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">substring</span><span style="color:#000;font-weight:bold">(</span>filename<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">lastIndexOf</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;.&#34;</span><span style="color:#000;font-weight:bold">)+</span>1<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//2、判断文件扩展名是否等于xlsx,xls
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">if</span><span style="color:#000;font-weight:bold">(!</span>extName<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">equals</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;xls&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">&amp;&amp;!</span>extName<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">equals</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;xlsx&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>            result<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;result&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#000;font-weight:bold">false</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            result<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;msg&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#d14">&#34;文件扩展名不正确，导入失败&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            result<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;num&#34;</span><span style="color:#000;font-weight:bold">,</span>0<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>       <span style="color:#000;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            InputStream inputStream <span style="color:#000;font-weight:bold">=</span> file<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getInputStream</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#998;font-style:italic">//初始化创建工作簿对象
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>            Workbook workbook <span style="color:#000;font-weight:bold">=</span> WorkbookFactory<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">create</span><span style="color:#000;font-weight:bold">(</span>inputStream<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#998;font-style:italic">//获取第一张工作表
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>            Sheet sheet <span style="color:#000;font-weight:bold">=</span> workbook<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSheetAt</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#998;font-style:italic">//获取工作表里面有数据行数
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>            <span style="color:#458;font-weight:bold">int</span> rows <span style="color:#000;font-weight:bold">=</span> sheet<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getPhysicalNumberOfRows</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#998;font-style:italic">//循环表格行
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>            <span style="color:#000;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#458;font-weight:bold">int</span> i <span style="color:#000;font-weight:bold">=</span> 1<span style="color:#000;font-weight:bold">;</span> i <span style="color:#000;font-weight:bold">&lt;</span>rows <span style="color:#000;font-weight:bold">;</span> i<span style="color:#000;font-weight:bold">++)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                QuestionEntity questionEntity <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> QuestionEntity<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>                <span style="color:#998;font-style:italic">//获取当前行
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>                Row row <span style="color:#000;font-weight:bold">=</span> sheet<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getRow</span><span style="color:#000;font-weight:bold">(</span>i<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#998;font-style:italic">//获取第一个单元格的内容 标题
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>              String title<span style="color:#000;font-weight:bold">=</span>  row<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getCell</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">getStringCellValue</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>              <span style="color:#998;font-style:italic">//设置到题目对象标题属性
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>                questionEntity<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setTitle</span><span style="color:#000;font-weight:bold">(</span>title<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;title:&#34;</span><span style="color:#000;font-weight:bold">+</span>title<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#998;font-style:italic">//获取第二个单元格的内容 答案
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>                String answer <span style="color:#000;font-weight:bold">=</span> row<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getCell</span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">getStringCellValue</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>                questionEntity<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setAnswer</span><span style="color:#000;font-weight:bold">(</span>answer<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;answer:&#34;</span><span style="color:#000;font-weight:bold">+</span>answer<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                <span style="color:#998;font-style:italic">//获取第三个单元格的内容 题目难度等级
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>                <span style="color:#458;font-weight:bold">double</span> level <span style="color:#000;font-weight:bold">=</span> row<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getCell</span><span style="color:#000;font-weight:bold">(</span>2<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">getNumericCellValue</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>                questionEntity<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setLevel</span><span style="color:#000;font-weight:bold">((</span><span style="color:#458;font-weight:bold">int</span><span style="color:#000;font-weight:bold">)</span>level<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#998;font-style:italic">//获取第四个单元格的内容 paix
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>                questionEntity<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setDisplayOrder</span><span style="color:#000;font-weight:bold">((</span><span style="color:#458;font-weight:bold">int</span><span style="color:#000;font-weight:bold">)</span>row<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getCell</span><span style="color:#000;font-weight:bold">(</span>3<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">getNumericCellValue</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#998;font-style:italic">//获取副标题
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>                questionEntity<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setSubTitle</span><span style="color:#000;font-weight:bold">(</span>row<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getCell</span><span style="color:#000;font-weight:bold">(</span>4<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">getStringCellValue</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>                <span style="color:#998;font-style:italic">//题目类型
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>                questionEntity<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setType</span><span style="color:#000;font-weight:bold">((</span><span style="color:#458;font-weight:bold">long</span><span style="color:#000;font-weight:bold">)</span>row<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getCell</span><span style="color:#000;font-weight:bold">(</span>5<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">getNumericCellValue</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>                <span style="color:#998;font-style:italic">//是否显示
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>                questionEntity<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setEnable</span><span style="color:#000;font-weight:bold">((</span><span style="color:#458;font-weight:bold">int</span><span style="color:#000;font-weight:bold">)</span>row<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getCell</span><span style="color:#000;font-weight:bold">(</span>6<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">getNumericCellValue</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>                <span style="color:#998;font-style:italic">//调用数据库保存方法，保存题目数据到书籍
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>                <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">save</span><span style="color:#000;font-weight:bold">(</span>questionEntity<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            result<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;result&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#000;font-weight:bold">true</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            result<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;msg&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#d14">&#34;导入成功&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;导入成功总条数:&#34;</span><span style="color:#000;font-weight:bold">+</span>list<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">size</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span>Exception e<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            e<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">printStackTrace</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>            result<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;result&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#000;font-weight:bold">false</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            result<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;msg&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#d14">&#34;文件导入失败，&#34;</span><span style="color:#000;font-weight:bold">+</span>e<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMessage</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>            result<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;num&#34;</span><span style="color:#000;font-weight:bold">,</span>0<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> result<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> Workbook <span style="color:#900;font-weight:bold">exportExcel</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 创建新的Excel 工作簿
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        Workbook workbook <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> HSSFWorkbook<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 在Excel工作簿中建一工作表，其名为缺省值 Sheet0
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#998;font-style:italic">//Sheet sheet = workbook.createSheet();
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">// 创建工作表
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        Sheet sheet <span style="color:#000;font-weight:bold">=</span> workbook<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createSheet</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;题库&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        Row row <span style="color:#000;font-weight:bold">=</span> sheet<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createRow</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        row<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;题目标题&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        row<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;题目解答&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        row<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>2<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;题目难度等级&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        row<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>3<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;排序&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        row<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>4<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;副标题&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        row<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>5<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;题目类型&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        row<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>6<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;是否显示&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        List<span style="color:#000;font-weight:bold">&lt;</span>QuestionEntity<span style="color:#000;font-weight:bold">&gt;</span> list <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">list</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#458;font-weight:bold">int</span> i <span style="color:#000;font-weight:bold">=</span> 0<span style="color:#000;font-weight:bold">;</span> i <span style="color:#000;font-weight:bold">&lt;</span> list<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">size</span><span style="color:#000;font-weight:bold">();</span> i<span style="color:#000;font-weight:bold">++)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            Row row2 <span style="color:#000;font-weight:bold">=</span> sheet<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createRow</span><span style="color:#000;font-weight:bold">(</span>i <span style="color:#000;font-weight:bold">+</span> 1<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#998;font-style:italic">//创建表格
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>            row2<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span>list<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span>i<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">getTitle</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>            row2<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>1<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span>list<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span>i<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">getAnswer</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>            row2<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>2<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span>list<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span>i<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">getLevel</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>            row2<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>3<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span>list<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span>i<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">getDisplayOrder</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>            row2<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>4<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span>list<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span>i<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">getSubTitle</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>            row2<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>5<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span>list<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span>i<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">getType</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>            row2<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">createCell</span><span style="color:#000;font-weight:bold">(</span>6<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">setCellValue</span><span style="color:#000;font-weight:bold">(</span>list<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span>i<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">getEnable</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> workbook<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="433-修改控制器questioncontroller实现导入导出方法">4.3.3 修改控制器QuestionController实现导入、导出方法</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#998;font-style:italic">//题目上传导入
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#3c5d5d;font-weight:bold">@PostMapping</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;/upload&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> R <span style="color:#900;font-weight:bold">upload</span><span style="color:#000;font-weight:bold">(</span>MultipartFile file<span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>        Map result <span style="color:#000;font-weight:bold">=</span> questionService<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">importExcel</span><span style="color:#000;font-weight:bold">(</span>file<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> R<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">ok</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;result&#34;</span><span style="color:#000;font-weight:bold">,</span>result<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;result&#34;</span><span style="color:#000;font-weight:bold">)).</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;msg&#34;</span><span style="color:#000;font-weight:bold">,</span>result<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;msg&#34;</span><span style="color:#000;font-weight:bold">)).</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;num&#34;</span><span style="color:#000;font-weight:bold">,</span>result<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;num&#34;</span><span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//导出excel
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#3c5d5d;font-weight:bold">@GetMapping</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;exportExcel&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">export</span><span style="color:#000;font-weight:bold">(</span>String tableName<span style="color:#000;font-weight:bold">,</span> HttpServletResponse response<span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;导出excele&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        Workbook workbook <span style="color:#000;font-weight:bold">=</span> questionService<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">exportExcel</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>workbook <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            String fileName <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;uxue_&#34;</span> <span style="color:#000;font-weight:bold">+</span> <span style="color:#000;font-weight:bold">new</span> SimpleDateFormat<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;yyyyMMddHHmmss&#34;</span><span style="color:#000;font-weight:bold">).</span><span style="color:#008080">format</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">new</span> Date<span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">+</span> <span style="color:#d14">&#34;.xlsx&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>            response<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setHeader</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Content-Disposition&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#d14">&#34;attachment;filename=&#34;</span> <span style="color:#000;font-weight:bold">+</span> fileName<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            response<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setContentType</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;application/octet-stream;charset=UTF-8&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            OutputStream outputStream<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                outputStream <span style="color:#000;font-weight:bold">=</span> response<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getOutputStream</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>                workbook<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">write</span><span style="color:#000;font-weight:bold">(</span>outputStream<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>                outputStream<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">flush</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>                outputStream<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">close</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span>Exception e<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>               e<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">printStackTrace</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">else</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>                response<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getWriter</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;error&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span> <span style="color:#000;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span>Exception e<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>               e<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">printStackTrace</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="44前端代码编写">4.4、前端代码编写</h2>
<h3 id="441-创建导入弹窗口视图页面">4.4.1 创建导入弹窗口视图页面</h3>
<p>在renren-fast-vue前端工程/src/views/modules/question/ 目录下新增视图文件 question-import.vue</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vue" data-lang="vue"><span style="display:flex;"><span>&lt;<span style="color:#000080">template</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#000080">el-dialog</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">:title</span><span style="color:#d14">=&#34;&#39;导入题库&#39;&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">:close-on-click-modal</span><span style="color:#d14">=&#34;false&#34;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">:visible.sync</span><span style="color:#d14">=&#34;visible&#34;</span> &gt;
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#000080">el-row</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#000080">div</span> <span style="color:#008080">class</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;el-form-item__content&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#000080">el-upload</span> <span style="color:#008080">ref</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;upload&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#008080">accept</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;.xls,.xlsx&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#008080">action</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;#&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000080">:auto-upload</span><span style="color:#d14">=&#34;false&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000080">:multiple</span><span style="color:#d14">=&#34;false&#34;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000080">:file-list</span><span style="color:#d14">=&#34;fileList&#34;</span>           
</span></span><span style="display:flex;"><span>            <span style="color:#000080">:http-request</span><span style="color:#d14">=&#34;uploadHttpRequest&#34;</span>
</span></span><span style="display:flex;"><span>            &gt;
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#000080">el-button</span> <span style="color:#008080">size</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;small&#34;</span> <span style="color:#008080">type</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;primary&#34;</span>&gt;选择文件<span style="color:#000;font-weight:bold">&lt;</span><span style="color:#a61717;background-color:#e3d2d2">/el-button&gt;</span>
</span></span><span style="display:flex;"><span>            &lt;<span style="color:#000080">div</span> <span style="color:#008080">slot</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;tip&#34;</span> <span style="color:#008080">class</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;el-upload__tip&#34;</span>&gt;一次只能上传一个xls<span style="color:#000;font-weight:bold">/</span>xlsx文件<span style="color:#a61717;background-color:#e3d2d2">，</span>且不超过10M&lt;/<span style="color:#000080">div</span>&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#a61717;background-color:#e3d2d2">/el-upload&gt;        </span>
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#000080">el-button</span> <span style="color:#008080">type</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;primary&#34;</span> <span style="color:#008080">size</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;small&#34;</span> <span style="color:#000080">@click</span><span style="color:#d14">=&#34;submitUpload&#34;</span>&gt;<span style="color:#008080">上</span> <span style="color:#008080">传</span><span style="color:#a61717;background-color:#e3d2d2">&lt;/</span><span style="color:#008080">el</span><span style="color:#000080">-button</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#000080">a</span> <span style="color:#008080">type</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;primary&#34;</span> <span style="color:#008080">href</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;/test.xls&#34;</span> <span style="color:#008080">size</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;small&#34;</span> &gt;下载导入模板&lt;/<span style="color:#000080">a</span>&gt;
</span></span><span style="display:flex;"><span>    &lt;/<span style="color:#000080">div</span>&gt;   
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#a61717;background-color:#e3d2d2">/el-row&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#a61717;background-color:#e3d2d2">/el-dialog&gt;</span>
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#000080">template</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#000080">script</span>&gt;
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">export</span> <span style="color:#000;font-weight:bold">default</span> {
</span></span><span style="display:flex;"><span>    data () {
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">return</span> {
</span></span><span style="display:flex;"><span>        visible<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">false</span>,    
</span></span><span style="display:flex;"><span>        fileList<span style="color:#000;font-weight:bold">:</span> [],        
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    methods<span style="color:#000;font-weight:bold">:</span> {     
</span></span><span style="display:flex;"><span>      init () {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">this</span>.visible <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>      },   
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// param是默认参数，可以取得file文件信息，具体信息如下图
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    uploadHttpRequest(param) {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">const</span> formData <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> FormData() <span style="color:#998;font-style:italic">//FormData对象，添加参数只能通过append(&#39;key&#39;, value)的形式添加
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        formData.append(<span style="color:#d14">&#39;file&#39;</span>, param.file) <span style="color:#998;font-style:italic">//添加文件对象
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        formData.append(<span style="color:#d14">&#39;uploadType&#39;</span>, <span style="color:#000;font-weight:bold">this</span>.rulesType)        
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">this</span>.$http({
</span></span><span style="display:flex;"><span>            url<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">this</span>.$http.adornUrl(<span style="color:#d14">`/question/question/upload`</span>),
</span></span><span style="display:flex;"><span>            method<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;post&#39;</span>,
</span></span><span style="display:flex;"><span>            data<span style="color:#000;font-weight:bold">:</span> formData,
</span></span><span style="display:flex;"><span>            contentType<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;form&#39;</span>
</span></span><span style="display:flex;"><span>          }).then( res =&gt; {
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">const</span> { data<span style="color:#000;font-weight:bold">:</span> { code, mark, num, msg } } <span style="color:#000;font-weight:bold">=</span> res
</span></span><span style="display:flex;"><span>                <span style="color:#000;font-weight:bold">if</span>(code <span style="color:#000;font-weight:bold">===</span> <span style="color:#099">0</span>) {
</span></span><span style="display:flex;"><span>                    <span style="color:#000;font-weight:bold">this</span>.fileList <span style="color:#000;font-weight:bold">=</span> []
</span></span><span style="display:flex;"><span>                    <span style="color:#000;font-weight:bold">this</span>.visible <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">false</span>
</span></span><span style="display:flex;"><span>                  <span style="color:#998;font-style:italic">//  param.onSuccess()  // 上传成功的文件显示绿色的对勾
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>                  <span style="color:#998;font-style:italic">//  this.uploadMark = mark
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>                  <span style="color:#998;font-style:italic">//this.$message.info(&#39;上传文件成功,导入条数:&#39;+num)
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>                  <span style="color:#000;font-weight:bold">this</span>.$message({
</span></span><span style="display:flex;"><span>                  message<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;上传文件成功,导入条数:&#39;</span><span style="color:#000;font-weight:bold">+</span>num,
</span></span><span style="display:flex;"><span>                  type<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;success&#39;</span>,
</span></span><span style="display:flex;"><span>                  duration<span style="color:#000;font-weight:bold">:</span> <span style="color:#099">1000</span>,
</span></span><span style="display:flex;"><span>                  onClose<span style="color:#000;font-weight:bold">:</span> () =&gt; {
</span></span><span style="display:flex;"><span>                    <span style="color:#000;font-weight:bold">this</span>.visible <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">false</span>
</span></span><span style="display:flex;"><span>                    <span style="color:#000;font-weight:bold">this</span>.$emit(<span style="color:#d14">&#39;refreshDataList&#39;</span>)
</span></span><span style="display:flex;"><span>                  }
</span></span><span style="display:flex;"><span>                })
</span></span><span style="display:flex;"><span>                }<span style="color:#000;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>                    <span style="color:#000;font-weight:bold">this</span>.$message.error(msg)
</span></span><span style="display:flex;"><span>                }
</span></span><span style="display:flex;"><span>              
</span></span><span style="display:flex;"><span>            })            
</span></span><span style="display:flex;"><span>            .<span style="color:#000;font-weight:bold">catch</span>( err =&gt; {
</span></span><span style="display:flex;"><span>                console.log(<span style="color:#d14">&#39;失败&#39;</span>, err)
</span></span><span style="display:flex;"><span>                param.onError() <span style="color:#998;font-style:italic">//上传失败的文件会从文件列表中删除
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>            })
</span></span><span style="display:flex;"><span>    },    
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">// 点击上传：手动上传到服务器，此时会触发组件的http-request
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    submitUpload() {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">this</span>.$refs.upload.submit()
</span></span><span style="display:flex;"><span>    }    
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#000080">script</span>&gt;
</span></span></code></pre></div><h3 id="442-修改题目维护页面questionvue">4.4.2 修改题目维护页面question.vue</h3>
<p>引入导入页面：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">import</span> ImportExcel from <span style="color:#d14">&#39;./question-import&#39;</span>
</span></span></code></pre></div><p>注册导入窗口：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!--</span> 导入窗口<span style="color:#000;font-weight:bold">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>ImportExcel v<span style="color:#000;font-weight:bold">-</span><span style="color:#000;font-weight:bold">if</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;importVisible&#34;</span> ref<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;importExcel&#34;</span> <span style="color:#a61717;background-color:#e3d2d2">@</span>refreshDataList<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;getDataList&#34;</span><span style="color:#000;font-weight:bold">&gt;&lt;</span><span style="color:#a61717;background-color:#e3d2d2">/ImportExcel&gt;</span>
</span></span></code></pre></div><p>声明允许显示导入弹窗变量</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>data () {
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">return</span> {
</span></span><span style="display:flex;"><span>      <span style="color:#998;font-style:italic">//是否允许显示导入窗口
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        importVisible<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">false</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span></code></pre></div><p>把导入页面注册到当前页面组件：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span>components<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>      AddOrUpdate,
</span></span><span style="display:flex;"><span>      ImportExcel
</span></span><span style="display:flex;"><span>    },
</span></span></code></pre></div><p>添加导入导出点击触发方法：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#998;font-style:italic">//导入
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>      importExcelHandle () {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">this</span>.importVisible <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">this</span>.$nextTick(() =&gt; {
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">this</span>.$refs.importExcel.init()
</span></span><span style="display:flex;"><span>        })        
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      <span style="color:#998;font-style:italic">//导出
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>      exportExcelHandle () {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">var</span> dom<span style="color:#000;font-weight:bold">=</span><span style="color:#0086b3">document</span>.getElementById(<span style="color:#d14">&#39;ifile&#39;</span>)
</span></span><span style="display:flex;"><span>        dom.src<span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">this</span>.$http.adornUrl(<span style="color:#d14">&#39;/question/question/exportExcel&#39;</span>)
</span></span><span style="display:flex;"><span>      },
</span></span></code></pre></div><p>在页面模板区域，添加 导入、导出按钮：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vue" data-lang="vue"><span style="display:flex;"><span>&lt;<span style="color:#000080">el-button</span> <span style="color:#008080">type</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;primary&#34;</span> <span style="color:#000080">@click</span><span style="color:#d14">=&#34;importExcelHandle()&#34;</span>&gt;<span style="color:#008080">导入</span><span style="color:#a61717;background-color:#e3d2d2">&lt;/</span><span style="color:#008080">el</span><span style="color:#000080">-button</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#000080">el-button</span> <span style="color:#008080">type</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;success&#34;</span> <span style="color:#000080">@click</span><span style="color:#d14">=&#34;exportExcelHandle()&#34;</span>&gt;<span style="color:#008080">导出</span><span style="color:#a61717;background-color:#e3d2d2">&lt;/</span><span style="color:#008080">el</span><span style="color:#000080">-button</span>&gt;
</span></span><span style="display:flex;"><span>&lt;<span style="color:#000080">iframe</span> <span style="color:#008080">id</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;ifile&#34;</span> <span style="color:#008080">style</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;display:none&#34;</span>&gt;&lt;/<span style="color:#000080">iframe</span>&gt;
</span></span></code></pre></div><p>导入、导出视图显示效果：</p>
<p><img src="/posts/project/20220528232959/image-20220528234344428.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>点击 导入 按钮，弹出导入弹窗：</p>
<p><img src="/posts/project/20220528232959/image-20220528234353730.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>下载导入模板，按照模板，填写数据，选中文件，点击上传，即可导入</p>
<p><img src="/posts/project/20220528232959/image-20220528234402053.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>导入模板样式：</p>
<p><img src="/posts/project/20220528232959/image-20220528234411612.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>导入成功，提示导入条数，关闭导入弹窗。</p>
<p><img src="/posts/project/20220528232959/image-20220528234421595.png"
    
    
    
    loading="lazy"
    
    
></p>
<h1 id="5echarts图表入门">5、Echarts图表入门</h1>
<h2 id="51echarts简介">5.1．Echarts简介</h2>
<p>ECahrs是百度的一个项目，用于图表展示，提供了常规的折线图、柱状图、散点图、饼图、K线图，用于统计的盒形图，用于地理数据可视化的地图、热力图、线图，用于关系数据可视化的关系图、treemap、旭日图，多维数据可视化的平行坐标，还有用于 BI 的漏斗图，仪表盘，并且支持图与图之间的混搭。
官方网站：https://echarts.apache.org/zh/index.html</p>
<h2 id="52基本使用">5.2．基本使用</h2>
<p>入门参考：官网-&gt;文档-&gt;教程-&gt;5分钟上手ECharts</p>
<h3 id="521柱状图创建">5.2.1、柱状图创建</h3>
<h4 id="1创建html页面柱图html">（1）创建html页面：柱图.html</h4>
<h4 id="2引入echarts">（2）引入ECharts</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!--</span> 引入 ECharts 文件 <span style="color:#000;font-weight:bold">--&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>script src<span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;echarts.min.js&#34;</span><span style="color:#000;font-weight:bold">&gt;&lt;</span><span style="color:#a61717;background-color:#e3d2d2">/script&gt;</span>
</span></span></code></pre></div><h4 id="3定义图表区域">（3）定义图表区域</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-html" data-lang="html"><span style="display:flex;"><span><span style="color:#998;font-style:italic">&lt;!-- 为ECharts准备一个具备大小（宽高）的Dom --&gt;</span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#000080">div</span> <span style="color:#008080">id</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;main&#34;</span> <span style="color:#008080">style</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;width: 600px;height:400px;&#34;</span>&gt;&lt;/<span style="color:#000080">div</span>&gt; 
</span></span></code></pre></div><h4 id="4渲染图表">（4）渲染图表</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>script<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">var</span> myChart <span style="color:#000;font-weight:bold">=</span> echarts.init(<span style="color:#0086b3">document</span>.getElementById(<span style="color:#d14">&#39;main&#39;</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">var</span> option <span style="color:#000;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>        title<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>            text<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;Echarts 柱状图入门demo&#39;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        tootip<span style="color:#000;font-weight:bold">:</span> {},
</span></span><span style="display:flex;"><span>        legend<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>            data<span style="color:#000;font-weight:bold">:</span> [<span style="color:#d14">&#39;销量&#39;</span>]
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        xAxis<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>            data<span style="color:#000;font-weight:bold">:</span> [<span style="color:#d14">&#34;衬衫&#34;</span>,<span style="color:#d14">&#34;羊毛衫&#34;</span>,<span style="color:#d14">&#34;羽绒服&#34;</span>,<span style="color:#d14">&#34;裤子&#34;</span>,<span style="color:#d14">&#34;高跟鞋&#34;</span>]
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        yAxis<span style="color:#000;font-weight:bold">:</span> {},
</span></span><span style="display:flex;"><span>        series<span style="color:#000;font-weight:bold">:</span> [{
</span></span><span style="display:flex;"><span>            name<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;销量&#39;</span>,
</span></span><span style="display:flex;"><span>            type<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;bar&#39;</span>,
</span></span><span style="display:flex;"><span>            data<span style="color:#000;font-weight:bold">:</span> [<span style="color:#099">1</span>,<span style="color:#099">6</span>,<span style="color:#099">7</span>,<span style="color:#099">4</span>,<span style="color:#099">15</span>]
</span></span><span style="display:flex;"><span>        }]
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    myChart.setOption(option);
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#a61717;background-color:#e3d2d2">/script&gt;</span>
</span></span></code></pre></div><p>测试效果：</p>
<p><img src="/posts/project/20220528232959/image-20220528234435662.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="522折线图创建">5.2.2、折线图创建</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-javascript" data-lang="javascript"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span>script<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">var</span> myChart <span style="color:#000;font-weight:bold">=</span> echarts.init(<span style="color:#0086b3">document</span>.getElementById(<span style="color:#d14">&#39;main&#39;</span>));
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">var</span> option <span style="color:#000;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>        title<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>            text<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;Echarts 折线图入门demo&#39;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        tootip<span style="color:#000;font-weight:bold">:</span> {},
</span></span><span style="display:flex;"><span>        legend<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>            data<span style="color:#000;font-weight:bold">:</span> [<span style="color:#d14">&#39;销量&#39;</span>]
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        xAxis<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>            type<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;category&#39;</span>,
</span></span><span style="display:flex;"><span>            data<span style="color:#000;font-weight:bold">:</span> [<span style="color:#d14">&#34;Mon&#34;</span>,<span style="color:#d14">&#34;Tue&#34;</span>,<span style="color:#d14">&#34;Wed&#34;</span>,<span style="color:#d14">&#34;Thu&#34;</span>,<span style="color:#d14">&#34;Fri&#34;</span>,<span style="color:#d14">&#34;Sat&#34;</span>,<span style="color:#d14">&#34;Sun&#34;</span>]
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        yAxis<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>            type<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;value&#39;</span>
</span></span><span style="display:flex;"><span>        },
</span></span><span style="display:flex;"><span>        series<span style="color:#000;font-weight:bold">:</span> [{
</span></span><span style="display:flex;"><span>            name<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;销量&#39;</span>,
</span></span><span style="display:flex;"><span>            type<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;line&#39;</span>,
</span></span><span style="display:flex;"><span>            data<span style="color:#000;font-weight:bold">:</span> [<span style="color:#099">820</span>, <span style="color:#099">932</span>, <span style="color:#099">901</span>, <span style="color:#099">934</span>, <span style="color:#099">1290</span>, <span style="color:#099">1330</span>, <span style="color:#099">1320</span>]
</span></span><span style="display:flex;"><span>        }]
</span></span><span style="display:flex;"><span>    };
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    myChart.setOption(option);
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">&lt;</span><span style="color:#a61717;background-color:#e3d2d2">/script&gt;</span>
</span></span></code></pre></div><p><img src="/posts/project/20220528232959/image-20220528234445613.png"
    
    
    
    loading="lazy"
    
    
></p>
<h1 id="6统计分析">6、统计分析</h1>
<h2 id="61题库分类数量统计分析">6.1．题库分类数量统计分析</h2>
<h3 id="611-编写java后端代码">6.1.1 编写java后端代码</h3>
<p>打开java模块u-question ，编辑接口QuestionService新增统计分类题目数量方法</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">interface</span> <span style="color:#458;font-weight:bold">QuestionService</span> <span style="color:#000;font-weight:bold">extends</span> IService<span style="color:#000;font-weight:bold">&lt;</span>QuestionEntity<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>     <span style="color:#000;font-weight:bold">public</span> List<span style="color:#000;font-weight:bold">&lt;</span>Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">&gt;&gt;</span> <span style="color:#900;font-weight:bold">countTypeQuestion</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>编辑接口实现类QuestionServiceImpl,编写统计分类题目数量实现方法</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Service</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;questionService&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">QuestionServiceImpl</span> <span style="color:#000;font-weight:bold">extends</span> ServiceImpl<span style="color:#000;font-weight:bold">&lt;</span>QuestionDao<span style="color:#000;font-weight:bold">,</span> QuestionEntity<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#000;font-weight:bold">implements</span> QuestionService <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> QuestionDao questionDao<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> List<span style="color:#000;font-weight:bold">&lt;</span>Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">&gt;&gt;</span> <span style="color:#900;font-weight:bold">countTypeQuestion</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        QueryWrapper<span style="color:#000;font-weight:bold">&lt;</span>QuestionEntity<span style="color:#000;font-weight:bold">&gt;</span> queryWrapper <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> QueryWrapper<span style="color:#000;font-weight:bold">&lt;</span>QuestionEntity<span style="color:#000;font-weight:bold">&gt;().</span><span style="color:#008080">select</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;TYPE,COUNT(TYPE) AS num&#34;</span><span style="color:#000;font-weight:bold">).</span><span style="color:#008080">groupBy</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;type&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        List<span style="color:#000;font-weight:bold">&lt;</span>Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">&gt;&gt;</span> mapList <span style="color:#000;font-weight:bold">=</span> questionDao<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">selectMaps</span><span style="color:#000;font-weight:bold">(</span>queryWrapper<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> mapList<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>编辑QuestionController,新增统计分类题目数量方法</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@RestController</span>
</span></span><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@RequestMapping</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;question/question&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">QuestionController</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> QuestionService questionService<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> TypeService typeService<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">//获取按照题库分类的统计数据
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#3c5d5d;font-weight:bold">@RequestMapping</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;countTypeQuestion&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> R <span style="color:#900;font-weight:bold">countTypeQuestion</span><span style="color:#000;font-weight:bold">(){</span>
</span></span><span style="display:flex;"><span>        List<span style="color:#000;font-weight:bold">&lt;</span>Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">&gt;&gt;</span> mapList <span style="color:#000;font-weight:bold">=</span> questionService<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">countTypeQuestion</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span>Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> Object<span style="color:#000;font-weight:bold">&gt;</span> map <span style="color:#000;font-weight:bold">:</span> mapList<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>            <span style="color:#998;font-style:italic">//根据分类id，读取对应的分类数据
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>             Long typeId <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">(</span>Long<span style="color:#000;font-weight:bold">)</span> map<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;TYPE&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>             TypeEntity typeEntity <span style="color:#000;font-weight:bold">=</span> typeService<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getById</span><span style="color:#000;font-weight:bold">(</span>typeId<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#998;font-style:italic">//重新封装分类名称到map
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>            map<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;name&#34;</span><span style="color:#000;font-weight:bold">,</span>typeEntity<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getType</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> R<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">ok</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;mapList&#34;</span><span style="color:#000;font-weight:bold">,</span>mapList<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="612-编写前端代码">6.1.2 编写前端代码</h3>
<p>前端项目renren-fast-vue/src/views/modules/question目录 新增统计注册用户数量页面 echarts.vue</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-vue" data-lang="vue"><span style="display:flex;"><span>&lt;<span style="color:#000080">template</span>&gt; 
</span></span><span style="display:flex;"><span>  &lt;<span style="color:#000080">div</span> <span style="color:#008080">class</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;mod-demo-echarts&#34;</span>&gt;   
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>    &lt;<span style="color:#000080">el-row</span> <span style="color:#000080">:gutter</span><span style="color:#d14">=&#34;20&#34;</span>&gt;
</span></span><span style="display:flex;"><span>      
</span></span><span style="display:flex;"><span>      &lt;<span style="color:#000080">el-col</span> <span style="color:#000080">:span</span><span style="color:#d14">=&#34;24&#34;</span>&gt;
</span></span><span style="display:flex;"><span>        &lt;<span style="color:#000080">el-card</span>&gt;
</span></span><span style="display:flex;"><span>          &lt;<span style="color:#000080">div</span> <span style="color:#008080">id</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;J_chartBarBox&#34;</span> <span style="color:#008080">class</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;chart-box&#34;</span>&gt;&lt;/<span style="color:#000080">div</span>&gt;
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#a61717;background-color:#e3d2d2">/el-card&gt;</span>
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#a61717;background-color:#e3d2d2">/el-col&gt;      </span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">&lt;</span><span style="color:#a61717;background-color:#e3d2d2">/el-row&gt;</span>
</span></span><span style="display:flex;"><span>  &lt;/<span style="color:#000080">div</span>&gt;
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#000080">template</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#000080">script</span>&gt;
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">import</span> echarts from <span style="color:#d14">&#39;echarts&#39;</span>
</span></span><span style="display:flex;"><span>  <span style="color:#000;font-weight:bold">export</span> <span style="color:#000;font-weight:bold">default</span> {
</span></span><span style="display:flex;"><span>    data () {
</span></span><span style="display:flex;"><span>      <span style="color:#000;font-weight:bold">return</span> {       
</span></span><span style="display:flex;"><span>        chartBar<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">null</span>,
</span></span><span style="display:flex;"><span>         beginTime<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;&#39;</span>,
</span></span><span style="display:flex;"><span>         endTime<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;&#39;</span>,
</span></span><span style="display:flex;"><span>         mapList<span style="color:#000;font-weight:bold">:</span> [],
</span></span><span style="display:flex;"><span>         xData<span style="color:#000;font-weight:bold">:</span> [],
</span></span><span style="display:flex;"><span>         yData<span style="color:#000;font-weight:bold">:</span> [],
</span></span><span style="display:flex;"><span>         btnDisabled<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">false</span>
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    mounted () {     
</span></span><span style="display:flex;"><span>         <span style="color:#000;font-weight:bold">this</span>.create()
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    activated () {
</span></span><span style="display:flex;"><span>      <span style="color:#998;font-style:italic">// 由于给echart添加了resize事件, 在组件激活时需要重新resize绘画一次, 否则出现空白bug     
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>      <span style="color:#000;font-weight:bold">if</span> (<span style="color:#000;font-weight:bold">this</span>.chartBar) {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">this</span>.chartBar.resize()
</span></span><span style="display:flex;"><span>      }     
</span></span><span style="display:flex;"><span>    },
</span></span><span style="display:flex;"><span>    methods<span style="color:#000;font-weight:bold">:</span> {      
</span></span><span style="display:flex;"><span>      create () {
</span></span><span style="display:flex;"><span>         <span style="color:#000;font-weight:bold">this</span>. getDataList ()
</span></span><span style="display:flex;"><span>         <span style="color:#000;font-weight:bold">this</span>.initChartBar()  
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>       <span style="color:#998;font-style:italic">// 获取数据列表
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>      getDataList () {
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">this</span>.dataListLoading <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">this</span>.$http({
</span></span><span style="display:flex;"><span>          url<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">this</span>.$http.adornUrl(<span style="color:#d14">&#39;/question/question/countTypeQuestion&#39;</span>),
</span></span><span style="display:flex;"><span>          method<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;get&#39;</span>          
</span></span><span style="display:flex;"><span>        }).then(({data}) =&gt; {
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">if</span> (data <span style="color:#000;font-weight:bold">&amp;&amp;</span> data.code <span style="color:#000;font-weight:bold">===</span> <span style="color:#099">0</span>) {            
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">this</span>.mapList <span style="color:#000;font-weight:bold">=</span> data.mapList   
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">this</span>.xData <span style="color:#000;font-weight:bold">=</span> []
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">this</span>.yData <span style="color:#000;font-weight:bold">=</span> []         
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">for</span>(<span style="color:#000;font-weight:bold">let</span> j <span style="color:#000;font-weight:bold">in</span> <span style="color:#000;font-weight:bold">this</span>.mapList){
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">this</span>.xData.push(<span style="color:#000;font-weight:bold">this</span>.mapList[j].name)
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">this</span>.yData.push(<span style="color:#000;font-weight:bold">this</span>.mapList[j].num)
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>             console.log(<span style="color:#000;font-weight:bold">this</span>.xData)
</span></span><span style="display:flex;"><span>            console.log(<span style="color:#000;font-weight:bold">this</span>.yData)
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">this</span>.chartBar.resize()
</span></span><span style="display:flex;"><span>          <span style="color:#998;font-style:italic">// this.xData= this.mapList.map(obj =&gt; n.NAME);       
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>          <span style="color:#998;font-style:italic">// this.yData= this.mapList.map(obj =&gt; n.VALUE);  
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>          <span style="color:#000;font-weight:bold">this</span>.chartBar.setOption({
</span></span><span style="display:flex;"><span>             xAxis<span style="color:#000;font-weight:bold">:</span> [
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>              type<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;category&#39;</span>,
</span></span><span style="display:flex;"><span>              data<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">this</span>.xData
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          ],
</span></span><span style="display:flex;"><span>          yAxis<span style="color:#000;font-weight:bold">:</span> [
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>              type<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;value&#39;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          ],
</span></span><span style="display:flex;"><span>          series<span style="color:#000;font-weight:bold">:</span> [
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>              name<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;题目数量&#39;</span>,
</span></span><span style="display:flex;"><span>              type<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;bar&#39;</span>,
</span></span><span style="display:flex;"><span>              data<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">this</span>.yData
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          ]
</span></span><span style="display:flex;"><span>          })
</span></span><span style="display:flex;"><span>          } <span style="color:#000;font-weight:bold">else</span> {
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">this</span>.mapList <span style="color:#000;font-weight:bold">=</span> []           
</span></span><span style="display:flex;"><span>          }        
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>      },
</span></span><span style="display:flex;"><span>      <span style="color:#998;font-style:italic">// 柱状图
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>      initChartBar () {
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">var</span> option <span style="color:#000;font-weight:bold">=</span> {
</span></span><span style="display:flex;"><span>          tooltip<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>            trigger<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;axis&#39;</span>,
</span></span><span style="display:flex;"><span>            axisPointer<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>              type<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;shadow&#39;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          },
</span></span><span style="display:flex;"><span>          legend<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>            data<span style="color:#000;font-weight:bold">:</span> [<span style="color:#d14">&#39;题目数量&#39;</span>]
</span></span><span style="display:flex;"><span>          },
</span></span><span style="display:flex;"><span>          grid<span style="color:#000;font-weight:bold">:</span> {
</span></span><span style="display:flex;"><span>            left<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;3%&#39;</span>,
</span></span><span style="display:flex;"><span>            right<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;4%&#39;</span>,
</span></span><span style="display:flex;"><span>            bottom<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;3%&#39;</span>,
</span></span><span style="display:flex;"><span>            containLabel<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">true</span>
</span></span><span style="display:flex;"><span>          },
</span></span><span style="display:flex;"><span>          xAxis<span style="color:#000;font-weight:bold">:</span> [
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>              type<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;category&#39;</span>,
</span></span><span style="display:flex;"><span>              data<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">this</span>.xData
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          ],
</span></span><span style="display:flex;"><span>          yAxis<span style="color:#000;font-weight:bold">:</span> [
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>              type<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;value&#39;</span>
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          ],
</span></span><span style="display:flex;"><span>          series<span style="color:#000;font-weight:bold">:</span> [
</span></span><span style="display:flex;"><span>            {
</span></span><span style="display:flex;"><span>              name<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;每日注册用户数&#39;</span>,
</span></span><span style="display:flex;"><span>              type<span style="color:#000;font-weight:bold">:</span> <span style="color:#d14">&#39;bar&#39;</span>,
</span></span><span style="display:flex;"><span>              data<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">this</span>.yData
</span></span><span style="display:flex;"><span>            }
</span></span><span style="display:flex;"><span>          ]
</span></span><span style="display:flex;"><span>        }
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">this</span>.chartBar <span style="color:#000;font-weight:bold">=</span> echarts.init(<span style="color:#0086b3">document</span>.getElementById(<span style="color:#d14">&#39;J_chartBarBox&#39;</span>))
</span></span><span style="display:flex;"><span>       <span style="color:#998;font-style:italic">// this.chartBar.setOption(option)
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#0086b3">window</span>.addEventListener(<span style="color:#d14">&#39;resize&#39;</span>, () =&gt; {
</span></span><span style="display:flex;"><span>          <span style="color:#000;font-weight:bold">this</span>.chartBar.resize()
</span></span><span style="display:flex;"><span>        })
</span></span><span style="display:flex;"><span>      }     
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#000080">script</span>&gt;
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>&lt;<span style="color:#000080">style</span> <span style="color:#008080">lang</span><span style="color:#000;font-weight:bold">=</span><span style="color:#d14">&#34;scss&#34;</span>&gt;
</span></span><span style="display:flex;"><span>  .mod<span style="color:#000;font-weight:bold">-</span>demo<span style="color:#000;font-weight:bold">-</span>echarts {
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">&gt;</span> .el<span style="color:#000;font-weight:bold">-</span>alert {
</span></span><span style="display:flex;"><span>      margin<span style="color:#000;font-weight:bold">-</span>bottom<span style="color:#000;font-weight:bold">:</span> <span style="color:#099">10</span>px;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">&gt;</span> .el<span style="color:#000;font-weight:bold">-</span>row {
</span></span><span style="display:flex;"><span>      margin<span style="color:#000;font-weight:bold">-</span>top<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span>px;
</span></span><span style="display:flex;"><span>      margin<span style="color:#000;font-weight:bold">-</span>bottom<span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">-</span><span style="color:#099">10</span>px;
</span></span><span style="display:flex;"><span>      .el<span style="color:#000;font-weight:bold">-</span>col {
</span></span><span style="display:flex;"><span>        padding<span style="color:#000;font-weight:bold">-</span>top<span style="color:#000;font-weight:bold">:</span> <span style="color:#099">10</span>px;
</span></span><span style="display:flex;"><span>        padding<span style="color:#000;font-weight:bold">-</span>bottom<span style="color:#000;font-weight:bold">:</span> <span style="color:#099">10</span>px;
</span></span><span style="display:flex;"><span>      }
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>    .chart<span style="color:#000;font-weight:bold">-</span>box {
</span></span><span style="display:flex;"><span>      min<span style="color:#000;font-weight:bold">-</span>height<span style="color:#000;font-weight:bold">:</span> <span style="color:#099">400</span>px;
</span></span><span style="display:flex;"><span>    }
</span></span><span style="display:flex;"><span>  }
</span></span><span style="display:flex;"><span>&lt;/<span style="color:#000080">style</span>&gt;
</span></span></code></pre></div><h3 id="613-配置用户注册统计菜单">6.1.3 配置用户注册统计菜单</h3>
<p><img src="/posts/project/20220528232959/image-20220528234506567.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>新增菜单后，刷新，即可查看菜单
<img src="/posts/project/20220528232959/image-20220528234513583.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>点击题目数量统计可以查看按照题目分类统计的数量柱状图
<img src="/posts/project/20220528232959/image-20220528234520645.png"
    
    
    
    loading="lazy"
    
    
></p>

    </div>

    

    


    <div class="container-prevnext">
    <div><a href="https://lovemjh.vercel.app/posts/project/20220528231163/">← tk-题库项目基本框架搭建</a></div>
    <div><a href="https://lovemjh.vercel.app/posts/project/20220528234610/">tk-题库项目开发3  →</a></div>
</div>
</div>

        </div>
        <div id="footer"><div class="container-footer">
    
    <a href="//beian.miit.gov.cn" target="_blank">
        
        豫ICP备2022002918号
        
    </a>
    <a id="s" href="/secrets">&nbsp;</a>
</div></div>
    </body>
</html>
