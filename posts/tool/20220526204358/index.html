<!DOCTYPE html>
<html lang="zh-CN"><head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta http-equiv="Content-Type" content="text/html;charset=UTF-8">
    <meta name="description" content="Spring-Boot-1 - https://lovemjh.vercel.app/posts/tool/20220526204358/">
    
    <meta name="msvalidate.01" content="B46311949B856F2A7015F366FB3CE878" />
    <title>Spring-Boot-1</title>
    <link rel="icon" type="image/png" href="/favicon.ico">
    
    <link rel="stylesheet" href="https://lovemjh.vercel.app/style.min.ef012369a26adc2a21396230b3395dfcd5975a3082a65b82785cbc0b446f2a2c.css">
    
    <script type="text/javascript" src="/main.js" defer></script>
    
</head>
<body class="active-animate cool">
        <div id="header"><div class="container-header">
    <div id="vars" class="container-vars" style="display: none;">
	{
		"hasFoldAllCodeBlocks": false,
		"svgColor": "#6c757d",
		"en": false,
		"dark": false
	}
</div>
    <h1 class="title">
        
            Spring-Boot-1
            
        
    </h1>

    <div class="container-breadcrumb-nav">
    
    <div class="breadcrumb-nav-bar">
        <div><a href="/"><svg t="1656411084410" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="2954" width="16" height="16"><path d="M947.5 390.6l-377-290c-34.5-26.5-82.6-26.5-117.1 0l-377 290c-14 10.8-16.6 30.9-5.9 44.9 10.8 14 30.9 16.6 44.9 5.9l28.5-21.9V768c0 88.2 71.8 160 160 160h80c35.3 0 64-28.7 64-64V640c0-17.6 14.4-32 32-32h64c17.6 0 32 14.4 32 32v224c0 35.3 28.7 64 64 64h80c88.2 0 160-71.8 160-160V419.4l28.5 21.9c5.8 4.5 12.7 6.6 19.5 6.6 9.6 0 19.1-4.3 25.4-12.5 10.8-13.9 8.2-34-5.8-44.8zM816 768c0 52.9-43.1 96-96 96h-80V640c0-52.9-43.1-96-96-96h-64c-52.9 0-96 43.1-96 96v224h-80c-52.9 0-96-43.1-96-96V370.2l284.5-218.8c11.5-8.8 27.5-8.8 39 0L816 370.2V768z" fill=#6c757d p-id="2955"></path></svg></a></div>
        <div><a href="/nav"><svg t="1656411531924" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5827" width="16" height="16"><path d="M849.59197473 125.23018519L139.22930586 391.72854662a23.35052669 23.35052669 0 0 0-14.95414244 21.65490745c-0.12257519 9.70384955 5.61801843 18.46795771 14.40255493 22.04306141l318.42928099 129.25528056 119.51057092 320.39047893c3.06437293 8.23295069 10.35758221 13.89182751 18.7335381 14.87242563l2.7170774 0.14300521a22.79893918 22.79893918 0 0 0 21.20546682-15.36272638l259.51158924-729.54564933a23.8612558 23.8612558 0 0 0-5.31158128-24.55584682 22.3290685 22.3290685 0 0 0-23.9021142-5.43415649zM793.65694081 211.64552314l-196.63064161 552.75171747-91.91077952-246.37564122-253.62799211-102.96295445 542.16941324-203.4131218z" p-id="5828" fill=#6c757d></path></svg></a></div>
        <div><a href="/search"><svg t="1656411627509" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="1730" width="14" height="14"><path d="M469.333333 85.333333c211.968 0 384 172.032 384 384s-172.032 384-384 384-384-172.032-384-384 172.032-384 384-384z m0 682.666667c164.992 0 298.666667-133.674667 298.666667-298.666667 0-165.034667-133.674667-298.666667-298.666667-298.666666-165.034667 0-298.666667 133.632-298.666666 298.666666 0 164.992 133.632 298.666667 298.666666 298.666667z m362.026667 3.029333l120.704 120.661334-60.373333 60.373333-120.661334-120.704 60.330667-60.330667z" p-id="1731" fill=#6c757d></path></svg></a></div>
        <div><a href="/posts"><svg t="1656411724198" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5655" width="12" height="12"><path d="M811.705761 1024H212.294239c-93.1199 0-174.823046-87.570975-174.823046-187.387854V162.322018C37.471193 69.776145 112.604921 0 212.294239 0H596.190595l7.015883 5.93161c111.74388 95.479788 185.857116 170.741078 279.614824 266.093304 29.65805 30.040735 61.165743 62.122454 96.436499 97.393211l7.271006 7.334787v459.859234c-0.063781 99.816879-81.703145 187.387854-174.823046 187.387854zM212.294239 49.94033c-72.391155 0-124.882716 47.261538-124.882716 112.381688v674.290128c0 71.94469 59.507443 137.383743 124.882716 137.383743h599.411522c65.311492 0 124.882716-65.439053 124.882716-137.383743V397.417876c-32.528184-32.464404-61.73977-62.250016-89.356836-90.377328-90.951355-92.418312-163.278729-165.957521-269.601245-257.163999H212.294239z" fill=#6c757d p-id="5656"></path><path d="M936.588477 449.526752h-212.326129c-99.753099 0-187.324073-81.703145-187.324073-174.823046V49.94033a25.002055 25.002055 0 0 1 49.94033 0v224.763376c0 65.311492 65.502834 124.882716 137.383743 124.882716h212.326129a25.002055 25.002055 0 1 1 0 49.94033z" fill=#6c757d p-id="5657"></path></svg></a></div>
        <div><a href="/archive"><svg t="1656411795742" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7334" width="12" height="12"><path d="M884.224 522.24H504.32V141.824c0-16.896-13.824-30.72-30.72-30.72-120.32 0-233.472 47.616-317.952 134.144S26.112 445.952 29.184 566.784c2.56 114.688 49.152 222.72 131.072 304.128 81.92 81.408 189.952 128 304.64 130.56h10.24c117.76 0 227.84-45.568 312.32-128.512 86.528-85.504 133.632-199.68 132.608-321.024-0.512-2.048-1.536-29.696-35.84-29.696z m-140.288 307.712c-74.752 73.728-173.056 112.64-277.504 110.592-205.824-4.608-370.688-169.472-375.296-374.784-3.072-104.448 35.84-202.752 108.544-277.504 65.536-67.072 151.552-107.52 243.712-114.688v378.88c0 16.896 13.824 30.72 30.72 30.72 129.024 0 311.296 0 382.976 0.512-6.144 93.184-46.08 179.712-113.152 246.272z" fill=#6c757d p-id="7335"></path><path d="M603.136 11.264c-8.192-0.512-15.872 3.072-22.016 8.704-5.632 5.632-9.216 13.824-9.216 22.016v378.88c0 16.896 13.824 30.72 30.72 30.72h378.88c16.896 0 30.72-13.824 30.72-30.72 0-223.744-183.808-407.552-409.088-409.6z m30.208 378.88V74.24c167.424 16.384 301.056 150.016 315.904 315.904h-315.904z" fill=#6c757d p-id="7336"></path></svg></a></div>
        <div id="light-dark" style="cursor: pointer;"><a><svg t="1656411842215" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="5086" width="12" height="12"><path d="M1007.492874 384.513055c-8.795694-34.58307-21.189627-67.666874-36.682043-99.05151-2.698679-5.397358-10.894667-3.498287-10.894666 2.598728v0.299853c0 32.484098-6.896624 63.868734-19.890263 92.554691-10.694764 23.488501-25.487523 45.077933-43.978471 64.068635-41.779547 42.679107-99.05151 66.967217-158.722299 67.26707-61.869712 0.299853-119.941284-24.188159-162.920244-68.966238-40.280281-41.979449-62.56937-98.251902-62.269516-156.323473 0.399804-59.270984 23.588452-114.94373 65.567901-156.823229 19.59041-19.59041 42.179351-35.082826 66.667364-46.077443C672.956643 71.166451 704.041426 64.469729 736.125719 64.469729h1.299364c6.097015 0 8.096037-8.096037 2.598728-10.794715C708.739126 37.982696 675.655322 25.488812 641.172203 16.493216 599.492607 5.598549 555.714038-0.098662 510.536154 0.001289 222.37722 0.700947-7.41029 237.38508 0.185992 525.444064c7.096526 271.667008 225.889418 490.559851 497.456474 497.856279 287.559228 7.796183 524.14341-220.891864 525.842579-508.551044 0.299853-44.977981-5.297407-88.656599-15.992171-130.236244z m-83.15929 301.552378c-22.588942 53.27392-54.873137 101.250434-95.953027 142.330323-41.179841 41.179841-89.056403 73.464036-142.330324 95.953027-55.172991 23.288599-113.744317 35.182777-174.314666 35.182777s-119.141675-11.794226-174.314666-35.182777c-53.27392-22.588942-101.250434-54.873137-142.330323-95.953027-41.179841-41.179841-73.464036-89.056403-95.953027-142.330323C75.749001 630.892442 63.954774 572.221164 63.954774 511.750767s11.794226-119.141675 35.182777-174.314666c22.588942-53.27392 54.873137-101.250434 95.953027-142.330323 41.179841-41.179841 89.056403-73.464036 142.330323-95.953027C392.593892 75.7642 451.26517 63.969974 511.735567 63.969974c13.99315 0 27.886348 0.599706 41.679596 1.89907C489.246577 118.643209 448.266638 198.704016 448.266638 288.360126c0 159.022152 128.836929 287.859081 287.859081 287.859081 89.156354 0 168.817357-40.580134 221.691473-104.149015 1.099462 13.09359 1.699168 26.387082 1.699168 39.680575 0 60.470397-11.794226 119.141675-35.182776 174.314666z" p-id="5087" fill=#6c757d></path></svg></a></div>
        
    </div>

    
</div>

            <div id="toc">📜</div>
        
    
    
</div>
</div>
        <div id="content">












<div class="container-main 
     container-page 
">

    <div class="desc">
        
        <span>
            
            <svg t="1656736000388" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="7409" width="12" height="12"><path d="M524.885333 338.986667L200.362667 663.466667c-17.28 15.274667-27.989333 36.693333-29.696 56.234666v133.76l130.730666 0.085334c22.784-1.621333 43.989333-12.245333 61.013334-31.701334l322.688-322.645333-160.213334-160.213333z m60.373334-60.330667l160.170666 160.213333 102.144-102.144a19.712 19.712 0 0 0 0-27.861333L715.093333 176.426667a19.456 19.456 0 0 0-27.605333 0L585.258667 278.613333zM701.312 85.333333c27.946667 0 54.741333 11.136 74.282667 30.848l132.309333 132.309334a105.045333 105.045333 0 0 1 0 148.565333L424.874667 879.957333c-29.824 34.346667-72.106667 55.466667-120.448 58.794667H85.333333v-42.666667l0.128-179.84c3.626667-44.970667 24.576-86.826667 56.448-114.944l485.12-485.034666A104.789333 104.789333 0 0 1 701.269333 85.333333z" p-id="7410" fill="#adb5bd"></path></svg>
            2022-05-26&nbsp;
        </span>
        <span>
            
            <svg t="1656737270708" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="23838" width="11" height="11"><path d="M824.264 95.36c0-23.859 25.043-44.16 48.902-44.16s49.714 20.301 49.714 44.16v190.08c0 23.859-19.054 52.868-42.913 52.868h-190.08c-23.859 0-46.696-25.96-46.696-49.819s22.55-46.249 46.409-46.249h82.025C702.344 175.534 610.22 155.853 512 155.853c-206.775 0-360.398 149.372-360.398 356.147 0 206.775 153.623 358.23 360.398 358.23 206.775 0 357.467-151.455 357.467-358.23 0-23.859 23.634-50.706 53.413-50.706 29.78 0 49.92 26.847 49.92 50.706 0 254.493-206.307 460.8-460.8 460.8-254.493 0-460.8-206.307-460.8-460.8C51.2 257.507 257.507 51.2 512 51.2c122.4 0 226.684 33.296 312.264 117.369 0.358 0.351 0.358-24.052 0-73.209z" p-id="23839" fill="#adb5bd"></path></svg>
            2022-05-26&nbsp;&nbsp;&nbsp;
        </span>
        <span>
            
            <svg t="1656737548689" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="33866" width="12" height="12"><path d="M832.038608 64.662657H192.030028C121.255125 64.662657 63.940169 121.98845 63.940169 192.694717v446.793671C63.940169 710.205493 121.255125 767.643272 192.030028 767.643272h133.353183a63.940169 63.940169 0 0 1 55.219742 31.576328l76.099638 129.83828c12.358154 21.093031 33.790754 31.626903 55.216129 31.626903s42.832688-10.544709 55.198067-31.619678l76.222461-129.870792a63.940169 63.940169 0 0 1 55.212517-31.551041h133.54103c70.576219 0 127.732228-57.289669 127.732227-127.800865V192.391272C959.825022 121.85479 902.643727 64.662657 832.038608 64.662657zM895.884854 639.842407A63.85347 63.85347 0 0 1 832.092795 703.703103h-133.54103a127.753903 127.753903 0 0 0-110.349172 63.09847l-76.222461 129.856342a0.274545 0.274545 0 0 1 0-0.050574h-0.032512s-0.021675 0.061411-0.032512 0.061412l-76.1466-129.85273A127.804477 127.804477 0 0 0 325.383211 703.703103H192.030028A64.207489 64.207489 0 0 1 127.880338 639.488388V192.694717A64.102729 64.102729 0 0 1 192.030028 128.602826h640.00858A63.799284 63.799284 0 0 1 895.884854 192.391272v447.451135z" fill="#adb5bd" p-id="33867"></path><path d="M608.154093 288.092004A31.970084 31.970084 0 0 0 576.184009 320.062089v160.078006l-134.650049-179.278119A31.970084 31.970084 0 0 0 384.002258 320.062089v255.760676a31.970084 31.970084 0 0 0 63.940169 0v-159.958796l134.650048 179.274507a31.970084 31.970084 0 0 0 57.531703-19.200113V320.062089a31.970084 31.970084 0 0 0-31.970085-31.970085z" fill="#adb5bd" p-id="33868"></path></svg>
            9702 字</span>&nbsp;
        <span>
            
            <svg t="1656737462334" class="icon" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" p-id="32892" width="12" height="12"><path d="M512 74.666667C270.933333 74.666667 74.666667 270.933333 74.666667 512S270.933333 949.333333 512 949.333333 949.333333 753.066667 949.333333 512 753.066667 74.666667 512 74.666667z m0 810.666666c-204.8 0-373.333333-168.533333-373.333333-373.333333S307.2 138.666667 512 138.666667 885.333333 307.2 885.333333 512 716.8 885.333333 512 885.333333z" p-id="32893" fill="#adb5bd"></path><path d="M695.466667 567.466667l-151.466667-70.4V277.333333c0-17.066667-14.933333-32-32-32s-32 14.933333-32 32v238.933334c0 12.8 6.4 23.466667 19.2 29.866666l170.666667 81.066667c4.266667 2.133333 8.533333 2.133333 12.8 2.133333 12.8 0 23.466667-6.4 29.866666-19.2 6.4-14.933333 0-34.133333-17.066666-42.666666z" p-id="32894" fill="#adb5bd"></path></svg>
            20 分钟</span><div class="container-ctgtag">
	<div class="taxonomy">
		
		<div class="ctg">
			
			
			<a href="/categories/"></a>
			
		</div>
		<div class="tag">
			
			 - 
			
			<a href="/tags/"></a>
			
		</div>
	</div>
</div>
    </div>
    
    <div class="toc">
        
        <div class="page-operation">
            <div><a href="#"><img src="/imgs/icons/arrow-up-circle.svg" alt=""></a></div>
            <div><a href="https://lovemjh.vercel.app/posts/tool/20220526164948/"><img src="/imgs/icons/arrow-left-circle.svg" alt=""></a></div>
            <div><a href="https://lovemjh.vercel.app/posts/java-frame/20220526213257/"><img src="/imgs/icons/arrow-right-circle.svg" alt=""></a></div>
        </div>
        
        <nav id="TableOfContents">
  <ul>
    <li><a href="#spring-boot第一节">Spring Boot第一节</a>
      <ul>
        <li><a href="#一spring-boot概述">一、Spring Boot概述</a>
          <ul>
            <li><a href="#一微服务概述">（一）微服务概述</a>
              <ul>
                <li><a href="#1微服务">1、微服务</a></li>
                <li><a href="#2单体应用">2、单体应用</a></li>
                <li><a href="#3单体应用和微服务对比">3、单体应用和微服务对比</a></li>
                <li><a href="#4微服务应用搭建">4、微服务应用搭建</a></li>
              </ul>
            </li>
            <li><a href="#二spring-boot简介">（二）Spring Boot简介</a></li>
            <li><a href="#三spring-boot的优势">（三）Spring Boot的优势</a></li>
            <li><a href="#四spring-boot的核心功能介绍">（四）Spring Boot的核心功能介绍</a></li>
          </ul>
        </li>
        <li><a href="#二spring-boot入门程序">二、Spring Boot入门程序</a>
          <ul>
            <li><a href="#一创建maven工程导入springboot依赖---继承父工程并加入web依赖">（一）创建maven工程导入springboot依赖  ( 继承父工程并加入web依赖)</a></li>
            <li><a href="#二编写spring-boot的主程序">（二）编写spring Boot的主程序</a>
              <ul>
                <li><a href="#1项目结构">1、项目结构</a></li>
                <li><a href="#2主程序代码">2、主程序代码</a></li>
              </ul>
            </li>
            <li><a href="#三编写controller代码">（三）编写Controller代码</a></li>
            <li><a href="#四运行主程序进行测试">（四）运行主程序进行测试</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#spring-boot第二节">Spring Boot第二节</a>
      <ul>
        <li><a href="#一spring-boot的简化部署">一、Spring Boot的简化部署</a>
          <ul>
            <li><a href="#一添加maven插件">（一）添加maven插件</a></li>
            <li><a href="#二执行package命令给项目打包">（二）执行package命令给项目打包</a></li>
            <li><a href="#三执行java--jar命令运行程序">（三）执行java -jar命令运行程序</a></li>
            <li><a href="#四学员进行简化部署练习">（四）学员进行简化部署练习</a></li>
          </ul>
        </li>
        <li><a href="#二spring-initializer快速创建spring-boot项目">二、Spring Initializer快速创建Spring Boot项目</a>
          <ul>
            <li><a href="#一创建spring-boot项目">（一）创建Spring Boot项目</a></li>
            <li><a href="#二项目结构解析">（二）项目结构解析</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#spring-boot第三节">Spring Boot第三节</a>
      <ul>
        <li><a href="#一spring-boot配置文件">一、Spring Boot配置文件</a>
          <ul>
            <li><a href="#一配置文件的作用及规范">（一）配置文件的作用及规范</a></li>
            <li><a href="#二yaml配置文件">（二）yaml配置文件</a>
              <ul>
                <li><a href="#1yaml的语法">1、yaml的语法</a>
                  <ul>
                    <li><a href="#1基本语法">（1）基本语法</a></li>
                    <li><a href="#2值的写法">（2）值的写法</a>
                      <ul>
                        <li><a href="#a字面量普通的值数字字符串布尔">a、字面量：普通的值（数字，字符串，布尔）</a></li>
                        <li><a href="#b对象map属性和值键值对">b、对象、Map（属性和值）（键值对)</a></li>
                        <li><a href="#c数组listset">c、数组（List,Set）</a></li>
                      </ul>
                    </li>
                  </ul>
                </li>
                <li><a href="#2配置文件值的注入">2、配置文件值的注入</a>
                  <ul>
                    <li><a href="#1构建bean对象">（1）构建bean对象</a></li>
                    <li><a href="#2构建配置文件">（2）构建配置文件</a></li>
                    <li><a href="#3执行单元测试查看person对象的值">（3）执行单元测试查看person对象的值</a></li>
                    <li><a href="#4引入配置文件处理器插件">（4）引入配置文件处理器插件</a></li>
                  </ul>
                </li>
                <li><a href="#3学员练习yuml的值的注入方式">3、学员练习yuml的值的注入方式</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#spring-boot第四节">Spring Boot第四节</a>
      <ul>
        <li><a href="#一spring-boot配置文件-1">一、Spring Boot配置文件</a>
          <ul>
            <li><a href="#一properties配置文件">（一）properties配置文件</a>
              <ul>
                <li><a href="#1properties语法">1、properties语法</a>
                  <ul>
                    <li><a href="#1字面量普通的值数字字符串布尔">（1）字面量：普通的值（数字，字符串，布尔）</a></li>
                    <li><a href="#2对象map属性和值键值对">（2）对象、Map（属性和值）（键值对)</a></li>
                    <li><a href="#3数组listset">（3）数组（List,Set）</a></li>
                  </ul>
                </li>
                <li><a href="#2配置文件值的注入-1">2、配置文件值的注入</a>
                  <ul>
                    <li><a href="#1构建bean对象-1">（1）构建bean对象</a></li>
                    <li><a href="#2构建配置文件-1">（2）构建配置文件</a></li>
                    <li><a href="#3执行单元测试查看person对象的值-1">（3）执行单元测试查看person对象的值</a></li>
                  </ul>
                </li>
                <li><a href="#3学员练习properties的值的注入方式">3、学员练习properties的值的注入方式</a></li>
              </ul>
            </li>
            <li><a href="#二configurationproperties注解和value注解的区别">（二）@ConfigurationProperties注解和@Value注解的区别</a></li>
            <li><a href="#三配置文件中的占位符">（三）配置文件中的占位符</a></li>
            <li><a href="#四多环境支持">（四）多环境支持</a></li>
            <li><a href="#五配置文件加载位置">（五）配置文件加载位置</a></li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#spring-boot第五节">Spring Boot第五节</a>
      <ul>
        <li><a href="#一spring-boot的web开发">一、Spring Boot的web开发</a>
          <ul>
            <li><a href="#一springboot关于静态资源的处理">（一）springboot关于静态资源的处理</a>
              <ul>
                <li><a href="#1webjars的使用">1、webjars的使用</a>
                  <ul>
                    <li><a href="#1引入依赖">（1）引入依赖</a></li>
                    <li><a href="#2启动服务访问资源">（2）启动服务访问资源</a></li>
                    <li><a href="#3学员练习webjars的使用">（3）学员练习webjars的使用</a></li>
                  </ul>
                </li>
                <li><a href="#2静态资源的存放位置">2、静态资源的存放位置</a>
                  <ul>
                    <li><a href="#1默认存放位置查看">（1）默认存放位置查看</a></li>
                    <li><a href="#2自定义位置存放">（2）自定义位置存放</a></li>
                    <li><a href="#3学员练习自定义静态资源访问">（3）学员练习自定义静态资源访问</a></li>
                  </ul>
                </li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
    <li><a href="#spring-boot第六节">Spring Boot第六节</a>
      <ul>
        <li><a href="#一spring-boot的web开发-1">一、Spring Boot的web开发</a>
          <ul>
            <li><a href="#一springboot的自动配置">（一）springboot的自动配置</a>
              <ul>
                <li><a href="#1自动配置原理">1、自动配置原理</a>
                  <ul>
                    <li><a href="#1springboot启动时加载主配值类解析注解springbootapplication">（1）springboot启动时加载主配值类，解析注解@SpringBootApplication</a></li>
                    <li><a href="#2在springbootapplication组合注解中解析enableautoconfiguration获取自动配置信息">（2）在@SpringBootApplication组合注解中解析@EnableAutoConfiguration获取自动配置信息</a></li>
                    <li><a href="#3初始化自动配置组件">（3）初始化自动配置组件</a></li>
                    <li><a href="#4小结">（4）小结</a></li>
                  </ul>
                </li>
                <li><a href="#2自定义配置实现访问拦截">2、自定义配置实现访问拦截</a></li>
                <li><a href="#1自定义拦截器">（1）自定义拦截器</a></li>
                <li><a href="#2注册拦截器">（2）注册拦截器</a></li>
                <li><a href="#3自定义配置视图控制器">3、自定义配置视图控制器</a></li>
                <li><a href="#4学员练习自动配置拦截器">4、学员练习自动配置拦截器</a></li>
              </ul>
            </li>
          </ul>
        </li>
      </ul>
    </li>
  </ul>
</nav>
    </div>

    <div class='content  content '>
        <h1 id="spring-boot第一节">Spring Boot第一节</h1>
<h2 id="一spring-boot概述">一、Spring Boot概述</h2>
<h3 id="一微服务概述">（一）微服务概述</h3>
<h4 id="1微服务">1、微服务</h4>
<pre tabindex="0"><code>微服务（英语：Microservices）是一种软件架构风格，它是以专注于单一责任与功能的小型功能区块 (Small Building Blocks) 为基础，利用模块化的方式组合出复杂的大型应用程序，各功能区块使用与语言无关 (Language-Independent/Language agnostic）的API集相互通信；2014年，Martin Fowler 与 James Lewis 共同提出了微服务的概念，定义了微服务是以开发一组小型服务的方式来开发一个独立的应用系统的。其中每个小型服务都运行在自己的进程中，并经常采用HTTP资源API这样轻量的机制来相互通信。这些服务围绕业务功能进行构建，并能通过全自动的部署机制来进行独立部署。这些微服务可以使用不同的语言来编写，并且可以使用不同的数据存储技术。对这些微服务我们仅做最低限度的集中管理。
 
把大型的项目按功能模块进行拆分，每个模块可以构建一个springBoot项目。
</code></pre><p><a class="link" href="/posts/tool/https://martinfowler.com/microservices/"  target="_blank" rel="noopener"
    >参考Martin Fowler微服务</a></p>
<h4 id="2单体应用">2、单体应用</h4>
<pre tabindex="0"><code>（1）单体应用：一个单块应用系统是以一个单个单元的方式来构建的。企业应用系统经常包含三个主要部分：客户端用户界面、数据库和服务端应用系统，这里的服务端应用系统就是一个单体的应用，系统中任意逻辑发生变化都会导致重新构建部署一个新版本的服务端应用系统。针对单体应用，当访问量变大时，通常采用负载均衡，横向扩展的方式将多个单体应用部署到多个服务器上访问。
（2）单体应用缺点：
软件变更受到了很大的限制，应用系统的一个很小的部分的一处变更，也需要将整个单块应用系统进行重新构建和部署。不能根据用户需求部署应用系统中的功能模块，只能扩展部署整个应用系统。
</code></pre><h4 id="3单体应用和微服务对比">3、单体应用和微服务对比</h4>
<p><img src="/posts/tool/20220526204358/image-20220526211225028.jpeg"
    
    
    
    loading="lazy"
    
    
></p>
<h4 id="4微服务应用搭建">4、微服务应用搭建</h4>
<p><img src="/posts/tool/20220526204358/image-20220526211238818.jpeg"
    
    
    
    loading="lazy"
    
    
></p>
<pre tabindex="0"><code>要搭建一个微服务，运维和部署都变得非常复杂，spring提供了一套解决方案：
springBoot:快速构建单个服务；
springcloud:是一系列有序框架的集合，其主要的设施有，服务发现与注册，配置中心，消息总线，负载均衡，断路器，数据监控等，通过Spring Boot的方式，可以实现一键启动，和部署。
Spring cloud data flow: 为基于微服务的分布式流处理和批处理数据通道提供了一系列模型和最佳实践.
</code></pre><p><img src="/posts/tool/20220526204358/image-20220526211250943.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="二spring-boot简介">（二）Spring Boot简介</h3>
<pre tabindex="0"><code>Spring-Boot是由Pivotal团队提供的全新框架，其设计目的是用来简化新Spring应用的初始搭建以及开发过程。个人理解来说Spring-Boot其实不是什么新的框架，它默认配置了很多框架的使用方式，就像maven整合了所有的jar包，Spring-Boot整合了其他相关联框架。
</code></pre><h3 id="三spring-boot的优势">（三）Spring Boot的优势</h3>
<pre tabindex="0"><code>1、快速构建项目。
2、对主流开发框架的无配置集成。
3、项目可独立运行，无须外部依赖Servlet容器。
4、提供运行时的应用监控。
5、极大的提高了开发、部署效率。
6、与云计算的天然集成。
</code></pre><h3 id="四spring-boot的核心功能介绍">（四）Spring Boot的核心功能介绍</h3>
<pre tabindex="0"><code>1、独立运行Spring项目
	Spring Boot 可以以jar包形式独立运行，运行一个Spring Boot项目只需要通过java -jar xx.jar来运行。
2、内嵌servlet容器
    Spring Boot可以选择内嵌Tomcat、jetty或者Undertow,这样我们无须以war包形式部署项目。
3、提供starter简化Maven配置
    spring提供了一系列的start pom来简化Maven的依赖加载，例如，当你使用了spring-boot-starter-web，会自动加入如图5-1所示的依赖包。
4、自动装配Spring
    Spring Boot会根据在类路径中的jar包，类、为jar包里面的类自动配置Bean，这样会极大地减少我们要使用的配置。当然，Spring Boot只考虑大多数的开发场景，并不是所有的场景，若在实际开发中我们需要配置Bean，而Spring Boot没有提供支持，则可以自定义自动配置。
5、准生产的应用监控
    Spring Boot提供基于http ssh telnet对运行时的项目进行监控。
6、无代码生产和xml配置　　
    Spring Boot不是借助与代码生成来实现的，而是通过条件注解来实现的，这是Spring4.x提供的新特性。
</code></pre><h2 id="二spring-boot入门程序">二、Spring Boot入门程序</h2>
<ol>
<li>新建一个maven工程
<img src="/posts/tool/20220526204358/image-20220526212521754.png"
    
    
    
    loading="lazy"
    
    
></li>
</ol>
<h3 id="一创建maven工程导入springboot依赖---继承父工程并加入web依赖">（一）创建maven工程导入springboot依赖  ( 继承父工程并加入web依赖)</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>  <span style="color:#998;font-style:italic">&lt;!--继承指定的父模块pom.xml文件：对项目进行整体的管理维护，如统一版本管理--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;parent&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#000080">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;artifactId&gt;</span>spring-boot-starter-parent<span style="color:#000080">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;version&gt;</span>2.4.3<span style="color:#000080">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;/parent&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#998;font-style:italic">&lt;!--spring提供的web项目启动器模块--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;dependencies&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000080">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#000080">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000080">&lt;artifactId&gt;</span>spring-boot-starter-web<span style="color:#000080">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;/dependency&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;/dependencies&gt;</span>
</span></span></code></pre></div><p>Spring Boot将所有的功能场景都抽取出来，做成一个个的starters（启动器），只需要在项目里面引入这些starter 相关场景的所有依赖都会导入进来。要用什么功能就导入什么场景的启动器 。</p>
<h3 id="二编写spring-boot的主程序">（二）编写spring Boot的主程序</h3>
<h4 id="1项目结构">1、项目结构</h4>
<p><img src="/posts/tool/20220526204358/image-20220526211315420.png"
    
    
    
    loading="lazy"
    
    
></p>
<h4 id="2主程序代码">2、主程序代码</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@SpringBootApplication</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Example</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">main</span><span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">[]</span> args<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">         * 启动springboot
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">         */</span>
</span></span><span style="display:flex;"><span>        SpringApplication<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">run</span><span style="color:#000;font-weight:bold">(</span>Example<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">,</span>args<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><p>@<strong>SpringBootApplication</strong>: 注解说明这个类是SpringBoot的主配置类，SpringBoot 就应该运行这个类的main方法来启动SpringBoot应用；并将<strong>主配置类（@SpringBootApplication标注的类）的所在包及下面所有子包里面的所有组件扫描到Spring容器</strong>；</p>
<h3 id="三编写controller代码">（三）编写Controller代码</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Controller</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">TestController</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@RequestMapping</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;/hello&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@ResponseBody</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> String <span style="color:#900;font-weight:bold">helloWorld</span><span style="color:#000;font-weight:bold">(){</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#d14">&#34;Hello world!&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="四运行主程序进行测试">（四）运行主程序进行测试</h3>
<p><img src="/posts/tool/20220526204358/image-20220526211343801.png"
    
    
    
    loading="lazy"
    
    
></p>
<p>（五）学员编写第一个springboot程序</p>
<pre tabindex="0"><code>练习CRUD
</code></pre><h1 id="spring-boot第二节">Spring Boot第二节</h1>
<h2 id="一spring-boot的简化部署">一、Spring Boot的简化部署</h2>
<h3 id="一添加maven插件">（一）添加maven插件</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>   <span style="color:#998;font-style:italic">&lt;!--执行maven命令插件--&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;build&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;plugins&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000080">&lt;plugin&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000080">&lt;groupId&gt;</span>org.springframework.boot<span style="color:#000080">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>                <span style="color:#000080">&lt;artifactId&gt;</span>spring-boot-maven-plugin<span style="color:#000080">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000080">&lt;/plugin&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;/plugins&gt;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000080">&lt;/build&gt;</span>
</span></span></code></pre></div><h3 id="二执行package命令给项目打包">（二）执行package命令给项目打包</h3>
<p><img src="/posts/tool/20220526204358/image-20220526211451041.png"
    
    
    
    loading="lazy"
    
    
></p>
<pre tabindex="0"><code>执行打包命令后，会在target目录下生成项目对应的jar包。
</code></pre><h3 id="三执行java--jar命令运行程序">（三）执行java -jar命令运行程序</h3>
<p><img src="/posts/tool/20220526204358/image-20220526211504187.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="四学员进行简化部署练习">（四）学员进行简化部署练习</h3>
<h2 id="二spring-initializer快速创建spring-boot项目">二、Spring Initializer快速创建Spring Boot项目</h2>
<h3 id="一创建spring-boot项目">（一）创建Spring Boot项目</h3>
<p><img src="/posts/tool/20220526204358/image-20220526211523357.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/tool/20220526204358/image-20220526211536923.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/tool/20220526204358/image-20220526211549016.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/tool/20220526204358/image-20220526211603188.png"
    
    
    
    loading="lazy"
    
    
></p>
<p><img src="/posts/tool/20220526204358/image-20220526211615649.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="二项目结构解析">（二）项目结构解析</h3>
<p><img src="/posts/tool/20220526204358/image-20220526211628579.png"
    
    
    
    loading="lazy"
    
    
></p>
<pre tabindex="0"><code>1、java文件夹目录结构中自动创建好指定包和Spring Boot启动主程序SpringbootApplication.class；
2、resources文件夹中目录结构 
static：保存所有的静态资源； js css images； 
templates：保存所有的模板页面，（Spring Boot默认jar包使用嵌入式的Tomcat，默认不支持JSP页面），可以使用模板引擎（freemarker、thymeleaf）； 
application.properties：Spring Boot应用的配置文件；可以修改一些默认设置；
</code></pre><h1 id="spring-boot第三节">Spring Boot第三节</h1>
<h2 id="一spring-boot配置文件">一、Spring Boot配置文件</h2>
<h3 id="一配置文件的作用及规范">（一）配置文件的作用及规范</h3>
<pre tabindex="0"><code>Spring Boot使用一个全局的配置文件，配置文件名是固定的；默认使用以下两种格式： 
•application.properties 
•application.yml 
配置文件的作用：修改SpringBoot自动配置的默认值；Spring Boot启动时会根据配置文件自动注册相关的应用组件；
</code></pre><h3 id="二yaml配置文件">（二）yaml配置文件</h3>
<h4 id="1yaml的语法">1、yaml的语法</h4>
<pre tabindex="0"><code>YAML：以数据为中心，比json、xml等更适合做配置文件；
</code></pre><h5 id="1基本语法">（1）基本语法</h5>
<pre tabindex="0"><code class="language-xaml" data-lang="xaml">– 使用缩进表示层级关系
– 缩进时不允许使用Tab键，只允许使用空格。
– 缩进的空格数目不重要，只要相同层级的元素左侧对齐即可 – 大小写敏感
- 键值对中间必须要有空格k:(空格)v
</code></pre><h5 id="2值的写法">（2）值的写法</h5>
<p>YAML 支持的三种数据结构:</p>
<h6 id="a字面量普通的值数字字符串布尔">a、字面量：普通的值（数字，字符串，布尔）</h6>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000080">server</span>:<span style="color:#bbb"> 
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">port</span>:<span style="color:#bbb"> </span><span style="color:#099">8081</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>注意：字符串默认不用加上单引号或者双引号； <span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>双引号：特殊符号表示转义符本身；<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">name</span>:<span style="color:#bbb"> </span><span style="color:#d14">&#34;zhangsan \n lisi&#34;</span>：输出；zhangsan 换行 lisi<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>单引号；特殊字符就表示字符本身；<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">name</span>:<span style="color:#bbb"> </span>‘zhangsan \n lisi’：输出；zhangsan \n lisi<span style="color:#bbb">
</span></span></span></code></pre></div><h6 id="b对象map属性和值键值对">b、对象、Map（属性和值）（键值对)</h6>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000080">person</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">name</span>:<span style="color:#bbb"> </span>zhangsan<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">age</span>:<span style="color:#bbb"> </span><span style="color:#099">12</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>另一种行内写法：<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">person</span>:<span style="color:#bbb"> </span>{<span style="color:#000080">name: zhangsan,age</span>:<span style="color:#bbb"> </span><span style="color:#099">12</span>}<span style="color:#bbb">
</span></span></span></code></pre></div><h6 id="c数组listset">c、数组（List,Set）</h6>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000080">hobbies</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span>- singing<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span>- dancing<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"> </span>- running<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>用-（空格）值表示数组中的一个元素<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>另一种行内写法：<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">hobbies</span>:<span style="color:#bbb"> </span>[singing,dancing,running]<span style="color:#bbb">
</span></span></span></code></pre></div><p><a class="link" href="/posts/tool/https://bitbucket.org/asomov/snakeyaml/wiki/Documentation#markdown-header-yaml%02syntax"  target="_blank" rel="noopener"
    >yaml参考文档</a></p>
<h4 id="2配置文件值的注入">2、配置文件值的注入</h4>
<h5 id="1构建bean对象">（1）构建bean对象</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#998;font-style:italic">//只有spring容器中的对象才能自动进行数据绑定
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#3c5d5d;font-weight:bold">@Component</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//将本类中的所有属性和配置文件中相关的配置进行绑定；
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// prefix指定要绑定的配置文件中的属性前缀；
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#3c5d5d;font-weight:bold">@ConfigurationProperties</span><span style="color:#000;font-weight:bold">(</span>prefix <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;person&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Person</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> String pname<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> <span style="color:#458;font-weight:bold">int</span> age<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> <span style="color:#458;font-weight:bold">boolean</span> success<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> Date birth<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> Car car<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span>Object<span style="color:#000;font-weight:bold">&gt;</span> maps<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> List<span style="color:#000;font-weight:bold">&lt;</span>Object<span style="color:#000;font-weight:bold">&gt;</span> lists<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h5 id="2构建配置文件">（2）构建配置文件</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span><span style="color:#000080">person</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">pname</span>:<span style="color:#bbb"> </span>zhangsan<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">age</span>:<span style="color:#bbb"> </span><span style="color:#099">12</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">birth</span>:<span style="color:#bbb"> </span><span style="color:#099">2020</span>/12/12<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">success</span>:<span style="color:#bbb"> </span><span style="color:#000;font-weight:bold">true</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">car</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">cname</span>:<span style="color:#bbb"> </span>奔驰<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">cprice</span>:<span style="color:#bbb"> </span><span style="color:#099">200.0</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">lists</span>:<span style="color:#bbb"> </span>[唱歌,跳舞]<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">maps</span>:<span style="color:#bbb"> </span>{<span style="color:#000080">key1: v1,key2</span>:<span style="color:#bbb"> </span>v2}<span style="color:#bbb">
</span></span></span></code></pre></div><h5 id="3执行单元测试查看person对象的值">（3）执行单元测试查看person对象的值</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@SpringBootTest</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">SpringbootApplicationTests</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> Person person<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">contextLoads</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span>person<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h5 id="4引入配置文件处理器插件">（4）引入配置文件处理器插件</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span>   <span style="color:#998;font-style:italic">&lt;!--作用：编辑配置文件时会有相关提示信息--&gt;</span> 
</span></span><span style="display:flex;"><span><span style="color:#000080">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000080">&lt;groupId&gt;</span> org.springframework.boot <span style="color:#000080">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000080">&lt;artifactId&gt;</span> spring-boot-configuration-processor <span style="color:#000080">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000080">&lt;optional&gt;</span> true <span style="color:#000080">&lt;/optional&gt;</span>
</span></span><span style="display:flex;"><span> <span style="color:#000080">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h4 id="3学员练习yuml的值的注入方式">3、学员练习yuml的值的注入方式</h4>
<h1 id="spring-boot第四节">Spring Boot第四节</h1>
<h2 id="一spring-boot配置文件-1">一、Spring Boot配置文件</h2>
<h3 id="一properties配置文件">（一）properties配置文件</h3>
<h4 id="1properties语法">1、properties语法</h4>
<pre tabindex="0"><code>以KEY=VALue键值对的方式设置值
</code></pre><h5 id="1字面量普通的值数字字符串布尔">（1）字面量：普通的值（数字，字符串，布尔）</h5>
<pre tabindex="0"><code class="language-properties" data-lang="properties">name=张三
</code></pre><h5 id="2对象map属性和值键值对">（2）对象、Map（属性和值）（键值对)</h5>
<pre tabindex="0"><code class="language-properties" data-lang="properties">person.name=张三
person.age=12
maps.key1=value1
maps.key2=value2
</code></pre><h5 id="3数组listset">（3）数组（List,Set）</h5>
<pre tabindex="0"><code class="language-properties" data-lang="properties">hobbies=singing,dancing,running
</code></pre><h4 id="2配置文件值的注入-1">2、配置文件值的注入</h4>
<h5 id="1构建bean对象-1">（1）构建bean对象</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#998;font-style:italic">//只有spring容器中的对象才能自动进行数据绑定
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#3c5d5d;font-weight:bold">@Component</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//将本类中的所有属性和配置文件中相关的配置进行绑定；
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">// prefix指定要绑定的配置文件中的属性前缀；
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#3c5d5d;font-weight:bold">@ConfigurationProperties</span><span style="color:#000;font-weight:bold">(</span>prefix <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;person&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Person</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> String pname<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> <span style="color:#458;font-weight:bold">int</span> age<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> <span style="color:#458;font-weight:bold">boolean</span> success<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> Date birth<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> Car car<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span>Object<span style="color:#000;font-weight:bold">&gt;</span> maps<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> List<span style="color:#000;font-weight:bold">&lt;</span>Object<span style="color:#000;font-weight:bold">&gt;</span> lists<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h5 id="2构建配置文件-1">（2）构建配置文件</h5>
<pre tabindex="0"><code class="language-properties" data-lang="properties">person.pname=张三
person.age=12
person.birth=2019/12/12
person.success=true
person.car.cname=宝马
person.car.cprice=100.0
person.lists=唱歌,跳舞,跑步
person.maps.k1=value1
person.maps.k2=value2
</code></pre><h5 id="3执行单元测试查看person对象的值-1">（3）执行单元测试查看person对象的值</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@SpringBootTest</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">SpringbootApplicationTests</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Autowired</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> Person person<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Test</span>
</span></span><span style="display:flex;"><span>    <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">contextLoads</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span>person<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="3学员练习properties的值的注入方式">3、学员练习properties的值的注入方式</h4>
<h3 id="二configurationproperties注解和value注解的区别">（二）@ConfigurationProperties注解和@Value注解的区别</h3>
<pre tabindex="0"><code>1、@ConfigurationProperties注解用于根据配置文件批量注入值，springboot默认配置文件application.yml/application.properties；
2、@Value注解用于根据配置文件单个注入值；
</code></pre><table>
<thead>
<tr>
<th>区别</th>
<th>@ConfigurationProperties</th>
<th>@Value</th>
</tr>
</thead>
<tbody>
<tr>
<td>SpEL</td>
<td>不支持</td>
<td>支持</td>
</tr>
<tr>
<td>复杂类型封装</td>
<td>支持</td>
<td>不支持</td>
</tr>
</tbody>
</table>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>案例<span style="color:#a61717;background-color:#e3d2d2">：</span>
</span></span><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Component</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//@ConfigurationProperties(prefix = &#34;person&#34;)
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">Person</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;${person.pname}&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> String pname<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Value</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;#{12*2}&#34;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> <span style="color:#458;font-weight:bold">int</span> age<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> <span style="color:#458;font-weight:bold">boolean</span> success<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> Date birth<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> Car car<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span>Object<span style="color:#000;font-weight:bold">&gt;</span> map<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">private</span> List<span style="color:#000;font-weight:bold">&lt;</span>Object<span style="color:#000;font-weight:bold">&gt;</span> hobbies<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h3 id="三配置文件中的占位符">（三）配置文件中的占位符</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-txt" data-lang="txt"><span style="display:flex;"><span>1、springboot全局配置文件中可以使用随机数
</span></span><span style="display:flex;"><span>${random.value}、${random.int}、${random.long}
</span></span><span style="display:flex;"><span>${random.int(10)}、${random.int[1024,65536]}
</span></span><span style="display:flex;"><span>2、springboot全局配置文件中可以使用占位符
</span></span><span style="display:flex;"><span>通过${属性名}获取已经在配置文件中加载过的属性值；
</span></span><span style="display:flex;"><span>通过${属性名:默认值}来指定找不到属性时的默认值；
</span></span></code></pre></div><pre tabindex="0"><code class="language-properties" data-lang="properties">案例：
person.pname=张三
person.age=${random.int}
person.success=true
person.birth=2012/12/12
person.car.cname=${car.cname:奔驰}
person.car.cprice=200.0
person.map.key1=value1
person.map.key2=value2
person.hobbies=唱歌,跳舞,跑步
</code></pre><h3 id="四多环境支持">（四）多环境支持</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-yaml" data-lang="yaml"><span style="display:flex;"><span>Profile是Spring对不同环境提供不同配置功能的支持，可以通过激活、指定参数等方式快速切换环境；<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#099">1</span>、多文件多环境形式：<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>格式：application-{profile}.properties/yml<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>例如：可以在项目中创建如下主配置文件：application-dev.properties、application-test.properties、application-prod.properties、application.properties,默认使用application.properties,可以通过配置spring.profiles.active=profile指定使用某个环境的配置文件。<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#099">2</span>、yaml支持单文件多环境形式：<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">spring</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">profiles</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">    </span><span style="color:#000080">active</span>:<span style="color:#bbb"> </span>test<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#555">---</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">spring</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">profiles</span>:<span style="color:#bbb"> </span>dev<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">server</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">port</span>:<span style="color:#bbb"> </span><span style="color:#099">8081</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#555">---</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">spring</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">profiles</span>:<span style="color:#bbb"> </span>test<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#000080">server</span>:<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span><span style="color:#000080">port</span>:<span style="color:#bbb"> </span><span style="color:#099">8082</span><span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span>通过---来区分不同的profile环境。<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb"></span><span style="color:#099">3</span>、激活方式：<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>在配置文件中指定 spring.profiles.active=dev<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>命令行  java -jar springboot-0.0.1-SNAPSHOT.jar --spring.profiles.active=dev<span style="color:#bbb">
</span></span></span><span style="display:flex;"><span><span style="color:#bbb">  </span>jvm参数 -Dspring.profiles.active=dev<span style="color:#bbb">
</span></span></span></code></pre></div><p><img src="/posts/tool/20220526204358/image-20220526211847607.png"
    
    
    
    loading="lazy"
    
    
></p>
<h3 id="五配置文件加载位置">（五）配置文件加载位置</h3>
<pre tabindex="0"><code>springboot默认会从以下位置加载配置文件：application.properties/application.yml
项目所在磁盘路径file:./config/ 
项目所在磁盘路径file:./ 
项目类路径classpath:/config/ 
项目类路径classpath:/
优先级由高到底，高优先级的配置会覆盖低优先级的配置；SpringBoot会从这四个位置全部加载主配置文件，互补配置；
如果要加载其他位置的配置文件，可以通过--spring.config.location（只能加到命令行）来指定要加载的配置文件的位置。
</code></pre><h1 id="spring-boot第五节">Spring Boot第五节</h1>
<h2 id="一spring-boot的web开发">一、Spring Boot的web开发</h2>
<pre tabindex="0"><code>讲解思路： 
 本章节主要掌握springboot当中静态资源的处理，springboot当中提供的静态资源存放的位置。 在实际当中开发，我们应该满足springboot的约定和规范。如果提供的静态资源目录不能满足实际的需求，还可以自定义静态资源的位置
</code></pre><h3 id="一springboot关于静态资源的处理">（一）springboot关于静态资源的处理</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>springboot启动时会根据配置文件自动配置相应场景的组件xxxAutoConfiguration<span style="color:#a61717;background-color:#e3d2d2">，</span>web项目启动时会初始化WebMvcAutoConfiguration组件处理请求相关的操作<span style="color:#a61717;background-color:#e3d2d2">，</span>其中有默认处理静态资源的方法<span style="color:#a61717;background-color:#e3d2d2">：</span>
</span></span><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">protected</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">addResourceHandlers</span><span style="color:#000;font-weight:bold">(</span>ResourceHandlerRegistry registry<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">super</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">addResourceHandlers</span><span style="color:#000;font-weight:bold">(</span>registry<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(!</span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">resourceProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">isAddMappings</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>				logger<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">debug</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Default resource handling disabled&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>			ServletContext servletContext <span style="color:#000;font-weight:bold">=</span> getServletContext<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			addResourceHandler<span style="color:#000;font-weight:bold">(</span>registry<span style="color:#000;font-weight:bold">,</span> <span style="color:#d14">&#34;/webjars/**&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#d14">&#34;classpath:/META-INF/resources/webjars/&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			addResourceHandler<span style="color:#000;font-weight:bold">(</span>registry<span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mvcProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getStaticPathPattern</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#000;font-weight:bold">(</span>registration<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">-&gt;</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>				registration<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">addResourceLocations</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">resourceProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getStaticLocations</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>servletContext <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>					registration<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">addResourceLocations</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">new</span> ServletContextResource<span style="color:#000;font-weight:bold">(</span>servletContext<span style="color:#000;font-weight:bold">,</span> SERVLET_LOCATION<span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">});</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><pre tabindex="0"><code>从该方法中可以发现：
1、默认情况下：
（1）匹配/webjars/** 的请求，都去 classpath:/META-INF/resources/webjars/ 找资源；
（2）匹配 &#34;/**&#34; 的请求，都去（静态资源的文件夹）找映射，静态资源文件夹路径如下：
&#34;classpath:/META‐INF/resources/&#34;
&#34;classpath:/resources/&#34;
&#34;classpath:/static/&#34;
&#34;classpath:/public/&#34; 
&#34;/&#34;：当前项目的根路径
2、自定义配置静态资源路径：
spring.web.resources.static-locations=自定义路径
</code></pre><h4 id="1webjars的使用">1、webjars的使用</h4>
<pre tabindex="0"><code>我们可以通过webjars以jar包的方式引入静态资源。
</code></pre><p><a class="link" href="/posts/tool/https://www.webjars.org/"  target="_blank" rel="noopener"
    >静态资源坐标参考</a></p>
<h5 id="1引入依赖">（1）引入依赖</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-xml" data-lang="xml"><span style="display:flex;"><span> <span style="color:#998;font-style:italic">&lt;!--jquery的jar包引入--&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;dependency&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000080">&lt;groupId&gt;</span>org.webjars<span style="color:#000080">&lt;/groupId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000080">&lt;artifactId&gt;</span>jquery<span style="color:#000080">&lt;/artifactId&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000080">&lt;version&gt;</span>3.6.0<span style="color:#000080">&lt;/version&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000080">&lt;/dependency&gt;</span>
</span></span></code></pre></div><h5 id="2启动服务访问资源">（2）启动服务访问资源</h5>
<pre tabindex="0"><code>浏览器访问路径：http://localhost:8080/webjars/jquery/3.6.0/jquery.min.js获取相应的静态资源。
</code></pre><h5 id="3学员练习webjars的使用">（3）学员练习webjars的使用</h5>
<h4 id="2静态资源的存放位置">2、静态资源的存放位置</h4>
<h5 id="1默认存放位置查看">（1）默认存放位置查看</h5>
<pre tabindex="0"><code>默认静态资源路径：
&#34;classpath:/META‐INF/resources/&#34;
&#34;classpath:/resources/&#34;
&#34;classpath:/static/&#34;
&#34;classpath:/public/&#34; 
&#34;/&#34;：当前项目的根路径
案例：在上述任意路径下创建静态资源hello.html,浏览器访问路径：http://localhost:8080/hello.html获取相应的静态资源。
</code></pre><h5 id="2自定义位置存放">（2）自定义位置存放</h5>
<pre tabindex="0"><code>在配置文件中通过属性spring.web.resources.static-locations=自定义路径，设置自定义静态资源存放路径；
案例：
a、配置文件中设置：spring.web.resources.static-locations=classpath:/hello/
b、在自定义路径下添加静态资源hello.html,浏览器访问路径：http://localhost:8080/hello.html获取相应的静态资源。
注意：自定义静态资源路径后，默认静态资源路径失效！
</code></pre><h5 id="3学员练习自定义静态资源访问">（3）学员练习自定义静态资源访问</h5>
<h1 id="spring-boot第六节">Spring Boot第六节</h1>
<h2 id="一spring-boot的web开发-1">一、Spring Boot的web开发</h2>
<pre tabindex="0"><code>讲解思路： 
  本章节有两大重点： 
  1、掌握springboot web模块的自动配置原理，从该模块引申，整个springboot当中大量的应用了自动配置，实现的具体思路相同。 
  2、自定义拦截器，注册拦截器，演示拦截器是否生效，拦截器在实际当中有大量的应用，务必掌握
</code></pre><h3 id="一springboot的自动配置">（一）springboot的自动配置</h3>
<h4 id="1自动配置原理">1、自动配置原理</h4>
<h5 id="1springboot启动时加载主配值类解析注解springbootapplication">（1）springboot启动时加载主配值类，解析注解@SpringBootApplication</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@SpringBootApplication</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">SpringbootApplication</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">main</span><span style="color:#000;font-weight:bold">(</span>String<span style="color:#000;font-weight:bold">[]</span> args<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        SpringApplication<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">run</span><span style="color:#000;font-weight:bold">(</span>SpringbootApplication<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">,</span> args<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h5 id="2在springbootapplication组合注解中解析enableautoconfiguration获取自动配置信息">（2）在@SpringBootApplication组合注解中解析@EnableAutoConfiguration获取自动配置信息</h5>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#998;font-style:italic">//在@EnableAutoConfiguration注解中，为容器导入自动配置的组件：
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#3c5d5d;font-weight:bold">@Target</span><span style="color:#000;font-weight:bold">(</span>ElementType<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">TYPE</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Retention</span><span style="color:#000;font-weight:bold">(</span>RetentionPolicy<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">RUNTIME</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Documented</span>
</span></span><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Inherited</span>
</span></span><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@AutoConfigurationPackage</span>
</span></span><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Import</span><span style="color:#000;font-weight:bold">(</span>AutoConfigurationImportSelector<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#3c5d5d;font-weight:bold">@interface</span> EnableAutoConfiguration<span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//1、第一步：通过AutoConfigurationImportSelector类的selectImports方法获取要导入的自动配置组件
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>	<span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">public</span> String<span style="color:#000;font-weight:bold">[]</span> <span style="color:#900;font-weight:bold">selectImports</span><span style="color:#000;font-weight:bold">(</span>AnnotationMetadata annotationMetadata<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(!</span>isEnabled<span style="color:#000;font-weight:bold">(</span>annotationMetadata<span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">return</span> NO_IMPORTS<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//获取自动配置的内容
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>		AutoConfigurationEntry autoConfigurationEntry <span style="color:#000;font-weight:bold">=</span> getAutoConfigurationEntry<span style="color:#000;font-weight:bold">(</span>annotationMetadata<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">return</span> StringUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">toStringArray</span><span style="color:#000;font-weight:bold">(</span>autoConfigurationEntry<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getConfigurations</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span> 
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//2、第二步：
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>	<span style="color:#000;font-weight:bold">protected</span> AutoConfigurationEntry <span style="color:#900;font-weight:bold">getAutoConfigurationEntry</span><span style="color:#000;font-weight:bold">(</span>AnnotationMetadata annotationMetadata<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(!</span>isEnabled<span style="color:#000;font-weight:bold">(</span>annotationMetadata<span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">return</span> EMPTY_ENTRY<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>		AnnotationAttributes attributes <span style="color:#000;font-weight:bold">=</span> getAttributes<span style="color:#000;font-weight:bold">(</span>annotationMetadata<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//获取配置信息
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>		List<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">&gt;</span> configurations <span style="color:#000;font-weight:bold">=</span> getCandidateConfigurations<span style="color:#000;font-weight:bold">(</span>annotationMetadata<span style="color:#000;font-weight:bold">,</span> attributes<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		configurations <span style="color:#000;font-weight:bold">=</span> removeDuplicates<span style="color:#000;font-weight:bold">(</span>configurations<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		Set<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">&gt;</span> exclusions <span style="color:#000;font-weight:bold">=</span> getExclusions<span style="color:#000;font-weight:bold">(</span>annotationMetadata<span style="color:#000;font-weight:bold">,</span> attributes<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		checkExcludedClasses<span style="color:#000;font-weight:bold">(</span>configurations<span style="color:#000;font-weight:bold">,</span> exclusions<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		configurations<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">removeAll</span><span style="color:#000;font-weight:bold">(</span>exclusions<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		configurations <span style="color:#000;font-weight:bold">=</span> getConfigurationClassFilter<span style="color:#000;font-weight:bold">().</span><span style="color:#008080">filter</span><span style="color:#000;font-weight:bold">(</span>configurations<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		fireAutoConfigurationImportEvents<span style="color:#000;font-weight:bold">(</span>configurations<span style="color:#000;font-weight:bold">,</span> exclusions<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">new</span> AutoConfigurationEntry<span style="color:#000;font-weight:bold">(</span>configurations<span style="color:#000;font-weight:bold">,</span> exclusions<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//3、第三步：
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">protected</span> List<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#900;font-weight:bold">getCandidateConfigurations</span><span style="color:#000;font-weight:bold">(</span>AnnotationMetadata metadata<span style="color:#000;font-weight:bold">,</span> AnnotationAttributes attributes<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#998;font-style:italic">//获取配置信息
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>		List<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">&gt;</span> configurations <span style="color:#000;font-weight:bold">=</span> SpringFactoriesLoader<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">loadFactoryNames</span><span style="color:#000;font-weight:bold">(</span>getSpringFactoriesLoaderFactoryClass<span style="color:#000;font-weight:bold">(),</span>
</span></span><span style="display:flex;"><span>				getBeanClassLoader<span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>		Assert<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">notEmpty</span><span style="color:#000;font-weight:bold">(</span>configurations<span style="color:#000;font-weight:bold">,</span> <span style="color:#d14">&#34;No auto configuration classes found in META-INF/spring.factories. If you &#34;</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">+</span> <span style="color:#d14">&#34;are using a custom packaging, make sure that file is correct.&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">return</span> configurations<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//4、第四步：
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> List<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">&gt;</span> <span style="color:#900;font-weight:bold">loadFactoryNames</span><span style="color:#000;font-weight:bold">(</span>Class<span style="color:#000;font-weight:bold">&lt;?&gt;</span> factoryType<span style="color:#000;font-weight:bold">,</span> <span style="color:#3c5d5d;font-weight:bold">@Nullable</span> ClassLoader classLoader<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		ClassLoader classLoaderToUse <span style="color:#000;font-weight:bold">=</span> classLoader<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>classLoaderToUse <span style="color:#000;font-weight:bold">==</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			classLoaderToUse <span style="color:#000;font-weight:bold">=</span> SpringFactoriesLoader<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getClassLoader</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>		String factoryTypeName <span style="color:#000;font-weight:bold">=</span> factoryType<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getName</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//获取要自动注入的组件信息
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>		<span style="color:#000;font-weight:bold">return</span> loadSpringFactories<span style="color:#000;font-weight:bold">(</span>classLoaderToUse<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">getOrDefault</span><span style="color:#000;font-weight:bold">(</span>factoryTypeName<span style="color:#000;font-weight:bold">,</span> Collections<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">emptyList</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//5、第五步：
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">static</span> Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> List<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">&gt;&gt;</span> <span style="color:#900;font-weight:bold">loadSpringFactories</span><span style="color:#000;font-weight:bold">(</span>ClassLoader classLoader<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>		Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> List<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">&gt;&gt;</span> result <span style="color:#000;font-weight:bold">=</span> cache<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">get</span><span style="color:#000;font-weight:bold">(</span>classLoader<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>result <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">return</span> result<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		result <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> HashMap<span style="color:#000;font-weight:bold">&lt;&gt;();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">try</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            <span style="color:#998;font-style:italic">//获取要自动注入的组件信息
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>			Enumeration<span style="color:#000;font-weight:bold">&lt;</span>URL<span style="color:#000;font-weight:bold">&gt;</span> urls <span style="color:#000;font-weight:bold">=</span> classLoader<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getResources</span><span style="color:#000;font-weight:bold">(</span>FACTORIES_RESOURCE_LOCATION<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">while</span> <span style="color:#000;font-weight:bold">(</span>urls<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">hasMoreElements</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>				URL url <span style="color:#000;font-weight:bold">=</span> urls<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">nextElement</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>				UrlResource resource <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> UrlResource<span style="color:#000;font-weight:bold">(</span>url<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>				Properties properties <span style="color:#000;font-weight:bold">=</span> PropertiesLoaderUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">loadProperties</span><span style="color:#000;font-weight:bold">(</span>resource<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span>Map<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">Entry</span><span style="color:#000;font-weight:bold">&lt;?,</span> <span style="color:#000;font-weight:bold">?&gt;</span> entry <span style="color:#000;font-weight:bold">:</span> properties<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">entrySet</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>					String factoryTypeName <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">((</span>String<span style="color:#000;font-weight:bold">)</span> entry<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getKey</span><span style="color:#000;font-weight:bold">()).</span><span style="color:#008080">trim</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>					String<span style="color:#000;font-weight:bold">[]</span> factoryImplementationNames <span style="color:#000;font-weight:bold">=</span>
</span></span><span style="display:flex;"><span>							StringUtils<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">commaDelimitedListToStringArray</span><span style="color:#000;font-weight:bold">((</span>String<span style="color:#000;font-weight:bold">)</span> entry<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getValue</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>					<span style="color:#000;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span>String factoryImplementationName <span style="color:#000;font-weight:bold">:</span> factoryImplementationNames<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>						result<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">computeIfAbsent</span><span style="color:#000;font-weight:bold">(</span>factoryTypeName<span style="color:#000;font-weight:bold">,</span> key <span style="color:#000;font-weight:bold">-&gt;</span> <span style="color:#000;font-weight:bold">new</span> ArrayList<span style="color:#000;font-weight:bold">&lt;&gt;())</span>
</span></span><span style="display:flex;"><span>								<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">add</span><span style="color:#000;font-weight:bold">(</span>factoryImplementationName<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">trim</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>					<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>			<span style="color:#998;font-style:italic">// Replace all lists with unmodifiable lists containing unique elements
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>			result<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">replaceAll</span><span style="color:#000;font-weight:bold">((</span>factoryType<span style="color:#000;font-weight:bold">,</span> implementations<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">-&gt;</span> implementations<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">distinct</span><span style="color:#000;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span>					<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">collect</span><span style="color:#000;font-weight:bold">(</span>Collectors<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">collectingAndThen</span><span style="color:#000;font-weight:bold">(</span>Collectors<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">toList</span><span style="color:#000;font-weight:bold">(),</span> Collections<span style="color:#000;font-weight:bold">::</span>unmodifiableList<span style="color:#000;font-weight:bold">)));</span>
</span></span><span style="display:flex;"><span>			cache<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">put</span><span style="color:#000;font-weight:bold">(</span>classLoader<span style="color:#000;font-weight:bold">,</span> result<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">catch</span> <span style="color:#000;font-weight:bold">(</span>IOException ex<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">throw</span> <span style="color:#000;font-weight:bold">new</span> IllegalArgumentException<span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Unable to load factories from location [&#34;</span> <span style="color:#000;font-weight:bold">+</span>
</span></span><span style="display:flex;"><span>					FACTORIES_RESOURCE_LOCATION <span style="color:#000;font-weight:bold">+</span> <span style="color:#d14">&#34;]&#34;</span><span style="color:#000;font-weight:bold">,</span> ex<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">return</span> result<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//第六步：获取自动配置信息spring.factories
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#000;font-weight:bold">final</span> String FACTORIES_RESOURCE_LOCATION <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;META-INF/spring.factories&#34;</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>获取到配置文件中的自动配置类xxxAutoConfiguration的信息<span style="color:#a61717;background-color:#e3d2d2">，</span>并将自动配置类中的组件初始化到容器中<span style="color:#a61717;background-color:#e3d2d2">。</span>
</span></span><span style="display:flex;"><span>初始化的过程中会加载xxxProperties对象<span style="color:#a61717;background-color:#e3d2d2">，</span>根据xxxProperties对象中的属性值初始化组件<span style="color:#000;font-weight:bold">,</span>xxxProperties对象的值可以通过全局配置文件指定<span style="color:#a61717;background-color:#e3d2d2">。</span>
</span></span></code></pre></div><h5 id="3初始化自动配置组件">（3）初始化自动配置组件</h5>
<p>以Spring Boot 自动配置SpringMVC为例，Spring Boot启动时会做以下操作：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#998;font-style:italic">//根据以上步骤找到自动配置类WebMvcAutoConfiguration，并根据自动配置类进行以下初始化操作：
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#3c5d5d;font-weight:bold">@Configuration</span><span style="color:#000;font-weight:bold">(</span>proxyBeanMethods <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">false</span><span style="color:#000;font-weight:bold">)</span><span style="color:#998;font-style:italic">//表示这是一个配置类，和以前编写的配置文件一样
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#3c5d5d;font-weight:bold">@ConditionalOnWebApplication</span><span style="color:#000;font-weight:bold">(</span>type <span style="color:#000;font-weight:bold">=</span> Type<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">SERVLET</span><span style="color:#000;font-weight:bold">)</span><span style="color:#998;font-style:italic">//@Conditional判断满足指定的条件，整个配置类里面的配置就会生效,否则不生效； 这里是判断当前应用是否是web应用，如果是当前配置类生效
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#3c5d5d;font-weight:bold">@ConditionalOnClass</span><span style="color:#000;font-weight:bold">({</span> Servlet<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">,</span> DispatcherServlet<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">,</span> WebMvcConfigurer<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span> <span style="color:#000;font-weight:bold">})</span><span style="color:#998;font-style:italic">//判断当前项目有没有以上指定类
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#3c5d5d;font-weight:bold">@ConditionalOnMissingBean</span><span style="color:#000;font-weight:bold">(</span>WebMvcConfigurationSupport<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">)</span><span style="color:#998;font-style:italic">//判断容器中是否没有指定组件
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#3c5d5d;font-weight:bold">@AutoConfigureOrder</span><span style="color:#000;font-weight:bold">(</span>Ordered<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">HIGHEST_PRECEDENCE</span> <span style="color:#000;font-weight:bold">+</span> 10<span style="color:#000;font-weight:bold">)</span><span style="color:#998;font-style:italic">//自动配置顺序
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#3c5d5d;font-weight:bold">@AutoConfigureAfter</span><span style="color:#000;font-weight:bold">({</span> DispatcherServletAutoConfiguration<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">,</span> TaskExecutionAutoConfiguration<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>		ValidationAutoConfiguration<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span> <span style="color:#000;font-weight:bold">})</span><span style="color:#998;font-style:italic">//在指定自动配置之后配置
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">WebMvcAutoConfiguration</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#998;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">         * a、自动配置视图解析器
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">         */</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#3c5d5d;font-weight:bold">@Bean</span><span style="color:#998;font-style:italic">//给容器中添加组件
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>		<span style="color:#3c5d5d;font-weight:bold">@ConditionalOnBean</span><span style="color:#000;font-weight:bold">(</span>ViewResolver<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@ConditionalOnMissingBean</span><span style="color:#000;font-weight:bold">(</span>name <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;viewResolver&#34;</span><span style="color:#000;font-weight:bold">,</span> value <span style="color:#000;font-weight:bold">=</span> ContentNegotiatingViewResolver<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">public</span> ContentNegotiatingViewResolver <span style="color:#900;font-weight:bold">viewResolver</span><span style="color:#000;font-weight:bold">(</span>BeanFactory beanFactory<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			ContentNegotiatingViewResolver resolver <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> ContentNegotiatingViewResolver<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			resolver<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setContentNegotiationManager</span><span style="color:#000;font-weight:bold">(</span>beanFactory<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getBean</span><span style="color:#000;font-weight:bold">(</span>ContentNegotiationManager<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>			<span style="color:#998;font-style:italic">// ContentNegotiatingViewResolver uses all the other view resolvers to locate
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>			<span style="color:#998;font-style:italic">// a view so it should have a high precedence
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>			resolver<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setOrder</span><span style="color:#000;font-weight:bold">(</span>Ordered<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">HIGHEST_PRECEDENCE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">return</span> resolver<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#998;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">         * 自动配置视图解析器
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">         */</span>
</span></span><span style="display:flex;"><span>        <span style="color:#3c5d5d;font-weight:bold">@Bean</span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@ConditionalOnBean</span><span style="color:#000;font-weight:bold">(</span>View<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@ConditionalOnMissingBean</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">public</span> BeanNameViewResolver <span style="color:#900;font-weight:bold">beanNameViewResolver</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			BeanNameViewResolver resolver <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> BeanNameViewResolver<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			resolver<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setOrder</span><span style="color:#000;font-weight:bold">(</span>Ordered<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">LOWEST_PRECEDENCE</span> <span style="color:#000;font-weight:bold">-</span> 10<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">return</span> resolver<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    	
</span></span><span style="display:flex;"><span>    	<span style="color:#998;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">         * b、提供静态资源访问路径和webjars访问路径
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">         */</span>
</span></span><span style="display:flex;"><span>    	<span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">protected</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">addResourceHandlers</span><span style="color:#000;font-weight:bold">(</span>ResourceHandlerRegistry registry<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">super</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">addResourceHandlers</span><span style="color:#000;font-weight:bold">(</span>registry<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(!</span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">resourceProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">isAddMappings</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>				logger<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">debug</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;Default resource handling disabled&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">return</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>			ServletContext servletContext <span style="color:#000;font-weight:bold">=</span> getServletContext<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			addResourceHandler<span style="color:#000;font-weight:bold">(</span>registry<span style="color:#000;font-weight:bold">,</span> <span style="color:#d14">&#34;/webjars/**&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#d14">&#34;classpath:/META-INF/resources/webjars/&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			addResourceHandler<span style="color:#000;font-weight:bold">(</span>registry<span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mvcProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getStaticPathPattern</span><span style="color:#000;font-weight:bold">(),</span> <span style="color:#000;font-weight:bold">(</span>registration<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">-&gt;</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>				registration<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">addResourceLocations</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">resourceProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getStaticLocations</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>servletContext <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>					registration<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">addResourceLocations</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">new</span> ServletContextResource<span style="color:#000;font-weight:bold">(</span>servletContext<span style="color:#000;font-weight:bold">,</span> SERVLET_LOCATION<span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">});</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">-----------------</span>内部类<span style="color:#000;font-weight:bold">--------------------</span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Configuration</span><span style="color:#000;font-weight:bold">(</span>proxyBeanMethods <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">false</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#3c5d5d;font-weight:bold">@Import</span><span style="color:#000;font-weight:bold">(</span>EnableWebMvcConfiguration<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#3c5d5d;font-weight:bold">@EnableConfigurationProperties</span><span style="color:#000;font-weight:bold">({</span> WebMvcProperties<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>			org<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">springframework</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">boot</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">autoconfigure</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">web</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">ResourceProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">,</span> WebProperties<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span> <span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span>	<span style="color:#3c5d5d;font-weight:bold">@Order</span><span style="color:#000;font-weight:bold">(</span>0<span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">WebMvcAutoConfigurationAdapter</span> <span style="color:#000;font-weight:bold">implements</span> WebMvcConfigurer <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">final</span> WebMvcProperties mvcProperties<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">final</span> ListableBeanFactory beanFactory<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">final</span> ObjectProvider<span style="color:#000;font-weight:bold">&lt;</span>HttpMessageConverters<span style="color:#000;font-weight:bold">&gt;</span> messageConvertersProvider<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">final</span> ObjectProvider<span style="color:#000;font-weight:bold">&lt;</span>DispatcherServletPath<span style="color:#000;font-weight:bold">&gt;</span> dispatcherServletPath<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">private</span> <span style="color:#000;font-weight:bold">final</span> ObjectProvider<span style="color:#000;font-weight:bold">&lt;</span>ServletRegistrationBean<span style="color:#000;font-weight:bold">&lt;?&gt;&gt;</span> servletRegistrations<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">final</span> ResourceHandlerRegistrationCustomizer resourceHandlerRegistrationCustomizer<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#998;font-style:italic">//该内部类只有一个带参构造方法，那么spring在创建该类实例时，只能从容器中获取参数；
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>		<span style="color:#000;font-weight:bold">public</span> <span style="color:#900;font-weight:bold">WebMvcAutoConfigurationAdapter</span><span style="color:#000;font-weight:bold">(</span>WebProperties webProperties<span style="color:#000;font-weight:bold">,</span> WebMvcProperties mvcProperties<span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>				ListableBeanFactory beanFactory<span style="color:#000;font-weight:bold">,</span> ObjectProvider<span style="color:#000;font-weight:bold">&lt;</span>HttpMessageConverters<span style="color:#000;font-weight:bold">&gt;</span> messageConvertersProvider<span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>				ObjectProvider<span style="color:#000;font-weight:bold">&lt;</span>ResourceHandlerRegistrationCustomizer<span style="color:#000;font-weight:bold">&gt;</span> resourceHandlerRegistrationCustomizerProvider<span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>				ObjectProvider<span style="color:#000;font-weight:bold">&lt;</span>DispatcherServletPath<span style="color:#000;font-weight:bold">&gt;</span> dispatcherServletPath<span style="color:#000;font-weight:bold">,</span>
</span></span><span style="display:flex;"><span>				ObjectProvider<span style="color:#000;font-weight:bold">&lt;</span>ServletRegistrationBean<span style="color:#000;font-weight:bold">&lt;?&gt;&gt;</span> servletRegistrations<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mvcProperties</span> <span style="color:#000;font-weight:bold">=</span> mvcProperties<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">beanFactory</span> <span style="color:#000;font-weight:bold">=</span> beanFactory<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">messageConvertersProvider</span> <span style="color:#000;font-weight:bold">=</span> messageConvertersProvider<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">resourceHandlerRegistrationCustomizer</span> <span style="color:#000;font-weight:bold">=</span> resourceHandlerRegistrationCustomizerProvider<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getIfAvailable</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">dispatcherServletPath</span> <span style="color:#000;font-weight:bold">=</span> dispatcherServletPath<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">servletRegistrations</span> <span style="color:#000;font-weight:bold">=</span> servletRegistrations<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mvcProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">checkConfiguration</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#998;font-style:italic">/**
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">         * c、自动注册Converter类型转换器
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">         */</span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">configureMessageConverters</span><span style="color:#000;font-weight:bold">(</span>List<span style="color:#000;font-weight:bold">&lt;</span>HttpMessageConverter<span style="color:#000;font-weight:bold">&lt;?&gt;&gt;</span> converters<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">messageConvertersProvider</span>
</span></span><span style="display:flex;"><span>					<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">ifAvailable</span><span style="color:#000;font-weight:bold">((</span>customConverters<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">-&gt;</span> converters<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">addAll</span><span style="color:#000;font-weight:bold">(</span>customConverters<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getConverters</span><span style="color:#000;font-weight:bold">()));</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">configureAsyncSupport</span><span style="color:#000;font-weight:bold">(</span>AsyncSupportConfigurer configurer<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">beanFactory</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">containsBean</span><span style="color:#000;font-weight:bold">(</span>TaskExecutionAutoConfiguration<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">APPLICATION_TASK_EXECUTOR_BEAN_NAME</span><span style="color:#000;font-weight:bold">))</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>				Object taskExecutor <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">beanFactory</span>
</span></span><span style="display:flex;"><span>						<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getBean</span><span style="color:#000;font-weight:bold">(</span>TaskExecutionAutoConfiguration<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">APPLICATION_TASK_EXECUTOR_BEAN_NAME</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>taskExecutor <span style="color:#000;font-weight:bold">instanceof</span> AsyncTaskExecutor<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>					configurer<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setTaskExecutor</span><span style="color:#000;font-weight:bold">(((</span>AsyncTaskExecutor<span style="color:#000;font-weight:bold">)</span> taskExecutor<span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>			Duration timeout <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mvcProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getAsync</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">getRequestTimeout</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>timeout <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>				configurer<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setDefaultTimeout</span><span style="color:#000;font-weight:bold">(</span>timeout<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">toMillis</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">configurePathMatch</span><span style="color:#000;font-weight:bold">(</span>PathMatchConfigurer configurer<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mvcProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getPathmatch</span><span style="color:#000;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span>					<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMatchingStrategy</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">==</span> WebMvcProperties<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">MatchingStrategy</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">PATH_PATTERN_PARSER</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>				configurer<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setPatternParser</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">new</span> PathPatternParser<span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>			configurer<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setUseSuffixPatternMatch</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mvcProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getPathmatch</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">isUseSuffixPattern</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>			configurer<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setUseRegisteredSuffixPatternMatch</span><span style="color:#000;font-weight:bold">(</span>
</span></span><span style="display:flex;"><span>					<span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mvcProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getPathmatch</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">isUseRegisteredSuffixPattern</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">dispatcherServletPath</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">ifAvailable</span><span style="color:#000;font-weight:bold">((</span>dispatcherPath<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">-&gt;</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>				String servletUrlMapping <span style="color:#000;font-weight:bold">=</span> dispatcherPath<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getServletUrlMapping</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>servletUrlMapping<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">equals</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;/&#34;</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">&amp;&amp;</span> singleDispatcherServlet<span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>					UrlPathHelper urlPathHelper <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> UrlPathHelper<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>					urlPathHelper<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setAlwaysUseFullPath</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">true</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>					configurer<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setUrlPathHelper</span><span style="color:#000;font-weight:bold">(</span>urlPathHelper<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">});</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">private</span> <span style="color:#458;font-weight:bold">boolean</span> <span style="color:#900;font-weight:bold">singleDispatcherServlet</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">servletRegistrations</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">stream</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">map</span><span style="color:#000;font-weight:bold">(</span>ServletRegistrationBean<span style="color:#000;font-weight:bold">::</span>getServlet<span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>					<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">filter</span><span style="color:#000;font-weight:bold">(</span>DispatcherServlet<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">::</span>isInstance<span style="color:#000;font-weight:bold">).</span><span style="color:#008080">count</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">==</span> 1<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">configureContentNegotiation</span><span style="color:#000;font-weight:bold">(</span>ContentNegotiationConfigurer configurer<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			WebMvcProperties<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">Contentnegotiation</span> contentnegotiation <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mvcProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getContentnegotiation</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			configurer<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">favorPathExtension</span><span style="color:#000;font-weight:bold">(</span>contentnegotiation<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">isFavorPathExtension</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>			configurer<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">favorParameter</span><span style="color:#000;font-weight:bold">(</span>contentnegotiation<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">isFavorParameter</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>contentnegotiation<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getParameterName</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>				configurer<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">parameterName</span><span style="color:#000;font-weight:bold">(</span>contentnegotiation<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getParameterName</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>			Map<span style="color:#000;font-weight:bold">&lt;</span>String<span style="color:#000;font-weight:bold">,</span> MediaType<span style="color:#000;font-weight:bold">&gt;</span> mediaTypes <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mvcProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getContentnegotiation</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">getMediaTypes</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			mediaTypes<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">forEach</span><span style="color:#000;font-weight:bold">(</span>configurer<span style="color:#000;font-weight:bold">::</span>mediaType<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@Bean</span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@ConditionalOnMissingBean</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">public</span> InternalResourceViewResolver <span style="color:#900;font-weight:bold">defaultViewResolver</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			InternalResourceViewResolver resolver <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> InternalResourceViewResolver<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			resolver<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setPrefix</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mvcProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getView</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">getPrefix</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>			resolver<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setSuffix</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mvcProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getView</span><span style="color:#000;font-weight:bold">().</span><span style="color:#008080">getSuffix</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">return</span> resolver<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@Bean</span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@ConditionalOnBean</span><span style="color:#000;font-weight:bold">(</span>View<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@ConditionalOnMissingBean</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">public</span> BeanNameViewResolver <span style="color:#900;font-weight:bold">beanNameViewResolver</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			BeanNameViewResolver resolver <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> BeanNameViewResolver<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			resolver<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setOrder</span><span style="color:#000;font-weight:bold">(</span>Ordered<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">LOWEST_PRECEDENCE</span> <span style="color:#000;font-weight:bold">-</span> 10<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">return</span> resolver<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@Bean</span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@ConditionalOnBean</span><span style="color:#000;font-weight:bold">(</span>ViewResolver<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@ConditionalOnMissingBean</span><span style="color:#000;font-weight:bold">(</span>name <span style="color:#000;font-weight:bold">=</span> <span style="color:#d14">&#34;viewResolver&#34;</span><span style="color:#000;font-weight:bold">,</span> value <span style="color:#000;font-weight:bold">=</span> ContentNegotiatingViewResolver<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">public</span> ContentNegotiatingViewResolver <span style="color:#900;font-weight:bold">viewResolver</span><span style="color:#000;font-weight:bold">(</span>BeanFactory beanFactory<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			ContentNegotiatingViewResolver resolver <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> ContentNegotiatingViewResolver<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			resolver<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setContentNegotiationManager</span><span style="color:#000;font-weight:bold">(</span>beanFactory<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getBean</span><span style="color:#000;font-weight:bold">(</span>ContentNegotiationManager<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>			<span style="color:#998;font-style:italic">// ContentNegotiatingViewResolver uses all the other view resolvers to locate
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>			<span style="color:#998;font-style:italic">// a view so it should have a high precedence
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>			resolver<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setOrder</span><span style="color:#000;font-weight:bold">(</span>Ordered<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">HIGHEST_PRECEDENCE</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">return</span> resolver<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#998;font-style:italic">//e、自动注册消息代码提示处理器MessageCodesResolver
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>		<span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">public</span> MessageCodesResolver <span style="color:#900;font-weight:bold">getMessageCodesResolver</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mvcProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMessageCodesResolverFormat</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>				DefaultMessageCodesResolver resolver <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> DefaultMessageCodesResolver<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>				resolver<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">setMessageCodeFormatter</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mvcProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getMessageCodesResolverFormat</span><span style="color:#000;font-weight:bold">());</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">return</span> resolver<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>		<span style="color:#998;font-style:italic">//获取所有的格式化器和转换器
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>		<span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">addFormatters</span><span style="color:#000;font-weight:bold">(</span>FormatterRegistry registry<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			ApplicationConversionService<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">addBeans</span><span style="color:#000;font-weight:bold">(</span>registry<span style="color:#000;font-weight:bold">,</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">beanFactory</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">---------------------------------------------------------</span>  
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//EnableWebMvcConfiguration内部类：
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>       <span style="color:#998;font-style:italic">// c、自动注册Formatter格式化器；
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#3c5d5d;font-weight:bold">@Bean</span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">public</span> FormattingConversionService <span style="color:#900;font-weight:bold">mvcConversionService</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			Format format <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">mvcProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getFormat</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			WebConversionService conversionService <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">new</span> WebConversionService<span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">new</span> DateTimeFormatters<span style="color:#000;font-weight:bold">()</span>
</span></span><span style="display:flex;"><span>					<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">dateFormat</span><span style="color:#000;font-weight:bold">(</span>format<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getDate</span><span style="color:#000;font-weight:bold">()).</span><span style="color:#008080">timeFormat</span><span style="color:#000;font-weight:bold">(</span>format<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getTime</span><span style="color:#000;font-weight:bold">()).</span><span style="color:#008080">dateTimeFormat</span><span style="color:#000;font-weight:bold">(</span>format<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getDateTime</span><span style="color:#000;font-weight:bold">()));</span>
</span></span><span style="display:flex;"><span>			addFormatters<span style="color:#000;font-weight:bold">(</span>conversionService<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">return</span> conversionService<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        <span style="color:#998;font-style:italic">//f、支持静态首页index.html访问
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">private</span> Resource <span style="color:#900;font-weight:bold">getWelcomePage</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">for</span> <span style="color:#000;font-weight:bold">(</span>String location <span style="color:#000;font-weight:bold">:</span> <span style="color:#000;font-weight:bold">this</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">resourceProperties</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getStaticLocations</span><span style="color:#000;font-weight:bold">())</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>				Resource indexHtml <span style="color:#000;font-weight:bold">=</span> getIndexHtml<span style="color:#000;font-weight:bold">(</span>location<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>indexHtml <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>					<span style="color:#000;font-weight:bold">return</span> indexHtml<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>			ServletContext servletContext <span style="color:#000;font-weight:bold">=</span> getServletContext<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">if</span> <span style="color:#000;font-weight:bold">(</span>servletContext <span style="color:#000;font-weight:bold">!=</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>				<span style="color:#000;font-weight:bold">return</span> getIndexHtml<span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">new</span> ServletContextResource<span style="color:#000;font-weight:bold">(</span>servletContext<span style="color:#000;font-weight:bold">,</span> SERVLET_LOCATION<span style="color:#000;font-weight:bold">));</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>        
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">-------------------------------------------------------</span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@Bean</span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@ConditionalOnMissingBean</span><span style="color:#000;font-weight:bold">({</span> RequestContextListener<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">,</span> RequestContextFilter<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span> <span style="color:#000;font-weight:bold">})</span>
</span></span><span style="display:flex;"><span>		<span style="color:#3c5d5d;font-weight:bold">@ConditionalOnMissingFilterBean</span><span style="color:#000;font-weight:bold">(</span>RequestContextFilter<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">class</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">static</span> RequestContextFilter <span style="color:#900;font-weight:bold">requestContextFilter</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>			<span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">new</span> OrderedRequestContextFilter<span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>		<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>	<span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span>a<span style="color:#a61717;background-color:#e3d2d2">、</span>自动配置视图解析器ViewResolver<span style="color:#a61717;background-color:#e3d2d2">（</span>ContentNegotiatingViewResolver 和 BeanNameViewResolver<span style="color:#a61717;background-color:#e3d2d2">）</span><span style="color:#000;font-weight:bold">,</span>作用<span style="color:#a61717;background-color:#e3d2d2">：</span>根据方法返回值得到视图对象<span style="color:#a61717;background-color:#e3d2d2">，</span>由视图对象决定请求转发或者重定向到指定视图<span style="color:#a61717;background-color:#e3d2d2">。（</span>注意<span style="color:#a61717;background-color:#e3d2d2">：</span>此处会创建获取容器中的所有视图解析器<span style="color:#a61717;background-color:#e3d2d2">，</span>包括自定义的视图解析器<span style="color:#a61717;background-color:#e3d2d2">）</span>
</span></span><span style="display:flex;"><span>b<span style="color:#a61717;background-color:#e3d2d2">、</span>提供静态资源访问路径和webjars访问路径<span style="color:#a61717;background-color:#e3d2d2">；</span>
</span></span><span style="display:flex;"><span>c<span style="color:#a61717;background-color:#e3d2d2">、</span>自动注册Converter类型转换器<span style="color:#000;font-weight:bold">,</span>Formatter格式化器<span style="color:#a61717;background-color:#e3d2d2">；</span>
</span></span><span style="display:flex;"><span>d<span style="color:#a61717;background-color:#e3d2d2">、</span>提供HttpMessageConverters<span style="color:#a61717;background-color:#e3d2d2">，</span>用于Http请求和响应之间的转换<span style="color:#a61717;background-color:#e3d2d2">，</span>将json或者xml格式字符串和java类型之间做转换<span style="color:#a61717;background-color:#e3d2d2">；</span>
</span></span><span style="display:flex;"><span><span style="color:#a61717;background-color:#e3d2d2">（</span>注意<span style="color:#a61717;background-color:#e3d2d2">：</span>如果要自定义类型转换器<span style="color:#a61717;background-color:#e3d2d2">，</span>也可以通过该接口注册<span style="color:#a61717;background-color:#e3d2d2">）</span>
</span></span><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Configuration</span><span style="color:#000;font-weight:bold">(</span>proxyBeanMethods <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">false</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">MyConfiguration</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Bean</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> HttpMessageConverters <span style="color:#900;font-weight:bold">customConverters</span><span style="color:#000;font-weight:bold">()</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        HttpMessageConverter<span style="color:#000;font-weight:bold">&lt;?&gt;</span> additional <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span>        HttpMessageConverter<span style="color:#000;font-weight:bold">&lt;?&gt;</span> another <span style="color:#000;font-weight:bold">=</span> <span style="color:#000;font-weight:bold">...</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">new</span> HttpMessageConverters<span style="color:#000;font-weight:bold">(</span>additional<span style="color:#000;font-weight:bold">,</span> another<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>e<span style="color:#a61717;background-color:#e3d2d2">、</span>自动注册消息代码提示处理器MessageCodesResolver
</span></span><span style="display:flex;"><span>f<span style="color:#a61717;background-color:#e3d2d2">、</span>支持静态首页index<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">html访问</span>
</span></span><span style="display:flex;"><span>g<span style="color:#a61717;background-color:#e3d2d2">、</span>自动注册web数据参数绑定对象ConfigurableWebBindingInitializer<span style="color:#a61717;background-color:#e3d2d2">，</span>如果我们自己注册了该类型对象<span style="color:#a61717;background-color:#e3d2d2">，</span>那springboot会自动调用我们注册的对象<span style="color:#a61717;background-color:#e3d2d2">，</span>替换默认对象将请求参数绑定到javabean<span style="color:#a61717;background-color:#e3d2d2">（</span>了解<span style="color:#a61717;background-color:#e3d2d2">）。</span>
</span></span><span style="display:flex;"><span>h<span style="color:#a61717;background-color:#e3d2d2">、</span>如果要自定义拦截器interceptors<span style="color:#a61717;background-color:#e3d2d2">，</span>格式化器formatters<span style="color:#a61717;background-color:#e3d2d2">，</span>视图控制器view controllers等<span style="color:#a61717;background-color:#e3d2d2">，</span>可以通过创建类型为WebMvcConfigurer的配置类来实现<span style="color:#a61717;background-color:#e3d2d2">，</span>不要加注解<span style="color:#3c5d5d;font-weight:bold">@EnableWebMvc</span><span style="color:#a61717;background-color:#e3d2d2">。</span>
</span></span><span style="display:flex;"><span>i<span style="color:#a61717;background-color:#e3d2d2">、</span>如果要自定义处理器映射器RequestMappingHandlerMapping<span style="color:#000;font-weight:bold">,</span> 处理器适配器RequestMappingHandlerAdapter<span style="color:#000;font-weight:bold">,</span> 或者异常处理器ExceptionHandlerExceptionResolver<span style="color:#a61717;background-color:#e3d2d2">，</span>可以在容器中创建类型为WebMvcRegistrations的组件对象来实现<span style="color:#a61717;background-color:#e3d2d2">。</span>
</span></span><span style="display:flex;"><span>j<span style="color:#a61717;background-color:#e3d2d2">、</span>如果想要完全使用自定义配置<span style="color:#a61717;background-color:#e3d2d2">，</span>不使用springboot默认配置<span style="color:#a61717;background-color:#e3d2d2">，</span>可以在配置类上加注解<span style="color:#3c5d5d;font-weight:bold">@EnableWebMvc</span><span style="color:#a61717;background-color:#e3d2d2">。（</span>不推荐<span style="color:#a61717;background-color:#e3d2d2">）</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>参考官方文档<span style="color:#a61717;background-color:#e3d2d2">：</span>https<span style="color:#000;font-weight:bold">:</span><span style="color:#998;font-style:italic">//docs.spring.io/spring-boot/docs/2.4.3/reference/html/spring-boot-features.html#boot-features-spring-mvc
</span></span></span></code></pre></div><h5 id="4小结">（4）小结</h5>
<pre tabindex="0"><code>a、SpringBoot启动会加载大量的自动配置类 
b、根据配置文件和xxxProperties的默认设置初始化自动配置类中的组件
c、可以在自动配置类中查看我们需要的功能是否已经自动配置，如果配置，我们就不用再做配置了；
</code></pre><h4 id="2自定义配置实现访问拦截">2、自定义配置实现访问拦截</h4>
<h4 id="1自定义拦截器">（1）自定义拦截器</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">MyIntercepter</span> <span style="color:#000;font-weight:bold">implements</span> HandlerInterceptor <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">boolean</span> <span style="color:#900;font-weight:bold">preHandle</span><span style="color:#000;font-weight:bold">(</span>HttpServletRequest request<span style="color:#000;font-weight:bold">,</span> HttpServletResponse response<span style="color:#000;font-weight:bold">,</span> Object handler<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Exception <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        HttpSession session <span style="color:#000;font-weight:bold">=</span> request<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getSession</span><span style="color:#000;font-weight:bold">();</span>
</span></span><span style="display:flex;"><span>        String username<span style="color:#000;font-weight:bold">=(</span>String<span style="color:#000;font-weight:bold">)</span>session<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getAttribute</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;username&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">if</span><span style="color:#000;font-weight:bold">(</span>username<span style="color:#000;font-weight:bold">!=</span><span style="color:#000;font-weight:bold">null</span><span style="color:#000;font-weight:bold">){</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;登录成功不拦截&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">true</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span><span style="color:#000;font-weight:bold">else</span><span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>            request<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">getRequestDispatcher</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;/index.html&#34;</span><span style="color:#000;font-weight:bold">).</span><span style="color:#008080">forward</span><span style="color:#000;font-weight:bold">(</span>request<span style="color:#000;font-weight:bold">,</span>response<span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            System<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">out</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">println</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;未登录拦截&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">return</span> <span style="color:#000;font-weight:bold">false</span><span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">postHandle</span><span style="color:#000;font-weight:bold">(</span>HttpServletRequest request<span style="color:#000;font-weight:bold">,</span> HttpServletResponse response<span style="color:#000;font-weight:bold">,</span> Object handler<span style="color:#000;font-weight:bold">,</span> ModelAndView modelAndView<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Exception <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">afterCompletion</span><span style="color:#000;font-weight:bold">(</span>HttpServletRequest request<span style="color:#000;font-weight:bold">,</span> HttpServletResponse response<span style="color:#000;font-weight:bold">,</span> Object handler<span style="color:#000;font-weight:bold">,</span> Exception ex<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">throws</span> Exception <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="2注册拦截器">（2）注册拦截器</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#3c5d5d;font-weight:bold">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">MyConfig</span> <span style="color:#000;font-weight:bold">implements</span> WebMvcConfigurer <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>   
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">addInterceptors</span><span style="color:#000;font-weight:bold">(</span>InterceptorRegistry registry<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        registry<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">addInterceptor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">new</span> MyIntercepter<span style="color:#000;font-weight:bold">()).</span><span style="color:#008080">addPathPatterns</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;/**&#34;</span><span style="color:#000;font-weight:bold">).</span><span style="color:#008080">excludePathPatterns</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;/&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#d14">&#34;/index.html&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#d14">&#34;/user/login&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="3自定义配置视图控制器">3、自定义配置视图控制器</h4>
<div class="highlight"><pre tabindex="0" style="background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-java" data-lang="java"><span style="display:flex;"><span><span style="color:#998;font-style:italic">//springboot默认不支持jsp，而是使用模板引擎thymeleaf作为视图
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//引入thymeleaf
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>        <span style="color:#000;font-weight:bold">&lt;</span>dependency<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">&lt;</span>groupId<span style="color:#000;font-weight:bold">&gt;</span>org<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">springframework</span><span style="color:#000;font-weight:bold">.</span><span style="color:#008080">boot</span><span style="color:#000;font-weight:bold">&lt;/</span>groupId<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>            <span style="color:#000;font-weight:bold">&lt;</span>artifactId<span style="color:#000;font-weight:bold">&gt;</span>spring<span style="color:#000;font-weight:bold">-</span>boot<span style="color:#000;font-weight:bold">-</span>starter<span style="color:#000;font-weight:bold">-</span>thymeleaf<span style="color:#000;font-weight:bold">&lt;/</span>artifactId<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span>        <span style="color:#000;font-weight:bold">&lt;/</span>dependency<span style="color:#000;font-weight:bold">&gt;</span>
</span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic">//配置视图控制器
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span><span style="color:#3c5d5d;font-weight:bold">@Configuration</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">public</span> <span style="color:#000;font-weight:bold">class</span> <span style="color:#458;font-weight:bold">MyConfig</span> <span style="color:#000;font-weight:bold">implements</span> WebMvcConfigurer <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">addInterceptors</span><span style="color:#000;font-weight:bold">(</span>InterceptorRegistry registry<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        registry<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">addInterceptor</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000;font-weight:bold">new</span> MyIntercepter<span style="color:#000;font-weight:bold">()).</span><span style="color:#008080">addPathPatterns</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;/**&#34;</span><span style="color:#000;font-weight:bold">).</span><span style="color:#008080">excludePathPatterns</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;/&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#d14">&#34;/index.html&#34;</span><span style="color:#000;font-weight:bold">,</span><span style="color:#d14">&#34;/user/login&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span>	<span style="color:#998;font-style:italic">//配置视图控制器
</span></span></span><span style="display:flex;"><span><span style="color:#998;font-style:italic"></span>    <span style="color:#3c5d5d;font-weight:bold">@Override</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">public</span> <span style="color:#458;font-weight:bold">void</span> <span style="color:#900;font-weight:bold">addViewControllers</span><span style="color:#000;font-weight:bold">(</span>ViewControllerRegistry registry<span style="color:#000;font-weight:bold">)</span> <span style="color:#000;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        registry<span style="color:#000;font-weight:bold">.</span><span style="color:#008080">addViewController</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;/main&#34;</span><span style="color:#000;font-weight:bold">).</span><span style="color:#008080">setViewName</span><span style="color:#000;font-weight:bold">(</span><span style="color:#d14">&#34;main&#34;</span><span style="color:#000;font-weight:bold">);</span>
</span></span><span style="display:flex;"><span>    <span style="color:#000;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">}</span>
</span></span></code></pre></div><h4 id="4学员练习自动配置拦截器">4、学员练习自动配置拦截器</h4>

    </div>

    

    


    <div class="container-prevnext">
    <div><a href="https://lovemjh.vercel.app/posts/tool/20220526164948/">← Redis</a></div>
    <div><a href="https://lovemjh.vercel.app/posts/java-frame/20220526213257/">Spring-Boot-2  →</a></div>
</div>
</div>

        </div>
        <div id="footer"><div class="container-footer">
    
    <a href="//beian.miit.gov.cn" target="_blank">
        
        豫ICP备2022002918号
        
    </a>
    <a id="s" href="/secrets">&nbsp;</a>
</div></div>
    </body>
</html>
